/*	SCCS Id: @(#)makemon.c	3.4	2003/09/06	*/
/* Copyright (c) Stichting Mathematisch Centrum, Amsterdam, 1985. */
/* NetHack may be freely redistributed.  See license for details. */

#include "hack.h"
#include "epri.h"
#include "emin.h"
#include "edog.h"
#include "quest.h"
#include "qtext.h"
#ifdef REINCARNATION
#include <ctype.h>
#endif

STATIC_VAR NEARDATA struct monst zeromonst;

/* this assumes that a human quest leader or nemesis is an archetype
   of the corresponding role; that isn't so for some roles (tourist
   for instance) but is for the priests and monks we use it for... */
#define quest_mon_represents_role(mptr,role_pm) \
		(mptr->mlet == S_HUMAN && Role_if(role_pm) && \
		  (mptr->msound == MS_LEADER || mptr->msound == MS_NEMESIS))

#ifdef OVL0
STATIC_DCL boolean uncommon(int);
STATIC_DCL int align_shift(struct permonst *);
#endif /* OVL0 */
STATIC_DCL boolean wrong_elem_type(struct permonst *);
STATIC_DCL void m_initgrp(struct monst *,int,int,int);
STATIC_DCL void m_initthrow(struct monst *,int,int);
STATIC_DCL void m_initweap(struct monst *);
STATIC_DCL void m_initxtraitem(struct monst *);
STATIC_DCL void m_initweap_normal(struct monst *);
STATIC_DCL void m_initarmorpieces(struct monst *);
#ifdef OVL1
STATIC_DCL void m_initinv(struct monst *);
#endif /* OVL1 */

extern const int monstr[];

#define m_initsgrp(mtmp, x, y)	m_initgrp(mtmp, x, y, 3)
#define m_initlgrp(mtmp, x, y)	m_initgrp(mtmp, x, y, 10)
#define m_initvlgrp(mtmp, x, y)  m_initgrp(mtmp, x, y, 20)
#define m_initxlgrp(mtmp, x, y)  m_initgrp(mtmp, x, y, 40)
#define m_initxxlgrp(mtmp, x, y)  m_initgrp(mtmp, x, y, 100)
#define toostrong(monindx, lev) (monstr[monindx] > lev)
#define tooweak(monindx, lev)	(monstr[monindx] < lev)
#define Qstats(x)	(quest_status.x)

#ifdef OVLB
boolean
is_home_elemental(ptr)
register struct permonst *ptr;
{
	if (ptr->mlet == S_ELEMENTAL)
	    switch (monsndx(ptr)) {
		case PM_AIR_ELEMENTAL: return Is_airlevel(&u.uz);
		case PM_FIRE_ELEMENTAL: return Is_firelevel(&u.uz);
		case PM_EARTH_ELEMENTAL: return Is_earthlevel(&u.uz);
		case PM_WATER_ELEMENTAL: return Is_waterlevel(&u.uz);
		case PM_ASTRAL_ELEMENTAL: return Is_astralevel(&u.uz);
	    }
	return FALSE;
}

boolean
monster_with_trait(ptr, type)
register struct permonst *ptr;
int type;
{
	if (type > 425) { /* same as monstercolor function */

	}

	if (( (type == 1 && !(ptr->msound == MS_SILENT)) || (type == 2 && !(ptr->msound == MS_BARK)) || (type == 3 && !(ptr->msound == MS_MEW)) || (type == 4 && !(ptr->msound == MS_ROAR)) || (type == 5 && !(ptr->msound == MS_GROWL)) || (type == 6 && !(ptr->msound == MS_SQEEK)) || (type == 7 && !(ptr->msound == MS_SQAWK)) || (type == 8 && !(ptr->msound == MS_HISS)) || (type == 9 && !(ptr->msound == MS_BUZZ)) || (type == 10 && !(ptr->msound == MS_GRUNT)) || (type == 11 && !(ptr->msound == MS_NEIGH)) || (type == 12 && !(ptr->msound == MS_WAIL)) || (type == 13 && !(ptr->msound == MS_GURGLE)) || (type == 14 && !(ptr->msound == MS_BURBLE)) || (type == 15 && !(ptr->msound == MS_SHRIEK)) || (type == 16 && !(ptr->msound == MS_BONES)) || (type == 17 && !(ptr->msound == MS_LAUGH)) || (type == 18 && !(ptr->msound == MS_MUMBLE)) || (type == 19 && !(ptr->msound == MS_IMITATE)) || (type == 20 && !(ptr->msound == MS_ORC)) || (type == 21 && !(ptr->msound == MS_HUMANOID)) || (type == 22 && !(ptr->msound == MS_ARREST)) || (type == 23 && !(ptr->msound == MS_SOLDIER)) || (type == 24 && !(ptr->msound == MS_DJINNI)) || (type == 25 && !(ptr->msound == MS_NURSE)) || (type == 26 && !(ptr->msound == MS_SEDUCE)) || (type == 27 && !(ptr->msound == MS_VAMPIRE)) || (type == 28 && !(ptr->msound == MS_CUSS)) || (type == 29 && !(ptr->msound == MS_NEMESIS)) || (type == 30 && !(ptr->msound == MS_SPELL)) || (type == 31 && !(ptr->msound == MS_WERE)) || (type == 32 && !(ptr->msound == MS_BOAST)) || (type == 33 && !(ptr->msound == MS_SHEEP)) || (type == 34 && !(ptr->msound == MS_CHICKEN)) || (type == 35 && !(ptr->msound == MS_COW)) || (type == 36 && !(ptr->msound == MS_PARROT)) || (type == 37 && !(ptr->msound == MS_WHORE)) || (type == 38 && !(ptr->msound == MS_FART_QUIET)) || (type == 39 && !(ptr->msound == MS_FART_NORMAL)) || (type == 40 && !(ptr->msound == MS_FART_LOUD)) || (type == 41 && !(ptr->msound == MS_BOSS)) || (type == 42 && !(ptr->msound == MS_SOUND)) || (type == 43 && !(ptr->mresists & MR_FIRE)) || (type == 44 && !(ptr->mresists & MR_COLD)) || (type == 45 && !(ptr->mresists & MR_SLEEP)) || (type == 46 && !(ptr->mresists & MR_DISINT)) || (type == 47 && !(ptr->mresists & MR_ELEC)) || (type == 48 && !(ptr->mresists & MR_POISON)) || (type == 49 && !(ptr->mresists & MR_ACID)) || (type == 50 && !(ptr->mresists & MR_STONE)) || (type == 51 && !(ptr->mresists & MR_DEATH)) || (type == 52 && !(ptr->mresists & MR_DRAIN)) || (type == 53 && !(ptr->mresists & MR_PLUSONE)) || (type == 54 && !(ptr->mresists & MR_PLUSTWO)) || (type == 55 && !(ptr->mresists & MR_PLUSTHREE)) || (type == 56 && !(ptr->mresists & MR_PLUSFOUR)) || (type == 57 && !(ptr->mresists & MR_HITASONE)) || (type == 58 && !(ptr->mresists & MR_HITASTWO)) || (type == 59 && !(ptr->mresists & MR_HITASTHREE)) || (type == 60 && !(ptr->mresists & MR_HITASFOUR)) || (type == 61 && !(ptr->mflags1 & M1_FLY)) || (type == 62 && !(ptr->mflags1 & M1_SWIM)) || (type == 63 && !(ptr->mflags1 & M1_AMORPHOUS)) || (type == 64 && !(ptr->mflags1 & M1_WALLWALK)) || (type == 65 && !(ptr->mflags1 & M1_CLING)) || (type == 66 && !(ptr->mflags1 & M1_TUNNEL)) || (type == 67 && !(ptr->mflags1 & M1_NEEDPICK)) || (type == 68 && !(ptr->mflags1 & M1_CONCEAL)) || (type == 69 && !(ptr->mflags1 & M1_HIDE)) || (type == 70 && !(ptr->mflags1 & M1_AMPHIBIOUS)) || (type == 71 && !(ptr->mflags1 & M1_BREATHLESS)) || (type == 72 && !(ptr->mflags1 & M1_NOTAKE)) || (type == 73 && !(ptr->mflags1 & M1_NOEYES)) || (type == 74 && !(ptr->mflags1 & M1_NOHANDS)) || (type == 75 && !(ptr->mflags1 & M1_NOLIMBS)) || (type == 76 && !(ptr->mflags1 & M1_NOHEAD)) || (type == 77 && !(ptr->mflags1 & M1_MINDLESS)) || (type == 78 && !(ptr->mflags1 & M1_HUMANOID)) || (type == 79 && !(ptr->mflags1 & M1_ANIMAL)) || (type == 80 && !(ptr->mflags1 & M1_SLITHY)) || (type == 81 && !(ptr->mflags1 & M1_UNSOLID)) || (type == 82 && !(ptr->mflags1 & M1_THICK_HIDE)) || (type == 83 && !(ptr->mflags1 & M1_OVIPAROUS)) || (type == 84 && !(ptr->mflags1 & M1_REGEN)) || (type == 85 && !(ptr->mflags1 & M1_SEE_INVIS)) || (type == 86 && !(ptr->mflags1 & M1_TPORT)) || (type == 87 && !(ptr->mflags1 & M1_TPORT_CNTRL)) || (type == 88 && !(ptr->mflags1 & M1_ACID)) || (type == 89 && !(ptr->mflags1 & M1_POIS)) || (type == 90 && !(ptr->mflags1 & M1_CARNIVORE)) || (type == 91 && !(ptr->mflags1 & M1_HERBIVORE)) || (type == 92 && !(ptr->mflags1 & M1_OMNIVORE)) || (type == 93 && !(ptr->mflags1 & M1_METALLIVORE)) || (type == 94 && !(ptr->mflags2 & M2_NOPOLY)) || (type == 95 && !(ptr->mflags2 & M2_UNDEAD)) || (type == 96 && !(ptr->mflags2 & M2_MERC)) || (type == 97 && !(ptr->mflags2 & M2_HUMAN)) || (type == 98 && !(ptr->mflags2 & M2_ELF)) || (type == 99 && !(ptr->mflags2 & M2_DWARF)) || (type == 100 && !(ptr->mflags2 & M2_GNOME)) || (type == 101 && !(ptr->mflags2 & M2_ORC)) || (type == 102 && !(ptr->mflags2 & M2_HOBBIT)) || (type == 103 && !(ptr->mflags2 & M2_WERE)) || (type == 104 && !(ptr->mflags2 & M2_VAMPIRE)) || (type == 105 && !(ptr->mflags2 & M2_LORD)) || (type == 106 && !(ptr->mflags2 & M2_PRINCE)) || (type == 107 && !(ptr->mflags2 & M2_MINION)) || (type == 108 && !(ptr->mflags2 & M2_GIANT)) || (type == 109 && !(ptr->mflags2 & M2_DEMON)) || (type == 110 && !(ptr->mflags2 & M2_MALE)) || (type == 111 && !(ptr->mflags2 & M2_FEMALE)) || (type == 112 && !(ptr->mflags2 & M2_NEUTER)) || (type == 113 && !(ptr->mflags2 & M2_PNAME)) || (type == 114 && !(ptr->mflags2 & M2_HOSTILE)) || (type == 115 && !(ptr->mflags2 & M2_PEACEFUL)) || (type == 116 && !(ptr->mflags2 & M2_DOMESTIC)) || (type == 117 && !(ptr->mflags2 & M2_WANDER)) || (type == 118 && !(ptr->mflags2 & M2_STALK)) || (type == 119 && !(ptr->mflags2 & M2_NASTY)) || (type == 120 && !(ptr->mflags2 & M2_STRONG)) || (type == 121 && !(ptr->mflags2 & M2_ROCKTHROW)) || (type == 122 && !(ptr->mflags2 & M2_GREEDY))  || (type == 123 && !(ptr->mflags2 & M2_JEWELS)) || (type == 124 && !(ptr->mflags2 & M2_COLLECT)) || (type == 125 && !(ptr->mflags2 & M2_MAGIC)) || (type == 126 && !(ptr->mflags3 & M3_WANTSAMUL)) || (type == 127 && !(ptr->mflags3 & M3_WANTSBELL)) || (type == 128 && !(ptr->mflags3 & M3_WANTSBOOK)) || (type == 129 && !(ptr->mflags3 & M3_WANTSCAND)) || (type == 130 && !(ptr->mflags3 & M3_WANTSARTI)) || (type == 131 && !(ptr->mflags3 & M3_WAITFORU)) || (type == 132 && !(ptr->mflags3 & M3_CLOSE)) || (type == 133 && !(ptr->mflags3 & M3_INFRAVISION)) || (type == 134 && !(ptr->mflags3 & M3_INFRAVISIBLE)) || (type == 135 && !(ptr->mflags3 & M3_TRAITOR)) || (type == 136 && !(ptr->mflags3 & M3_NOTAME)) || (type == 137 && !(ptr->mflags3 & M3_AVOIDER)) || (type == 138 && !(ptr->mflags3 & M3_LITHIVORE)) || (type == 139 && !(ptr->mflags3 & M3_PETTY)) || (type == 140 && !(ptr->mflags3 & M3_POKEMON)) || (type == 141 && !(ptr->mflags3 & M3_NOPLRPOLY)) || (type == 142 && !(ptr->mflags3 & M3_NONMOVING)) || (type == 143 && !(ptr->mflags3 & M3_EGOTYPE)) || (type == 144 && !(ptr->mflags3 & M3_TELEPATHIC)) || (type == 145 && !(ptr->mflags3 & M3_SPIDER)) || (type == 146 && !(ptr->mflags3 & M3_PETRIFIES)) || (type == 147 && !(ptr->mflags3 & M3_IS_MIND_FLAYER)) || (type == 148 && !(ptr->mflags3 & M3_NO_DECAY)) || (type == 149 && !(ptr->mflags3 & M3_MIMIC)) || (type == 150 && !(ptr->mflags3 & M3_PERMAMIMIC)) || (type == 151 && !(ptr->mflags3 & M3_SLIME)) || (type == 152 && !(ptr->mflags3 & M3_FREQ_UNCOMMON2)) || (type == 153 && !(ptr->mflags3 & M3_FREQ_UNCOMMON3)) || (type == 154 && !(ptr->mflags3 & M3_FREQ_UNCOMMON5)) || (type == 155 && !(ptr->mflags3 & M3_FREQ_UNCOMMON7)) || (type == 156 && !(ptr->mflags3 & M3_FREQ_UNCOMMON10)) || (type == 157 && !(ptr->mflags3 & M3_MIND_FLAYER)) || (type == 158 && !(ptr->msize == MZ_TINY)) || (type == 159 && !(ptr->msize == MZ_SMALL)) || (type == 160 && !(ptr->msize == MZ_MEDIUM)) || (type == 161 && !(ptr->msize == MZ_LARGE)) || (type == 162 && !(ptr->msize == MZ_HUGE)) || (type == 163 && !(ptr->msize == MZ_GIGANTIC)) || (type == 164 && !(ptr->geno & G_VLGROUP)) || (type == 165 && !(ptr->geno & G_UNIQ)) || (type == 166 && !(ptr->geno & G_SGROUP)) || (type == 167 && !(ptr->geno & G_LGROUP)) || (type == 168 && !(ptr->geno & G_GENO)) || (type == 169 && !(ptr->geno & G_NOCORPSE)) || (type == 170 && !haspassive(ptr)) || (type == 171 && !attacktype(ptr, AT_CLAW)) || (type == 172 && !attacktype(ptr, AT_BITE)) || (type == 173 && !attacktype(ptr, AT_KICK)) || (type == 174 && !attacktype(ptr, AT_BUTT)) || (type == 175 && !attacktype(ptr, AT_TUCH)) || (type == 176 && !attacktype(ptr, AT_STNG)) || (type == 177 && !attacktype(ptr, AT_HUGS)) || (type == 178 && !attacktype(ptr, AT_SCRA)) || (type == 179 && !attacktype(ptr, AT_LASH)) || (type == 180 && !attacktype(ptr, AT_SPIT)) || (type == 181 && !attacktype(ptr, AT_ENGL)) || (type == 182 && !attacktype(ptr, AT_BREA)) || (type == 183 && !attacktype(ptr, AT_EXPL)) || (type == 184 && !attacktype(ptr, AT_BOOM)) || (type == 185 && !attacktype(ptr, AT_GAZE)) || (type == 186 && !attacktype(ptr, AT_TENT)) || (type == 187 && !attacktype(ptr, AT_TRAM)) || (type == 188 && !attacktype(ptr, AT_BEAM)) || (type == 189 && !attacktype(ptr, AT_MULTIPLY)) || (type == 190 && !attacktype(ptr, AT_WEAP)) || (type == 191 && !attacktype(ptr, AT_MAGC)) || (type == 192 && !dmgtype(ptr, AD_PHYS)) || (type == 193 && !dmgtype(ptr, AD_MAGM)) || (type == 194 && !dmgtype(ptr, AD_FIRE)) || (type == 195 && !dmgtype(ptr, AD_COLD)) || (type == 196 && !dmgtype(ptr, AD_SLEE)) || (type == 197 && !dmgtype(ptr, AD_DISN)) || (type == 198 && !dmgtype(ptr, AD_ELEC)) || (type == 199 && !dmgtype(ptr, AD_DRST)) || (type == 200 && !dmgtype(ptr, AD_ACID)) || (type == 201 && !dmgtype(ptr, AD_LITE)) || (type == 202 && !dmgtype(ptr, AD_BLND)) || (type == 203 && !dmgtype(ptr, AD_STUN)) || (type == 204 && !dmgtype(ptr, AD_SLOW)) || (type == 205 && !dmgtype(ptr, AD_PLYS)) || (type == 206 && !dmgtype(ptr, AD_DRLI)) || (type == 207 && !dmgtype(ptr, AD_DREN)) || (type == 208 && !dmgtype(ptr, AD_LEGS)) || (type == 209 && !dmgtype(ptr, AD_STON)) || (type == 210 && !dmgtype(ptr, AD_STCK)) || (type == 211 && !dmgtype(ptr, AD_SGLD)) || (type == 212 && !dmgtype(ptr, AD_SITM)) || (type == 213 && !dmgtype(ptr, AD_SEDU)) || (type == 214 && !dmgtype(ptr, AD_TLPT)) || (type == 215 && !dmgtype(ptr, AD_RUST)) || (type == 216 && !dmgtype(ptr, AD_CONF)) || (type == 217 && !dmgtype(ptr, AD_DGST)) || (type == 218 && !dmgtype(ptr, AD_HEAL)) || (type == 219 && !dmgtype(ptr, AD_WRAP)) || (type == 220 && !dmgtype(ptr, AD_WERE)) || (type == 221 && !dmgtype(ptr, AD_DRDX)) || (type == 222 && !dmgtype(ptr, AD_DRCO)) || (type == 223 && !dmgtype(ptr, AD_DRIN)) || (type == 224 && !dmgtype(ptr, AD_DISE)) || (type == 225 && !dmgtype(ptr, AD_DCAY)) || (type == 226 && !dmgtype(ptr, AD_SSEX)) || (type == 227 && !dmgtype(ptr, AD_HALU)) || (type == 228 && !dmgtype(ptr, AD_DETH)) || (type == 229 && !dmgtype(ptr, AD_PEST)) || (type == 230 && !dmgtype(ptr, AD_FAMN)) || (type == 231 && !dmgtype(ptr, AD_SLIM)) || (type == 232 && !dmgtype(ptr, AD_CALM)) || (type == 233 && !dmgtype(ptr, AD_ENCH)) || (type == 234 && !dmgtype(ptr, AD_POLY)) || (type == 235 && !dmgtype(ptr, AD_CORR)) || (type == 236 && !dmgtype(ptr, AD_TCKL)) || (type == 237 && !dmgtype(ptr, AD_NGRA)) || (type == 238 && !dmgtype(ptr, AD_GLIB)) || (type == 239 && !dmgtype(ptr, AD_DARK)) || (type == 240 && !dmgtype(ptr, AD_WTHR)) || (type == 241 && !dmgtype(ptr, AD_LUCK)) || (type == 242 && !dmgtype(ptr, AD_NUMB)) || (type == 243 && !dmgtype(ptr, AD_FRZE)) || (type == 244 && !dmgtype(ptr, AD_DISP)) || (type == 245 && !dmgtype(ptr, AD_BURN)) || (type == 246 && !dmgtype(ptr, AD_FEAR)) || (type == 247 && !dmgtype(ptr, AD_NPRO)) || (type == 248 && !dmgtype(ptr, AD_POIS)) || (type == 249 && !dmgtype(ptr, AD_THIR)) || (type == 250 && !dmgtype(ptr, AD_LAVA)) || (type == 251 && !dmgtype(ptr, AD_FAKE)) || (type == 252 && !dmgtype(ptr, AD_LETH)) || (type == 253 && !dmgtype(ptr, AD_CNCL)) || (type == 254 && !dmgtype(ptr, AD_BANI)) || (type == 255 && !dmgtype(ptr, AD_WISD)) || (type == 256 && !dmgtype(ptr, AD_SHRD)) || (type == 257 && !dmgtype(ptr, AD_WET)) || (type == 258 && !dmgtype(ptr, AD_SUCK)) || (type == 259 && !dmgtype(ptr, AD_MALK)) || (type == 260 && !dmgtype(ptr, AD_UVUU)) || (type == 261 && !dmgtype(ptr, AD_ABDC)) || (type == 262 && !dmgtype(ptr, AD_AXUS)) || (type == 263 && !dmgtype(ptr, AD_CHKH)) || (type == 264 && !dmgtype(ptr, AD_HODS)) || (type == 265 && !dmgtype(ptr, AD_CHRN)) || (type == 266 && !dmgtype(ptr, AD_WEEP)) || (type == 267 && !dmgtype(ptr, AD_VAMP)) || (type == 268 && !dmgtype(ptr, AD_WEBS)) || (type == 269 && !dmgtype(ptr, AD_STTP)) || (type == 270 && !dmgtype(ptr, AD_DEPR)) || (type == 271 && !dmgtype(ptr, AD_WRAT)) || (type == 272 && !dmgtype(ptr, AD_LAZY)) || (type == 273 && !dmgtype(ptr, AD_DRCH)) || (type == 274 && !dmgtype(ptr, AD_DFOO)) || (type == 275 && !dmgtype(ptr, AD_NEXU)) || (type == 276 && !dmgtype(ptr, AD_SOUN)) || (type == 277 && !dmgtype(ptr, AD_GRAV)) || (type == 278 && !dmgtype(ptr, AD_INER)) || (type == 279 && !dmgtype(ptr, AD_TIME)) || (type == 280 && !dmgtype(ptr, AD_MANA)) || (type == 281 && !dmgtype(ptr, AD_PLAS)) || (type == 282 && !dmgtype(ptr, AD_SKIL)) || (type == 283 && !dmgtype(ptr, AD_CLRC)) || (type == 284 && !dmgtype(ptr, AD_SPEL)) || (type == 285 && !dmgtype(ptr, AD_RBRE)) || (type == 286 && !dmgtype(ptr, AD_SAMU)) || (type == 287 && !dmgtype(ptr, AD_CURS)) || (type == 288 && !dmgtype(ptr, AD_SPC2)) || (type == 289 && !dmgtype(ptr, AD_VENO)) || (type == 290 && !dmgtype(ptr, AD_DREA)) || (type == 291 && !dmgtype(ptr, AD_NAST)) || (type == 292 && !dmgtype(ptr, AD_BADE)) || (type == 293 && !dmgtype(ptr, AD_SLUD)) || (type == 294 && !dmgtype(ptr, AD_ICUR)) || (type == 295 && !dmgtype(ptr, AD_VULN)) || (type == 296 && !dmgtype(ptr, AD_FUMB)) || (type == 297 && !dmgtype(ptr, AD_DIMN)) || (type == 298 && !dmgtype(ptr, AD_AMNE)) || (type == 299 && !dmgtype(ptr, AD_ICEB)) || (type == 300 && !dmgtype(ptr, AD_VAPO)) || (type == 301 && !dmgtype(ptr, AD_EDGE)) || (type == 302 && !dmgtype(ptr, AD_VOMT)) || (type == 303 && !dmgtype(ptr, AD_LITT)) || (type == 304 && !dmgtype(ptr, AD_FREN)) || (type == 305 && !dmgtype(ptr, AD_NGEN)) || (type == 306 && !dmgtype(ptr, AD_CHAO)) || (type == 307 && !dmgtype(ptr, AD_INSA)) || (type == 308 && !dmgtype(ptr, AD_TRAP)) || (type == 309 && !dmgtype(ptr, AD_WGHT)) || (type == 310 && !dmgtype(ptr, AD_NTHR)) || (type == 311 && !dmgtype(ptr, AD_MIDI)) || (type == 312 && !dmgtype(ptr, AD_RNG)) || (type == 313 && !dmgtype(ptr, AD_CAST)) || (type == 314 && !(ptr->mflags4 & M4_BAT)) || (type == 315 && !(ptr->mflags4 & M4_REVIVE)) || (type == 316 && !(ptr->mflags4 & M4_RAT)) || (type == 317 && !(ptr->mflags4 & M4_SHADE)) || (type == 318 && !(ptr->mflags4 & M4_REFLECT)) || (type == 319 && !(ptr->mflags4 & M4_MULTIHUED)) || (type == 320 && !(ptr->mflags4 & M4_TAME)) || (type == 321 && !(ptr->mflags4 & M4_ORGANIVORE)) || (type == 322 && !(ptr->mflags5 & M5_SPACEWARS)) || (type == 323 && !(ptr->mflags5 & M5_JOKE)) || (type == 324 && !(ptr->mflags5 & M5_ANGBAND)) || (type == 325 && !(ptr->mflags5 & M5_STEAMBAND)) || (type == 326 && !(ptr->mflags5 & M5_ANIMEBAND)) || (type == 327 && !(ptr->mflags5 & M5_DIABLO)) || (type == 328 && !(ptr->mflags5 & M5_DLORDS)) || (type == 329 && !(ptr->mflags5 & M5_VANILLA)) || (type == 330 && !(ptr->mflags5 & M5_DNETHACK)) || (type == 331 && !(ptr->mflags5 & M5_RANDOMIZED)) || (type == 332 && !(ptr->msound == MS_SHOE)) || (type == 333 && !(ptr->msound == MS_STENCH)) || (type == 334 && !dmgtype(ptr, AD_ALIN)) || (type == 335 && !dmgtype(ptr, AD_SIN)) || (type == 336 && !dmgtype(ptr, AD_MINA)) || (type == 337 && !dmgtype(ptr, AD_CONT)) || (type == 338 && !dmgtype(ptr, AD_AGGR)) || (type == 339 && !(ptr->mflags5 & M5_JONADAB)) || (type == 340 && !dmgtype(ptr, AD_DATA)) || (type == 341 && !(ptr->mflags5 & M5_EVIL)) || (type == 342 && !(ptr->mflags4 & M4_SHAPESHIFT)) || (type == 343 && !(ptr->mflags4 & M4_GRIDBUG)) || (type == 344 && !dmgtype(ptr, AD_DEST)) || (type == 345 && !dmgtype(ptr, AD_TREM)) || (type == 346 && !dmgtype(ptr, AD_RAGN)) || (type == 347 && !(ptr->msound == MS_CONVERT)) || (type == 348 && !(ptr->msound == MS_HCALIEN)) || (type == 349 && !dmgtype(ptr, AD_IDAM)) || (type == 350 && !dmgtype(ptr, AD_ANTI)) || (type == 351 && !dmgtype(ptr, AD_PAIN)) || (type == 352 && !dmgtype(ptr, AD_TECH)) || (type == 353 && !dmgtype(ptr, AD_MEMO)) || (type == 354 && !dmgtype(ptr, AD_TRAI)) || (type == 355 && !dmgtype(ptr, AD_STAT)) || (type == 356 && !dmgtype(ptr, AD_DAMA)) || (type == 357 && !dmgtype(ptr, AD_THIE)) || (type == 358 && !dmgtype(ptr, AD_PART)) || (type == 359 && !dmgtype(ptr, AD_RUNS)) || (type == 360 && !attacktype(ptr, AT_RATH)) || (type == 361 && !(ptr->mflags5 & M5_ELONA)) || (type == 362 && !dmgtype(ptr, AD_NACU)) || (type == 363 && !dmgtype(ptr, AD_SANI)) || (type == 364 && !dmgtype(ptr, AD_RBAD)) || (type == 365 && !dmgtype(ptr, AD_BLEE)) || (type == 366 && !dmgtype(ptr, AD_SHAN)) || (type == 367 && !dmgtype(ptr, AD_SCOR)) || (type == 368 && !dmgtype(ptr, AD_TERR)) || (type == 369 && !dmgtype(ptr, AD_FEMI)) || (type == 370 && !dmgtype(ptr, AD_LEVI)) || (type == 371 && !dmgtype(ptr, AD_ILLU)) || (type == 372 && !dmgtype(ptr, AD_MCRE)) || (type == 373 && !dmgtype(ptr, AD_FLAM)) || (type == 374 && !dmgtype(ptr, AD_DEBU)) || (type == 375 && !dmgtype(ptr, AD_UNPR)) || (type == 376 && !dmgtype(ptr, AD_NIVE)) || (type == 377 && !dmgtype(ptr, AD_TDRA)) || (type == 378 && !dmgtype(ptr, AD_BLAS)) || (type == 379 && !dmgtype(ptr, AD_DROP)) || (type == 380 && !(ptr->mflags6 & M6_FLEE)) || (type == 381 && !(ptr->mflags6 & M6_RANDWALK)) || (type == 382 && !(ptr->msound == MS_CASINO))  || (type == 383 && !(ptr->msound == MS_GIBBERISH)) || (type == 384 && !(ptr->msound == MS_GLYPHS)) || (type == 385 && !(ptr->msound == MS_SOCKS)) || (type == 386 && !(ptr->msound == MS_PANTS)) || (type == 387 && !(ptr->msound == MS_HANDY)) || (type == 388 && !(ptr->msound == MS_CAR)) || (type == 389 && !(ptr->msound == MS_JAPANESE)) || (type == 390 && !(ptr->msound == MS_SOVIET)) || (type == 391 && !(ptr->msound == MS_SNORE)) || (type == 392 && !(ptr->msound == MS_PHOTO)) || (type == 393 && !(ptr->msound == MS_REPAIR)) || (type == 394 && !(ptr->msound == MS_DRUGS)) || (type == 395 && !(ptr->msound == MS_COMBAT)) || (type == 396 && !(ptr->msound == MS_MUTE)) || (type == 397 && !(ptr->msound == MS_CORONA)) || (type == 398 && !(ptr->msound == MS_TRUMPET)) || (type == 399 && !(ptr->msound == MS_PAIN)) || (type == 400 && !(ptr->msound == MS_BRAG)) || (type == 401 && !(ptr->msound == MS_PRINCESSLEIA)) || (type == 402 && !(ptr->msound == MS_SISSY)) || (type == 403 && !(ptr->msound == MS_SING)) || (type == 404 && !(ptr->msound == MS_ALLA)) || (type == 405 && !(ptr->msound == MS_POKEDEX)) || (type == 406 && !(ptr->msound == MS_BOT)) || (type == 407 && !(ptr->msound == MS_APOC)) || (type == 408 && !(ptr->msound == MS_LIEDER)) || (type == 409 && !(ptr->msound == MS_GAARDIEN)) || (type == 410 && !(ptr->msound == MS_MISSING)) || (type == 411 && !(ptr->msound == MS_SELFHARM)) || (type == 412 && !(ptr->msound == MS_CLOCK)) || (type == 413 && !(ptr->msound == MS_OHGOD)) || (type == 414 && !(ptr->msound == MS_WOLLOH)) || (type == 415 && !(ptr->msound == MS_CODE)) || (type == 416 && !(ptr->msound == MS_BARBER)) || (type == 417 && !(ptr->msound == MS_AREOLA)) || (type == 418 && !(ptr->msound == MS_STABILIZE)) || (type == 419 && !(ptr->msound == MS_ESCAPE)) || (type == 420 && !(ptr->msound == MS_FEARHARE)) || (type == 421 && !(ptr->msound == MS_SPOILER)) || (type == 422 && !(ptr->msound == MS_DEAD)) || (type == 423 && !(ptr->msound == MS_TREESQUAD)) || (type == 424 && !(ptr->msound == MS_METALMAFIA)) || (type == 425 && !(ptr->msound == MS_DEEPSTATE)) )) return FALSE;
	return TRUE;

}

/*
 * Return true if the given monster cannot exist on this elemental level.
 */
STATIC_OVL boolean
wrong_elem_type(ptr)
    register struct permonst *ptr;
{
    if (ptr->mlet == S_ELEMENTAL) {
	return((boolean)(!is_home_elemental(ptr)));
    } else if (Is_earthlevel(&u.uz)) {
	/* no restrictions? */
    } else if (Is_waterlevel(&u.uz)) {
	/* just monsters that can swim */
	if(!is_swimmer(ptr)) return TRUE;
    } else if (Is_firelevel(&u.uz)) {
	if (!pm_resistance(ptr,MR_FIRE)) return TRUE;
    } else if (Is_airlevel(&u.uz)) {
	if(!(is_flyer(ptr) && ptr->mlet != S_TRAPPER) && !is_floater(ptr)
	   && !amorphous(ptr) && !noncorporeal(ptr) && !is_whirly(ptr))
	    return TRUE;
    }
    return FALSE;
}

STATIC_OVL void
m_initgrp(mtmp, x, y, n)	/* make a group just like mtmp */
register struct monst *mtmp;
register int x, y, n;
{
	coord mm;
	register int cnt = rno(n);
	int kindred = rn2(20) ? 0 : 1;

	if (mtmp->data->geno & G_PLATOON) kindred = 1;
	if (mtmp->data->geno & G_UNIQ) kindred = 1; /* uniques are created with others of their kin, instead of clones of themselves */
	struct monst *mon;
#if defined(__GNUC__) && (defined(HPUX) || defined(DGUX))
	/* There is an unresolved problem with several people finding that
	 * the game hangs eating CPU; if interrupted and restored, the level
	 * will be filled with monsters.  Of those reports giving system type,
	 * there were two DG/UX and two HP-UX, all using gcc as the compiler.
	 * hcroft@hpopb1.cern.ch, using gcc 2.6.3 on HP-UX, says that the
	 * problem went away for him and another reporter-to-newsgroup
	 * after adding this debugging code.  This has almost got to be a
	 * compiler bug, but until somebody tracks it down and gets it fixed,
	 * might as well go with the "but it went away when I tried to find
	 * it" code.
	 */
	int cnttmp,cntdiv;

	cnttmp = cnt;
# ifdef DEBUG
	pline("init group call x=%d,y=%d,n=%d,cnt=%d.", x, y, n, cnt);
# endif
	cntdiv = ((u.ulevel < 3) ? 4 : (u.ulevel < 5) ? 2 : 1);
#endif
	/* Tuning: cut down on swarming at low character levels [mrs] */
	if ((/*u.ulevel*/level_difficulty() < 5) && rn2(5) ) cnt /= 2;
#if defined(__GNUC__) && (defined(HPUX) || defined(DGUX))
	if (cnt != (cnttmp/cntdiv)) {
		pline("cnt=%d using %d, cnttmp=%d, cntdiv=%d", cnt,
			(u.ulevel < 3) ? 4 : (u.ulevel < 5) ? 2 : 1,
			cnttmp, cntdiv);
	}
#endif
	if(!cnt) cnt++;
#if defined(__GNUC__) && (defined(HPUX) || defined(DGUX))
	if (cnt < 0) cnt = 1;
	if (cnt > 10) cnt = 10;
#endif

	mm.x = x;
	mm.y = y;
	while(cnt--) {
		if (peace_minded(mtmp->data)) continue;
		/* Don't create groups of peaceful monsters since they'll get
		 * in our way.  If the monster has a percentage chance so some
		 * are peaceful and some are not, the result will just be a
		 * smaller group.
		 */
		if (enexto(&mm, mm.x, mm.y, mtmp->data)) {
		    if (!kindred) mon = makemon(mtmp->data, mm.x, mm.y, NO_MM_FLAGS);
		    else mon = makemon(mkclass(mtmp->data->mlet,0), mm.x, mm.y, NO_MM_FLAGS);
			if (mon) {
		    mon->mpeaceful = FALSE;
		    mon->mavenge = 0;
		    set_malign(mon);
			}
		    /* Undo the second peace_minded() check in makemon(); if the
		     * monster turned out to be peaceful the first time we
		     * didn't create it at all; we don't want a second check.
		     */
		}
	}
}

STATIC_OVL
void
m_initthrow(mtmp,otyp,oquan)
struct monst *mtmp;
int otyp,oquan;
{
	register struct obj *otmp;

	otmp = mksobj(otyp, TRUE, FALSE, FALSE);
	if (!otmp) return;
	otmp->quan = (long) rn1(oquan, 3);
	if (!issoviet) {
		if (!rn2(20)) otmp->quan += rnd(otmp->quan);
		if (!rn2(1000)) otmp->quan += rnz(otmp->quan + 3);
		if (!rn2(1000)) otmp->quan += rnz( rnd( (otmp->quan * 2) + 3) );
	}
	if (In_lategame(&u.uz) && !issoviet) {
		if (!rn2(6)) otmp->quan += rnd(otmp->quan);
		if (!rn2(50)) otmp->quan += rnz(otmp->quan + 3);
		if (!rn2(200)) otmp->quan += rnz( rnd( (otmp->quan * 2) + 3) );
	}
	otmp->owt = weight(otmp);
	if (otyp == ORCISH_ARROW) otmp->opoisoned = TRUE;
	if (otyp == CROSSBOW_BOLT && mtmp->data == &mons[PM_POISON_ARROW_FROG]) otmp->opoisoned = TRUE;
	if (otyp == CROSSBOW_BOLT && mtmp->data == &mons[PM_ROXY]) otmp->opoisoned = TRUE;
	if (otyp == CROSSBOW_BOLT && mtmp->data == &mons[PM_ROXANNE]) otmp->opoisoned = TRUE;
	if (otmp->oclass == WEAPON_CLASS) otmp->mstartinventB = 1;
	if (otmp->oclass == GEM_CLASS && !objects[otmp->otyp].oc_magic) otmp->mstartinventB = 1;
	if (is_weptool(otmp)) otmp->mstartinventB = 1;
	(void) mpickobj(mtmp, otmp, TRUE);
}

#endif /* OVLB */
#ifdef OVL2

/* function by Amy: sometimes give armor pieces to the monster */
STATIC_OVL void
m_initarmorpieces(mtmp)
register struct monst *mtmp;
{
	if ((!cantweararm(mtmp->data) || mtmp->data->msize == MZ_SMALL) && !rn2(100)) { /* shirt */
		(void) mongets(mtmp, T_SHIRT);
	}

	if ((!cantweararm(mtmp->data) || mtmp->data->msize == MZ_SMALL) && !rn2(10)) { /* cloak */
		switch (rnd(17)) {

			case 1:
			case 2:
			case 3:
			case 4: (void) mongets(mtmp, MUMMY_WRAPPING); break;
			case 5:
			case 6:
			case 7:
			case 8: (void) mongets(mtmp, ORCISH_CLOAK); break;
			case 9:
			case 10:
			case 11: (void) mongets(mtmp, DWARVISH_CLOAK); break;
			case 12: (void) mongets(mtmp, ELVEN_CLOAK); break;
			case 13:
			case 14:
			case 15:
			case 16: (void) mongets(mtmp, LEATHER_CLOAK); break;
			case 17: (void) mongets(mtmp, FUR); break;

		}
	}

	if (!rn2(3)) { /* helmet */
		switch (rnd(22)) {
			case 1: (void) mongets(mtmp, ELVEN_LEATHER_HELM); break;
			case 2:
			case 3:
			case 4:
			case 5:
			case 6: (void) mongets(mtmp, GNOMISH_HELM); break;
			case 7:
			case 8:
			case 9:
			case 10: (void) mongets(mtmp, ORCISH_HELM); break;
			case 11: (void) mongets(mtmp, DWARVISH_IRON_HELM); break;
			case 12:
			case 13: (void) mongets(mtmp, DENTED_POT); break;
			case 14:
			case 15: (void) mongets(mtmp, ELVEN_HELM); break;
			case 16: (void) mongets(mtmp, BUNNY_EAR); break;
			case 17: (void) mongets(mtmp, STRAW_HAT); break;
			case 18: (void) mongets(mtmp, MECHA_IRAZU); break;
			case 19: (void) mongets(mtmp, SCHOOL_CAP); break;
			case 20:
			case 21: (void) mongets(mtmp, HELMET); break;
			case 22: (void) mongets(mtmp, SKULLCAP); break;
		}

	}

	if (!rn2(8)) { /* shield */
		switch (rnd(26)) {
			case 1:
			case 2:
			case 3:
			case 4:
			case 5: (void) mongets(mtmp, SMALL_SHIELD); break;
			case 6:
			case 7:
			case 8:
			case 9: (void) mongets(mtmp, HEAVY_SHIELD); break;
			case 10: (void) mongets(mtmp, BARRIER_SHIELD); break;
			case 11: (void) mongets(mtmp, TARRIER); break;
			case 12:
			case 13: (void) mongets(mtmp, ELVEN_SHIELD); break;
			case 14: (void) mongets(mtmp, ORCISH_SHIELD); break;
			case 15: (void) mongets(mtmp, LARGE_SHIELD); break;
			case 16:
			case 17:
			case 18:
			case 19:
			case 20: (void) mongets(mtmp, PAPER_SHIELD); break;
			case 21: (void) mongets(mtmp, DWARVISH_ROUNDSHIELD); break;
			case 22: (void) mongets(mtmp, ORCISH_GUARD_SHIELD); break;
			case 23: (void) mongets(mtmp, SHIELD); break;
			case 24: (void) mongets(mtmp, SILVER_SHIELD); break;
			case 25: (void) mongets(mtmp, RAPIRAPI); break;
			case 26: (void) mongets(mtmp, HIDE_SHIELD); break;
		}
	}

	if (!rn2(12)) { /* gauntlets */
		switch (rnd(13)) {
			case 1:
			case 2:
			case 3:
			case 4:
			case 5: (void) mongets(mtmp, LEATHER_GLOVES); break;
			case 6: (void) mongets(mtmp, GAUNTLETS_OF_TYPING); break;
			case 7: (void) mongets(mtmp, GAUNTLETS_OF_PLUGSUIT); break;
			case 8: (void) mongets(mtmp, COMMANDER_GLOVES); break;
			case 9: (void) mongets(mtmp, FIELD_GLOVES); break;
			case 10:
			case 11:
			case 12: (void) mongets(mtmp, GAUNTLETS); break;
			case 13: (void) mongets(mtmp, SILVER_GAUNTLETS); break;

		}

	}

	if (((!slithy(mtmp->data) && mtmp->data->mlet != S_CENTAUR) || !issoviet) && !rn2(10)) { /* boots */
		switch (rnd(26)) {
			case 1:
			case 2:
			case 3:
			case 4:
			case 5: (void) mongets(mtmp, LOW_BOOTS); break;
			case 6:
			case 7:
			case 8: (void) mongets(mtmp, IRON_SHOES); break;
			case 9:
			case 10:
			case 11:
			case 12:
			case 13: (void) mongets(mtmp, GNOMISH_BOOTS); break;
			case 14:
			case 15: (void) mongets(mtmp, HIGH_BOOTS); break;
			case 16:
			case 17: (void) mongets(mtmp, RUBBER_BOOTS); break;
			case 18:
			case 19:
			case 20: (void) mongets(mtmp, LEATHER_SHOES); break;
			case 21:
			case 22:
			case 23: (void) mongets(mtmp, SNEAKERS); break;
			case 24: switch (rnd(8)) {
				case 1: (void) mongets(mtmp, WEDGE_SANDALS); break;
				case 2: (void) mongets(mtmp, DANCING_SHOES); break;
				case 3: (void) mongets(mtmp, SWEET_MOCASSINS); break;
				case 4: (void) mongets(mtmp, SOFT_SNEAKERS); break;
				case 5: (void) mongets(mtmp, FEMININE_PUMPS); break;
				case 6: (void) mongets(mtmp, LEATHER_PEEP_TOES); break;
				case 7: (void) mongets(mtmp, HIPPIE_HEELS); break;
				case 8: (void) mongets(mtmp, COMBAT_STILETTOS); break;
				}
			case 25: (void) mongets(mtmp, BOOTS_OF_PLUGSUIT); break;
			case 26: (void) mongets(mtmp, FIELD_BOOTS); break;

		}

	}

	if (!cantweararm(mtmp->data) && !rn2(3)) { /* body armor */
		switch (rnd(112)) {
			case 1: (void) mongets(mtmp, PLATE_MAIL); break;
			case 2: (void) mongets(mtmp, RIBBED_PLATE_MAIL); break;
			case 3: (void) mongets(mtmp, PARTIAL_PLATE_MAIL); break;
			case 4: (void) mongets(mtmp, rn2(10) ? LEATHER_ARMOR : FULL_PLATE_MAIL); break;
			case 5: (void) mongets(mtmp, CRYSTAL_PLATE_MAIL); break;
			case 6: (void) mongets(mtmp, BRONZE_PLATE_MAIL); break;
			case 7:
			case 8: (void) mongets(mtmp, SPLINT_MAIL); break;
			case 9:
			case 10: (void) mongets(mtmp, METAL_LAMELLAR_ARMOR); break;
			case 11:
			case 12: (void) mongets(mtmp, BANDED_MAIL); break;
			case 13: (void) mongets(mtmp, DWARVISH_MITHRIL_COAT); break;
			case 14: (void) mongets(mtmp, ELVEN_MITHRIL_COAT); break;
			case 15:
			case 16:
			case 17:
			case 18:
			case 19:
			case 20:
			case 21:
			case 22:
			case 23:
			case 24: (void) mongets(mtmp, GNOMISH_SUIT); break;
			case 25:
			case 26:
			case 27: (void) mongets(mtmp, CHAIN_MAIL); break;
			case 28:
			case 29:
			case 30: (void) mongets(mtmp, BAR_CHAIN_MAIL); break;
			case 31:
			case 32:
			case 33: (void) mongets(mtmp, TAR_CHAIN_MAIL); break;
			case 34: (void) mongets(mtmp, SAILOR_BLOUSE); break;
			case 35: (void) mongets(mtmp, FEATHER_ARMOR); break;
			case 36:
			case 37: (void) mongets(mtmp, SCHOOL_UNIFORM); break;
			case 38: (void) mongets(mtmp, BUNNY_UNIFORM); break;
			case 39:
			case 40: (void) mongets(mtmp, MAID_DRESS); break;
			case 41: (void) mongets(mtmp, NURSE_UNIFORM); break;
			case 42: (void) mongets(mtmp, COMMANDER_SUIT); break;
			case 43: (void) mongets(mtmp, CAMOUFLAGED_CLOTHES); break;
			case 44: (void) mongets(mtmp, SHOULDER_RINGS); break;
			case 45:
			case 46:
			case 47:
			case 48:
			case 49: (void) mongets(mtmp, BAMBOO_MAIL); break;
			case 50:
			case 51:
			case 52:
			case 53:
			case 54: (void) mongets(mtmp, SILK_MAIL); break;
			case 55:
			case 56:
			case 57: (void) mongets(mtmp, ORCISH_CHAIN_MAIL); break;
			case 58:
			case 59:
			case 60: (void) mongets(mtmp, SCALE_MAIL); break;
			case 61:
			case 62:
			case 63:
			case 64:
			case 65: (void) mongets(mtmp, STUDDED_LEATHER_ARMOR); break;
			case 66:
			case 67:
			case 68: (void) mongets(mtmp, RING_MAIL); break;
			case 69:
			case 70:
			case 71:
			case 72:
			case 73: (void) mongets(mtmp, HEAVY_MAIL); break;
			case 74:
			case 75:
			case 76: (void) mongets(mtmp, ORCISH_RING_MAIL); break;
			case 77:
			case 78:
			case 79:
			case 80:
			case 81:
			case 82:
			case 83:
			case 84:
			case 85:
			case 86: (void) mongets(mtmp, LEATHER_ARMOR); break;
			case 87: (void) mongets(mtmp, ELVEN_TOGA); break;
			case 88: (void) mongets(mtmp, HEALER_UNIFORM); break;
			case 89: (void) mongets(mtmp, GENTLEMAN_S_SUIT); break;
			case 90: (void) mongets(mtmp, GENTLEWOMAN_S_DRESS); break;
			case 91: (void) mongets(mtmp, STRAITJACKET); break;
			case 92:
			case 93:
			case 94:
			case 95: (void) mongets(mtmp, HAWAIIAN_SHORTS); break;
			case 96:
			case 97:
			case 98:
			case 99:
			case 100:
			case 101:
			case 102: (void) mongets(mtmp, LEATHER_JACKET); break;
			case 103:
			case 104:
			case 105:
			case 106:
			case 107:
			case 108:
			case 109:
			case 110:
			case 111:
			case 112: (void) mongets(mtmp, ROBE); break;

		}

	} else if (is_hobbit(mtmp->data) && !rn2(30)) { /* elven mithril-coat */
		(void) mongets(mtmp, ELVEN_MITHRIL_COAT);
	} else if (is_gnome(mtmp->data) && !rn2(10)) { /* gnomish suit */
		(void) mongets(mtmp, GNOMISH_SUIT);
	}

}

STATIC_OVL void
m_initweap_normal(mtmp)
register struct monst *mtmp;
{
	register struct permonst *ptr = mtmp->data;
	int bias;

	bias = (is_lord(ptr) * 2) + (is_prince(ptr) * 5) + (extra_nasty(ptr) * 3) + strongmonst(ptr);
	if (bias > 0) bias += rnd(bias);
	if (bias > 24) bias = 24; /* preventing those eternal rnd() error messages at last --Amy */

	switch(rnd(25 - bias)) {
	    case 1:
		if(strongmonst(ptr)) (void) mongets(mtmp, rn2(20) ? BATTLE_AXE : TRIDENT);
		else if (rn2(2)) m_initthrow(mtmp, rn2(200) ? DART : SPIKE, 25);
		else (void) mongets(mtmp, KNIFE);
		break;
	    case 2:
		if(strongmonst(ptr))
		    (void) mongets(mtmp, rn2(20) ? TWO_HANDED_SWORD : QUARTERSTAFF);
		else if (rn2(2)) {
		    (void) mongets(mtmp, rn2(20) ? CROSSBOW : !rn2(3) ? POWER_CROSSBOW : !rn2(4) ? (rn2(2) ? PILE_BUNKER : HELO_CROSSBOW) : rn2(50) ? DROVEN_CROSSBOW : DEMON_CROSSBOW);
		    m_initthrow(mtmp, rn2(20) ? CROSSBOW_BOLT : rn2(5) ? DROVEN_BOLT : KOKKEN, 45);
		}
		else {
		    (void) mongets(mtmp, rn2(500) ? SLING : CATAPULT);
		    m_initthrow(mtmp, rn2(100) ? ROCK : FLINT, 10);
		}
		break;
	    case 3:
		if (rn2(20)) {
			(void) mongets(mtmp, rn2(1000) ? BOW : HYDRA_BOW);
			if (rn2(250)) m_initthrow(mtmp, ARROW, 30);
			else switch (rnd(5)) {
				case 1:
					m_initthrow(mtmp, SILVER_ARROW, 35);
					break;
				case 2:
					m_initthrow(mtmp, GOLDEN_ARROW, 40);
					break;
				case 3:
					m_initthrow(mtmp, ANCIENT_ARROW, 40);
					break;
				case 4:
					m_initthrow(mtmp, DROVEN_ARROW, 50);
					break;
				case 5:
					m_initthrow(mtmp, YA, 45);
					break;
			}
		}
		else if (rn2(200)) {
			if (rn2(20)) {
				(void) mongets(mtmp, PISTOL);
				m_initthrow(mtmp, rn2(2000) ? PISTOL_BULLET : ANTIMATTER_PISTOL_BULLET, 25);
			} else {
				(void) mongets(mtmp, RIFLE);
				m_initthrow(mtmp, rn2(2000) ? RIFLE_BULLET : ANTIMATTER_RIFLE_BULLET, 25);
			}
		}
		else switch (rnd(100)) {
			case 1:
				(void) mongets(mtmp, HEAVY_MACHINE_GUN);
				m_initthrow(mtmp, rn2(2000) ? MG_BULLET : ANTIMATTER_MG_BULLET, 50);
				m_initthrow(mtmp, rn2(2000) ? MG_BULLET : ANTIMATTER_MG_BULLET, 50);
				break;
			case 2:
				(void) mongets(mtmp, AUTO_SHOTGUN);
				m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 50);
				break;
			case 3:
				(void) mongets(mtmp, ARM_BLASTER);
				m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
				break;
			case 4:
			case 5:
			case 6:
			case 7:
			case 8:
			case 9:
			case 10:
				(void) mongets(mtmp, HAND_BLASTER);
				m_initthrow(mtmp, BLASTER_BOLT, 40);
				break;
			case 11:
			case 12:
			case 13:
			case 14:
			case 15:
				(void) mongets(mtmp, CUTTING_LASER);
				m_initthrow(mtmp, LASER_BEAM, 50);
				break;
			case 16:
			case 17:
			case 18:
				(void) mongets(mtmp, RAYGUN);
				m_initthrow(mtmp, RAYGUN_BOLT, 50);
				break;
			case 19:
				(void) mongets(mtmp, ROCKET_LAUNCHER);
				m_initthrow(mtmp, ROCKET, 5);
				break;
			case 20:
				(void) mongets(mtmp, GRENADE_LAUNCHER);
				m_initthrow(mtmp, FRAG_GRENADE, 15);
				break;
			case 21:
				(void) mongets(mtmp, GRENADE_LAUNCHER);
				m_initthrow(mtmp, GAS_GRENADE, 15);
				break;
			case 22:
				(void) mongets(mtmp, SAWED_OFF_SHOTGUN);
				m_initthrow(mtmp, SHOTGUN_SHELL, 25);
				break;
			case 23:
			case 24:
			case 25:
			case 26:
			case 27:
			case 28:
			case 29:
			case 30:
			case 31:
			case 32:
			case 33:
			case 34:
			case 35:
			case 36:
				(void) mongets(mtmp, SHOTGUN);
				m_initthrow(mtmp, SHOTGUN_SHELL, 25);
				break;
			case 37:
			case 38:
			case 39:
			case 40:
			case 41:
			case 42:
			case 43:
			case 44:
			case 45:
			case 46:
			case 47:
			case 48:
			case 49:
			case 50:
				(void) mongets(mtmp, ASSAULT_RIFLE);
				m_initthrow(mtmp, rn2(2000) ? ASSAULT_RIFLE_BULLET : ANTIMATTER_ASSAULT_RIFLE_BULLE, 50);
				m_initthrow(mtmp, rn2(2000) ? ASSAULT_RIFLE_BULLET : ANTIMATTER_ASSAULT_RIFLE_BULLE, 25);
				break;
			case 51:
			case 52:
			case 53:
			case 54:
			case 55:
			case 56:
			case 57:
			case 58:
			case 59:
			case 60:
			case 61:
			case 62:
			case 63:
			case 64:
			case 65:
			case 66:
			case 67:
			case 68:
			case 69:
			case 70:
			case 71:
			case 72:
			case 73:
			case 74:
			case 75:
				(void) mongets(mtmp, SNIPER_RIFLE);
				m_initthrow(mtmp, rn2(2000) ? SNIPER_BULLET : ANTIMATTER_SNIPER_BULLET, 50);
				break;
			case 76:
			case 77:
			case 78:
			case 79:
			case 80:
			case 81:
			case 82:
			case 83:
			case 84:
			case 85:
			case 86:
			case 87:
			case 88:
			case 89:
			case 90:
			case 91:
			case 92:
			case 93:
			case 94:
			case 95:
			case 96:
			case 97:
			case 98:
			case 99:
			case 100:
				(void) mongets(mtmp, SUBMACHINE_GUN);
				m_initthrow(mtmp, rn2(2000) ? SMG_BULLET : ANTIMATTER_SMG_BULLET, 50);
				break;
		}

		break;
	    case 4:
		if(strongmonst(ptr)) (void) mongets(mtmp, rn2(20) ? LONG_SWORD : BROADSWORD);
		else if (rn2(2)) m_initthrow(mtmp, DAGGER, 3);
		else m_initthrow(mtmp, KNIFE, 1);
		break;
	    case 5:
		if(strongmonst(ptr))
		    (void) mongets(mtmp, rn2(20) ? LUCERN_HAMMER : BEC_DE_CORBIN);
		else if (rn2(2)) (void) mongets(mtmp, AKLYS);
		else (void) mongets(mtmp, BULLWHIP);
		break;
	    /* [Tom] added some more */
	    case 6:
		if(strongmonst(ptr))
		    (void) mongets(mtmp, rn2(20) ? AXE : WAR_HAMMER);
		else if (rn2(2)) (void) mongets(mtmp, SHORT_SWORD);
		else (void) mongets(mtmp, FLAIL);
		break;
	    case 7:
		if(strongmonst(ptr))
		    (void) mongets(mtmp, rn2(20) ? MACE : BASEBALL_BAT);
		else if (rn2(2)) (void) mongets(mtmp, CLUB);
		else (void) mongets(mtmp, RUBBER_HOSE);
		break;
	    case 8:
		(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		if (!rn2(20)) (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		if(strongmonst(ptr)) (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		break;
	    case 9:
		if (!rn2(50)) (void) mongets(mtmp, PICK_AXE);
		if (!rn2(250)) (void) mongets(mtmp, DWARVISH_MATTOCK);
	    default:
		break;
	}

	if (needspick(ptr) && !rn2(40) ) (void) mongets(mtmp, PICK_AXE);

	if (Role_if(PM_GRENADONIN) && !rn2(50)) {

		switch (rnd(42)) { /* grenades half of the time, guns otherwise */

			case 1:
				(void) mongets(mtmp, PISTOL);
				m_initthrow(mtmp, rn2(2000) ? PISTOL_BULLET : ANTIMATTER_PISTOL_BULLET, 30);
				break;
			case 2:
				(void) mongets(mtmp, FLINTLOCK);
				m_initthrow(mtmp, rn2(2000) ? PISTOL_BULLET : ANTIMATTER_PISTOL_BULLET, 20);
				break;
			case 3:
				(void) mongets(mtmp, BEAM_REFLECTOR_GUN);
				m_initthrow(mtmp, rn2(2000) ? PISTOL_BULLET : ANTIMATTER_PISTOL_BULLET, 30);
				break;
			case 4:
				if (mtmp->m_lev > 4) {
					(void) mongets(mtmp, SUBMACHINE_GUN);
					m_initthrow(mtmp, rn2(2000) ? SMG_BULLET : ANTIMATTER_SMG_BULLET, 50);

				} else {
					(void) mongets(mtmp, PISTOL);
					m_initthrow(mtmp, rn2(2000) ? PISTOL_BULLET : ANTIMATTER_PISTOL_BULLET, 50);

				}

				break;
			case 5:
				if (mtmp->m_lev > 30) {
					(void) mongets(mtmp, HEAVY_MACHINE_GUN);
					m_initthrow(mtmp, rn2(2000) ? MG_BULLET : ANTIMATTER_MG_BULLET, 50);
					m_initthrow(mtmp, rn2(2000) ? MG_BULLET : ANTIMATTER_MG_BULLET, 50);
					m_initthrow(mtmp, rn2(2000) ? MG_BULLET : ANTIMATTER_MG_BULLET, 50);
					m_initthrow(mtmp, rn2(2000) ? MG_BULLET : ANTIMATTER_MG_BULLET, 50);

				} else {
					(void) mongets(mtmp, PISTOL);
					m_initthrow(mtmp, rn2(2000) ? PISTOL_BULLET : ANTIMATTER_PISTOL_BULLET, 50);
				}
				break;
			case 6:
				(void) mongets(mtmp, RIFLE);
				m_initthrow(mtmp, rn2(2000) ? RIFLE_BULLET : ANTIMATTER_RIFLE_BULLET, 50);
				break;
			case 7:
				(void) mongets(mtmp, HUNTING_RIFLE);
				m_initthrow(mtmp, rn2(2000) ? RIFLE_BULLET : ANTIMATTER_RIFLE_BULLET, 50);
				break;
			case 8:
				if (mtmp->m_lev > 11) {
					(void) mongets(mtmp, ASSAULT_RIFLE);
					m_initthrow(mtmp, rn2(2000) ? ASSAULT_RIFLE_BULLET : ANTIMATTER_ASSAULT_RIFLE_BULLE, 50);
					m_initthrow(mtmp, rn2(2000) ? ASSAULT_RIFLE_BULLET : ANTIMATTER_ASSAULT_RIFLE_BULLE, 50);
				} else {
					(void) mongets(mtmp, PISTOL);
					m_initthrow(mtmp, rn2(2000) ? PISTOL_BULLET : ANTIMATTER_PISTOL_BULLET, 50);
				}
				break;
			case 9:
				if (mtmp->m_lev > 6) {
					(void) mongets(mtmp, SNIPER_RIFLE);
					m_initthrow(mtmp, rn2(2000) ? SNIPER_BULLET : ANTIMATTER_SNIPER_BULLET, 50);

				} else {
					(void) mongets(mtmp, RIFLE);
					m_initthrow(mtmp, rn2(2000) ? RIFLE_BULLET : ANTIMATTER_RIFLE_BULLET, 50);
				}
				break;
			case 10:
				(void) mongets(mtmp, SHOTGUN);
				m_initthrow(mtmp, SHOTGUN_SHELL, 25);
				break;
			case 11:
				(void) mongets(mtmp, PAPER_SHOTGUN);
				m_initthrow(mtmp, SHOTGUN_SHELL, 25);
				break;
			case 12:
				(void) mongets(mtmp, SAWED_OFF_SHOTGUN);
				m_initthrow(mtmp, SHOTGUN_SHELL, 25);
				break;
			case 13:
				if (mtmp->m_lev > 8) {
					(void) mongets(mtmp, AUTO_SHOTGUN);
					m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 50);
				} else {
					(void) mongets(mtmp, SHOTGUN);
					m_initthrow(mtmp, SHOTGUN_SHELL, 25);
				}
				break;
			case 14:
				(void) mongets(mtmp, HAND_BLASTER);
				m_initthrow(mtmp, BLASTER_BOLT, 40);
				break;
			case 15:
				if (mtmp->m_lev > 15) {
					(void) mongets(mtmp, ARM_BLASTER);
					m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
				} else {
					(void) mongets(mtmp, HAND_BLASTER);
					m_initthrow(mtmp, BLASTER_BOLT, 50);
				}
				break;
			case 16:
				(void) mongets(mtmp, PROCESS_CARD);
				m_initthrow(mtmp, RADIO, 40);
				break;
			case 17:
				if (mtmp->m_lev > 20) {
					(void) mongets(mtmp, CUTTING_LASER);
					m_initthrow(mtmp, LASER_BEAM, 50);
					m_initthrow(mtmp, LASER_BEAM, 50);
				} else {
					(void) mongets(mtmp, HAND_BLASTER);
					m_initthrow(mtmp, BLASTER_BOLT, 50);
				}
				break;
			case 18:
				(void) mongets(mtmp, mtmp->m_lev > 30 ? BFG : PISTOL);
				if (mtmp->m_lev > 30) {
				  	m_initthrow(mtmp, BFG_AMMO, 50);
				  	m_initthrow(mtmp, BFG_AMMO, 50);
				  	m_initthrow(mtmp, BFG_AMMO, 50);
				  	m_initthrow(mtmp, BFG_AMMO, 50);
				  	m_initthrow(mtmp, BFG_AMMO, 50);
				  	m_initthrow(mtmp, BFG_AMMO, 50);
				  	m_initthrow(mtmp, BFG_AMMO, 50);
				  	m_initthrow(mtmp, BFG_AMMO, 50);
				} else {
					m_initthrow(mtmp, rn2(2000) ? PISTOL_BULLET : ANTIMATTER_PISTOL_BULLET, 30);
				}
				break;
			case 19:
				(void) mongets(mtmp, mtmp->m_lev > 9 ? ROCKET_LAUNCHER : PISTOL);
				if (mtmp->m_lev > 9) {
					m_initthrow(mtmp, ROCKET, 5);
				} else {
					m_initthrow(mtmp, rn2(2000) ? PISTOL_BULLET : ANTIMATTER_PISTOL_BULLET, 30);
				}
				break;
			case 20:
				(void) mongets(mtmp, mtmp->m_lev > 4 ? GRENADE_LAUNCHER : PISTOL);
				if (mtmp->m_lev > 4) {
					m_initthrow(mtmp, FRAG_GRENADE, 15);
				} else {
					m_initthrow(mtmp, rn2(2000) ? PISTOL_BULLET : ANTIMATTER_PISTOL_BULLET, 30);
				}
				break;
			case 21:
				(void) mongets(mtmp, mtmp->m_lev > 4 ? GRENADE_LAUNCHER : PISTOL);
				if (mtmp->m_lev > 4) {
					m_initthrow(mtmp, GAS_GRENADE, 15);
				} else {
					m_initthrow(mtmp, rn2(2000) ? PISTOL_BULLET : ANTIMATTER_PISTOL_BULLET, 30);
				}
				break;
			default:
				m_initthrow(mtmp, rn2(2) ? FRAG_GRENADE : GAS_GRENADE, 20);
				break;

		}

	}

	return;
}

STATIC_OVL void
m_initxtraitem(mtmp)
register struct monst *mtmp;
{
	register struct permonst *ptr = mtmp->data;

	if (!rn2(250) && timebasedlowerchance() && (rn2(100) > u.usefulitemchance) ) (void) mongets(mtmp, SCR_STANDARD_ID);

	if (!rn2(60) && ((rn2(100) > u.usefulitemchance) || (rn2(100) > u.usefulitemchance) ) ) (void) mongets(mtmp, SCR_HEALING);

	if (!rn2(ishaxor ? 600 : 1200)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
	if (!rn2(ishaxor ? 600 : 1200)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
	if (!rn2(ishaxor ? 600 : 1200)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));

	if (attacktype(ptr, AT_WEAP) && !rn2(ishaxor ? 1000 : 2000)) {
		struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
		if (otmpX) {
			otmpX->spe = 0;
			otmpX->quan = 1;
			otmpX->owt = weight(otmpX);
			otmpX->corpsenm = egg_type_from_parent(PM_COCKATRICE, FALSE);
			attach_egg_hatch_timeout(otmpX);
			kill_egg(otmpX); /* make sure they're stale --Amy */
			(void) mpickobj(mtmp,otmpX, TRUE);
		}
	}

	if (attacktype(ptr, AT_WEAP) && !rn2(ishaxor ? 250 : 500)) {

		struct obj *otmpY = mksobj(CORPSE,TRUE,FALSE, FALSE);

		if (otmpY) {
			otmpY->spe = 0;
			otmpY->quan = 1;
			otmpY->owt = /*weight(otmpY)*/30;
			otmpY->corpsenm = PM_COCKATRICE;
			start_corpse_timeout(otmpY); /* gotta make sure they time out after a while! --Amy */
			(void) mpickobj(mtmp,otmpY, TRUE);
		}

		struct obj *otmpZ = mksobj(rnd_class(PLASTEEL_GLOVES,GAUNTLETS_OF_DEXTERITY), TRUE, FALSE, FALSE);
		if (otmpZ) {
			otmpZ->quan = 1;
			otmpZ->owt = weight(otmpZ);
			(void) mpickobj(mtmp, otmpZ, TRUE);
		}

	}

}

STATIC_OVL void
m_initweap(mtmp)
register struct monst *mtmp;
{
	register struct permonst *ptr = mtmp->data;
	register int mm = monsndx(ptr);
	struct obj *otmp;

#ifdef REINCARNATION
	if (Is_rogue_level(&u.uz) && rn2(2) ) return;
#endif
/*
 *	first a few special cases:
 *
 *		giants get a boulder to throw sometimes.
 *		ettins get clubs
 *		kobolds get darts to throw
 *		centaurs get some sort of bow & arrows or bolts
 *		soldiers get all sorts of things.
 *		kops get clubs & cream pies.
 */

	switch (ptr->mlet) {
	    case S_GIANT:

		/* very low-level monsters with M2_ROCKTHROW would totally 0wn you if they were to start with boulders --Amy */
		if (rn2(2) && ptr->mlevel >= 4) (void)mongets(mtmp, (mm != PM_ETTIN) ?
				    BOULDER : CLUB);

		if (ptr == &mons[PM_HILL_GIANT_WITH_NO_DOTS_ON_THE_U]) {
			otmp = mksobj(BOULDER, FALSE, FALSE, FALSE);
			if (otmp) {
				otmp->oinvis = TRUE;
				(void) mpickobj(mtmp, otmp, TRUE);
			}
			otmp = mksobj(BOULDER, FALSE, FALSE, FALSE);
			if (otmp) {
				otmp->oinvis = TRUE;
				(void) mpickobj(mtmp, otmp, TRUE);
			}
			otmp = mksobj(BOULDER, FALSE, FALSE, FALSE);
			if (otmp) {
				otmp->oinvis = TRUE;
				(void) mpickobj(mtmp, otmp, TRUE);
			}
		}

		if (ptr == &mons[PM_HABIBA]) (void)mongets(mtmp, WAN_CREATE_HORDE);
		if (ptr == &mons[PM_HANIFE]) (void)mongets(mtmp, DIAMOND_SMASHER);
		if (ptr == &mons[PM_OPERATION]) (void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (ptr == &mons[PM_SUNBEAM]) (void)mongets(mtmp, WAN_SOLAR_BEAM);
		if (ptr == &mons[PM_CLUB_RACQUET]) (void)mongets(mtmp, MACE);
		if (ptr == &mons[PM_BLOOD_IMPACTER]) (void)mongets(mtmp, FLAIL);
		if (ptr == &mons[PM_IMPACTER]) (void)mongets(mtmp, FLANGED_MACE);
		if (ptr == &mons[PM_DEATH_IMPACTER]) (void)mongets(mtmp, AKLYS);
		if (ptr == &mons[PM_TURBO_CLUB_RACQUET]) (void)mongets(mtmp, METAL_CLUB);
		if (ptr == &mons[PM_GIANT_STONE_CRUSHER]) (void)mongets(mtmp, MALLET);
		if (ptr == &mons[PM_MAULOTAUR]) (void)mongets(mtmp, MALLET);

		if (ptr == &mons[PM_CONCRETE_GIANT]) (void)mongets(mtmp, BOULDER);

		if (ptr == &mons[PM_ELECTRIC_GIANT]) (void)mongets(mtmp, WAN_LIGHTNING);

		if (ptr == &mons[PM_FATHIEN_ELITE]) { (void)mongets(mtmp, ELVEN_BOW); (void)mongets(mtmp, ELVEN_DAGGER);
			 m_initthrow(mtmp, ELVEN_ARROW, 50);
		}

		if (ptr == &mons[PM_FATHIEN_BLADEWITCH]) { (void)mongets(mtmp, ELVEN_BOW); (void)mongets(mtmp, WEDGE_SANDALS); (void)mongets(mtmp, ELVEN_SHORT_SWORD); m_initthrow(mtmp, ELVEN_ARROW, 50); /* M4_SANDALS */
		}

		if (ptr == &mons[PM_GRASS_GIANT]) { (void)mongets(mtmp, SLING); m_initthrow(mtmp, ROCK, 50);
		}

		if (ptr == &mons[PM_EARTH_GIANT]) { (void)mongets(mtmp, WAN_DIGGING); (void)mongets(mtmp, BOULDER); (void)mongets(mtmp, BOULDER); (void)mongets(mtmp, SLING); m_initthrow(mtmp, FLINT, 20);
		}

		if (ptr == &mons[PM_POISON_GIANT]) { (void)mongets(mtmp, ORCISH_BOW); m_initthrow(mtmp, ORCISH_ARROW, 50);
		}

		if (ptr == &mons[PM_GLASS_GIANT]) { (void)mongets(mtmp, SLING); m_initthrow(mtmp, FLINT, 35);
		}

		break;

	    case S_ANT:

		if (ptr == &mons[PM_DUKE_NUKEM_PLAYER]) { (void) mongets(mtmp, PISTOL);
			 m_initthrow(mtmp, PISTOL_BULLET, 25);

		}
		if (ptr == &mons[PM_DOOM_PLAYER]) {
			 (void) mongets(mtmp, HAND_BLASTER);
			m_initthrow(mtmp, BLASTER_BOLT, 40);

		}

		break;

	    case S_FELINE:

		if (ptr == &mons[PM_PANTHER_WOMAN]) (void)mongets(mtmp, BULLWHIP);
		if (ptr == &mons[PM_ARMED_PANTHER]) m_initthrow(mtmp, ORCISH_DAGGER, 2);

		if (ptr == &mons[PM_HUNTRESS]) (void)mongets(mtmp, BULLWHIP);
		if (ptr == &mons[PM_SLINGER]) m_initthrow(mtmp, ORCISH_DAGGER, 3);
		if (ptr == &mons[PM_SPEAR_THROWING_CAT]) m_initthrow(mtmp, SPEAR, 3);
		if (ptr == &mons[PM_ONE_OF_THE_SPEAR_CATS]) m_initthrow(mtmp, RANDOSPEAR, 3);
		if (ptr == &mons[PM_BOMB_THROWING_CAT]) m_initthrow(mtmp, FRAG_GRENADE, 3);
		if (ptr == &mons[PM_SABER_CAT]) (void)mongets(mtmp, RAPIER);
		if (ptr == &mons[PM_NIGHT_TIGER]) (void)mongets(mtmp, JAVELIN);
		if (ptr == &mons[PM_NIGHT_SLINGER]) { (void)mongets(mtmp, SLING); m_initthrow(mtmp, ROCK, 25);}
		if (ptr == &mons[PM_CAT_APULT]) { (void)mongets(mtmp, SLING); m_initthrow(mtmp, ROCK, 50); m_initthrow(mtmp, ROCK, 50);}
		if (ptr == &mons[PM_POISON_SLINGER]) m_initthrow(mtmp, GAS_GRENADE, 3);
		if (ptr == &mons[PM_INCORRECT_CAT]) (void)mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		if (ptr == &mons[PM_ANNOYING_CAT]) (void)mongets(mtmp, AMULET_OF_LIFE_SAVING );
		if (ptr == &mons[PM_HYPER_SABLE_CAT]) (void)mongets(mtmp, GOLDEN_SABER );
		if (ptr == &mons[PM_HELL_SLINGER]) { (void)mongets(mtmp, SLING); m_initthrow(mtmp, FLINT, 25);}

		if (ptr == &mons[PM_GUN_CAT]) { (void)mongets(mtmp, PISTOL); m_initthrow(mtmp, PISTOL_BULLET, 25);}

		if (ptr == &mons[PM_AUTOHIT_SLINGER]) { (void)mongets(mtmp, SLING); m_initthrow(mtmp, FLINT, 35);}
		if (ptr == &mons[PM_JAVELIN_CHUCKER]) m_initthrow(mtmp, JAVELIN, 3);
		if (ptr == &mons[PM_SPIRIT_THROWER]) m_initthrow(mtmp, SPIRIT_THROWER, 3);

		break;

	    case S_WALLMONST:

		if (ptr == &mons[PM_KALASHNIKOV_WALL] || ptr == &mons[PM_PETTY_KALASHNIKOV_WALL]) {
		  	(void) mongets(mtmp, HEAVY_MACHINE_GUN);
		  	m_initthrow(mtmp, MG_BULLET, 30);
		  	m_initthrow(mtmp, MG_BULLET, 30);
		}

		if (ptr == &mons[PM_MELODY]) {
		  	(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		  	(void) mongets(mtmp, BULLWHIP);
		}

		break;

	    case S_RUBMONST:

		if (ptr == &mons[PM_LIGHTNINGROD]) {
		  	(void) mongets(mtmp, POT_SPEED);
		  	(void) mongets(mtmp, WAN_CREATE_HORDE);
		}

		break;

	    case S_HUMAN:

		if (ptr == &mons[PM_RASHIDA]) {
		  	(void) mongets(mtmp, BRONZE_PLATE_MAIL);
		  	(void) mongets(mtmp, HIGH_BOOTS);
		  	(void) mongets(mtmp, GAUNTLETS_OF_STEEL);
		  	(void) mongets(mtmp, BRIDGE_MUZZLE);
		  	(void) mongets(mtmp, SHIELD);

		}

		if (ptr == &mons[PM_TRIBUTE]) {

			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));

		}

		if (ptr == &mons[PM_TRIBUTE_MASTER]) {

			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
		}

		if (ptr == &mons[PM_BLOODY_LAWYER]) (void) mongets(mtmp, SCR_BAD_EFFECT);

		if (ptr == &mons[PM_HEFFER]) (void) mongets(mtmp, MALLET);

		if (ptr == &mons[PM_KARATE_SISTER]) (void) mongets(mtmp, COMBAT_STILETTOS);

		if (ptr == &mons[PM_WOODSMAN]) (void) mongets(mtmp, AXE);

		if (ptr == &mons[PM_BATTLE_MAIDEN]) {(void) mongets(mtmp, LEATHER_PEEP_TOES); (void) mongets(mtmp, KATANA); (void) mongets(mtmp, CROSSBOW); m_initthrow(mtmp, CROSSBOW_BOLT, 50);
		}

		if (ptr == &mons[PM_FEMALE_SAMURAI]) {(void) mongets(mtmp, WEDGE_SANDALS); (void) mongets(mtmp, KATANA); (void) mongets(mtmp, YUMI); m_initthrow(mtmp, YA, 35); /* M4_SANDALS */
		}

		if (ptr == &mons[PM_FRYBONE]) {(void) mongets(mtmp, DAGGER); (void) mongets(mtmp, SMALL_SHIELD);}

		if (ptr == &mons[PM_GEMINI_RICKETS]) {(void) mongets(mtmp, ATHAME); (void) mongets(mtmp, LARGE_SHIELD); (void) mongets(mtmp, SPLINT_MAIL);}

		if (ptr == &mons[PM_CAR_DRIVING_SUPERTHIEF]) {(void) mongets(mtmp, SCR_WARPING); (void) mongets(mtmp, SCR_WARPING);}
		if (ptr == &mons[PM_HAR_HAR_THIEF]) {(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);}

		if (ptr == &mons[PM_SUPERJEDI] || ptr == &mons[PM_DIVISION_JEDI] || ptr == &mons[PM_CRITICALLY_INJURED_JEDI]) (void) mongets(mtmp, RED_LIGHTSABER);

		if (ptr == &mons[PM_OH_GOD]) (void) mongets(mtmp, WAN_SUMMON_UNDEAD);
		if (ptr == &mons[PM_IZUMO]) { (void) mongets(mtmp, KATANA); m_initthrow(mtmp, DART, 30);
		}

		if (ptr == &mons[PM_DARK_RANGER] || ptr == &mons[PM_DARK_ARCHER] || ptr == &mons[PM_VILE_ARCHER] || ptr == &mons[PM_FIRE_ARCHER] || ptr == &mons[PM_BLACK_ARCHER] || ptr == &mons[PM_FLESH_ARCHER] || ptr == &mons[PM_SAND_ARCHER] || ptr == &mons[PM_JUNGLE_ARCHER] || ptr == &mons[PM_SERRATED_ARCHER] || ptr == &mons[PM_PALE_ARCHER] || ptr == &mons[PM_WATER_ARCHER]) { (void) mongets(mtmp, BOW); m_initthrow(mtmp, ARROW, 30); }

		if (ptr == &mons[PM_RANGER_CHIEFTAIN]) { (void) mongets(mtmp, BOW); m_initthrow(mtmp, ARROW, 50); }
		if (ptr == &mons[PM_CORSAIR_OF_UMBAR]) { (void) mongets(mtmp, BOW); m_initthrow(mtmp, ARROW, 50); }
		if (ptr == &mons[PM_NOVICE_RANGER]) { (void) mongets(mtmp, BOW); m_initthrow(mtmp, ARROW, 20); }
		if (ptr == &mons[PM_SEMI_NOVICE_RANGER]) { (void) mongets(mtmp, BOW); m_initthrow(mtmp, ARROW, 20); }

		if (ptr == &mons[PM_ROGUE_HIRELING] || ptr == &mons[PM_ROGUE_SCOUT] || ptr == &mons[PM_WIG_SHEEP] || ptr == &mons[PM_ROGUE_CAPTAIN]) { (void) mongets(mtmp, BOW); m_initthrow(mtmp, ARROW, 40); }

		if (ptr == &mons[PM_HOSTILE_GIRLFRIEND] || ptr == &mons[PM_PAS_OP]) { (void) mongets(mtmp, CROSSBOW); m_initthrow(mtmp, CROSSBOW_BOLT, 40); m_initthrow(mtmp, CROSSBOW_BOLT, 20); }

		if (ptr == &mons[PM_VERA_S_SERVANT] || ptr == &mons[PM_LADY_FREEZE]) { (void) mongets(mtmp, ELVEN_BOW); m_initthrow(mtmp, ELVEN_ARROW, 40); }

		if (ptr == &mons[PM_DEVIOUS_GIRL] || ptr == &mons[PM_HELL_FIRE_ROGUE]) { (void) mongets(mtmp, GRENADE_LAUNCHER); m_initthrow(mtmp, FRAG_GRENADE, 10); }

		if (ptr == &mons[PM_NINJA_LORD]) { (void) mongets(mtmp, KATANA); m_initthrow(mtmp, SHURIKEN, 45); }

		if (ptr == &mons[PM_VIOLET_BLADEWITCH]) { (void) mongets(mtmp, RUNESWORD); (void) mongets(mtmp, DROVEN_BOW); m_initthrow(mtmp, DROVEN_ARROW, 50); (void) mongets(mtmp, DANCING_SHOES); }

		if (ptr == &mons[PM_WEAK_GUARD] || ptr == &mons[PM_POSSESSED_GUARD]) { (void) mongets(mtmp, VOULGE); (void) mongets(mtmp, SCALE_MAIL); }

		if (ptr == &mons[PM_PSYCHO_GUARD]) { (void) mongets(mtmp, GUISARME); (void) mongets(mtmp, CHAIN_MAIL); }
		if (ptr == &mons[PM_EXTREME_PSYCHO_GUARD]) { (void) mongets(mtmp, GUISARME); (void) mongets(mtmp, CHAIN_MAIL); }

		if (ptr == &mons[PM_BAD_GUARD] || ptr == &mons[PM_DARK_LORD_GUARD]) { (void) mongets(mtmp, BILL_GUISARME); (void) mongets(mtmp, SPLINT_MAIL); }

		if (ptr == &mons[PM_DARK_SPEARWOMAN]) (void) mongets(mtmp, SPEAR);

		if (ptr == &mons[PM_DREAD_WITCH]) (void) mongets(mtmp, SCR_SUMMON_UNDEAD);

		if (ptr == &mons[PM_DIRE_WITCH]) {(void) mongets(mtmp, SCR_CREATE_MONSTER); (void) mongets(mtmp, WAN_COLD);}

		if (ptr == &mons[PM_SHAOLIN_PRIESTESS]) {(void) mongets(mtmp, ELECTRIC_SWORD); (void) mongets(mtmp, ROBE_OF_POWER); (void) mongets(mtmp, SWEET_MOCASSINS);}

		if (ptr == &mons[PM_TWISTED_SYLPH]) {(void) mongets(mtmp, WAN_CREATE_MONSTER); (void) mongets(mtmp, POT_FULL_HEALING); (void) mongets(mtmp, WAN_FIREBALL); (void) mongets(mtmp, WAN_BAD_EFFECT);}

		if (ptr == &mons[PM_DARK_RONIN] || ptr == &mons[PM_FEMALE_RONIN]) {(void) mongets(mtmp, KATANA); (void) mongets(mtmp, LARGE_SHIELD); (void) mongets(mtmp, YUMI); m_initthrow(mtmp, YA, 45);}

		if (ptr == &mons[PM_ELVEN_ARCHER]) {(void) mongets(mtmp, ELVEN_BOW); m_initthrow(mtmp, ELVEN_ARROW, 30);}
		if (ptr == &mons[PM_HIGH_ELVEN_RANGER]) {(void) mongets(mtmp, ELVEN_BOW); m_initthrow(mtmp, ELVEN_ARROW, 50); m_initthrow(mtmp, ELVEN_ARROW, 50);}

		if (ptr == &mons[PM_BAAL_SPY] || ptr == &mons[PM_HOSTILE_POW]) (void) mongets(mtmp, TWO_HANDED_SWORD);

		if (ptr == &mons[PM_TORTURED_TRAITOR] || ptr == &mons[PM_TRANSLATOR]) (void) mongets(mtmp, TSURUGI);

		if (ptr == &mons[PM_VILE_LANCER] || ptr == &mons[PM_BAD_LANCE_CARRIER] || ptr == &mons[PM_DARK_LANCER] || ptr == &mons[PM_SAND_LANCER] || ptr == &mons[PM_BLACK_LANCER] || ptr == &mons[PM_FLESH_LANCER] || ptr == &mons[PM_FIRE_LANCER] || ptr == &mons[PM_SERRATED_LANCE_CARRIER] || ptr == &mons[PM_PALE_PHALANX] || ptr == &mons[PM_JUNGLE_PHALANX] || ptr == &mons[PM_WATER_PHALANX] || ptr == &mons[PM_CHARRED_PHALANX] || ptr == &mons[PM_NINJA_FIGHTER] || ptr == &mons[PM_MARTIAL_ARTS_ASSASSIN]) (void) mongets(mtmp, LANCE);

		if (ptr == &mons[PM_BLACK_MAGE] || ptr == &mons[PM_COUNSELOR] || ptr == &mons[PM_MAGISTRATE] || ptr == &mons[PM_GREEN_GUNNER] || ptr == &mons[PM_ADVOCATE] || ptr == &mons[PM_CABBALIST] || ptr == &mons[PM_DREADJUDGE] || ptr == &mons[PM_JOY_SPIKE_MAGE] || ptr == &mons[PM_JOY_PRISON_MAGE] || ptr == &mons[PM_BEAR_CLAN_MAGE]) (void) mongets(mtmp, QUARTERSTAFF);

		if (ptr == &mons[PM_GREEN_GUNNER]) { (void) mongets(mtmp, PISTOL); m_initthrow(mtmp, PISTOL_BULLET, 25); }
		if (ptr == &mons[PM_BEAR_CLAN_MAGE]) { (void) mongets(mtmp, SHOTGUN); m_initthrow(mtmp, SHOTGUN_SHELL, 20); }

		if (ptr == &mons[PM_SERRATED_ROGUE]) (void) mongets(mtmp, JAGGED_STAR);

		if (ptr == &mons[PM_ARABELLA_THE_MONEY_THIEF]) {

			mtmp->mgold = u.bankcashamount;
			u.bankcashamount = 0;
			u.bankcashlimit = rnz(1000 * (monster_difficulty() + 1 + (long)mvitals[PM_ARABELLA_THE_MONEY_THIEF].born));

		}

		if (ptr == &mons[PM_DARK_JEDI]) (void) mongets(mtmp, RED_LIGHTSABER);

		if (ptr == &mons[PM_STORECLERK]) (void) mongets(mtmp, POT_PARALYSIS);
		if (ptr == &mons[PM_FUNNY_GIRL]) (void) mongets(mtmp, POT_BLINDNESS);
		if (ptr == &mons[PM_FUNNY_LADY]) {(void) mongets(mtmp, POT_BLINDNESS); (void) mongets(mtmp, POT_BLINDNESS); }
		if (ptr == &mons[PM_JOYOUS_GIRL]) (void) mongets(mtmp, POT_BLINDNESS);
		if (ptr == &mons[PM_JOYOUS_LADY]) {(void) mongets(mtmp, POT_BLINDNESS); (void) mongets(mtmp, POT_BLINDNESS); }
		if (ptr == &mons[PM_ELF_BOXER]) (void) mongets(mtmp, POT_CONFUSION);
		if (ptr == &mons[PM_ELF_CHAMPION]) {(void) mongets(mtmp, POT_CONFUSION); (void) mongets(mtmp, POT_CONFUSION); (void) mongets(mtmp, POT_CONFUSION);}
		if (ptr == &mons[PM_LECTURER]) {(void) mongets(mtmp, POT_SLEEPING); (void) mongets(mtmp, POT_SLEEPING); (void) mongets(mtmp, POT_SLEEPING);}

		if(is_mercenary(ptr) || mm == PM_SHOPKEEPER || mm == PM_MASTER_SHOPKEEPER || mm == PM_ELITE_SHOPKEEPER || mm == PM_PUNISHER
				|| mm == PM_CHIEF_YEOMAN_WARDER || mm == PM_YEOMAN_WARDER || mm == PM_SHOTGUN_STORMTROOPER
				|| mm == PM_JEDI || mm == PM_SHADOW_JEDI
				|| mm == PM_HEDDERJEDI || mm == PM_PADAWAN || mm == PM_STORMTROOPER
				|| mm == PM_ENEMY_TROOPER || mm == PM_INFANTRYMAN || mm == PM_CUNTGUN_TROOPER
				|| mm == PM_GI_TROOPER || mm == PM_HEAVY_WEAPON_DUDE || mm == PM_RIFLEMAN
				|| mm == PM_SNIPER || mm == PM_TREPIDANT_SNIPER || mm == PM_RIOT_BREAKER || mm == PM_TANK_BREAKER
				|| mm == PM_EVASIVE_ENEMY_TROOPER || mm == PM_EVASIVE_INFANTRYMAN || mm == PM_EVASIVE_CUNTGUN_TROOPER
				|| mm == PM_EVASIVE_GI_TROOPER || mm == PM_EVASIVE_HEAVY_WEAPON_DUDE || mm == PM_EVASIVE_RIFLEMAN
				|| mm == PM_EVASIVE_SNIPER || mm == PM_EVASIVE_RIOT_BREAKER || mm == PM_EVASIVE_TANK_BREAKER
		) {

		    int w1 = 0, w2 = 0;
		    switch (mm) {
			case PM_ILLUSIONARY_SOLDIER:

				(void) mongets(mtmp, LEATHER_GLOVES);
				{
					struct obj *otmpS = mksobj(CORPSE,TRUE,FALSE, FALSE);

					if (otmpS) {
						otmpS->spe = 0;
						otmpS->quan = 1;
						otmpS->owt = 30;
						otmpS->corpsenm = PM_COCKATRICE;
						start_corpse_timeout(otmpS); /* gotta make sure they time out after a while! --Amy */
						(void) mpickobj(mtmp,otmpS, TRUE);
					}
				}
				/* fall through */

			case PM_SOLDIER:

			  if (rn2(2)) {
				  w1 = RIFLE;
			  	  m_initthrow(mtmp, RIFLE_BULLET, 25);
			  	  m_initthrow(mtmp, RIFLE_BULLET, 25);
			  } else {
				  w1 = SUBMACHINE_GUN;
			  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  }

			  w2 = rn2(2) ? KNIFE : DAGGER;
			  if (rn2(2)) (void) mongets(mtmp, FRAG_GRENADE);
			  break;
			case PM_VANILLA_SOLDIER:
			  if (rn2(3)) w1 = rn2(2) ? SHORT_SWORD : SPEAR;
			  else if (!rn2(5)) w1 = LANCE;
			  else if (!rn2(5)) w1 = DWARVISH_MATTOCK;
			  else w1 = rnd_class(PARTISAN,BEC_DE_CORBIN);
			  w2 = rn2(2) ? KNIFE : DAGGER;
			  break;
			case PM_MILITARY_GUY:
			  w1 = PISTOL;
			  w2 = rn2(2) ? KNIFE : DAGGER;
		  	  m_initthrow(mtmp, PISTOL_BULLET, 30);
			  break;
			case PM_MILITARIZER:
			  w1 = SUBMACHINE_GUN;
			  w2 = rn2(2) ? KNIFE : DAGGER;
		  	  m_initthrow(mtmp, SMG_BULLET, 50);
			  break;
			case PM_COMMANDER_IN_CHIEF:
			  w1 = ASSAULT_RIFLE;
			  w2 = rn2(2) ? KNIFE : DAGGER;
		  	  m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 30);
		  	  m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 30);
			  break;
			case PM_VIKING_SOLDIER:
			  if (rn2(3)) {
				  w1 = BOW;
			  	  m_initthrow(mtmp, ARROW, 25);
			  	  m_initthrow(mtmp, ARROW, 25);
			  } else {
				  w1 = CROSSBOW;
			  	  m_initthrow(mtmp, CROSSBOW_BOLT, 25);
			  	  m_initthrow(mtmp, CROSSBOW_BOLT, 25);
			  }
			  w2 = BATLETH;
			  break;
			case PM_SWAMP_SOLDIER:
			  if (rn2(2)) {
				  w1 = RIFLE;
			  	  m_initthrow(mtmp, RIFLE_BULLET, 25);
			  	  m_initthrow(mtmp, RIFLE_BULLET, 25);
			  } else {
				  w1 = SUBMACHINE_GUN;
			  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  }
			  w2 = rn2(2) ? KNIFE : DAGGER;
			  if (rn2(2)) (void) mongets(mtmp, FRAG_GRENADE);
			  break;
			case PM_JAVA_SOLDIER:
			  w1 = AKLYS;
		  	  m_initthrow(mtmp, JAVELIN, 7);
			  w2 = SPEAR;
			  break;
			case PM_IBERIAN_SOLDIER:
			  w1 = PISTOL;
		  	  m_initthrow(mtmp, PISTOL_BULLET, 25);
		  	  m_initthrow(mtmp, PISTOL_BULLET, 25);
			  w2 = rn2(2) ? KNIFE : DAGGER;
			  if (rn2(2)) (void) mongets(mtmp, FRAG_GRENADE);
			  break;
			case PM_ROHIRRIM_SOLDIER:
			  if (rn2(2)) {
				  w1 = RIFLE;
			  	  m_initthrow(mtmp, RIFLE_BULLET, 25);
			  	  m_initthrow(mtmp, RIFLE_BULLET, 25);
			  } else {
				  w1 = SUBMACHINE_GUN;
			  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  }
			  w2 = rn2(2) ? KNIFE : DAGGER;
			  if (rn2(2)) (void) mongets(mtmp, FRAG_GRENADE);
			  break;
			case PM_TEUTON_SOLDIER:
			  if (rn2(2)) {
				  w1 = RIFLE;
			  	  m_initthrow(mtmp, RIFLE_BULLET, 25);
			  	  m_initthrow(mtmp, RIFLE_BULLET, 25);
			  } else {
				  w1 = SUBMACHINE_GUN;
			  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  }
			  w2 = WAR_HAMMER;
			  if (rn2(2)) (void) mongets(mtmp, GAS_GRENADE);
			  break;
			case PM_FRANKISH_SOLDIER:
			  if (rn2(2)) {
				  w1 = RIFLE;
			  	  m_initthrow(mtmp, RIFLE_BULLET, 25);
			  	  m_initthrow(mtmp, RIFLE_BULLET, 25);
			  } else {
				  w1 = SUBMACHINE_GUN;
			  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  }
			  w2 = rn2(2) ? AXE : SHORT_SWORD;
			  if (rn2(2)) (void) mongets(mtmp, FRAG_GRENADE);
			  break;
			case PM_BRITISH_SOLDIER:
			  w1 = rn2(2) ? BOW : YUMI;
		  	  m_initthrow(mtmp, ARROW, 25);
		  	  m_initthrow(mtmp, ARROW, 25);
			  w2 = rn2(2) ? KNIFE : DAGGER;
			  if (rn2(2)) (void) mongets(mtmp, POT_INVISIBILITY);
			  break;
			case PM_AMERICAN_SOLDIER:
			  if (rn2(2)) {
				  w1 = RIFLE;
			  	  m_initthrow(mtmp, RIFLE_BULLET, 25);
			  	  m_initthrow(mtmp, RIFLE_BULLET, 25);
			  } else {
				  w1 = SUBMACHINE_GUN;
			  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  }
			  w2 = rn2(2) ? KNIFE : DAGGER;
			  if (rn2(2)) (void) mongets(mtmp, FRAG_GRENADE);
			  break;
			case PM_COPPER_SOLDIER:
			  w1 = RIFLE;
		  	  m_initthrow(mtmp, COPPER_RIFLE_BULLET, 25);
		  	  m_initthrow(mtmp, COPPER_RIFLE_BULLET, 25);
			  w2 = rn2(2) ? KNIFE : DAGGER;
			  (void) mongets(mtmp, BRONZE_PLATE_MAIL);
			  break;
			case PM_ARAB_SOLDIER:
			  if (rn2(2)) {
				  w1 = RIFLE;
			  	  m_initthrow(mtmp, RIFLE_BULLET, 25);
			  	  m_initthrow(mtmp, RIFLE_BULLET, 25);
			  } else {
				  w1 = SUBMACHINE_GUN;
			  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  }
			  w2 = rn2(2) ? SAND_SWORD : DESERT_SWORD;
			  if (rn2(2)) (void) mongets(mtmp, FRAG_GRENADE);
			  if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
			  break;
			case PM_ASIAN_SOLDIER:
			  if (rn2(2)) {
				  w1 = HUNTING_RIFLE;
			  	  m_initthrow(mtmp, RIFLE_BULLET, 25);
			  	  m_initthrow(mtmp, RIFLE_BULLET, 25);
			  } else {
				  w1 = SUBMACHINE_GUN;
			  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  }
			  w2 = rn2(2) ? SCIMITAR : QUARTERSTAFF;
			  if (rn2(2)) (void) mongets(mtmp, FRAG_GRENADE);
			  if (!rn2(10)) (void) mongets(mtmp, LEATHER_PEEP_TOES);
			  break;
			case PM_PAD_SOLDIER:
			  w1 = CROSSBOW;
		  	  m_initthrow(mtmp, FLEECE_BOLT, 30);
			  w2 = BULLWHIP;
			  break;
			case PM_GAUCHE_SOLDIER:
			  w1 = MAIN_SWORD;
			  break;
			case PM_SEAFARING_SOLDIER:
			  w1 = rn2(2) ? SHOTGUN : SAWED_OFF_SHOTGUN;
		  	  m_initthrow(mtmp, SHOTGUN_SHELL, 25);
		  	  m_initthrow(mtmp, SHOTGUN_SHELL, 25);
			  w2 = !rn2(10) ? SILVER_SABER : rn2(2) ? SCIMITAR : IRON_SABER;
			  if (rn2(2)) (void) mongets(mtmp, FRAG_GRENADE);
			  break;
			case PM_BYZANTINE_SOLDIER:
			  w1 = JAVELIN;
			  w2 = rn2(2) ? KNIFE : DAGGER;
			  break;
			case PM_CELTIC_SOLDIER:
			  w1 = rn2(2) ? SLING : METAL_SLING;
		  	  m_initthrow(mtmp, FLINT, 25);
		  	  m_initthrow(mtmp, SLING_AMMO, 25);
			  w2 = rn2(2) ? WAR_HAMMER : CLUB;
			  if (rn2(2)) (void) mongets(mtmp, FRAG_GRENADE);
			  break;
			case PM_BEGINNER_MERC:
			  w1 = SHORT_SWORD;
			  w2 = NOOB_POLLAX;
			  break;
			case PM_WATCHMAN:
			case PM_ANGRY_WATCHMAN:
			  if (!rn2(3)) {
			      w1 = rn2(20) ? rnd_class(PARTISAN,BEC_DE_CORBIN) : GRINDER;
			      w2 = rn2(2) ? DAGGER : KNIFE;
			  } else w1 = rn2(2) ? SPEAR : SHORT_SWORD;
			  break;
			case PM_WATCH_CAPTAIN:
			case PM_ANGRY_WATCH_CAPTAIN:
			  w1 = rn2(2) ? LONG_SWORD : SILVER_SABER;
			  break;
			case PM_ANGRY_WATCH_LIEUTENANT:
			case PM_WATCH_LIEUTENANT:
			  w1 = rn2(2) ? LONG_SWORD : SILVER_SABER;
			  break;
			case PM_ANGRY_WATCH_LEADER:
			case PM_WATCH_LEADER:
			  w1 = rn2(2) ? LONG_SWORD : SILVER_SABER;
			  break;
			case PM_LIEUTENANT:
			  if (rn2(2)) {
			  	w1 = HEAVY_MACHINE_GUN;
			  	m_initthrow(mtmp, MG_BULLET, 50);
			  	m_initthrow(mtmp, MG_BULLET, 50);
			  	m_initthrow(mtmp, MG_BULLET, 50);
			  } else {
			  	w1 = SUBMACHINE_GUN;
			  	m_initthrow(mtmp, SMG_BULLET, 30);
			  	m_initthrow(mtmp, SMG_BULLET, 30);
			  }
			  w2 = rn2(2) ? KNIFE : DAGGER;
			  if (!rn2(4)) {
			  	(void) mongets(mtmp, FRAG_GRENADE);
			  	(void) mongets(mtmp, FRAG_GRENADE);
			  } else if (!rn2(4)) {
			  	(void) mongets(mtmp, GAS_GRENADE);
			  	(void) mongets(mtmp, GAS_GRENADE);
			  }
			  break;
			case PM_YAMATO_LIEUTENANT:
			  if (rn2(2)) {
			  	w1 = HEAVY_MACHINE_GUN;
			  	m_initthrow(mtmp, MG_BULLET, 50);
			  	m_initthrow(mtmp, MG_BULLET, 50);
			  	m_initthrow(mtmp, MG_BULLET, 50);
			  } else {
			  	w1 = SUBMACHINE_GUN;
			  	m_initthrow(mtmp, SMG_BULLET, 30);
			  	m_initthrow(mtmp, SMG_BULLET, 30);
			  }
			  w2 = rn2(2) ? SHORT_SWORD : LANCE;
			  if (!rn2(4)) {
			  	(void) mongets(mtmp, FRAG_GRENADE);
			  	(void) mongets(mtmp, FRAG_GRENADE);
			  } else if (!rn2(4)) {
			  	(void) mongets(mtmp, GAS_GRENADE);
			  	(void) mongets(mtmp, GAS_GRENADE);
			  }
			  break;
			case PM_CARTHAGE_LIEUTENANT:
			  if (rn2(2)) {
			  	w1 = HEAVY_MACHINE_GUN;
			  	m_initthrow(mtmp, MG_BULLET, 50);
			  	m_initthrow(mtmp, MG_BULLET, 50);
			  	m_initthrow(mtmp, MG_BULLET, 50);
			  } else {
			  	w1 = SUBMACHINE_GUN;
			  	m_initthrow(mtmp, SMG_BULLET, 30);
			  	m_initthrow(mtmp, SMG_BULLET, 30);
			  }
			  w2 = rn2(2) ? TRIDENT : SPEAR;
			  if (!rn2(4)) {
			  	(void) mongets(mtmp, FRAG_GRENADE);
			  	(void) mongets(mtmp, FRAG_GRENADE);
			  } else if (!rn2(4)) {
			  	(void) mongets(mtmp, GAS_GRENADE);
			  	(void) mongets(mtmp, GAS_GRENADE);
			  }
			  break;
			case PM_ROMAN_LIEUTENANT:
			  if (rn2(2)) {
			  	w1 = HEAVY_MACHINE_GUN;
			  	m_initthrow(mtmp, MG_BULLET, 50);
			  	m_initthrow(mtmp, MG_BULLET, 50);
			  	m_initthrow(mtmp, MG_BULLET, 50);
			  } else {
			  	w1 = SUBMACHINE_GUN;
			  	m_initthrow(mtmp, SMG_BULLET, 30);
			  	m_initthrow(mtmp, SMG_BULLET, 30);
			  }
			  w2 = rn2(2) ? LONG_SWORD : GRAIN_SCYTHE;
			  if (!rn2(4)) {
			  	(void) mongets(mtmp, FRAG_GRENADE);
			  	(void) mongets(mtmp, FRAG_GRENADE);
			  } else if (!rn2(4)) {
			  	(void) mongets(mtmp, GAS_GRENADE);
			  	(void) mongets(mtmp, GAS_GRENADE);
			  }
			  break;
			case PM_SERGEANT:
			  if (rn2(2)) {
			  	w1 = AUTO_SHOTGUN;
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 10);
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 10);
			  } else {
			  	w1 = ASSAULT_RIFLE;
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 30);
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 30);
			  }
			  w2= rn2(2) ? DAGGER : KNIFE;
			  if (!rn2(5)) {
			  	m_initthrow(mtmp, FRAG_GRENADE, 5);
				if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			  } else if (!rn2(5)) {
			  	m_initthrow(mtmp, GAS_GRENADE, 5);
				if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			  }
			  break;
			case PM_EXTRATERRESTRIAL_SERGEANT:
			  if (rn2(2)) {
			  	w1 = AUTO_SHOTGUN;
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 10);
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 10);
			  } else {
			  	w1 = ASSAULT_RIFLE;
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 30);
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 30);
			  }
			  w2= rn2(2) ? DAGGER : KNIFE;
			  if (!rn2(5)) {
			  	m_initthrow(mtmp, FRAG_GRENADE, 5);
				if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			  } else if (!rn2(5)) {
			  	m_initthrow(mtmp, GAS_GRENADE, 5);
				if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			  }
			  break;
			case PM_MINOAN_SERGEANT:
			  if (rn2(2)) {
			  	w1 = YUMI;
			  	m_initthrow(mtmp, YA, 30);
			  	m_initthrow(mtmp, YA, 30);
			  } else {
			  	w1 = CROSSBOW;
			  	m_initthrow(mtmp, CROSSBOW_BOLT, 30);
			  	m_initthrow(mtmp, CROSSBOW_BOLT, 30);
			  }
			  w2= rn2(2) ? DAGGER : KNIFE;
			  break;
			case PM_HUN_SERGEANT:
			  if (rn2(2)) {
			  	w1 = AUTO_SHOTGUN;
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 10);
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 10);
			  } else {
			  	w1 = ASSAULT_RIFLE;
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 30);
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 30);
			  }
			  w2= rn2(2) ? STEEL_WHIP : CHAINWHIP;
			  if (!rn2(5)) {
			  	m_initthrow(mtmp, FRAG_GRENADE, 5);
				if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			  } else if (!rn2(5)) {
			  	m_initthrow(mtmp, GAS_GRENADE, 5);
				if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			  }
			  break;
			case PM_MONGOL_SERGEANT:
			  if (rn2(2)) {
			  	w1 = AUTO_SHOTGUN;
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 10);
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 10);
			  } else {
			  	w1 = ASSAULT_RIFLE;
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 30);
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 30);
			  }
			  w2= rn2(2) ? LONG_SWORD : TWO_HANDED_SWORD;
			  if (!rn2(5)) {
			  	m_initthrow(mtmp, FRAG_GRENADE, 5);
				if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			  } else if (!rn2(5)) {
			  	m_initthrow(mtmp, GAS_GRENADE, 5);
				if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			  }
			  break;
			case PM_TWOWEAP_SERGEANT:
			  w1 = MAIN_SWORD;
			  w2 = PAPER_SWORD;
			  break;
			case PM_PERSIAN_SERGEANT:
			  if (rn2(2)) {
			  	w1 = AUTO_SHOTGUN;
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 10);
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 10);
			  } else {
			  	w1 = ASSAULT_RIFLE;
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 30);
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 30);
			  }
			  w2= rn2(2) ? BARDICHE : FAUCHARD;
			  if (!rn2(5)) {
			  	m_initthrow(mtmp, FRAG_GRENADE, 5);
				if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			  } else if (!rn2(5)) {
			  	m_initthrow(mtmp, GAS_GRENADE, 5);
				if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			  }
			  break;
			case PM_YEOMAN_WARDER:
			  w1 = rn2(2) ? FLAIL : MACE;
			  break;
			case PM_PRISON_GUARD:
			case PM_CAPTAIN:
			case PM_URBAN_CAMO_CAPTAIN:
			case PM_GENERAL:
			  if (rn2(2)) {
			  	w1 = AUTO_SHOTGUN;
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 20);
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 20);
			  } else if (rn2(2)) {
			  	w1 = HEAVY_MACHINE_GUN;
			  	m_initthrow(mtmp, MG_BULLET, 60);
			  	m_initthrow(mtmp, MG_BULLET, 60);
			  	m_initthrow(mtmp, MG_BULLET, 60);
			  } else {
			  	w1 = ASSAULT_RIFLE;
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 60);
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 60);
			  }
			  if (rn2(2)) {
				  w2 = ROCKET_LAUNCHER;
			  	  m_initthrow(mtmp, ROCKET, 5);
			  } else if (!rn2(4)) {
				  (void) mongets(mtmp, GRENADE_LAUNCHER);			  
			  	  m_initthrow(mtmp, 
			  	  	(rn2(2) ? FRAG_GRENADE : GAS_GRENADE), 
			  	  	5);
			  } else {
				  w2 = rn2(2) ? SILVER_SABER : DAGGER;
			  }
			  break;
			case PM_GOTHIC_CAPTAIN:
			  if (rn2(2)) {
			  	w1 = AUTO_SHOTGUN;
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 20);
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 20);
			  } else if (rn2(2)) {
			  	w1 = HEAVY_MACHINE_GUN;
			  	m_initthrow(mtmp, MG_BULLET, 60);
			  	m_initthrow(mtmp, MG_BULLET, 60);
			  	m_initthrow(mtmp, MG_BULLET, 60);
			  } else {
			  	w1 = ASSAULT_RIFLE;
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 60);
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 60);
			  }
			  if (rn2(2)) {
				  w2 = ROCKET_LAUNCHER;
			  	  m_initthrow(mtmp, ROCKET, 5);
			  } else if (!rn2(4)) {
				  (void) mongets(mtmp, GRENADE_LAUNCHER);			  
			  	  m_initthrow(mtmp, (rn2(2) ? FRAG_GRENADE : GAS_GRENADE), 5);
			  } else {
				  w2 = rn2(2) ? GREAT_HOUCHOU : WEIGHTED_FLAIL;
			  }
			  break;
			case PM_CHIEF_YEOMAN_WARDER:
			  w1 = rn2(2) ? BROADSWORD : LONG_SWORD;
			  break;
			case PM_PADAWAN:
			case PM_JEDI:
			case PM_SHADOW_JEDI:
			case PM_HEDDERJEDI:
			  switch(rnd(12)){
			    case 1: mongets(mtmp, RED_LIGHTSABER); break;
			    case 2: mongets(mtmp, BLUE_LIGHTSABER); break;
			    case 3: mongets(mtmp, GREEN_LIGHTSABER); break;
			    case 4: mongets(mtmp, VIOLET_LIGHTSABER); break;
			    case 5: mongets(mtmp, WHITE_LIGHTSABER); break;
			    case 6: mongets(mtmp, YELLOW_LIGHTSABER); break;
			    case 7: mongets(mtmp, RED_DOUBLE_LIGHTSABER); break;
			    case 8: mongets(mtmp, WHITE_DOUBLE_LIGHTSABER); break;
			    case 9: mongets(mtmp, MYSTERY_LIGHTSABER); break;
			    case 10: mongets(mtmp, ORANGE_LIGHTSABER); break;
			    case 11: mongets(mtmp, BLACK_LIGHTSABER); break;
			    case 12: mongets(mtmp, CYAN_DOUBLE_LIGHTSABER); break;
			    default: break;
			  }
			  break;
			case PM_THE_JEDI_MASTER:
			  mongets(mtmp, BLUE_LIGHTSABER);
			  mongets(mtmp, SPEED_BOOTS);
			  mongets(mtmp, AMULET_OF_REFLECTION);
			  break;
			case PM_STORMTROOPER:
			  if (rn2(2)) {
			  	w1 = HEAVY_MACHINE_GUN;
			  	m_initthrow(mtmp, MG_BULLET, 50);
			  } else {
			  	w1 = SUBMACHINE_GUN;
			  	m_initthrow(mtmp, SMG_BULLET, 30);
			  }
			  mongets(mtmp, PLASTEEL_ARMOR);
			  mongets(mtmp, PLASTEEL_GLOVES);
			  mongets(mtmp, PLASTEEL_BOOTS);
			  mongets(mtmp, PLASTEEL_HELM);
			  break;

			case PM_SHOTGUN_STORMTROOPER:
			  if (rn2(2)) {
			  	w1 = SHOTGUN;
			  	m_initthrow(mtmp, SHOTGUN_SHELL, 25);
			  } else {
			  	w1 = AUTO_SHOTGUN;
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 50);
			  }
			  mongets(mtmp, PLASTEEL_ARMOR);
			  mongets(mtmp, PLASTEEL_GLOVES);
			  mongets(mtmp, PLASTEEL_BOOTS);
			  mongets(mtmp, PLASTEEL_HELM);
			  break;

			case PM_LASER_STORMTROOPER:
			  if (rn2(15)) {
			  	w1 = HAND_BLASTER;
			  	m_initthrow(mtmp, BLASTER_BOLT, 50);
			  } else {
			  	w1 = RAYGUN;
			  	m_initthrow(mtmp, RAYGUN_BOLT, 50);
			  }
			  mongets(mtmp, PLASTEEL_ARMOR);
			  mongets(mtmp, PLASTEEL_GLOVES);
			  mongets(mtmp, PLASTEEL_BOOTS);
			  mongets(mtmp, PLASTEEL_HELM);
			  break;

			case PM_HEAVY_WEAPON_DUDE:
			case PM_EVASIVE_HEAVY_WEAPON_DUDE:
			  	w1 = HEAVY_MACHINE_GUN;
			  	m_initthrow(mtmp, MG_BULLET, 50);
			  mongets(mtmp, CHAIN_MAIL);
			  break;

			case PM_INFANTRYMAN:
			case PM_EVASIVE_INFANTRYMAN:
			  	w1 = SUBMACHINE_GUN;
			  	m_initthrow(mtmp, SMG_BULLET, 50);
			  mongets(mtmp, CHAIN_MAIL);
			  break;

			case PM_ENEMY_TROOPER:
			case PM_EVASIVE_ENEMY_TROOPER:
			  	w1 = PISTOL;
			  	m_initthrow(mtmp, PISTOL_BULLET, 50);
			  mongets(mtmp, CHAIN_MAIL);
			  break;

			case PM_CUNTGUN_TROOPER:
			case PM_EVASIVE_CUNTGUN_TROOPER:
			  	w1 = RIFLE;
			  	m_initthrow(mtmp, RIFLE_BULLET, 50);
			  mongets(mtmp, CHAIN_MAIL);
			  break;

			case PM_GI_TROOPER:
			case PM_EVASIVE_GI_TROOPER:
			  	w1 = ASSAULT_RIFLE;
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
			  mongets(mtmp, CHAIN_MAIL);
			  break;

			case PM_SNIPER:
			case PM_TREPIDANT_SNIPER:
			case PM_EVASIVE_SNIPER:
			  	w1 = SNIPER_RIFLE;
			  	m_initthrow(mtmp, SNIPER_BULLET, 50);
			  mongets(mtmp, CHAIN_MAIL);
			  break;

			case PM_GERMAN_SNIPER:
			  	w1 = SNIPER_RIFLE;
			  	m_initthrow(mtmp, SNIPER_BULLET, 50);
			  	m_initthrow(mtmp, SNIPER_BULLET, 50);
			  mongets(mtmp, PLATE_MAIL);
			  break;

			case PM_RIFLEMAN:
			case PM_EVASIVE_RIFLEMAN:
			  	w1 = SHOTGUN;
			  	m_initthrow(mtmp, SHOTGUN_SHELL, 20);
			  mongets(mtmp, CHAIN_MAIL);
			  break;

			case PM_RIOT_BREAKER:
			case PM_EVASIVE_RIOT_BREAKER:
			  	w1 = AUTO_SHOTGUN;
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 20);
			  mongets(mtmp, CHAIN_MAIL);
			  break;

			case PM_TANK_BREAKER:
			case PM_EVASIVE_TANK_BREAKER:
			  	w1 = ROCKET_LAUNCHER;
			  	m_initthrow(mtmp, ROCKET, 7);
			  mongets(mtmp, CHAIN_MAIL);
			  break;
			case PM_SHOPKEEPER:
			case PM_MASTER_SHOPKEEPER:
			case PM_ELITE_SHOPKEEPER:
			case PM_PUNISHER:
			  (void) mongets(mtmp, rn2(50) ? SHOTGUN : SAWED_OFF_SHOTGUN);
			  m_initthrow(mtmp, SHOTGUN_SHELL, 20);
			  m_initthrow(mtmp, SHOTGUN_SHELL, 20);
			  m_initthrow(mtmp, SHOTGUN_SHELL, 20);

			/* evil patch idea by jonadab: 5% chance for shopkeepers to be generated invisible */
			  if (!rn2(20)) (void) mongets(mtmp, CLOAK_OF_INVISIBILITY);

			  /* Fallthrough */
			default:
			  if (!rn2(4)) w1 = DAGGER;
			  if (!rn2(7)) w2 = SPEAR;
			  break;
		    }
		    if (w1) (void)mongets(mtmp, w1);
		    if (!w2 && w1 != DAGGER && !rn2(4)) w2 = KNIFE;
		    if (w2) (void)mongets(mtmp, w2);
		} else if (is_elf(ptr)) {

		    if (mm == PM_ALBAE || mm == PM_DROW_NOVICE) { /* don't hand elven bows to them! --Amy */
			(void) mongets(mtmp, ELVEN_CLOAK);
		    } else if (mm == PM_DROW) {
			(void) mongets(mtmp, DARK_ELVEN_MITHRIL_COAT);
			(void) mongets(mtmp, DARK_ELVEN_SHORT_SWORD);
			(void) mongets(mtmp, DARK_ELVEN_BOW);
			m_initthrow(mtmp, DARK_ELVEN_ARROW, 30);
		    } else if (mm == PM_DROW_SHARPSHOOTER) {
			(void) mongets(mtmp, DARK_ELVEN_MITHRIL_COAT);
			(void) mongets(mtmp, DARK_ELVEN_SHORT_SWORD);
			(void) mongets(mtmp, DROVEN_CROSSBOW);
			m_initthrow(mtmp, DROVEN_BOLT, 55);
		    } else if (mm == PM_DROW_SNIPER) {
			(void) mongets(mtmp, DARK_ELVEN_MITHRIL_COAT);
			(void) mongets(mtmp, DARK_ELVEN_SHORT_SWORD);
			(void) mongets(mtmp, DROVEN_BOW);
			m_initthrow(mtmp, DROVEN_ARROW, 45);
		    } else if (ptr->mlevel >= 3) { /* fail safe, because of albae and stuff */
				if (rn2(2))
					(void) mongets(mtmp, !rn2(4) ? ELVEN_MITHRIL_COAT : ELVEN_CLOAK);
				if (!rn2(3)) (void)mongets(mtmp, ELVEN_LEATHER_HELM);
				else if (!rn2(4)) (void)mongets(mtmp, ELVEN_BOOTS);
				if (!rn2(3)) (void)mongets(mtmp, ELVEN_DAGGER);
				switch (rn2(3)) {
					case 0:
						if (!rn2(4)) (void)mongets(mtmp, ELVEN_SHIELD);
						if (rn2(3)) (void)mongets(mtmp, ELVEN_SHORT_SWORD);
						(void)mongets(mtmp, ELVEN_BOW);
						m_initthrow(mtmp, ELVEN_ARROW, 30);
						break;
					case 1:
						(void)mongets(mtmp, ELVEN_BROADSWORD);
						if (rn2(2)) (void)mongets(mtmp, ELVEN_SHIELD);
						break;
					case 2:
						if (rn2(2)) {
							(void)mongets(mtmp, ELVEN_SPEAR);
							(void)mongets(mtmp, ELVEN_SHIELD);
						}
						break;
				}
				if (mm == PM_ELVENKING) {
					if (rn2(3) || (in_mklev && Is_earthlevel(&u.uz)))
						(void)mongets(mtmp, PICK_AXE);
					if (!rn2(50)) (void)mongets(mtmp, CRYSTAL_BALL);
				}
		    } else { /* too low in level to be getting a bow */
			(void) mongets(mtmp, LEATHER_CLOAK);
		    } /* normal elves */                
		} else /* enemy characters! */ /* They will always get stuff now. --Amy */
		 if ((mm >= PM_ARCHEOLOGIST && mm <= PM_WIZARD /*&& rn2(4)*/) || (mm >= PM_UNDEAD_ARCHEOLOGIST && mm <= PM_UNDEAD_WIZARD) ) { 

			if (!rn2(ishaxor ? 20 : 40) ) (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			if (!rn2(ishaxor ? 20 : 40) ) (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			if (!rn2(ishaxor ? 40 : 80) ) (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			if (!rn2(ishaxor ? 80 : 160) ) (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			if (!rn2(ishaxor ? 160 : 320) ) (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			if (!rn2(ishaxor ? 320 : 640) ) (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));

		  switch (mm) {
		   case PM_ARCHEOLOGIST:
		   case PM_UNDEAD_ARCHEOLOGIST:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));

		     (void)mongets(mtmp, BULLWHIP);
		     (void)mongets(mtmp, LEATHER_JACKET);
		     (void)mongets(mtmp, FEDORA);
		     if (rn2(2)) (void)mongets(mtmp, PICK_AXE);
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 15);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 15));
#endif
		   break;

		   case PM_ZOOKEEPER:
		   case PM_UNDEAD_ZOOKEEPER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));

		     (void)mongets(mtmp, BULLWHIP);
		   break;

		   case PM_CLIMACTERIAL:
		   case PM_UNDEAD_CLIMACTERIAL:
		     (void)mongets(mtmp, TOILET_ROLL);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));

		   break;

		   case PM_WOMANIZER:
		   case PM_UNDEAD_WOMANIZER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, ROSE_WHIP);
		     (void)mongets(mtmp, ELVIS_SHOES);

		   break;

		   case PM_ARTIST:
		   case PM_UNDEAD_ARTIST:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, MALLET);
		     (void)mongets(mtmp, FEDORA);
		     (void)mongets(mtmp, LAB_COAT);
		     if (!rn2(4)) (void)mongets(mtmp, GAUNTLETS_OF_DEXTERITY);
		   break;

		   case PM_GAMER:
		   case PM_UNDEAD_GAMER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     (void)mongets(mtmp, T_SHIRT);

		   break;

		   case PM_BARBARIAN:
		   case PM_UNDEAD_BARBARIAN:
		   case PM_NOOB_MODE_BARB:
		   case PM_UNDEAD_NOOB_MODE_BARB:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));

		     (void)mongets(mtmp, BATTLE_AXE);
		     if (!rn2(2)) (void)mongets(mtmp, TWO_HANDED_SWORD);
		     (void)mongets(mtmp, RING_MAIL);
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 15);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 15));
#endif
		   break;

		   case PM_BINDER:
		   case PM_UNDEAD_BINDER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, VOULGE);
		     (void)mongets(mtmp, KNIFE);
		     (void)mongets(mtmp, LEATHER_CLOAK);
		   break;

		   case PM_ANACHRONOUNBINDER:
		   case PM_UNDEAD_ANACHRONOUNBINDER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, SHORT_SWORD);
		     (void)mongets(mtmp, LEATHER_ARMOR);
		   break;

		   case PM_BLEEDER:
		   case PM_UNDEAD_BLEEDER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, KNIFE);
		     (void)mongets(mtmp, LAB_COAT);
		   break;

		   case PM_SOFTWARE_ENGINEER:
		   case PM_UNDEAD_SOFTWARE_ENGINEER:
		     (void)mongets(mtmp, PISTOL);
			m_initthrow(mtmp, PISTOL_BULLET, 30);
		     (void)mongets(mtmp, HEALER_UNIFORM);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));

		   break;

		   case PM_CRACKER:
		   case PM_UNDEAD_CRACKER:
		     (void)mongets(mtmp, PISTOL);
		     (void)mongets(mtmp, PICK_AXE);
			m_initthrow(mtmp, PISTOL_BULLET, 30);
		     (void)mongets(mtmp, HEALER_UNIFORM);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		   break;

		   case PM_JANITOR:
		   case PM_UNDEAD_JANITOR:
		     (void)mongets(mtmp, MOP);
		     if (rn2(2)) (void)mongets(mtmp, PICK_AXE);
		     (void)mongets(mtmp, BUNNY_UNIFORM);
		     (void)mongets(mtmp, IRON_SHOES);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		   break;

		   case PM_SPACE_MARINE:
		   case PM_UNDEAD_SPACE_MARINE:
		     (void)mongets(mtmp, PISTOL);
		     (void)mongets(mtmp, JUMPSUIT);
			m_initthrow(mtmp, PISTOL_BULLET, 50);
		     (void)mongets(mtmp, HAND_BLASTER);
			m_initthrow(mtmp, BLASTER_BOLT, 50);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));

		   break;

		   case PM_STORMBOY:
		   case PM_UNDEAD_STORMBOY:
		     (void)mongets(mtmp, SNIPER_RIFLE);
			m_initthrow(mtmp, SNIPER_BULLET, 50);
			m_initthrow(mtmp, FRAG_GRENADE, 20);
		     (void)mongets(mtmp, JUMPSUIT);
		     (void)mongets(mtmp, HELMET);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));

		   break;

		   case PM_YAUTJA:
		   case PM_UNDEAD_YAUTJA:
		     (void)mongets(mtmp, (rn2(3) || (monster_difficulty() < 15) ) ? HAND_BLASTER : ARM_BLASTER);
			m_initthrow(mtmp, BLASTER_BOLT, 50);
			m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
			m_initthrow(mtmp, SPEAR, 5);
		     (void)mongets(mtmp, SCIMITAR);
		     (void)mongets(mtmp, rn2(2) ? RAZOR_WHIP : NATURAL_STICK);
		     (void)mongets(mtmp, PLATE_MAIL);
		     (void)mongets(mtmp, LEATHER_CLOAK);
		     (void)mongets(mtmp, ANTENNA);
		     (void)mongets(mtmp, SCR_TELEPORTATION);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		   break;

		   case PM_QUARTERBACK:
		   case PM_UNDEAD_QUARTERBACK:
		     (void)mongets(mtmp, LEATHER_GLOVES);
		     (void)mongets(mtmp, HELMET);
		     (void)mongets(mtmp, BASEBALL_BAT);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));

		   break;

		   case PM_PSYKER:
		   case PM_UNDEAD_PSYKER:
		     (void)mongets(mtmp, HAND_BLASTER);
			m_initthrow(mtmp, BLASTER_BOLT, 50);
		     (void)mongets(mtmp, HEALER_UNIFORM);
		     (void)mongets(mtmp, POT_HEALING);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		   break;

		   case PM_EMPATH:
		   case PM_UNDEAD_EMPATH:
		     (void)mongets(mtmp, ELVEN_DAGGER);
		     (void)mongets(mtmp, ELVEN_TOGA);
		     (void)mongets(mtmp, POT_HEALING);
		     (void)mongets(mtmp, POT_HEALING);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));

		   break;

		   case PM_MASTERMIND:
		   case PM_UNDEAD_MASTERMIND:
		     (void)mongets(mtmp, SILK_MAIL);
		     (void)mongets(mtmp, RAYGUN);
			m_initthrow(mtmp, RAYGUN_BOLT, 50);
			m_initthrow(mtmp, RAYGUN_BOLT, 50);
		     (void)mongets(mtmp, POT_FULL_HEALING);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		   break;

		   case PM_WEIRDBOY:
		   case PM_UNDEAD_WEIRDBOY:
		     (void)mongets(mtmp, HELMET);
		     (void)mongets(mtmp, BRONZE_MORNING_STAR);
		     (void)mongets(mtmp, HEALER_UNIFORM);
		     (void)mongets(mtmp, POT_HEALING);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		   break;

		   case PM_ASTRONAUT:
		   case PM_UNDEAD_ASTRONAUT:
		     (void)mongets(mtmp, JUMPSUIT);
		     (void)mongets(mtmp, HELMET);
		     (void)mongets(mtmp, HIGH_BOOTS);
		     (void)mongets(mtmp, LEATHER_CLOAK);
		     (void)mongets(mtmp, SCR_ANTIMATTER);
		     (void)mongets(mtmp, POT_HEALING);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		   break;

		   case PM_CYBERNINJA:
		   case PM_UNDEAD_CYBERNINJA:
		     (void)mongets(mtmp, KATANA);
		     (void)mongets(mtmp, CAMOUFLAGED_CLOTHES);
			m_initthrow(mtmp, FRAG_GRENADE, 5);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		   break;

		   case PM_DISSIDENT:
		   case PM_UNDEAD_DISSIDENT:
		     (void)mongets(mtmp, GREEN_DRAGON_SCALES);
		     (void)mongets(mtmp, ELVEN_CLOAK);
		     (void)mongets(mtmp, SPIKED_CLUB);
			m_initthrow(mtmp, GAS_GRENADE, 5);
		     (void)mongets(mtmp, HAND_BLASTER);
			m_initthrow(mtmp, BLASTER_BOLT, 5);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));

		   break;

		   case PM_XELNAGA:
		   case PM_UNDEAD_XELNAGA:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		   break;

		   case PM_GRENADONIN:
		   case PM_UNDEAD_GRENADONIN:

		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     (void)mongets(mtmp, KATANA);
		     if (rn2(2)) (void)mongets(mtmp, SHORT_SWORD);
		     if (rn2(3)) {
			(void)mongets(mtmp, YUMI);
			m_initthrow(mtmp, YA, 40);
		     }
			m_initthrow(mtmp, FRAG_GRENADE, 40);
		     (void)mongets(mtmp, SPLINT_MAIL);

			break;

		   case PM_CELLAR_CHILD:
		   case PM_UNDEAD_CELLAR_CHILD:

		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, QUARTERSTAFF);
		     (void)mongets(mtmp, PLATE_MAIL);

			break;

		   case PM_DEMAGOGUE:
		   case PM_UNDEAD_DEMAGOGUE:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));

		     (void)mongets(mtmp, MALLET);
		     (void)mongets(mtmp, FULL_PLATE_MAIL);
		     (void)mongets(mtmp, HELMET);

			break;

		   case PM_SOCIAL_JUSTICE_WARRIOR:
		   case PM_UNDEAD_SOCIAL_JUSTICE_WARRIOR:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));

		     (void)mongets(mtmp, FEDORA);
		     (void)mongets(mtmp, FLY_SWATTER);

			break;

		   case PM_WALSCHOLAR:
		   case PM_UNDEAD_WALSCHOLAR:

		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, DAGGER);
		     (void)mongets(mtmp, PICK_AXE);
		     (void)mongets(mtmp, LEATHER_ARMOR);

			break;

		   case PM_SINGSLAVE:
		   case PM_UNDEAD_SINGSLAVE:

		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

			break;

		   case PM_MASON:
		   case PM_UNDEAD_MASON:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, PICK_AXE);
		     (void)mongets(mtmp, WAR_HAMMER);
		     (void)mongets(mtmp, CHAIN_MAIL);
		     (void)mongets(mtmp, HELMET);
		     (void)mongets(mtmp, SCR_LOCKOUT);
		   break;

		   case PM_HUSSY:
		   case PM_UNDEAD_HUSSY:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));

		     (void)mongets(mtmp, SOFT_GIRL_SNEAKER);
		     (void)mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		     (void)mongets(mtmp, SCR_BAD_EFFECT);
		     (void)mongets(mtmp, SCR_BAD_EFFECT);
		   break;

		   case PM_BARD: case PM_UNDEAD_BARD:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, LEATHER_CLOAK);
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 15);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 15));
#endif
		   break;

		   case PM_CAVEMAN: case PM_CAVEWOMAN:
		   case PM_UNDEAD_CAVEMAN: case PM_UNDEAD_CAVEWOMAN:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, CLUB);
		     if (rn2(3)) {
			(void)mongets(mtmp, BOW);
			 m_initthrow(mtmp, ARROW, 30);
		     }
		     (void)mongets(mtmp, LEATHER_ARMOR);
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 15);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 15));
#endif
		   break;
		   case PM_DOPPELGANGER:
		     (void)mongets(mtmp, SILVER_DAGGER);
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 15);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 15));
#endif
		   break;

		   case PM_HEMI_DOPPELGANGER:

			(void)mongets(mtmp, WAN_POLYMORPH);
		   break;

		   case PM_GEEK:
		   case PM_UNDEAD_GEEK:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     (void)mongets(mtmp, SILVER_DAGGER);
		   break;
		   case PM_ELF:
		     /* gets taken care of later... */
		     /*(void)mongets(mtmp, ELVEN_SHORT_SWORD);
		     if (rn2(3)) {
			(void)mongets(mtmp, ELVEN_BOW);
			 m_initthrow(mtmp, ELVEN_ARROW, 30);
		     }
		     if (rn2(3)) (void)mongets(mtmp, ELVEN_CLOAK);
		     else (void)mongets(mtmp, ELVEN_MITHRIL_COAT);*/
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 15);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 15));
#endif
		   break;
		   case PM_FLAME_MAGE:
		   case PM_UNDEAD_FLAME_MAGE:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, QUARTERSTAFF);
		     (void)mongets(mtmp, STUDDED_LEATHER_ARMOR);
		     (void)mongets(mtmp, WAN_FIRE);
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 15);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 15));
#endif
		   break;

		   case PM_FIREFIGHTER:
		   case PM_UNDEAD_FIREFIGHTER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, AXE);
		     (void)mongets(mtmp, WAN_FIRE);
		   break;

		   case PM_ACID_MAGE:
		   case PM_UNDEAD_ACID_MAGE:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, QUARTERSTAFF);
		     (void)mongets(mtmp, STUDDED_LEATHER_ARMOR);
		     (void)mongets(mtmp, WAN_ACID);
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 15);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 15));
#endif
		   break;

		   case PM_UNDEAD_ROCKER: /* needs to be filled */
		   case PM_ROCKER: /* needs to be filled */
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));

			(void)mongets(mtmp, SLING);
			 m_initthrow(mtmp, FLINT, 25);
			(void)mongets(mtmp, PICK_AXE);

			struct obj *otmp = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmp) {
				otmp->spe = 0;
				otmp->quan = 1;
				otmp->owt = weight(otmp);
				otmp->corpsenm = egg_type_from_parent(PM_COCKATRICE, FALSE);
				attach_egg_hatch_timeout(otmp);
				kill_egg(otmp); /* make sure they're stale --Amy */
				mpickobj(mtmp,otmp, TRUE);
			}

		   break;

		   case PM_CONVICT:
		   case PM_UNDEAD_CONVICT:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, HEAVY_IRON_BALL);
		     (void)mongets(mtmp, STRIPED_SHIRT);
		     (void)mongets(mtmp, ROCK);
		     (void)mongets(mtmp, ROCK);
		     (void)mongets(mtmp, ROCK);
		     (void)mongets(mtmp, ROCK);
		     (void)mongets(mtmp, ROCK);

			break;

		   case PM_MURDERER:
		   case PM_UNDEAD_MURDERER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, HEAVY_IRON_BALL);
		     (void)mongets(mtmp, STRIPED_SHIRT);
		     (void)mongets(mtmp, ROCK);
		     (void)mongets(mtmp, ROCK);
		     (void)mongets(mtmp, ROCK);
		     (void)mongets(mtmp, ROCK);
		     (void)mongets(mtmp, ROCK);

		   break;

		   case PM_SPACEWARS_FIGHTER:
		   case PM_UNDEAD_SPACEWARS_FIGHTER:
		   case PM_CAMPERSTRIKER:
		   case PM_UNDEAD_CAMPERSTRIKER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, GREEN_LIGHTSABER);
		     (void)mongets(mtmp, DAGGER);
		     (void)mongets(mtmp, PLASTEEL_ARMOR);
		     if (!rn2(3)) (void)mongets(mtmp, WAN_SOLAR_BEAM);

		   break;

		   case PM_CARTOMANCER:
		   case PM_UNDEAD_CARTOMANCER:

			(void) mongets(mtmp, rnd_class(SCR_CREATE_MONSTER, SCR_GIRLINESS) );
			(void) mongets(mtmp, rnd_class(SCR_CREATE_MONSTER, SCR_GIRLINESS) );
			(void) mongets(mtmp, rnd_class(SCR_CREATE_MONSTER, SCR_GIRLINESS) );
			(void) mongets(mtmp, rnd_class(SCR_CREATE_MONSTER, SCR_GIRLINESS) );
			(void) mongets(mtmp, rnd_class(SCR_CREATE_MONSTER, SCR_GIRLINESS) );
			(void)mongets(mtmp, DAGGER);
			(void)mongets(mtmp, SCR_CREATE_MONSTER);
			(void)mongets(mtmp, SCR_CREATE_MONSTER);
			 m_initthrow(mtmp, SHURIKEN, 25);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
			break;

		   case PM_DRAGONMASTER:
		   case PM_UNDEAD_DRAGONMASTER:
			(void)mongets(mtmp, BROADSWORD);
			(void)mongets(mtmp, SCALE_MAIL);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));

			break;

		   case PM_COMBATANT:
		   case PM_UNDEAD_COMBATANT:
			(void)mongets(mtmp, RING_MAIL);
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));

			break;

		   case PM_FJORDE:
		   case PM_UNDEAD_FJORDE:
			(void)mongets(mtmp, rn2(2) ? FISHING_POLE : GRAPPLING_HOOK);
			(void)mongets(mtmp, STUDDED_LEATHER_ARMOR);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

			break;

		   case PM_PRACTICANT:
		   case PM_UNDEAD_PRACTICANT:
			(void)mongets(mtmp, STEEL_CAPPED_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, BLACK_DRESS);
			(void)mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

			break;

		   case PM_EMERA:
		   case PM_UNDEAD_EMERA:
			(void)mongets(mtmp, SLING);
			 m_initthrow(mtmp, FLINT, 50);
			(void)mongets(mtmp, RAZOR_WHIP);
			(void)mongets(mtmp, FUTON_SWATTER);
			(void)mongets(mtmp, BUNNY_UNIFORM);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));

			break;

		   case PM_TOSSER:
		   case PM_UNDEAD_TOSSER:
			 m_initthrow(mtmp, JAVELIN, 10);
			(void)mongets(mtmp, WAR_HAMMER);
			(void)mongets(mtmp, RING_MAIL);
			(void)mongets(mtmp, LOW_BOOTS);
			(void)mongets(mtmp, PAPER_SHIELD);
			(void)mongets(mtmp, LEATHER_CLOAK);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

			break;

		   case PM_AKLYST:
		   case PM_UNDEAD_AKLYST:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
			(void)mongets(mtmp, AKLYS);
			(void)mongets(mtmp, AKLYS);
			(void)mongets(mtmp, BLOW_AKLYS);
			(void)mongets(mtmp, LEATHER_ARMOR);
			(void)mongets(mtmp, ELVEN_HELM);
			(void)mongets(mtmp, LEATHER_SHOES);

			break;

		   case PM_MILL_SWALLOWER:
		   case PM_UNDEAD_MILL_SWALLOWER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
			(void)mongets(mtmp, AXE);
			(void)mongets(mtmp, CROSSBOW);
			 m_initthrow(mtmp, MINERAL_BOLT, 40);
			(void)mongets(mtmp, CHAIN_MAIL);
			(void)mongets(mtmp, DWARVISH_IRON_HELM);
			(void)mongets(mtmp, ROCKET_GAUNTLETS);

			break;

		   case PM_SYMBIANT:
		   case PM_UNDEAD_SYMBIANT:
			(void)mongets(mtmp, MACE);
			(void)mongets(mtmp, DRAGON_HORNED_HEADPIECE);
			if (timebasedlowerchance()) (void)mongets(mtmp, SYMBIOTE);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

			break;

		   case PM_GENDERSTARIST:
		   case PM_UNDEAD_GENDERSTARIST:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
			if (!rn2(10)) (void)mongets(mtmp, WAN_POLYMORPH);

			break;

		   case PM_BUTT_LOVER:
		   case PM_UNDEAD_BUTT_LOVER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));

			break;

		   case PM_DANCER:
		   case PM_UNDEAD_DANCER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
			(void) mongets(mtmp, DANCING_SHOES);

			break;

		   case PM_DIABLIST:
		   case PM_UNDEAD_DIABLIST:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
			(void) mongets(mtmp, !rn2(3) ? QATAR : !rn2(2) ? EAGLE_BALL : GRINDER);
			(void) mongets(mtmp, LEATHER_ARMOR);
			(void) mongets(mtmp, POT_HEALING);

			break;

		   case PM_PREVERSIONER:
		   case PM_UNDEAD_PREVERSIONER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
			(void) mongets(mtmp, DAGGER);

			break;

		   case PM_SECRET_ADVICE_MEMBER:
		   case PM_UNDEAD_SECRET_ADVICE_MEMBER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
			if (!rn2(100)) (void) mongets(mtmp, WAN_BANISHMENT);
			(void) mongets(mtmp, (monster_difficulty() < 9) ? SUBMACHINE_GUN : ASSAULT_RIFLE);
			 m_initthrow(mtmp, SMG_BULLET, 50);
			 m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);

			break;

		   case PM_SHOE_FETISHIST:
		   case PM_UNDEAD_SHOE_FETISHIST:
			(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

			break;

		   case PM_COURIER:
		   case PM_UNDEAD_COURIER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, PISTOL);
			 m_initthrow(mtmp, PISTOL_BULLET, 25);
		     (void)mongets(mtmp, KNIFE);

		   break;

		   case PM_ZYBORG:
		   case PM_UNDEAD_ZYBORG:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, PLATE_MAIL);
		     (void)mongets(mtmp, GREEN_LIGHTSABER);
		     (void)mongets(mtmp, WAN_SOLAR_BEAM);

		   break;

		   case PM_LUNATIC:
		   case PM_UNDEAD_LUNATIC:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, STEEL_SHIELD);
		     (void)mongets(mtmp, STEEL_WHIP);

		   break;

		   case PM_GANGSTER:
		   case PM_UNDEAD_GANGSTER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     (void)mongets(mtmp, SUBMACHINE_GUN);
			 m_initthrow(mtmp, SMG_BULLET, 50);
			 m_initthrow(mtmp, SMG_BULLET, 50);
		     (void)mongets(mtmp, LEATHER_JACKET);

		   break;

		   case PM_GUNNER:
		   case PM_UNDEAD_GUNNER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     (void)mongets(mtmp, (monster_difficulty() < 9) ? SUBMACHINE_GUN : ASSAULT_RIFLE);
		     if (!rn2(5)) (void)mongets(mtmp, SNIPER_RIFLE);
			 m_initthrow(mtmp, SNIPER_BULLET, 10);
			 m_initthrow(mtmp, SMG_BULLET, 25);
			 m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 35);
		     (void)mongets(mtmp, LEATHER_JACKET);

		   break;

		   case PM_DOOM_MARINE:
		   case PM_UNDEAD_DOOM_MARINE:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     (void)mongets(mtmp, (monster_difficulty() < 9) ? SUBMACHINE_GUN : ASSAULT_RIFLE);
			 m_initthrow(mtmp, SMG_BULLET, 25);
			 m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 25);
		     (void)mongets(mtmp, (monster_difficulty() < 15) ? HAND_BLASTER : ARM_BLASTER);
			 m_initthrow(mtmp, BLASTER_BOLT, 50);
			 m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		     (void)mongets(mtmp, CHAIN_MAIL);
		     (void)mongets(mtmp, HELMET);
		     (void)mongets(mtmp, LEATHER_GLOVES);
		     (void)mongets(mtmp, IRON_SHOES);
			if (!rn2(100)) {
		     (void)mongets(mtmp, BFG);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
			}

		   break;

		   case PM_WANDKEEPER:
		   case PM_UNDEAD_WANDKEEPER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, LAB_COAT);
		     (void)mongets(mtmp, KNIFE);
		     (void)mongets(mtmp, WAN_MAGIC_MISSILE);
		     if (!rn2(5)) (void)mongets(mtmp, WAN_FIRE);
		     if (!rn2(5)) (void)mongets(mtmp, WAN_STRIKING);
		     if (!rn2(5)) (void)mongets(mtmp, WAN_COLD);
		     if (!rn2(5)) (void)mongets(mtmp, WAN_LIGHTNING);
		     if (!rn2(5)) (void)mongets(mtmp, WAN_ACID);
		     if (!rn2(5)) (void)mongets(mtmp, WAN_SLEEP);
		     if (!rn2(25)) (void)mongets(mtmp, WAN_DEATH);
		     if (!rn2(10)) (void)mongets(mtmp, WAN_FIREBALL);
		     if (!rn2(5)) (void)mongets(mtmp, WAN_SOLAR_BEAM);
		     if (!rn2(5)) (void)mongets(mtmp, WAN_CREATE_MONSTER);
		     if (!rn2(5)) (void)mongets(mtmp, WAN_BAD_EFFECT);
		     if (!rn2(5)) (void)mongets(mtmp, WAN_FULL_HEALING);
		     if (!rn2(10)) (void)mongets(mtmp, WAN_DRAINING);
		     if (!rn2(50)) (void)mongets(mtmp, WAN_CANCELLATION);
		     if (!rn2(25)) (void)mongets(mtmp, WAN_POLYMORPH);
		     if (!rn2(5)) (void)mongets(mtmp, WAN_TELEPORTATION);
		     if (!rn2(1000)) (void)mongets(mtmp, WAN_BANISHMENT);
		     if (!rn2(50)) (void)mongets(mtmp, WAN_CREATE_HORDE);
		     if (!rn2(50)) (void)mongets(mtmp, WAN_CLONE_MONSTER);
		     if (!rn2(5)) (void)mongets(mtmp, WAN_DIGGING);
		     if (!rn2(15)) (void)mongets(mtmp, WAN_TRAP_CREATION);

		   break;

		   case PM_DEATH_EATER:
		   case PM_UNDEAD_DEATH_EATER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     (void)mongets(mtmp, QUARTERSTAFF);
		     (void)mongets(mtmp, SHOTGUN);
			 m_initthrow(mtmp, SHOTGUN_SHELL, 10);
		     (void)mongets(mtmp, CLOAK_OF_REFLECTION);
		     if (!rn2(10)) (void) mongets(mtmp, WAN_DEATH);
		     if (!rn2(10)) (void) mongets(mtmp, AMULET_OF_LIFE_SAVING);

		   break;

		   case PM_POKEMON:
		   case PM_UNDEAD_POKEMON:
		   case PM_MUSICIAN:
		   case PM_UNDEAD_MUSICIAN:
		   case PM_GRADUATE:
		   case PM_UNDEAD_GRADUATE:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		   break;

		   case PM_FORM_CHANGER:
		   case PM_UNDEAD_FORM_CHANGER:
		     (void)mongets(mtmp, WAN_POLYMORPH);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		   break;

		   case PM_TRACER:
		   case PM_UNDEAD_TRACER:
		     (void)mongets(mtmp, SHORT_SWORD);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));

		   break;

		   case PM_GANG_SCHOLAR:
		   case PM_UNDEAD_GANG_SCHOLAR:
		     (void)mongets(mtmp, DAGGER);
		     (void)mongets(mtmp, LEATHER_ARMOR);
		     (void)mongets(mtmp, WAN_MAGIC_MISSILE);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));

		   break;

		   case PM_FEMINIST:
		   case PM_UNDEAD_FEMINIST:
		     (void)mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		     (void)mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));

		   break;

		   case PM_NUCLEAR_PHYSICIST:
		   case PM_UNDEAD_NUCLEAR_PHYSICIST:
		     (void)mongets(mtmp, SPEAR);
		     (void)mongets(mtmp, POT_RADIUM);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));

		   break;

		   case PM_WARRIOR:
		   case PM_UNDEAD_WARRIOR:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     (void)mongets(mtmp, MACE);
		     (void)mongets(mtmp, CROSSBOW);
			 m_initthrow(mtmp, CROSSBOW_BOLT, 50);
			 m_initthrow(mtmp, CROSSBOW_BOLT, 20);
		     (void)mongets(mtmp, LARGE_SHIELD);

			(void) mongets(mtmp, rnd_class(PLATE_MAIL,YELLOW_DRAGON_SCALES));

		   break;

		   case PM_NOBLEMAN:
		   case PM_UNDEAD_NOBLEMAN:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, RAPIER);
		     (void)mongets(mtmp, RUFFLED_SHIRT);
		     (void)mongets(mtmp, LEATHER_GLOVES);
		     (void)mongets(mtmp, LEATHER_CLOAK);

		   break;

		   case PM_NOBLEWOMAN:
		   case PM_UNDEAD_NOBLEWOMAN:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, RAPIER);
		     (void)mongets(mtmp, VICTORIAN_UNDERWEAR);
		     (void)mongets(mtmp, LEATHER_GLOVES);
		     (void)mongets(mtmp, LEATHER_CLOAK);

		   break;

		   case PM_DRUNK:
		   case PM_UNDEAD_DRUNK:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, RUBBER_HOSE);

		   break;

		   case PM_PIRATE:
		   case PM_UNDEAD_PIRATE:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     (void)mongets(mtmp, SCIMITAR);
		     (void)mongets(mtmp, PISTOL);
		     (void)mongets(mtmp, KNIFE);
			 m_initthrow(mtmp, PISTOL_BULLET, 50);
			 m_initthrow(mtmp, PISTOL_BULLET, 50);
		     (void)mongets(mtmp, LEATHER_JACKET);
		     (void)mongets(mtmp, HIGH_BOOTS);

		   break;

		   case PM_OFFICER:
		   case PM_UNDEAD_OFFICER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     (void)mongets(mtmp, CLUB);
		     (void)mongets(mtmp, PISTOL);
			 m_initthrow(mtmp, PISTOL_BULLET, 50);
			 m_initthrow(mtmp, PISTOL_BULLET, 50);
		     (void)mongets(mtmp, LEATHER_ARMOR);
		     (void)mongets(mtmp, rn2(2) ? WAN_STRIKING : WAN_MAGIC_MISSILE);

		   break;

		   case PM_GLADIATOR:
		   case PM_UNDEAD_GLADIATOR:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     (void)mongets(mtmp, SILVER_SPEAR);
		     (void)mongets(mtmp, SHIELD_OF_REFLECTION);

		   break;

		   case PM_GOFF:
		   case PM_UNDEAD_GOFF:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     (void)mongets(mtmp, QUARTERSTAFF);
		     (void)mongets(mtmp, HIPPIE_HEELS);
		     (void)mongets(mtmp, PISTOL);
			 m_initthrow(mtmp, PISTOL_BULLET, 50);
		     (void)mongets(mtmp, POT_ACID);
		     (void)mongets(mtmp, POT_ACID);

		   break;

		   case PM_AMAZON:
		   case PM_UNDEAD_AMAZON:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     (void)mongets(mtmp, JAVELIN);
		     (void)mongets(mtmp, LEATHER_ARMOR);
		     (void)mongets(mtmp, BOW);
			 m_initthrow(mtmp, ARROW, 50);

		   break;

		   case PM_DRUID:
		   case PM_UNDEAD_DRUID:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     (void)mongets(mtmp, CLUB);
		     (void)mongets(mtmp, LEATHER_ARMOR);
		     (void)mongets(mtmp, BOW);
			 m_initthrow(mtmp, ARROW, 50);

		   break;

		   case PM_ALTMER:
		   case PM_UNDEAD_ALTMER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     (void)mongets(mtmp, QUARTERSTAFF);
		     (void)mongets(mtmp, WAN_FIRE);

		   break;

		   case PM_BOSMER:
		   case PM_UNDEAD_BOSMER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     (void)mongets(mtmp, ELVEN_DAGGER);
		     (void)mongets(mtmp, ELVEN_BOW);
			 m_initthrow(mtmp, ELVEN_ARROW, 50);

		   break;

		   case PM_DUNMER:
		   case PM_UNDEAD_DUNMER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     (void)mongets(mtmp, DARK_ELVEN_DAGGER);
		     (void)mongets(mtmp, DARK_ELVEN_BOW);
			 m_initthrow(mtmp, DARK_ELVEN_ARROW, 50);

		   break;

		   case PM_THALMOR:
		   case PM_UNDEAD_THALMOR:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     (void)mongets(mtmp, ELVEN_BROADSWORD);
		     (void)mongets(mtmp, ELVEN_MITHRIL_COAT);
		     (void)mongets(mtmp, DARK_ELVEN_BOW);
			 m_initthrow(mtmp, DARK_ELVEN_ARROW, 50);

		   break;

		   case PM_ORDINATOR:
		   case PM_UNDEAD_ORDINATOR:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     (void)mongets(mtmp, TSURUGI);
		     (void)mongets(mtmp, RUNESWORD);
		     (void)mongets(mtmp, DARK_ELVEN_MITHRIL_COAT);

		   break;

		   case PM_KORSAIR:
		   case PM_UNDEAD_KORSAIR:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     (void)mongets(mtmp, DAGGER);
		     (void)mongets(mtmp, SCIMITAR);

		   break;

		   case PM_DIVER:
		   case PM_UNDEAD_DIVER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, KNIFE);
		     (void)mongets(mtmp, TRIDENT);
		     (void)mongets(mtmp, SPEAR);
		     (void)mongets(mtmp, OILSKIN_CLOAK);

		   break;

		   case PM_CHEVALIER:
		   case PM_UNDEAD_CHEVALIER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     (void)mongets(mtmp, TRIDENT);
		     (void)mongets(mtmp, ROBE);
		     (void)mongets(mtmp, SMALL_SHIELD);

		   break;

		   case PM_PROSTITUTE:
		   case PM_UNDEAD_PROSTITUTE:
		   case PM_KURWA:
		   case PM_UNDEAD_KURWA:

		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, INKA_SHACKLE);
		     (void)mongets(mtmp, PISTOL);
		     (void)mongets(mtmp, KNIFE);
			 m_initthrow(mtmp, PISTOL_BULLET, 50);
			(void) mongets(mtmp, rnd_class(WEDGE_SANDALS,COMBAT_STILETTOS));

		   break;

		   case PM_TRANSVESTITE:
		   case PM_UNDEAD_TRANSVESTITE:
		   case PM_TRANSSYLVANIAN:
		   case PM_UNDEAD_TRANSSYLVANIAN:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

			(void) mongets(mtmp, rnd_class(WEDGED_LITTLE_GIRL_SANDAL,SPIKED_BATTLE_BOOT));
			(void) mongets(mtmp, rnd_class(WEDGE_SANDALS,COMBAT_STILETTOS));

		   break;

		   case PM_TOPMODEL:
		   case PM_UNDEAD_TOPMODEL:
		   case PM_FAILED_EXISTENCE:
		   case PM_UNDEAD_FAILED_EXISTENCE:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, KNIFE);
		     (void)mongets(mtmp, RIFLE);
			 m_initthrow(mtmp, RIFLE_BULLET, 50);
			(void) mongets(mtmp, rnd_class(WEDGE_SANDALS,COMBAT_STILETTOS));

		   break;

		   case PM_ACTIVISTOR:
		   case PM_UNDEAD_ACTIVISTOR:

			if (moves < 2) mtmp->female = 1;

			if (mtmp->female) (void)mongets(mtmp, VICTORIAN_UNDERWEAR);
			else (void)mongets(mtmp, RUFFLED_SHIRT);

		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, FLY_SWATTER);

		   break;

		   case PM_UNBELIEVER:
		   case PM_UNDEAD_UNBELIEVER:

			(void)mongets(mtmp, BLACK_AESTIVALIS);
			(void)mongets(mtmp, CHAIN_MAIL);

		   break;

		   case PM_ELECTRIC_MAGE:
		   case PM_UNDEAD_ELECTRIC_MAGE:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, QUARTERSTAFF);
		     (void)mongets(mtmp, STUDDED_LEATHER_ARMOR);
		     (void)mongets(mtmp, WAN_LIGHTNING);
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 15);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 15));
#endif
		   break;

		   case PM_OCCULT_MASTER:
		   case PM_UNDEAD_OCCULT_MASTER:
			(void) mongets(mtmp, COLLUSION_KNIFE);
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
			if (!rn2(10)) (void) mongets(mtmp, WAN_TIDAL_WAVE);
			if (!rn2(10)) (void) mongets(mtmp, WAN_INERTIA);
			if (!rn2(10)) (void) mongets(mtmp, WAN_TIME);

		   break;

		   case PM_ELEMENTALIST:
		   case PM_UNDEAD_ELEMENTALIST:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
			if (!rn2(5)) (void) mongets(mtmp, WAN_FIRE);
			if (!rn2(5)) (void) mongets(mtmp, WAN_COLD);
			if (!rn2(5)) (void) mongets(mtmp, WAN_LIGHTNING);
			if (!rn2(5)) (void) mongets(mtmp, WAN_POISON);
			if (!rn2(50)) (void) mongets(mtmp, WAN_CHROMATIC_BEAM);
			(void) mongets(mtmp, FIRE_STICK);

		   break;

		   case PM_CHAOS_SORCEROR:
		   case PM_UNDEAD_CHAOS_SORCEROR:

		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
			(void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM));
			(void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM));
			(void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM));
			(void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM));
			(void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));

		   break;

		   case PM_WILD_TALENT:
		   case PM_UNDEAD_WILD_TALENT:

		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));

		   break;

		   case PM_POISON_MAGE:
		   case PM_UNDEAD_POISON_MAGE:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, SILVER_KHAKKHARA);
		     (void)mongets(mtmp, POISONOUS_CLOAK);
		     (void)mongets(mtmp, WAN_POISON);
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 15);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 15));
#endif
		   break;

		   case PM_HEALER:
		   case PM_UNDEAD_HEALER:
		   case PM_SCIENTIST:
		   case PM_UNDEAD_SCIENTIST:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, SCALPEL);
		     (void)mongets(mtmp, LEATHER_GLOVES);
		     (void)mongets(mtmp, WAN_HEALING);
		     (void)mongets(mtmp, WAN_SLEEP);
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 20);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 20));
#endif
		   break;
		   case PM_ICE_MAGE:
		   case PM_UNDEAD_ICE_MAGE:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, QUARTERSTAFF);
		     (void)mongets(mtmp, STUDDED_LEATHER_ARMOR);
		     (void)mongets(mtmp, WAN_COLD);
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 15);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 15));
#endif
		   break;
		   case PM_YEOMAN:
		   case PM_UNDEAD_YEOMAN:
		   case PM_KNIGHT:
		   case PM_UNDEAD_KNIGHT:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, LONG_SWORD);
		     (void)mongets(mtmp, PLATE_MAIL);
		     (void)mongets(mtmp, LARGE_SHIELD);
		     (void)mongets(mtmp, HELMET);
		     (void)mongets(mtmp, LEATHER_GLOVES);
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 15);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 15));
#endif
		     break;

		   case PM_PALADIN:
		   case PM_UNDEAD_PALADIN:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, LONG_SWORD);
		     (void)mongets(mtmp, PLATE_MAIL);
		     (void)mongets(mtmp, LARGE_SHIELD);
		     (void)mongets(mtmp, HELMET);
		     (void)mongets(mtmp, LEATHER_GLOVES);
		     (void)mongets(mtmp, LOW_BOOTS);
		     break;

		   case PM_MONK:
		   case PM_UNDEAD_MONK:
		   case PM_HALF_BAKED:
		   case PM_UNDEAD_HALF_BAKED:
		   case PM_SAIYAN:
		   case PM_UNDEAD_SAIYAN:
		   case PM_PSION:
		   case PM_UNDEAD_PSION:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));


#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 5);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 5));
#endif
		   break;
		   case PM_NECROMANCER:
		   case PM_UNDEAD_NECROMANCER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));

		     (void)mongets(mtmp, ATHAME);
		     (void)mongets(mtmp, SCR_SUMMON_UNDEAD);
		     if (!rn2(10)) (void)mongets(mtmp, WAN_SUMMON_UNDEAD);
		     if (!rn2(4)) (void)mongets(mtmp, PICK_AXE);
		     (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     (void) mongets(mtmp, rnd_defensive_item(mtmp));
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 15);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 15));
#endif
		   break;

		   case PM_JESTER:
		   case PM_UNDEAD_JESTER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, HAWAIIAN_SHIRT);
		     (void)mongets(mtmp, DUNCE_CAP);
		     (void)mongets(mtmp, LEATHER_GLOVES);
		     (void)mongets(mtmp, DAGGER);
		     (void)mongets(mtmp, RUBBER_HOSE);

			break;

		   case PM_FEAT_MASTER:
		   case PM_UNDEAD_FEAT_MASTER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, FLAIL);
		     (void)mongets(mtmp, ORCISH_HELM);
		     (void)mongets(mtmp, LEATHER_JACKET);
		     (void)mongets(mtmp, POT_HEALING);

			break;

		   case PM_FOXHOUND_AGENT:
		   case PM_UNDEAD_FOXHOUND_AGENT:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, FEDORA);
		     (void)mongets(mtmp, ELVEN_CLOAK);
		     (void)mongets(mtmp, LEATHER_GLOVES);
		     (void)mongets(mtmp, KNIFE);
		     if (!rn2(6)) (void)mongets(mtmp, KICKING_BOOTS);

			break;

		   case PM_PRIEST:
		   case PM_PRIESTESS:
		   case PM_UNDEAD_PRIEST:
		   case PM_UNDEAD_PRIESTESS:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, MACE);
		     (void)mongets(mtmp, rnd_class(ROBE,ROBE_OF_WEAKNESS));
		     (void)mongets(mtmp, SMALL_SHIELD);
		     if (!rn2(4) && timebasedlowerchance()) {
			int v,vials;
			vials = rn2(4)+1;
			for (v=0;v<vials;v++) {
			  otmp = mksobj(POT_WATER, FALSE, FALSE, FALSE);
			  if (otmp) {
				  bless(otmp);
				  mpickobj(mtmp, otmp, TRUE);
			  }
			}
		     }
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 15);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 15));
#endif
		   break;
		   case PM_ROGUE:
		   case PM_UNDEAD_ROGUE:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, SHORT_SWORD);
		     (void)mongets(mtmp, LEATHER_ARMOR);
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 25);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 25));
#endif
		   break;

		   case PM_ASSASSIN:
		   case PM_UNDEAD_ASSASSIN:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, DAGGER);
		     (void)mongets(mtmp, BOW);
			    m_initthrow(mtmp, ARROW, 25);
			    m_initthrow(mtmp, ARROW, 25);
		     (void)mongets(mtmp, LEATHER_ARMOR);
		     (void)mongets(mtmp, LEATHER_CLOAK);
		   break;

		   case PM_LOCKSMITH:
		   case PM_UNDEAD_LOCKSMITH:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		   break;

		   case PM_DQ_SLIME:
		   case PM_UNDEAD_DQ_SLIME:
		   case PM_ERDRICK:
		   case PM_UNDEAD_ERDRICK:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, BATTLE_STAFF);
		     (void)mongets(mtmp, LEATHER_ARMOR);
		     (void)mongets(mtmp, HELMET);

		   break;

		   case PM_BULLY:
		   case PM_UNDEAD_BULLY:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, KNIFE);
		     (void)mongets(mtmp, CLUB);
		     (void)mongets(mtmp, DUNCE_CAP);
		     (void)mongets(mtmp, T_SHIRT);

		   break;

		   case PM_PICKPOCKET:
		   case PM_UNDEAD_PICKPOCKET:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, KNIFE);
		     (void)mongets(mtmp, DAGGER);
		     (void)mongets(mtmp, LEATHER_GLOVES);
		     (void)mongets(mtmp, CLOAK_OF_DISPLACEMENT);

		   break;

		   case PM_RANGER:
		   case PM_ELPH:
		   case PM_UNDEAD_RANGER:
		   case PM_UNDEAD_ELPH:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     (void)mongets(mtmp, ELVEN_DAGGER);
		     (void)mongets(mtmp, ELVEN_BOW);
			    m_initthrow(mtmp, ELVEN_ARROW, 40);

		   break;

		   case PM_TWELPH:
		   case PM_UNDEAD_TWELPH:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     (void)mongets(mtmp, DARK_ELVEN_DAGGER);
		     (void)mongets(mtmp, DARK_ELVEN_BOW);
			    m_initthrow(mtmp, DARK_ELVEN_ARROW, 40);

		   break;

		   case PM_GOLDMINER:
		   case PM_UNDEAD_GOLDMINER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     (void)mongets(mtmp, PICK_AXE);
		     (void)mongets(mtmp, CROSSBOW);
			    m_initthrow(mtmp, CROSSBOW_BOLT, 50);
			    m_initthrow(mtmp, CROSSBOW_BOLT, 20);

		   break;

		   case PM_MIDGET:
		   case PM_UNDEAD_MIDGET:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     (void)mongets(mtmp, DWARVISH_MATTOCK);
		     (void)mongets(mtmp, DWARVISH_IRON_HELM);
		     (void)mongets(mtmp, DWARVISH_MITHRIL_COAT);

		   break;

		   case PM_RINGSEEKER:
		   case PM_UNDEAD_RINGSEEKER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     (void)mongets(mtmp, SLING);
		     (void)mongets(mtmp, LEATHER_ARMOR);
			    m_initthrow(mtmp, ROCK, 25);
			    m_initthrow(mtmp, ROCK, 25);

		   break;

		   case PM_SHAPESHIFTER:
		   case PM_UNDEAD_SHAPESHIFTER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, WAN_POLYMORPH);

		   break;

		   case PM_NINJA:
		   case PM_UNDEAD_NINJA:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     (void)mongets(mtmp, SHORT_SWORD);
		     (void)mongets(mtmp, POT_INVISIBILITY);
			m_initthrow(mtmp, SHURIKEN, 40);
		   break;

		   case PM_SAMURAI:
		   case PM_UNDEAD_SAMURAI:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     (void)mongets(mtmp, KATANA);
		     if (rn2(2)) (void)mongets(mtmp, SHORT_SWORD);
		     if (rn2(3)) {
			(void)mongets(mtmp, YUMI);
			m_initthrow(mtmp, YA, 40);
		     }
		     (void)mongets(mtmp, SPLINT_MAIL);
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 15);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 15));
#endif
		   break;

		   case PM_OTAKU:
		   case PM_UNDEAD_OTAKU:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     (void)mongets(mtmp, KATANA);
		     (void)mongets(mtmp, T_SHIRT);
		   break;

		   case PM_LIBRARIAN:
		   case PM_UNDEAD_LIBRARIAN:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, ROBE);

		   break;

		   case PM_FIGHTER:
		   case PM_UNDEAD_FIGHTER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, SHORT_SWORD);
		     (void)mongets(mtmp, SAILOR_BLOUSE);
		     (void)mongets(mtmp, WAN_POLYMORPH);

		   break;

		   case PM_FENCER:
		   case PM_UNDEAD_FENCER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     (void)mongets(mtmp, SHORT_SWORD);
		     (void)mongets(mtmp, DAGGER);
		     (void)mongets(mtmp, LEATHER_ARMOR);

		   break;

		   case PM_MEDIUM:
		   case PM_UNDEAD_MEDIUM:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, SILVER_DAGGER);
		     (void)mongets(mtmp, YUMI);
		     (void)mongets(mtmp, ROBE);
		     m_initthrow(mtmp, YA, 50);

		   break;

		   case PM_JUSTICE_KEEPER:
		   case PM_UNDEAD_JUSTICE_KEEPER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     (void)mongets(mtmp, MACE);
		     (void)mongets(mtmp, SPLINT_MAIL);

		   break;

		   case PM_STAND_USER:
		   case PM_UNDEAD_STAND_USER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		   break;

		   case PM_SEXYMATE:
		   case PM_UNDEAD_SEXYMATE:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		     (void)mongets(mtmp, SEXY_LEATHER_PUMP);

		   break;

		   case PM_LADIESMAN:
		   case PM_UNDEAD_LADIESMAN:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, KNIFE);
		     (void)mongets(mtmp, RUFFLED_SHIRT);
		     (void)mongets(mtmp, FEDORA);

		   break;

		   case PM_SUPERMARKET_CASHIER:
		   case PM_UNDEAD_SUPERMARKET_CASHIER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, LEATHER_JACKET);
		     (void)mongets(mtmp, KNIFE);
		     (void)mongets(mtmp, LOW_BOOTS);

		   break;

		   case PM_BLOODSEEKER:
		   case PM_UNDEAD_BLOODSEEKER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, SHORT_SWORD);
		     (void)mongets(mtmp, WAN_FIRE);
		     (void)mongets(mtmp, COMBAT_STILETTOS);

		   break;

		   case PM_SLAVE_MASTER:
		   case PM_UNDEAD_SLAVE_MASTER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		   break;

		   case PM_MYSTIC:
		   case PM_UNDEAD_MYSTIC:
			(void) mongets(mtmp, rnd_offensive_item(mtmp));
			(void) mongets(mtmp, rnd_offensive_item(mtmp));
			(void) mongets(mtmp, rnd_defensive_item(mtmp));
			(void) mongets(mtmp, rnd_defensive_item(mtmp));
			(void) mongets(mtmp, rnd_misc_item(mtmp));
			(void) mongets(mtmp, rnd_misc_item(mtmp));
			(void) mongets(mtmp, rnd_offensive_item_new(mtmp));
			(void) mongets(mtmp, rnd_offensive_item_new(mtmp));
			(void) mongets(mtmp, rnd_defensive_item_new(mtmp));
			(void) mongets(mtmp, rnd_defensive_item_new(mtmp));
			(void) mongets(mtmp, rnd_misc_item_new(mtmp));
			(void) mongets(mtmp, rnd_misc_item_new(mtmp));

		   break;

		   case PM_COOK:
		   case PM_UNDEAD_COOK:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     (void)mongets(mtmp, ROBE);
		     (void)mongets(mtmp, KNIFE);

		   break;

		   case PM_TOURIST:
		   case PM_UNDEAD_TOURIST:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     m_initthrow(mtmp, DART, 40);
		     (void)mongets(mtmp, HAWAIIAN_SHIRT);
		     if (rn2(2) && timebasedlowerchance()) (void)mongets(mtmp, EXPENSIVE_CAMERA);
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 20);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 20));
#endif
		   break;
		   case PM_UNDEAD_SLAYER:
		   case PM_NON_UNDEAD_SLAYER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, SILVER_SPEAR);
		     (void)mongets(mtmp, CHAIN_MAIL);
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 15);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 15));
#endif
		   break;

		   case PM_AUGURER:
		   case PM_UNDEAD_AUGURER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     (void)mongets(mtmp, LEATHER_ARMOR);

		   break;

		   case PM_POLITICIAN:
		   case PM_UNDEAD_POLITICIAN:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     (void)mongets(mtmp, LEATHER_JACKET);
		     (void)mongets(mtmp, T_SHIRT);
		     (void)mongets(mtmp, LOW_BOOTS);

		   break;

		   case PM_INTEL_SCRIBE:
		   case PM_UNDEAD_INTEL_SCRIBE:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, DAGGER);
		     if (!rn2(3)) (void)mongets(mtmp, CLOAK_OF_DISPLACEMENT);
		   break;

		   case PM_MAHOU_SHOUJO:
		   case PM_UNDEAD_MAHOU_SHOUJO:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, WAN_STRIKING);
		     if (!rn2(100)) (void)mongets(mtmp, WAN_BANISHMENT);
		     if (!rn2(2)) (void)mongets(mtmp, POT_PARALYSIS);
		     if (!rn2(2)) (void)mongets(mtmp, POT_CYANIDE);
		   break;

		   case PM_DOLL_MISTRESS:
		   case PM_UNDEAD_DOLL_MISTRESS:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, WORM_TOOTH);
		     (void)mongets(mtmp, DWARVISH_CLOAK);
		     (void)mongets(mtmp, VICTORIAN_UNDERWEAR);
		   break;

		   case PM_CRUEL_ABUSER:
		   case PM_UNDEAD_CRUEL_ABUSER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, BULLWHIP);
		     (void)mongets(mtmp, KNOUT);
		     (void)mongets(mtmp, IRON_CHAIN);
		     (void)mongets(mtmp, VICTORIAN_UNDERWEAR);
		     (void)mongets(mtmp, LEATHER_JACKET);
		     if (!rn2(6)) (void)mongets(mtmp, KICKING_BOOTS);
		   break;

		   case PM_UNDERTAKER:
		   case PM_UNDEAD_UNDERTAKER:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, SCALPEL);
		     (void)mongets(mtmp, VICTORIAN_UNDERWEAR);
		   break;

		   case PM_VALKYRIE:
		   case PM_UNDEAD_VALKYRIE:
		   case PM_VANILLA_VALK:
		   case PM_UNDEAD_VANILLA_VALK:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));

		     (void)mongets(mtmp, LONG_SWORD);
		     if (!rn2(3)) m_initthrow(mtmp, DAGGER, 4);
		     (void)mongets(mtmp, SMALL_SHIELD);
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 15);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 15));
#endif
		   break;

		   case PM_SAGE:
		   case PM_UNDEAD_SAGE:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, MACE);
		     (void)mongets(mtmp, ROBE);
		     (void)mongets(mtmp, POT_HEALING);
		     (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(100)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		   break;

		   case PM_WIZARD:
		   case PM_UNDEAD_WIZARD:
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(50)) (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(400)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));

		     (void)mongets(mtmp, ATHAME);
		     (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     (void) mongets(mtmp, rnd_offensive_item(mtmp));
		     (void) mongets(mtmp, rnd_defensive_item(mtmp));
		     if (!rn2(100)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(100)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(100)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
#ifndef GOLDOBJ
		     mtmp->mgold = (long) d(mtmp->m_lev, 15);
#else
		     mkmonmoney(mtmp, (long) d(mtmp->m_lev, 15));
#endif
		   break;
		   default:
		   break;
		  } 
		  if ((int) mtmp->m_lev > rn2(120))
		     (void) mongets(mtmp, rnd_offensive_item(mtmp));
		  if (!rn2(200))
		     (void) mongets(mtmp, rnd_offensive_item(mtmp));
		  if ((int) mtmp->m_lev > rn2(120))
		     (void) mongets(mtmp, rnd_defensive_item(mtmp));
		  if (!rn2(200))
		     (void) mongets(mtmp, rnd_defensive_item(mtmp));
		  if ((int) mtmp->m_lev > rn2(120))
		     (void) mongets(mtmp, rnd_misc_item(mtmp));
		  if (!rn2(200))
		     (void) mongets(mtmp, rnd_misc_item(mtmp));
		     if (!rn2(1000)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(1000)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(1000)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		     if (!rn2(1000)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(1000)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
		     if (!rn2(1000)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		 } /* end of other characters */
	       /*break;*/
		else if (ptr->msound == MS_PRIEST ||
			quest_mon_represents_role(ptr,PM_PRIEST)) {

		    otmp = mksobj(MACE, FALSE, FALSE, FALSE);
		    if(otmp) {
			otmp->spe = rnd(3);
			if(!rn2(2)) curse(otmp);
			(void) mpickobj(mtmp, otmp, TRUE);
		    }

		} else if (mm == PM_PIRATE_BROTHER){
			(void)mongets(mtmp, SCIMITAR);
			(void)mongets(mtmp, LEATHER_ARMOR);
			(void)mongets(mtmp, HIGH_BOOTS);

		} else if (mm == PM_SIZZLE){
		    otmp = mksobj(LONG_SWORD, FALSE, FALSE, FALSE);
		    if (otmp) {
			int spe2;
			otmp = oname(otmp, artiname(ART_VORPAL_BLADE));
			bless(otmp);
			otmp->oerodeproof = TRUE;
			spe2 = rn2(4);
			otmp->spe = max(otmp->spe, spe2);
			(void) mpickobj(mtmp, otmp, TRUE);
		    }

		} else if (mm == PM_KATNISS){

			(void)mongets(mtmp, ELVEN_SPEAR);

		} else if (mm == PM_ARABELLA){

			(void)mongets(mtmp, HUGGING_BOOT);
			(void)mongets(mtmp, SPEED_BOOTS);
			if (!Role_if(PM_SHOE_FETISHIST)) (void)mongets(mtmp, WAN_BANISHMENT);

		} else if (mm == PM_ANASTASIA){

			(void)mongets(mtmp, SOFT_GIRL_SNEAKER);
			(void)mongets(mtmp, DANCING_SHOES);

		} else if (mm == PM_HENRIETTA){

			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			(void)mongets(mtmp, PLASTEEL_BOOTS);

		} else if (mm == PM_KATRIN){

			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		} else if (mm == PM_JANA){

			(void)mongets(mtmp, SOFT_GIRL_SNEAKER);
			(void)mongets(mtmp, ELVEN_BOOTS);

		} else if (mm == PM_THE_CHAMPION_OF_POMPEJI){

			(void)mongets(mtmp, STYGIAN_PIKE);
			(void)mongets(mtmp, STONE_DRAGON_SCALE_MAIL);

		} else if (mm == PM_DEATH_METAL_FREAK){
			if (rn2(2)) (void)mongets(mtmp, rn2(2) ? FIRE_HORN : FROST_HORN);
			(void)mongets(mtmp, SCR_LOCKOUT);
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));

		} else if (mm == PM_FREAKY_GIRL){
			if (rn2(2)) (void)mongets(mtmp, rn2(2) ? FIRE_HORN : FROST_HORN);
			(void)mongets(mtmp, SCR_LOCKOUT);
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));

		} else if (mm == PM_ACTIVIST){

			if (mtmp->female) (void)mongets(mtmp, VICTORIAN_UNDERWEAR);
			else (void)mongets(mtmp, RUFFLED_SHIRT);
			(void)mongets(mtmp, rnd_class(SCR_LAVA,SCR_LOCKOUT));

		} else if (mm == PM_HELEN_WANNABE){

			if (mtmp->female) (void)mongets(mtmp, VICTORIAN_UNDERWEAR);
			else (void)mongets(mtmp, RUFFLED_SHIRT);
			(void)mongets(mtmp, rnd_class(SCR_LAVA,SCR_LOCKOUT));

		} else if (mm == PM_ACTIVIST_LEADER || mm == PM_HELEN_THE_ACTIVIST_LEADER){

			if (mtmp->female) (void)mongets(mtmp, VICTORIAN_UNDERWEAR);
			else (void)mongets(mtmp, RUFFLED_SHIRT);
			(void)mongets(mtmp, rnd_class(SCR_LAVA,SCR_LOCKOUT));
			(void)mongets(mtmp, rnd_class(SCR_LAVA,SCR_LOCKOUT));
			(void)mongets(mtmp, rnd_class(SCR_LAVA,SCR_LOCKOUT));
			(void)mongets(mtmp, rnd_class(SCR_LAVA,SCR_LOCKOUT));
			(void)mongets(mtmp, rnd_class(SCR_LAVA,SCR_LOCKOUT));
			(void)mongets(mtmp, rnd_class(SCR_LAVA,SCR_LOCKOUT));
			(void)mongets(mtmp, rnd_class(SCR_LAVA,SCR_LOCKOUT));
			(void)mongets(mtmp, rnd_class(SCR_LAVA,SCR_LOCKOUT));
			(void)mongets(mtmp, rnd_class(SCR_LAVA,SCR_LOCKOUT));
			(void)mongets(mtmp, rnd_class(SCR_LAVA,SCR_LOCKOUT));
			(void)mongets(mtmp, rnd_class(SCR_LAVA,SCR_LOCKOUT));

		} else if (mm == PM_DEATH_METAL_DRUMMER){
			if (rn2(2)) (void)mongets(mtmp, rn2(2) ? FIRE_HORN : FROST_HORN);
			(void)mongets(mtmp, SCR_LOCKOUT);
		     (void)mongets(mtmp, SUBMACHINE_GUN);
			 m_initthrow(mtmp, SMG_BULLET, 50);
			 m_initthrow(mtmp, SMG_BULLET, 50);
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));

		} else if (mm == PM_WILD_WOMAN){
			if (rn2(2)) (void)mongets(mtmp, rn2(2) ? FIRE_HORN : FROST_HORN);
			(void)mongets(mtmp, SCR_LOCKOUT);
		     (void)mongets(mtmp, SUBMACHINE_GUN);
			 m_initthrow(mtmp, SMG_BULLET, 50);
			 m_initthrow(mtmp, SMG_BULLET, 50);
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));

		} else if (mm == PM_DEATH_METAL_ORCHESTRA_LEADER){
			if (rn2(2)) (void)mongets(mtmp, rn2(2) ? FIRE_HORN : FROST_HORN);
			(void)mongets(mtmp, SCR_LOCKOUT);
			(void)mongets(mtmp, SCR_LOCKOUT);
			(void)mongets(mtmp, SCR_LOCKOUT);
			(void)mongets(mtmp, SCR_LOCKOUT);
			(void)mongets(mtmp, SCR_LOCKOUT);
		     (void)mongets(mtmp, HEAVY_MACHINE_GUN);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));

		} else if (mm == PM_DRACO_THE_SHARPSHOOTER){
		     (void)mongets(mtmp, SNIPER_RIFLE);
			 m_initthrow(mtmp, SNIPER_BULLET, 50);
			 m_initthrow(mtmp, SNIPER_BULLET, 50);
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));

		} else if (mm == PM_GRANDPA_TANK_BREAKER){
		     (void)mongets(mtmp, ROCKET_LAUNCHER);
			 m_initthrow(mtmp, ROCKET, 10);
		     (void)mongets(mtmp, REALLY_HEAVY_IRON_BALL);
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));

		} else if (mm == PM_DANCING_GUY){
			(void)mongets(mtmp, DANCING_SHOES);

		} else if (mm == PM_DANCING_GIRL){
			(void)mongets(mtmp, DANCING_SHOES);

		} else if (mm == PM_SEXY_GIRL){
			(void)mongets(mtmp, DANCING_SHOES);

		} else if (mm == PM_DANCING_KING){
			(void)mongets(mtmp, LACQUERED_DANCING_SHOE);
			(void)mongets(mtmp, DANCING_SHOES);

		} else if (mm == PM_DANCING_QUEEN){
			(void)mongets(mtmp, LACQUERED_DANCING_SHOE);
			(void)mongets(mtmp, DANCING_SHOES);

		} else if (mm == PM_SEXY_LADY){
			(void)mongets(mtmp, LACQUERED_DANCING_SHOE);
			(void)mongets(mtmp, DANCING_SHOES);

		} else if (mm == PM_ASIAN_GIRL){
			(void)mongets(mtmp, HUGGING_BOOT);

		} else if (mm == PM_CHINESE_GIRL){
			(void)mongets(mtmp, HUGGING_BOOT);

		} else if (mm == PM_JAPANESE_GIRL){
			(void)mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */

		} else if (mm == PM_ANIME_GIRL){
			(void)mongets(mtmp, ATSUZOKO_BOOTS);

		} else if (mm == PM_KOREAN_GIRL){
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

		} else if (mm == PM_VIETNAMESE_GIRL){
			(void)mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */

		} else if (mm == PM_TURKISH_GIRL){
			(void)mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);

		} else if (mm == PM_PERSIAN_GIRL){
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);

		} else if (mm == PM_WUHANESE_GIRL){
			(void)mongets(mtmp, INKA_BOOT);

		} else if (mm == PM_TENDER_ASIAN_GIRL){
			(void)mongets(mtmp, HUGGING_BOOT);

		} else if (mm == PM_ESTRELLA_GIRL){
			(void)mongets(mtmp, SWEET_MOCASSINS);

		} else if (mm == PM_SWEET_COQUETTE){
			(void)mongets(mtmp, SWEET_MOCASSINS);

		} else if (mm == PM_DARK_GIRL){
			(void)mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */

		} else if (mm == PM_DARK_WOMAN){
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			(void)mongets(mtmp, DANCING_SHOES);

		} else if (mm == PM_DARK_LADY){
			(void)mongets(mtmp, LACQUERED_DANCING_SHOE);
			(void)mongets(mtmp, LEATHER_PEEP_TOES);

		} else if (mm == PM_SEXY_CHILD_MODEL){
			(void)mongets(mtmp, HIGH_STILETTOS);

		} else if (mm == PM_SEXY_MODEL){
			(void)mongets(mtmp, HIGH_STILETTOS);
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);

		} else if (mm == PM_SKATER_GIRL){
			(void)mongets(mtmp, ROLLER_BLADE);

		} else if (mm == PM_SKATER_WOMAN){
			(void)mongets(mtmp, ROLLER_BLADE);
			(void)mongets(mtmp, SOFT_GIRL_SNEAKER);

		} else if (mm == PM_MYSTERIOUS_GIRL){
			(void)mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */

		} else if (mm == PM_MYSTERIOUS_WOMAN){
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			(void)mongets(mtmp, DANCING_SHOES);

		} else if (mm == PM_MYSTERIOUS_LADY){
			(void)mongets(mtmp, LACQUERED_DANCING_SHOE);
			(void)mongets(mtmp, LEATHER_PEEP_TOES);

		} else if (mm == PM_REDGUARD_GIRL){
			(void)mongets(mtmp, SOFT_GIRL_SNEAKER);
			(void)mongets(mtmp, AMULET_OF_LIFE_SAVING);

		} else if (mm == PM_REDGUARD_WOMAN){
			(void)mongets(mtmp, HUGGING_BOOT);
			(void)mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
			(void)mongets(mtmp, AMULET_OF_LIFE_SAVING);

		} else if (mm == PM_REDGUARD_LADY){
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
			(void)mongets(mtmp, AMULET_OF_LIFE_SAVING);

		} else if (mm == PM_ODOROUS_GIRL){
			(void)mongets(mtmp, SOFT_GIRL_SNEAKER);
			(void)mongets(mtmp, AMULET_OF_LIFE_SAVING);

		} else if (mm == PM_ODOROUS_WOMAN){
			(void)mongets(mtmp, HUGGING_BOOT);
			(void)mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
			(void)mongets(mtmp, AMULET_OF_LIFE_SAVING);

		} else if (mm == PM_ODOROUS_LADY){
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
			(void)mongets(mtmp, AMULET_OF_LIFE_SAVING);

		} else if (mm == PM_THIEVING_GIRL){
			(void)mongets(mtmp, SOFT_GIRL_SNEAKER);

		} else if (mm == PM_THIEVING_WOMAN){
			(void)mongets(mtmp, LACQUERED_DANCING_SHOE);
			(void)mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

		} else if (mm == PM_THIEVING_LADY){
			(void)mongets(mtmp, SPIKED_BATTLE_BOOT);
			(void)mongets(mtmp, COMBAT_STILETTOS);

		} else if (mm == PM_CRAPPY_BRAT){
			(void)mongets(mtmp, SOFT_GIRL_SNEAKER);

		} else if (mm == PM_SPOILED_PRINCESS){
			(void)mongets(mtmp, LACQUERED_DANCING_SHOE);
			(void)mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

		} else if (mm == PM_HAUGHTY_BITCH){
			(void)mongets(mtmp, SPIKED_BATTLE_BOOT);
			(void)mongets(mtmp, COMBAT_STILETTOS);

		} else if (mm == PM_KICKBOXING_GIRL){
			(void)mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
			(void)mongets(mtmp, SOFT_GIRL_SNEAKER);

		} else if (mm == PM_KICKBOXING_LADY){
			(void)mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
			(void)mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */

		} else if (mm == PM_FORSAKEN_GIRL){
			(void)mongets(mtmp, SOFT_SNEAKERS);
			(void)mongets(mtmp, SOFT_GIRL_SNEAKER);

		} else if (mm == PM_FORSAKEN_LADY){
			(void)mongets(mtmp, SOFT_SNEAKERS);
			(void)mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */

		} else if (mm == PM_ELONA_GIRL){
			(void)mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
			(void)mongets(mtmp, SOFT_GIRL_SNEAKER);

		} else if (mm == PM_ELONA_LADY){
			(void)mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
			(void)mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */

		} else if (mm == PM_ESTRELLARINA){
			(void)mongets(mtmp, SWEET_MOCASSINS);

		} else if (mm == PM_EROTICITY_QUEEN){
			(void)mongets(mtmp, SWEET_MOCASSINS);

		} else if (mm == PM_NORMAL_PROSTITUTE){
			(void)mongets(mtmp, BULLWHIP);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

		} else if (mm == PM_ABNORMAL_PROSTITUTE){
			(void)mongets(mtmp, BULLWHIP);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

		} else if (mm == PM_STRIPPER_GIRL){
			(void)mongets(mtmp, BULLWHIP);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, SUBMACHINE_GUN);
		  	m_initthrow(mtmp, SMG_BULLET, 50);

		} else if (mm == PM_STRIPPER_LADY){
			(void)mongets(mtmp, KNIFE);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, ASSAULT_RIFLE);
		  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);

		} else if (mm == PM_THICK_PROSTITUTE){
			(void)mongets(mtmp, BULLWHIP);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

		} else if (mm == PM_FULL_SKINNY_PROSTITUTE){
			(void)mongets(mtmp, BULLWHIP);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

		} else if (mm == PM_BLACK_PROSTITUTE){
			(void)mongets(mtmp, FLY_SWATTER);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, VICTORIAN_UNDERWEAR);

		} else if (mm == PM_DARK_PROSTITUTE){
			(void)mongets(mtmp, FLY_SWATTER);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, VICTORIAN_UNDERWEAR);

		} else if (mm == PM_LEOPARD_DRESS_PROSTITUTE){
			(void)mongets(mtmp, FLY_SWATTER);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, VICTORIAN_UNDERWEAR);

		} else if (mm == PM_POLKA_DOT_DRESS_PROSTITUTE){
			(void)mongets(mtmp, FLY_SWATTER);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, VICTORIAN_UNDERWEAR);

		} else if (mm == PM_SADISTIC_PROSTITUTE){
			(void)mongets(mtmp, FLY_SWATTER);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, VICTORIAN_UNDERWEAR);

		} else if (mm == PM_UNFAIR_PROSTITUTE){
			(void)mongets(mtmp, FLY_SWATTER);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, VICTORIAN_UNDERWEAR);

		} else if (mm == PM_GREEN_PROSTITUTE){
			(void)mongets(mtmp, KNIFE);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, ROBE);

		} else if (mm == PM_HISPANIC_PROSTITUTE){
			(void)mongets(mtmp, KNIFE);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, ROBE);

		} else if (mm == PM_VIOLET_PROSTITUTE){
			(void)mongets(mtmp, KNIFE);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, ROBE);

		} else if (mm == PM_SWEET_PROSTITUTE){
			(void)mongets(mtmp, KNIFE);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, ROBE);

		} else if (mm == PM_STRING_TANGA_PROSTITUTE){
			(void)mongets(mtmp, KNIFE);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, ROBE);

		} else if (mm == PM_PIMPING_PROSTITUTE){
			(void)mongets(mtmp, KNIFE);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, ROBE);

		} else if (mm == PM_CIGARETTE_SMOKING_PROSTITUTE){
			(void)mongets(mtmp, KNIFE);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, ROBE);

		} else if (mm == PM_WIZENED_PROSTITUTE){
			(void)mongets(mtmp, KNIFE);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, ROBE);

		} else if (mm == PM_SECRETARY){
			(void)mongets(mtmp, KNIFE);
			(void)mongets(mtmp, PISTOL);
		  	m_initthrow(mtmp, PISTOL_BULLET, 50);
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
			(void)mongets(mtmp, VICTORIAN_UNDERWEAR);

		} else if (mm == PM_STUDENT_ASSISTANT){
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

		} else if (mm == PM_ANTISOCIAL_WOMAN){
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

		} else if (mm == PM_STUDENT_LEADER){
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, SCR_CREATE_MONSTER);
			(void)mongets(mtmp, SCR_CREATE_MONSTER);
			(void)mongets(mtmp, SCR_CREATE_MONSTER);
			(void)mongets(mtmp, WAN_CREATE_HORDE);
			(void)mongets(mtmp, WAN_SUMMON_UNDEAD);

		} else if (mm == PM_HIPPIE_LADY){
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

		} else if (mm == PM_SPUTA_FLOWING_WOMAN){
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

		} else if (mm == PM_HIPPIE_GUY){
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

		} else if (mm == PM_SWEET_WOMAN){
			(void)mongets(mtmp, SWEET_MOCASSINS);
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

		} else if (mm == PM_SEXY_WOMAN){
			(void)mongets(mtmp, SWEET_MOCASSINS);
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

		} else if (mm == PM_PETTY_SWEET_WOMAN){
			(void)mongets(mtmp, SWEET_MOCASSINS);
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

		} else if (mm == PM_LITTLE_GIRL){
			(void)mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */

		} else if (mm == PM_ITALIAN_GIRL){
			(void)mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, ITALIAN_HEELS); /* M4_SANDALS */
		} else if (mm == PM_FEMININE_GIRL){
			(void)mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		} else if (mm == PM_ELEGANT_GIRL){
			(void)mongets(mtmp, BLOCK_HEELED_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, STILETTO_SANDALS); /* M4_SANDALS */
		} else if (mm == PM_ITALIAN_LASS){
			(void)mongets(mtmp, SOFT_LADY_SHOE);
			(void)mongets(mtmp, ITALIAN_HEELS); /* M4_SANDALS */
		} else if (mm == PM_FEMININE_LASS){
			(void)mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, HUGGING_BOOT);
		} else if (mm == PM_ELEGANT_LASS){
			(void)mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, STILETTO_SANDALS); /* M4_SANDALS */
		} else if (mm == PM_ITALIAN_WOMAN){
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);
			(void)mongets(mtmp, ITALIAN_HEELS); /* M4_SANDALS */
		} else if (mm == PM_FEMININE_WOMAN){
			(void)mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, INKA_BOOT);
		} else if (mm == PM_ELEGANT_WOMAN){
			(void)mongets(mtmp, PROSTITUTE_SHOE);
			(void)mongets(mtmp, STILETTO_SANDALS); /* M4_SANDALS */
		} else if (mm == PM_ITALIAN_DAME){
			(void)mongets(mtmp, BLOCK_HEELED_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, ITALIAN_HEELS); /* M4_SANDALS */
		} else if (mm == PM_FEMININE_DAME){
			(void)mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, STEEL_CAPPED_SANDAL); /* M4_HAMMERSANDAL */
		} else if (mm == PM_ELEGANT_DAME){
			(void)mongets(mtmp, SOFT_LADY_SHOE);
			(void)mongets(mtmp, STILETTO_SANDALS); /* M4_SANDALS */
		} else if (mm == PM_ITALIAN_LADY){
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);
			(void)mongets(mtmp, ITALIAN_HEELS); /* M4_SANDALS */
		} else if (mm == PM_FEMININE_LADY){
			(void)mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, SPIKED_BATTLE_BOOT);
		} else if (mm == PM_ELEGANT_LADY){
			(void)mongets(mtmp, PROSTITUTE_SHOE);
			(void)mongets(mtmp, STILETTO_SANDALS); /* M4_SANDALS */
		} else if (mm == PM_SOUR_PROSTITUTE){
			(void)mongets(mtmp, PROSTITUTE_SHOE);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		} else if (mm == PM_ANGRY_PROSTITUTE){
			(void)mongets(mtmp, PROSTITUTE_SHOE);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		} else if (mm == PM_PINK_PROSTITUTE){
			(void)mongets(mtmp, PROSTITUTE_SHOE);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		} else if (mm == PM_REDGUARD_PROSTITUTE){
			(void)mongets(mtmp, PROSTITUTE_SHOE);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		} else if (mm == PM_SEXY_PROSTITUTE){
			(void)mongets(mtmp, SEXPLAY_WHIP);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		} else if (mm == PM_GORGEOUS_PROSTITUTE){
			(void)mongets(mtmp, SEXPLAY_WHIP);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

		} else if (mm == PM_HC_GIRL){
			(void)mongets(mtmp, SWEET_MOCASSINS);

		} else if (mm == PM_HC_MARTIAL_ARTIST){
			(void)mongets(mtmp, LEATHER_PEEP_TOES);

		} else if (mm == PM_HC_YOUNG_WOMAN){
			(void)mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

		} else if (mm == PM_LITTLE_BOY){
			(void)mongets(mtmp, SOFT_GIRL_SNEAKER);

		} else if (mm == PM_LESBIAN_GIRL){
			(void)mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */

		} else if (mm == PM_GAY_BOY){
			(void)mongets(mtmp, SOFT_GIRL_SNEAKER);

		} else if (mm == PM_FARTING_GIRL){
			(void)mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */

		} else if (mm == PM_FARTING_YOUNG_WOMAN){
			(void)mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);

		} else if (mm == PM_OLDER_FARTING_WOMAN){
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

		} else if (mm == PM_FARTING_BOY){
			(void)mongets(mtmp, SOFT_GIRL_SNEAKER);

		} else if (mm == PM_ASIAN_WOMAN){
			(void)mongets(mtmp, HUGGING_BOOT);
			(void)mongets(mtmp, LEATHER_PEEP_TOES);

		} else if (mm == PM_SEXY_CHINESE_WOMAN){
			(void)mongets(mtmp, HUGGING_BOOT);
			(void)mongets(mtmp, LEATHER_PEEP_TOES);

		} else if (mm == PM_JAPANESE_WOMAN){
			(void)mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

		} else if (mm == PM_ANIME_WOMAN){
			(void)mongets(mtmp, ATSUZOKO_BOOTS);
			(void)mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */

		} else if (mm == PM_MANGA_WOMAN){
			(void)mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */

		} else if (mm == PM_KOREAN_WOMAN){
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

		} else if (mm == PM_VIETNAMESE_WOMAN){
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		} else if (mm == PM_TURKISH_WOMAN){
			(void)mongets(mtmp, SPIKED_BATTLE_BOOT);
			(void)mongets(mtmp, COMBAT_STILETTOS);

		} else if (mm == PM_PERSIAN_WOMAN){
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);
			(void)mongets(mtmp, SWEET_MOCASSINS);

		} else if (mm == PM_WUHANESE_WOMAN){
			(void)mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		} else if (mm == PM_PRETTY_ASIAN_WOMAN){
			(void)mongets(mtmp, HUGGING_BOOT);
			(void)mongets(mtmp, LEATHER_PEEP_TOES);

		} else if (mm == PM_ASIAN_LADY){
			(void)mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, LEATHER_PEEP_TOES);

		} else if (mm == PM_CHINESE_LADY){
			(void)mongets(mtmp, HUGGING_BOOT);
			(void)mongets(mtmp, LEATHER_PEEP_TOES);

		} else if (mm == PM_JAPANESE_LADY){
			(void)mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

		} else if (mm == PM_ANIME_LADY){
			(void)mongets(mtmp, ATSUZOKO_BOOTS);
			(void)mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */

		} else if (mm == PM_MANGA_LADY){
			(void)mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */

		} else if (mm == PM_KOREAN_LADY){
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			(void)mongets(mtmp, COMBAT_STILETTOS);

		} else if (mm == PM_VIETNAMESE_LADY){
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);
			(void)mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

		} else if (mm == PM_TURKISH_LADY){
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			(void)mongets(mtmp, COMBAT_STILETTOS);

		} else if (mm == PM_PERSIAN_LADY){
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		} else if (mm == PM_WUHANESE_LADY){
			(void)mongets(mtmp, STEEL_CAPPED_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, STILETTO_SANDALS); /* M4_SANDALS */

		} else if (mm == PM_SEXY_ASIAN_LADY){
			(void)mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, LEATHER_PEEP_TOES);

		} else if (mm == PM_YOUNG_ADULT_GIRL){
			(void)mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
			(void)mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

		} else if (mm == PM_YOUNG_ADULT_BOY){
			(void)mongets(mtmp, SOFT_GIRL_SNEAKER);
			(void)mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

		} else if (mm == PM_YOUNG_WOMAN){
			(void)mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		} else if (mm == PM_BUNDLE_SOFT_LOVEWOMAN){
			(void)mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		} else if (mm == PM_YOUNG_MAN){
			(void)mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

		} else if (mm == PM_FARTING_WOMAN){
			(void)mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		} else if (mm == PM_FARTING_MAN){
			(void)mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

		} else if (mm == PM_ADULT_LADY){
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		} else if (mm == PM_ADULT_GENTLEMAN){
			(void)mongets(mtmp, SPIKED_BATTLE_BOOT);
			(void)mongets(mtmp, COMBAT_STILETTOS);

		} else if (mm == PM_LESBIAN_WOMAN){
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		} else if (mm == PM_GAY_MAN){
			(void)mongets(mtmp, SPIKED_BATTLE_BOOT);
			(void)mongets(mtmp, COMBAT_STILETTOS);

		} else if (mm == PM_LESBIAN_BEAUTY){
			(void)mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		} else if (mm == PM_GAY_MATE){
			(void)mongets(mtmp, STEEL_CAPPED_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, LEATHER_PEEP_TOES);

		} else if (mm == PM_OLD_GRANNY){
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		} else if (mm == PM_OLD_GRANDPA){
			(void)mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, COMBAT_STILETTOS);

		} else if (mm == PM_FARTING_QUEEN){
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		} else if (mm == PM_FARTING_KING){
			(void)mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, COMBAT_STILETTOS);

		} else if (mm == PM_CHARMING_SCRATCHER){
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		} else if (mm == PM_NICE_OLD_LADY){
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		} else if (mm == PM_KUNG_FU_GIRL){
			(void)mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

		} else if (mm == PM_NINJA_GIRL){
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

		} else if (mm == PM_YOGA_GIRL){
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

		} else if (mm == PM_NINJA_BOY){
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

		} else if (mm == PM_TAEKWONDO_GIRL){
			(void)mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, LEATHER_PEEP_TOES);

		} else if (mm == PM_TAI_CHI_GIRL){
			(void)mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, LEATHER_PEEP_TOES);

		} else if (mm == PM_REAL_TAI_CHI_GIRL){
			(void)mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, LEATHER_PEEP_TOES);

		} else if (mm == PM_CHAI_TEA_GIRL){
			(void)mongets(mtmp, POT_CURE_CRITICAL_WOUNDS);

		} else if (mm == PM_BLACKBELT){
			(void)mongets(mtmp, SPIKED_BATTLE_BOOT);
			(void)mongets(mtmp, COMBAT_STILETTOS);

		} else if (mm == PM_KUNG_FU_GUY){
			(void)mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

		} else if (mm == PM_FLYING_GIRL){
			(void)mongets(mtmp, COMBAT_STILETTOS);

		} else if (mm == PM_FLYING_GUY){
			(void)mongets(mtmp, COMBAT_STILETTOS);

		} else if (mm == PM_DRAGONBALL_KID){

			(void) mongets(mtmp, rnd_class(PLASTEEL_BOOTS,LEVITATION_BOOTS));

		} else if (mm == PM_KAMEHAMEHA_FIGHTER){

			(void) mongets(mtmp, rnd_class(PLASTEEL_BOOTS,LEVITATION_BOOTS));

			if (!rn2(5)) mongets(mtmp, rnd_offensive_item_new(mtmp));

		} else if (mm == PM_SUPER_SAIYAN){

			mongets(mtmp, rnd_offensive_item_new(mtmp));
			(void) mongets(mtmp, rnd_class(PLASTEEL_BOOTS,LEVITATION_BOOTS));

		} else if (mm == PM_MAYOR_CUMMERBUND){

			int spe2;
		    otmp = mksobj(SCIMITAR, FALSE, FALSE, FALSE);
		    if (otmp) {
			curse(otmp);
			otmp->oerodeproof = TRUE;
			spe2 = d(1,3);
			otmp->spe = max(otmp->spe, spe2);
			(void) mpickobj(mtmp, otmp, TRUE);
		    }
			
		    otmp = mksobj(LEATHER_JACKET, FALSE, FALSE, FALSE);
		    if (otmp) {
			otmp->oerodeproof = TRUE;
			spe2 = d(2,3);
			otmp->spe = max(otmp->spe, spe2);
			(void) mpickobj(mtmp, otmp, TRUE);
		    }

		    otmp = mksobj(SMALL_SHIELD, FALSE, FALSE, FALSE);
		    if (otmp) {
			otmp->oerodeproof = TRUE;
			spe2 = d(1,3);
			otmp->spe = max(otmp->spe, spe2);
			(void) mpickobj(mtmp, otmp, TRUE);
		    }

			(void)mongets(mtmp, LEATHER_CLOAK);
			(void)mongets(mtmp, HIGH_BOOTS);
			(void)mongets(mtmp, LEATHER_GLOVES);
		}

		else if (mm == PM_MINER || mm == PM_DEAD_MINER) {

		    (void)mongets(mtmp, PICK_AXE);
		    otmp = mksobj(BRASS_LANTERN, TRUE, FALSE, FALSE);
			if (otmp) (void) mpickobj(mtmp, otmp, TRUE);
	            /*begin_burn(otmp, FALSE);*/
		}

		break;

		case S_DOG:

			if(mm == PM_SPIT_DEMON){ (void)mongets(mtmp, SLING);
		  	  m_initthrow(mtmp, ROCK, 5);
			}

			if(mm == PM_CORPULENT_DOG || mm == PM_THICK_POTATO){ (void)mongets(mtmp, ROCKET_LAUNCHER);
		  	  m_initthrow(mtmp, ROCKET, 1);
			}
			if(mm == PM_CORPSE_SPITTER || mm == PM_BLACK_MUZZLE){ (void)mongets(mtmp, ROCKET_LAUNCHER);
		  	  m_initthrow(mtmp, ROCKET, 2);
			}
			if(mm == PM_MUZZLE_FIEND || mm == PM_MAW_FIEND){ (void)mongets(mtmp, ROCKET_LAUNCHER);
		  	  m_initthrow(mtmp, ROCKET, 3);
			}
			if(mm == PM_ROCKET_MUZZLE){ (void)mongets(mtmp, ROCKET_LAUNCHER);
		  	  m_initthrow(mtmp, ROCKET, 4);
			}

		break;

		case S_GHOST:
		if(mm == PM_BLACKBEARD_S_GHOST){

			int spe2;
		    otmp = mksobj(SCIMITAR, FALSE, FALSE, FALSE);
		    if (otmp) {
			curse(otmp);
			otmp->oerodeproof = TRUE;
			otmp->oeroded = 1;
			spe2 = d(2,3);
			otmp->spe = max(otmp->spe, spe2);
			(void) mpickobj(mtmp, otmp, TRUE);
		    }

		    /* MRKR: Dwarves in the Mines sometimes carry torches */

		    if (In_mines(&u.uz)) {
		      if (!rn2(4)) {	
			otmp = mksobj(TORCH, TRUE, FALSE, FALSE);
			if (otmp) {
				otmp->quan = 1;
				otmp->owt = weight(otmp);
				(void) mpickobj(mtmp, otmp, TRUE);
			}

			/* If this spot is unlit, light the torch */

			/*if (!levl[mtmp->mx][mtmp->my].lit) {
			  begin_burn(otmp, FALSE);
			}*/
			/* was causing weird error messages, so let's just disable it for now --Amy */
		      
		      }
		    }
		} else if (mm == PM_IMELDA_S_GHOST) {

		    (void)mongets(mtmp, LEATHER_PEEP_TOES);
		} 

		if (mm == PM_SHAWNA) {
				(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
				(void)mongets(mtmp, KNIFE);
		}

		if (mm == PM_POLICE) {
				(void)mongets(mtmp, RUBBER_HOSE);
				m_initthrow(mtmp, CREAM_PIE, 2);
		}

		break;

	    case S_ANGEL:
		{

			/* preventing low level angels from generating with powerful stuff that players can claim --Amy */
			if (mtmp->m_lev < rnd(100)) break;
			/* or powerful stuff with which they can 0wn the player */
			if (ptr->mlevel < 4) break;

		    int spe2;

		    /* create minion stuff; can't use mongets */
		    otmp = mksobj(LONG_SWORD, FALSE, FALSE, FALSE);

		    if (otmp) {

			/* maybe make it special */
			if (!rn2(20) || is_lord(ptr))
				otmp = oname(otmp, artiname(rn2(2) ? ART_DEMONBANE : ART_SUNSWORD));
			bless(otmp);
			otmp->oerodeproof = TRUE;
			spe2 = rn2(4);
			otmp->spe = max(otmp->spe, spe2);
			(void) mpickobj(mtmp, otmp, TRUE);

			otmp = mksobj(!rn2(4) || is_lord(ptr) ?
				  SHIELD_OF_REFLECTION : LARGE_SHIELD, FALSE, FALSE, FALSE);
			otmp->cursed = otmp->hvycurse = otmp->prmcurse = otmp->morgcurse = otmp->evilcurse = otmp->bbrcurse = otmp->stckcurse = FALSE;
			otmp->oerodeproof = TRUE;
			otmp->spe = 0;
			(void) mpickobj(mtmp, otmp, TRUE);

		    }
		}
		break;

	    case S_GOLEM:
		{
			if (mm == PM_ANIMATED_WEDGE_SANDAL) (void)mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
			else if (mm == PM_ANIMATED_SYNTHETIC_SANDAL) (void)mongets(mtmp, SYNTHETIC_SANDALS);
			else if (mm == PM_ANIMATED_SEXY_LEATHER_PUMP) (void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
			else if (mm == PM_ANIMATED_UNFAIR_STILETTO) (void)mongets(mtmp, UNFAIR_STILETTOS);
			else if (mm == PM_ANIMATED_SKY_HIGH_HEEL) (void)mongets(mtmp, SKY_HIGH_HEELS);
			else if (mm == PM_ANIMATED_BEAUTIFUL_FUNNEL_HEELED_PUMP) (void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
			else if (mm == PM_ANIMATED_LEATHER_PEEP_TOE) (void)mongets(mtmp, LEATHER_PEEP_TOES);
			else if (mm == PM_ANIMATED_COMBAT_STILETTO) (void)mongets(mtmp, COMBAT_STILETTOS);
			else if (mm == PM_ANIMATED_ATSUZOKO_BOOT) (void)mongets(mtmp, ATSUZOKO_BOOTS);
			else if (mm == PM_ANIMATED_STILETTO_SANDAL) (void)mongets(mtmp, HIGH_STILETTOS);
			else if (mm == PM_ANIMATED_LADY_BOOT) (void)mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
			else if (mm == PM_ANIMATED_PRETTY_SANDAL) (void)mongets(mtmp, STILETTO_SANDALS); /* M4_SANDALS */
			else if (mm == PM_ANIMATED_ROLLER_BLADE) (void)mongets(mtmp, ROLLER_BLADE);
			else if (mm == PM_ANIMATED_PROSTITUTE_SHOE) (void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			else if (mm == PM_WEREPROSTITUTESHOE) (void)mongets(mtmp, HIPPIE_HEELS);
			else if (mm == PM_WERESEXYLEATHERPUMP) (void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
			else if (mm == PM_WEREWEDGESANDAL) (void)mongets(mtmp, WEDGE_SANDALS);
			else if (mm == PM_WEREUNFAIRSTILETTO) (void)mongets(mtmp, UNFAIR_STILETTOS);
			else if (mm == PM_WEREBEAUTIFULFUNNELHEELEDPUMP) (void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
			else if (mm == PM_WEREPEEPTOE) (void)mongets(mtmp, LEATHER_PEEP_TOES);
			else if (mm == PM_WERECOMBATSTILETTO) (void)mongets(mtmp, COMBAT_STILETTOS);
			else if (mm == PM_WERESTILETTOSANDAL) (void)mongets(mtmp, HIGH_STILETTOS);
			else if (mm == PM_SLAP_HEELED_SANDAL_BOOT) (void)mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */

			if (mm == PM_SHERINE) {
				(void)mongets(mtmp, KATANA);
				(void)mongets(mtmp, SHORT_SWORD);
			}
			if (mm == PM_TAMMY) (void)mongets(mtmp, SWEET_MOCASSINS);

			if (mm == PM_ATHENA_GUARDIAN) (void)mongets(mtmp, HEAVY_HAMMER);
			if (mm == PM_ATHENA_GIANT) (void)mongets(mtmp, MALLET);

			if (mm == PM_CLOCK_GOLEM) (void)mongets(mtmp, WAN_TIME);

			if (mm == PM_FLYING_SCIMITAR) (void)mongets(mtmp, SCIMITAR);
			if (mm == PM_WHIRLING_HATCHET) (void)mongets(mtmp, AXE);
			if (mm == PM_CURSED_SWORD) (void)mongets(mtmp, ELVEN_SHORT_SWORD);
			if (mm == PM_ANIMATED_DAGGER) (void)mongets(mtmp, rn2(20) ? DAGGER : SILVER_DAGGER);
			if (mm == PM_SWORD_FAMILIAR) (void)mongets(mtmp, SHORT_SWORD);
			if (mm == PM_HAMMER_OF_THE_UNDERWORLD) (void)mongets(mtmp, MALLET);
			if (mm == PM_HYPERTYPE) (void)mongets(mtmp, WAN_TRAP_CREATION);
			if (mm == PM_LEVEL____ENEMY) (void)mongets(mtmp, SCR_TRAP_CREATION);
			if (mm == PM_SECURITY_BOT) {
			  (void)mongets(mtmp, ASSAULT_RIFLE);
		  	  m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 25);
			}
			if (mm == PM_PROTECTOR_OF_THE_POOR) {(void)mongets(mtmp, BOW);
		  	  m_initthrow(mtmp, ARROW, 50);
		  	  m_initthrow(mtmp, ARROW, 50);
			}

		}
		break;

	    case S_IMP:

		switch (mm) {
			case PM_LEGION_DEVIL_GRUNT:

			  if (rn2(2)) {
				(void) mongets(mtmp, RIFLE);
		 		m_initthrow(mtmp, RIFLE_BULLET, 25);
		 		m_initthrow(mtmp, RIFLE_BULLET, 25);
			  } else {
				(void) mongets(mtmp, SUBMACHINE_GUN);
		 		m_initthrow(mtmp, SMG_BULLET, 25);
		 		m_initthrow(mtmp, SMG_BULLET, 25);
			  }

			  (void) mongets(mtmp, rn2(2) ? KNIFE : DAGGER);
			  if (rn2(2)) (void) mongets(mtmp, FRAG_GRENADE);
			  break;
			case PM_LEGION_DEVIL_SOLDIER:

			  if (rn2(2)) {
			  	(void) mongets(mtmp, HEAVY_MACHINE_GUN);
			  	m_initthrow(mtmp, MG_BULLET, 50);
			  	m_initthrow(mtmp, MG_BULLET, 50);
			  	m_initthrow(mtmp, MG_BULLET, 50);
			  } else {
			  	(void) mongets(mtmp, SUBMACHINE_GUN);
			  	m_initthrow(mtmp, SMG_BULLET, 30);
			  	m_initthrow(mtmp, SMG_BULLET, 30);
			  }
			  (void) mongets(mtmp, rn2(2) ? KNIFE : DAGGER);
			  if (!rn2(4)) {
			  	(void) mongets(mtmp, FRAG_GRENADE);
			  	(void) mongets(mtmp, FRAG_GRENADE);
			  } else if (!rn2(4)) {
			  	(void) mongets(mtmp, GAS_GRENADE);
			  	(void) mongets(mtmp, GAS_GRENADE);
			  }
			  break;
			case PM_LEGION_DEVIL_SERGEANT:

			  if (rn2(2)) {
			  	(void) mongets(mtmp, AUTO_SHOTGUN);
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 10);
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 10);
			  } else {
			  	(void) mongets(mtmp, ASSAULT_RIFLE);
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 30);
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 30);
			  }
			  (void) mongets(mtmp, rn2(2) ? DAGGER : KNIFE);
			  if (!rn2(5)) {
			  	m_initthrow(mtmp, FRAG_GRENADE, 5);
			  	if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			  } else if (!rn2(5)) {
			  	m_initthrow(mtmp, GAS_GRENADE, 5);
			  	if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			  }
			  break;
			case PM_LEGION_DEVIL_CAPTAIN:
			case PM_LEGION_DEVIL_GENERAL:

			  if (rn2(2)) {
			  	(void) mongets(mtmp, AUTO_SHOTGUN);
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 20);
			  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 20);
			  } else if (rn2(2)) {
			  	(void) mongets(mtmp, HEAVY_MACHINE_GUN);
			  	m_initthrow(mtmp, MG_BULLET, 60);
			  	m_initthrow(mtmp, MG_BULLET, 60);
			  	m_initthrow(mtmp, MG_BULLET, 60);
			  } else {
			  	(void) mongets(mtmp, ASSAULT_RIFLE);
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 60);
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 60);
			  }
			  if (rn2(2)) {
				  (void) mongets(mtmp, ROCKET_LAUNCHER);
			  	  m_initthrow(mtmp, ROCKET, 5);
			  } else if (!rn2(4)) {
				  (void) mongets(mtmp, GRENADE_LAUNCHER);			  
			  	  m_initthrow(mtmp, 
			  	  	(rn2(2) ? FRAG_GRENADE : GAS_GRENADE), 
			  	  	5);
			  } else {
				  (void) mongets(mtmp, rn2(2) ? SILVER_SABER : DAGGER);
			  }
			  break;
		    default:
			/*m_initweap_normal(mtmp);*/
			break;
		}	
		break;

	    case S_QUADRUPED:

			if(ptr == &mons[PM_SANTA_CLAUS]) (void) mongets(mtmp, MACE);
			if(ptr == &mons[PM_HELL_BULL]) (void) mongets(mtmp, LUCERN_HAMMER);

			if(ptr == &mons[PM_CHAINED_CLAN]) (void) mongets(mtmp, ROTATING_CHAIN);
			if(ptr == &mons[PM_TUNDRA_CLAN]) (void) mongets(mtmp, SCR_ICE);
			if(ptr == &mons[PM_BURNING_CLAN]) (void) mongets(mtmp, POT_FIRE);
			if(ptr == &mons[PM_CIRCLE_CLAN]) (void) mongets(mtmp, SCR_TELEPORTATION);
			if(ptr == &mons[PM_SMOKE_CLAN]) (void) mongets(mtmp, SCR_FIRE);

			if(ptr == &mons[PM_FOREST_CLAN]) (void) mongets(mtmp, SCR_GROWTH);
			if(ptr == &mons[PM_MARSH_CLAN]) (void) mongets(mtmp, SCR_FLOOD);
			if(ptr == &mons[PM_ASH_CLAN]) (void) mongets(mtmp, FRAG_GRENADE);
			if(ptr == &mons[PM_TOMB_CLAN]) (void) mongets(mtmp, SCR_SUMMON_UNDEAD);
			if(ptr == &mons[PM_LATTICE_CLAN]) (void) mongets(mtmp, SCR_BARRHING);
			if(ptr == &mons[PM_HELL_CLAN]) (void) mongets(mtmp, SCR_LAVA);

			if(ptr == &mons[PM_LAIR_TOUGHGUY]) (void) mongets(mtmp, BASEBALL_BAT);
			if(ptr == &mons[PM_HARD_HITTING_DUDE]) (void) mongets(mtmp, HEAVY_HAMMER);

		break;

	    case S_SPIDER:

			if(ptr == &mons[PM_PHIBIE]) {
				(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
				(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
			}

		break;

	    case S_TRAPPER:

			if(ptr == &mons[PM_SMART_TRAPPER]) (void) mongets(mtmp, SCR_TRAP_CREATION);
			if(ptr == &mons[PM_TRAPPER_KING]) (void) mongets(mtmp, WAN_TRAP_CREATION);

			if(ptr == &mons[PM_GRAY_SNIPER]) {
				(void) mongets(mtmp, SLING);
				(void) mongets(mtmp, rnd_class(RIGHT_MOUSE_BUTTON_STONE,NASTY_STONE));
			}

			if(ptr == &mons[PM_TRIXI]) {
				(void) mongets(mtmp, ATSUZOKO_BOOTS);
				(void) mongets(mtmp, HYDRA_BOW);
				(void) mongets(mtmp, SCR_FLOOD);
			  	m_initthrow(mtmp, ARROW, 50);
			  	m_initthrow(mtmp, ARROW, 50);
			  	m_initthrow(mtmp, ARROW, 50);
			  	m_initthrow(mtmp, ARROW, 50);
			}

			if(ptr == &mons[PM_NASTYSTONE_SNIPER]) {
				(void) mongets(mtmp, SLING);
				(void) mongets(mtmp, rnd_class(RIGHT_MOUSE_BUTTON_STONE,NASTY_STONE));
				(void) mongets(mtmp, rnd_class(RIGHT_MOUSE_BUTTON_STONE,NASTY_STONE));
			}

			if(ptr == &mons[PM_EVIL_PATCH_IDEA_IMPLEMENTATOR]) {
				(void) mongets(mtmp, SLING);
				(void) mongets(mtmp, rnd_class(RIGHT_MOUSE_BUTTON_STONE,NASTY_STONE));
				(void) mongets(mtmp, rnd_class(RIGHT_MOUSE_BUTTON_STONE,NASTY_STONE));
				(void) mongets(mtmp, rnd_class(RIGHT_MOUSE_BUTTON_STONE,NASTY_STONE));
			}

		break;

	    case S_GNOME:

			if(ptr == &mons[PM_RADIOACTIVE_GNOLL]) (void) mongets(mtmp, POT_RADIUM);
			if(ptr == &mons[PM_NET_GNOME]) (void) mongets(mtmp, TRIDENT);

			/* don't hand out crossbows to the low-level wimps because that would make them capable of sniping a
			 * beginning character at long range and possibly instakill them! --Amy */
			if (!rn2(10) && ptr->mlevel > 1 && (rnd(4) > ptr->mlevel) ) {
				(void) mongets(mtmp, CROSSBOW);
				m_initthrow(mtmp, CROSSBOW_BOLT, 35);

			}

		switch (mm) {
		    case PM_GNOLL:
			if(!rn2(3)) (void) mongets(mtmp, ORCISH_HELM);
			if(!rn2(3)) (void) mongets(mtmp, STUDDED_LEATHER_ARMOR);
			if(!rn2(3)) (void) mongets(mtmp, ORCISH_SHIELD);
			if(!rn2(4)) (void) mongets(mtmp, SPEAR);
			break;

		    case PM_GNOLL_WARRIOR:
			if(!rn2(2)) (void) mongets(mtmp, ORCISH_HELM);

			if (!rn2(20))
			    (void) mongets(mtmp, ORANGE_DRAGON_SCALE_MAIL);
			else if (rn2(3))
			    (void) mongets(mtmp, SCALE_MAIL);
			else
			    (void) mongets(mtmp, SPLINT_MAIL);

			if(!rn2(2)) (void) mongets(mtmp, ORCISH_SHIELD);
		 	if(!rn2(3)) (void) mongets(mtmp, KATANA);
			break;

		    case PM_GNOLL_CHIEFTAIN:
			(void) mongets(mtmp, ORCISH_HELM);

			if (!rn2(10))
			    (void) mongets(mtmp, BLUE_DRAGON_SCALE_MAIL);
			else
			    (void) mongets(mtmp, CRYSTAL_PLATE_MAIL);

			(void) mongets(mtmp, ORCISH_SHIELD);
			(void) mongets(mtmp, KATANA);
			(void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(100)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
			break;

		    case PM_GNOLL_SHAMAN:
			if (!rn2(10))
			    (void) mongets(mtmp, SILVER_DRAGON_SCALE_MAIL);
			else if (rn2(5))
			    (void) mongets(mtmp, CRYSTAL_PLATE_MAIL);
			else
			    (void) mongets(mtmp, RED_DRAGON_SCALE_MAIL);

			(void) mongets(mtmp, ATHAME);
			m_initthrow(mtmp, SHURIKEN, 40);
			(void) mongets(mtmp, rnd_offensive_item(mtmp));
			(void) mongets(mtmp, rnd_offensive_item(mtmp));
		     if (!rn2(100)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
		     if (!rn2(100)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
			break;

		    default:
			/*m_initweap_normal(mtmp);*/
			break;
		}	
		break;
	    case S_HUMANOID:

		if (ptr == &mons[PM_KLINGON_SOLDIER]) {

			  (void) mongets(mtmp, SUBMACHINE_GUN);
		  	  m_initthrow(mtmp, SMG_BULLET, 25);
		  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  (void) mongets(mtmp, DAGGER);
			  (void) mongets(mtmp, FRAG_GRENADE);

		}

		if (ptr == &mons[PM_DREY_ELF]) { (void)mongets(mtmp, ELVEN_BOW); (void)mongets(mtmp, ELVEN_DAGGER);
			 m_initthrow(mtmp, ELVEN_ARROW, 35);
		}

		if (ptr == &mons[PM_DEATHWALKER_KNIGHT]) {

		     (void)mongets(mtmp, LONG_SWORD);
		     (void)mongets(mtmp, PLATE_MAIL);
		     (void)mongets(mtmp, LARGE_SHIELD);
		     (void)mongets(mtmp, HELMET);
		     (void)mongets(mtmp, LEATHER_GLOVES);
		}

		if (ptr == &mons[PM_DEATHWALKER_BATTLEMASTER]) {

		     (void)mongets(mtmp, ELECTRIC_SWORD);
		     (void)mongets(mtmp, DWARVISH_MITHRIL_COAT);
		     (void)mongets(mtmp, STEEL_SHIELD);
		     (void)mongets(mtmp, HELM_OF_STEEL);
		     (void)mongets(mtmp, GAUNTLETS_OF_STEEL);
		}

		if (ptr == &mons[PM_SKULK_BLADE]) {

		     (void)mongets(mtmp, SCIMITAR);
		     (void)mongets(mtmp, SMALL_SHIELD);
		     (void)mongets(mtmp, POT_HEALING);
		}

		if (ptr == &mons[PM_SOULLESS_CUTTER]) (void)mongets(mtmp, AXE);

		if (ptr == &mons[PM_HALFLING_SLINGER]) {(void)mongets(mtmp, SLING); m_initthrow(mtmp, ROCK, 15); }

		if (ptr == &mons[PM_GREAT_BAR_SLAYER]) (void)mongets(mtmp, PARTISAN);
		if (ptr == &mons[PM_RELIGIOUS_POTATO]) (void)mongets(mtmp, VOULGE);
		if (ptr == &mons[PM_FANATICIAN]) (void)mongets(mtmp, HALBERD);
		if (ptr == &mons[PM_BUTLER]) (void)mongets(mtmp, LUCERN_HAMMER);

		if (ptr == &mons[PM_FETISH] || ptr == &mons[PM_FLAYER] || ptr == &mons[PM_SOUL_KILLER] || ptr == &mons[PM_PYGMY_WARRIOR] || ptr == &mons[PM_STYGIAN_DOLL] || ptr == &mons[PM_VOODOO_FETISH] || ptr == &mons[PM_CANNIBAL_CULTIST] || ptr == &mons[PM_GIANT_PYGMY]) (void)mongets(mtmp, KNIFE);

		if (ptr == &mons[PM_FETISH_BLOWDART] || ptr == &mons[PM_FLAYER_BLOWDART] || ptr == &mons[PM_SOUL_KILLER_BLOWDART] || ptr == &mons[PM_PYGMY_WARRIOR_BLOWDART] || ptr == &mons[PM_STYGIAN_DOLL_BLOWDART] || ptr == &mons[PM_VOODOO_FETISH_BLOWDART] || ptr == &mons[PM_CANNIBAL_CULTIST_BLOWDART] || ptr == &mons[PM_GIANT_PYGMY_BLOWDART]) m_initthrow(mtmp, DART, 40);

		if (ptr == &mons[PM_POLICEMAN]) {

				(void)mongets(mtmp, RUBBER_HOSE);
				m_initthrow(mtmp, CREAM_PIE, 2);
		}

		if (is_dwarf(ptr)) {
		    if (rn2(7)) (void)mongets(mtmp, DWARVISH_CLOAK);
		    if (rn2(7)) (void)mongets(mtmp, IRON_SHOES);
		    if (!rn2(4) && ptr->mlevel >= 2) { /* very low-level fools with mattocks would be too strong --Amy */
			(void)mongets(mtmp, DWARVISH_SHORT_SWORD);
			/* note: you can't use a mattock with a shield */
			if (rn2(2)) (void)mongets(mtmp, DWARVISH_MATTOCK);
			else {
				(void)mongets(mtmp, AXE);
				(void)mongets(mtmp, DWARVISH_ROUNDSHIELD);
			}
			(void)mongets(mtmp, DWARVISH_IRON_HELM);
			if (!rn2(4))
			    (void)mongets(mtmp, DWARVISH_MITHRIL_COAT);
		    } else if (rn2(2)) { /* if the monster level is too low it will end up here; pick-axes are ok --Amy */
			(void)mongets(mtmp, !rn2(3) ? PICK_AXE : DAGGER);
		    }
		} else if(mm == PM_GITHYANKI_PIRATE){
			(void)mongets(mtmp, TWO_HANDED_SWORD);
			(void)mongets(mtmp, BRONZE_PLATE_MAIL);
			(void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, HIGH_BOOTS);
		} else if (is_hobbit(ptr)) {
			    switch (rn2(6)) {
			        case 0:
				    (void)mongets(mtmp, DAGGER);
				    break;
				case 1:
				    (void)mongets(mtmp, ELVEN_DAGGER);
				    break;
				case 2:
			            (void)mongets(mtmp, rn2(500) ? SLING : CATAPULT);
			            /* WAC give them some rocks to throw */
			            m_initthrow(mtmp, ROCK, rn2(200) ? 2 : 50); 
					if (!rn2(40)) m_initthrow(mtmp, ROCK, 20);
						break;
			        case 3:
			        case 4:
			        case 5:
					break;
			      }
				/* WAC add 50% chance of leather */
			    if (!rn2(10)) (void)mongets(mtmp, ELVEN_MITHRIL_COAT);
				else if (!rn2(2)) (void)mongets(mtmp, LEATHER_ARMOR);
				if (!rn2(10)) (void)mongets(mtmp, DWARVISH_CLOAK);
		} else switch(mm) {
          /* Mind flayers get robes */
          case PM_MIND_FLAYER:
            if (!rn2(2)) (void)mongets(mtmp, ROBE);

            break;
          case PM_GITHYANKI_PIRATE:
            (void)mongets(mtmp, SCIMITAR);

            break;
          case PM_ANUBITE:
            (void)mongets(mtmp, TRIDENT);
            (void)mongets(mtmp, RING_MAIL);

            break;
          case PM_MASTER_MIND_FLAYER:

            if (!rn2(10)) (void)mongets(mtmp, ROBE_OF_PROTECTION);
			else if (!rn2(10)) (void)mongets(mtmp, ROBE_OF_POWER);
			else (void)mongets(mtmp, ROBE);
            break;
		  case PM_GNOLL:
			if (!rn2(2)) switch (rn2(3)) {
				case 0: (void)mongets(mtmp, BARDICHE); break;
				case 1: (void)mongets(mtmp, VOULGE); break;
				case 2: (void)mongets(mtmp, HALBERD); break;
			}
			if (!rn2(2)) (void)mongets(mtmp, LEATHER_ARMOR);
			break;
          default:
	          break;                     
		}
		break;
	    case S_KOP:		/* create Keystone Kops with cream pies to
				 * throw. As suggested by KAA.	   [MRS]
				 */
		if (!rn2(4)) m_initthrow(mtmp, CREAM_PIE, 2);
		if (!rn2(3)) (void)mongets(mtmp,(rn2(2)) ? CLUB : RUBBER_HOSE);
		if (!rn2(500)) (void)mongets(mtmp, nastymusableitem() );

		if (ptr == &mons[PM_KOLDIER]) {
			  if (rn2(2)) {
				(void) mongets(mtmp, RIFLE);
		 		m_initthrow(mtmp, RIFLE_BULLET, 25);
		 		m_initthrow(mtmp, RIFLE_BULLET, 25);
			  } else {
				(void) mongets(mtmp, SUBMACHINE_GUN);
		 		m_initthrow(mtmp, SMG_BULLET, 25);
		 		m_initthrow(mtmp, SMG_BULLET, 25);
			  }
			(void)mongets(mtmp, (rn2(2)) ? KNIFE : DAGGER);
			  if (rn2(2)) (void) mongets(mtmp, FRAG_GRENADE);
		}

		if (ptr == &mons[PM_KOG]) {
			  if (rn2(2)) {
				(void) mongets(mtmp, RIFLE);
		 		m_initthrow(mtmp, RIFLE_BULLET, 25);
		 		m_initthrow(mtmp, RIFLE_BULLET, 25);
			  } else {
				(void) mongets(mtmp, SUBMACHINE_GUN);
		 		m_initthrow(mtmp, SMG_BULLET, 25);
		 		m_initthrow(mtmp, SMG_BULLET, 25);
			  }
			(void)mongets(mtmp, (rn2(2)) ? KNIFE : DAGGER);
			  if (rn2(2)) (void) mongets(mtmp, FRAG_GRENADE);
			(void)mongets(mtmp, (!rn2(3)) ? RING_MAIL : rn2(2) ? CHAIN_MAIL : SPLINT_MAIL);
			(void)mongets(mtmp, HELMET);
			if (!rn2(3)) (void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, rn2(2) ? LOW_BOOTS : HIGH_BOOTS);
			(void)mongets(mtmp, SMALL_SHIELD);
		}

		if (ptr == &mons[PM_WATCH_KOP]) {
			if (!rn2(2)) (void)mongets(mtmp, rn2(20) ? rnd_class(PARTISAN,BEC_DE_CORBIN) : GRINDER);
			(void)mongets(mtmp, (rn2(2)) ? KNIFE : DAGGER);
			if (!rn2(2)) (void)mongets(mtmp, (rn2(2)) ? SPEAR : SHORT_SWORD);
		}
		if (ptr == &mons[PM_KATCHMAN]) {
			if (!rn2(2)) (void)mongets(mtmp, rn2(20) ? rnd_class(PARTISAN,BEC_DE_CORBIN) : GRINDER);
			(void)mongets(mtmp, (rn2(2)) ? KNIFE : DAGGER);
			if (!rn2(2)) (void)mongets(mtmp, (rn2(2)) ? SPEAR : SHORT_SWORD);
			(void)mongets(mtmp, (!rn2(3)) ? RING_MAIL : rn2(2) ? CHAIN_MAIL : SPLINT_MAIL);
			(void)mongets(mtmp, HELMET);
			if (!rn2(3)) (void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, rn2(2) ? LOW_BOOTS : HIGH_BOOTS);
			(void)mongets(mtmp, SMALL_SHIELD);
		}

		if (ptr == &mons[PM_WATCH_KAPTAIN]) {
			(void)mongets(mtmp, (rn2(2)) ? LONG_SWORD : SILVER_SABER);
		}

		if (ptr == &mons[PM_KATCHTAIN]) {
			(void)mongets(mtmp, (rn2(2)) ? LONG_SWORD : SILVER_SABER);
			(void)mongets(mtmp, (!rn2(3)) ? RING_MAIL : rn2(2) ? CHAIN_MAIL : SPLINT_MAIL);
			(void)mongets(mtmp, HELMET);
			if (!rn2(3)) (void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, rn2(2) ? LOW_BOOTS : HIGH_BOOTS);
			(void)mongets(mtmp, SMALL_SHIELD);
		}

		if (ptr == &mons[PM_BLACK_KOPETEER]) {
			(void)mongets(mtmp, TWO_HANDED_SWORD);
		}
		if (ptr == &mons[PM_PITCH_KOPETEER]) {
			(void)mongets(mtmp, TWO_HANDED_SWORD);
			(void)mongets(mtmp, (!rn2(3)) ? RING_MAIL : rn2(2) ? CHAIN_MAIL : SPLINT_MAIL);
			(void)mongets(mtmp, HELMET);
			if (!rn2(3)) (void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, rn2(2) ? LOW_BOOTS : HIGH_BOOTS);
			(void)mongets(mtmp, SMALL_SHIELD);
		}

		if (ptr == &mons[PM_WATCH_KIEUTENANT]) {
			(void)mongets(mtmp, (rn2(2)) ? LONG_SWORD : SILVER_SABER);
		}
		if (ptr == &mons[PM_KATCHENANT]) {
			(void)mongets(mtmp, (rn2(2)) ? LONG_SWORD : SILVER_SABER);
			(void)mongets(mtmp, (!rn2(3)) ? RING_MAIL : rn2(2) ? CHAIN_MAIL : SPLINT_MAIL);
			(void)mongets(mtmp, HELMET);
			if (!rn2(3)) (void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, rn2(2) ? LOW_BOOTS : HIGH_BOOTS);
			(void)mongets(mtmp, SMALL_SHIELD);
		}

		if (ptr == &mons[PM_KOPKEEPER]) {
			(void)mongets(mtmp, (rn2(2)) ? SHOTGUN : SAWED_OFF_SHOTGUN);
			m_initthrow(mtmp, SHOTGUN_SHELL, 30);
		}
		if (ptr == &mons[PM_SHKOP]) {
			(void)mongets(mtmp, (rn2(2)) ? SHOTGUN : SAWED_OFF_SHOTGUN);
			m_initthrow(mtmp, SHOTGUN_SHELL, 30);
			(void)mongets(mtmp, (!rn2(3)) ? RING_MAIL : rn2(2) ? CHAIN_MAIL : SPLINT_MAIL);
			(void)mongets(mtmp, HELMET);
			if (!rn2(3)) (void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, rn2(2) ? LOW_BOOTS : HIGH_BOOTS);
			(void)mongets(mtmp, SMALL_SHIELD);
		}

		if (ptr == &mons[PM_WATCH_KEADER]) {
			(void)mongets(mtmp, (rn2(2)) ? LONG_SWORD : SILVER_SABER);
		}
		if (ptr == &mons[PM_KEEYOP]) {
			(void)mongets(mtmp, (rn2(2)) ? LONG_SWORD : SILVER_SABER);
			(void)mongets(mtmp, (!rn2(3)) ? RING_MAIL : rn2(2) ? CHAIN_MAIL : SPLINT_MAIL);
			(void)mongets(mtmp, HELMET);
			if (!rn2(3)) (void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, rn2(2) ? LOW_BOOTS : HIGH_BOOTS);
			(void)mongets(mtmp, SMALL_SHIELD);
		}

		if (ptr == &mons[PM_KIEUTENANT]) {

			  if (rn2(2)) {
				(void) mongets(mtmp, HEAVY_MACHINE_GUN);
		 		m_initthrow(mtmp, MG_BULLET, 30);
		 		m_initthrow(mtmp, MG_BULLET, 30);
		 		if (!rn2(2)) m_initthrow(mtmp, MG_BULLET, 50);
		 		if (!rn2(5)) m_initthrow(mtmp, MG_BULLET, 50);
			  } else {
				(void) mongets(mtmp, SUBMACHINE_GUN);
		 		m_initthrow(mtmp, SMG_BULLET, 30);
		 		m_initthrow(mtmp, SMG_BULLET, 30);
		 		if (!rn2(2)) m_initthrow(mtmp, SMG_BULLET, 50);
		 		if (!rn2(5)) m_initthrow(mtmp, SMG_BULLET, 50);
			  }

			(void)mongets(mtmp, (rn2(2)) ? KNIFE : DAGGER);
			if (rn2(2)) (void) mongets(mtmp, (rn2(2)) ? GAS_GRENADE : FRAG_GRENADE);
		}
		if (ptr == &mons[PM_KOPPENANT]) {
			  if (rn2(2)) {
				(void) mongets(mtmp, HEAVY_MACHINE_GUN);
		 		m_initthrow(mtmp, MG_BULLET, 30);
		 		m_initthrow(mtmp, MG_BULLET, 30);
		 		if (!rn2(2)) m_initthrow(mtmp, MG_BULLET, 50);
		 		if (!rn2(5)) m_initthrow(mtmp, MG_BULLET, 50);
			  } else {
				(void) mongets(mtmp, SUBMACHINE_GUN);
		 		m_initthrow(mtmp, SMG_BULLET, 30);
		 		m_initthrow(mtmp, SMG_BULLET, 30);
		 		if (!rn2(2)) m_initthrow(mtmp, SMG_BULLET, 50);
		 		if (!rn2(5)) m_initthrow(mtmp, SMG_BULLET, 50);
			  }
			(void)mongets(mtmp, (rn2(2)) ? KNIFE : DAGGER);
			if (rn2(2)) (void) mongets(mtmp, (rn2(2)) ? GAS_GRENADE : FRAG_GRENADE);
			(void)mongets(mtmp, (!rn2(3)) ? RING_MAIL : rn2(2) ? CHAIN_MAIL : SPLINT_MAIL);
			(void)mongets(mtmp, HELMET);
			if (!rn2(3)) (void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, rn2(2) ? LOW_BOOTS : HIGH_BOOTS);
			(void)mongets(mtmp, SMALL_SHIELD);
		}

		if (ptr == &mons[PM_KERGEANT]) {
			if (rn2(2)) {
				(void)mongets(mtmp, AUTO_SHOTGUN);
				m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 10);
				m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 10);
			} else {
				(void)mongets(mtmp, ASSAULT_RIFLE);
				m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 30);
				m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 30);
			}
			(void)mongets(mtmp, (rn2(2)) ? KNIFE : DAGGER);
			if (!rn2(3)) {
				(void) mongets(mtmp, (rn2(2)) ? GAS_GRENADE : FRAG_GRENADE);
				if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			}
		}
		if (ptr == &mons[PM_KOPANT]) {
			if (rn2(2)) {
				(void)mongets(mtmp, AUTO_SHOTGUN);
				m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 10);
				m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 10);
			} else {
				(void)mongets(mtmp, ASSAULT_RIFLE);
				m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 30);
				m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 30);
			}
			(void)mongets(mtmp, (rn2(2)) ? KNIFE : DAGGER);
			if (!rn2(3)) {
				(void) mongets(mtmp, (rn2(2)) ? GAS_GRENADE : FRAG_GRENADE);
				if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			}
			(void)mongets(mtmp, (!rn2(3)) ? RING_MAIL : rn2(2) ? CHAIN_MAIL : SPLINT_MAIL);
			(void)mongets(mtmp, HELMET);
			if (!rn2(3)) (void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, rn2(2) ? LOW_BOOTS : HIGH_BOOTS);
			(void)mongets(mtmp, SMALL_SHIELD);
		}

		if (ptr == &mons[PM_KAPTAIN]) {
			if (rn2(2)) {
				(void)mongets(mtmp, AUTO_SHOTGUN);
				m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 20);
				m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 20);
			} else if (rn2(2)) {
				(void)mongets(mtmp, HEAVY_MACHINE_GUN);
				m_initthrow(mtmp, MG_BULLET, 60);
				m_initthrow(mtmp, MG_BULLET, 60);
				m_initthrow(mtmp, MG_BULLET, 60);
			} else {
				(void)mongets(mtmp, ASSAULT_RIFLE);
				m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 60);
				m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 60);
			}
			if (rn2(2)) {
				(void)mongets(mtmp, ROCKET_LAUNCHER);
				m_initthrow(mtmp, ROCKET, 5);
			}
			(void)mongets(mtmp, (rn2(2)) ? SILVER_SABER : DAGGER);
			if (!rn2(3)) {
				(void) mongets(mtmp, (rn2(2)) ? GAS_GRENADE : FRAG_GRENADE);
				if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			}

		}
		if (ptr == &mons[PM_KOPTEN]) {
			if (rn2(2)) {
				(void)mongets(mtmp, AUTO_SHOTGUN);
				m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 20);
				m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 20);
			} else if (rn2(2)) {
				(void)mongets(mtmp, HEAVY_MACHINE_GUN);
				m_initthrow(mtmp, MG_BULLET, 60);
				m_initthrow(mtmp, MG_BULLET, 60);
				m_initthrow(mtmp, MG_BULLET, 60);
			} else {
				(void)mongets(mtmp, ASSAULT_RIFLE);
				m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 60);
				m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 60);
			}
			if (rn2(2)) {
				(void)mongets(mtmp, ROCKET_LAUNCHER);
				m_initthrow(mtmp, ROCKET, 5);
			}
			(void)mongets(mtmp, (rn2(2)) ? SILVER_SABER : DAGGER);
			if (!rn2(3)) {
				(void) mongets(mtmp, (rn2(2)) ? GAS_GRENADE : FRAG_GRENADE);
				if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			}
			(void)mongets(mtmp, (!rn2(3)) ? RING_MAIL : rn2(2) ? CHAIN_MAIL : SPLINT_MAIL);
			(void)mongets(mtmp, HELMET);
			if (!rn2(3)) (void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, rn2(2) ? LOW_BOOTS : HIGH_BOOTS);
			(void)mongets(mtmp, SMALL_SHIELD);

		}

		if (ptr == &mons[PM_KENERAL]) {
			if (rn2(2)) {
				(void)mongets(mtmp, AUTO_SHOTGUN);
				m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 20);
				m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 20);
			} else if (rn2(2)) {
				(void)mongets(mtmp, HEAVY_MACHINE_GUN);
				m_initthrow(mtmp, MG_BULLET, 60);
				m_initthrow(mtmp, MG_BULLET, 60);
				m_initthrow(mtmp, MG_BULLET, 60);
			} else {
				(void)mongets(mtmp, ASSAULT_RIFLE);
				m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 60);
				m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 60);
			}
			if (rn2(2)) {
				(void)mongets(mtmp, ROCKET_LAUNCHER);
				m_initthrow(mtmp, ROCKET, 5);
			}
			(void)mongets(mtmp, (rn2(2)) ? SILVER_SABER : DAGGER);
			if (!rn2(3)) {
				(void) mongets(mtmp, (rn2(2)) ? GAS_GRENADE : FRAG_GRENADE);
				if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			}

		}
		if (ptr == &mons[PM_KENEROP]) {
			if (rn2(2)) {
				(void)mongets(mtmp, AUTO_SHOTGUN);
				m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 20);
				m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 20);
			} else if (rn2(2)) {
				(void)mongets(mtmp, HEAVY_MACHINE_GUN);
				m_initthrow(mtmp, MG_BULLET, 60);
				m_initthrow(mtmp, MG_BULLET, 60);
				m_initthrow(mtmp, MG_BULLET, 60);
			} else {
				(void)mongets(mtmp, ASSAULT_RIFLE);
				m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 60);
				m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 60);
			}
			if (rn2(2)) {
				(void)mongets(mtmp, ROCKET_LAUNCHER);
				m_initthrow(mtmp, ROCKET, 5);
			}
			(void)mongets(mtmp, (rn2(2)) ? SILVER_SABER : DAGGER);
			if (!rn2(3)) {
				(void) mongets(mtmp, (rn2(2)) ? GAS_GRENADE : FRAG_GRENADE);
				if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			}
			(void)mongets(mtmp, (!rn2(3)) ? RING_MAIL : rn2(2) ? CHAIN_MAIL : SPLINT_MAIL);
			(void)mongets(mtmp, HELMET);
			if (!rn2(3)) (void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, rn2(2) ? LOW_BOOTS : HIGH_BOOTS);
			(void)mongets(mtmp, SMALL_SHIELD);

		}

		if (ptr == &mons[PM_KARNEL]) {
			if (rn2(2)) {
				(void)mongets(mtmp, ARM_BLASTER);
				m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
				m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
			} else if (rn2(2)) {
				(void)mongets(mtmp, BFG);
				m_initthrow(mtmp, BFG_AMMO, 60);
				m_initthrow(mtmp, BFG_AMMO, 60);
				m_initthrow(mtmp, BFG_AMMO, 60);
			} else {
				(void)mongets(mtmp, RAYGUN);
				m_initthrow(mtmp, RAYGUN_BOLT, 60);
				m_initthrow(mtmp, RAYGUN_BOLT, 60);
			}
			if (rn2(2)) {
				(void)mongets(mtmp, ROCKET_LAUNCHER);
				m_initthrow(mtmp, ROCKET, 5);
				m_initthrow(mtmp, ROCKET, 5);
			}
			(void)mongets(mtmp, (rn2(2)) ? SILVER_LONG_SWORD : COLLUSION_KNIFE);
			if (!rn2(3)) {
				(void) mongets(mtmp, (rn2(2)) ? GAS_GRENADE : FRAG_GRENADE);
				(void) mongets(mtmp, (rn2(2)) ? GAS_GRENADE : FRAG_GRENADE);
				(void) mongets(mtmp, (rn2(2)) ? GAS_GRENADE : FRAG_GRENADE);
				if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			}

		}
		if (ptr == &mons[PM_KOPNEL]) {
			if (rn2(2)) {
				(void)mongets(mtmp, ARM_BLASTER);
				m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
				m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
			} else if (rn2(2)) {
				(void)mongets(mtmp, BFG);
				m_initthrow(mtmp, BFG_AMMO, 60);
				m_initthrow(mtmp, BFG_AMMO, 60);
				m_initthrow(mtmp, BFG_AMMO, 60);
			} else {
				(void)mongets(mtmp, RAYGUN);
				m_initthrow(mtmp, RAYGUN_BOLT, 60);
				m_initthrow(mtmp, RAYGUN_BOLT, 60);
			}
			if (rn2(2)) {
				(void)mongets(mtmp, ROCKET_LAUNCHER);
				m_initthrow(mtmp, ROCKET, 5);
				m_initthrow(mtmp, ROCKET, 5);
			}
			(void)mongets(mtmp, (rn2(2)) ? SILVER_LONG_SWORD : COLLUSION_KNIFE);
			if (!rn2(3)) {
				(void) mongets(mtmp, (rn2(2)) ? GAS_GRENADE : FRAG_GRENADE);
				(void) mongets(mtmp, (rn2(2)) ? GAS_GRENADE : FRAG_GRENADE);
				(void) mongets(mtmp, (rn2(2)) ? GAS_GRENADE : FRAG_GRENADE);
				if (!rn2(5)) (void) mongets(mtmp, GRENADE_LAUNCHER);
			}
			(void)mongets(mtmp, (!rn2(3)) ? RING_MAIL : rn2(2) ? CHAIN_MAIL : SPLINT_MAIL);
			(void)mongets(mtmp, HELMET);
			if (!rn2(3)) (void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, rn2(2) ? LOW_BOOTS : HIGH_BOOTS);
			(void)mongets(mtmp, SMALL_SHIELD);

		}

		break;
	    case S_ORC:

		if (ptr == &mons[PM_DEPRAVED_ORC]) (void) mongets(mtmp, WAN_CANCELLATION);

                /* All orcs will get at least an orcish dagger*/
		if(rn2(2)) (void)mongets(mtmp, ORCISH_HELM);
		switch (mm != PM_ORC_CAPTAIN ? mm :
			rn2(2) ? PM_MORDOR_ORC : PM_URUK_HAI) {
		    case PM_MORDOR_ORC:
			if(!rn2(3)) (void)mongets(mtmp, SCIMITAR);
                            else if (rn2(2)) (void)mongets(mtmp, ORCISH_DAGGER);
			if(!rn2(3)) (void)mongets(mtmp, ORCISH_SHIELD);
			if(!rn2(3)) (void)mongets(mtmp, KNIFE);
                        /* WAC add possible orcish spear */
                        if (!rn2(4)) m_initthrow(mtmp, ORCISH_SPEAR, 1);
			if(!rn2(3)) (void)mongets(mtmp, KNIFE);
			if(!rn2(3)) (void)mongets(mtmp, ORCISH_CHAIN_MAIL);
			break;
		    case PM_URUK_HAI:
			if(!rn2(3)) (void)mongets(mtmp, ORCISH_CLOAK);
			if(!rn2(3)) (void)mongets(mtmp, ORCISH_SHORT_SWORD);
                            else if (rn2(2)) (void)mongets(mtmp, ORCISH_DAGGER);
			if(!rn2(3)) (void)mongets(mtmp, IRON_SHOES);
			if(!rn2(3)) {
			    (void)mongets(mtmp, ORCISH_BOW);
			    m_initthrow(mtmp, ORCISH_ARROW, 35);
			}
			if(!rn2(3)) (void)mongets(mtmp, URUK_HAI_SHIELD);
			break;
                    case PM_GOBLIN:
                        if(!rn2(3)) (void)mongets(mtmp, ORCISH_SHORT_SWORD);
                            else if (rn2(2)) (void)mongets(mtmp, ORCISH_DAGGER);
			break;
                    case PM_GOBLIN_COP:
				(void)mongets(mtmp, RUBBER_HOSE);
				m_initthrow(mtmp, CREAM_PIE, 2);
			break;
                    case PM_SUPERCOP:
				(void)mongets(mtmp, RUBBER_HOSE);
				m_initthrow(mtmp, CREAM_PIE, 2);
			break;
                    case PM_HOBGOBLIN:
                        if(!rn2(3)) (void)mongets(mtmp, MORNING_STAR);
                            else if(!rn2(3)) (void)mongets(mtmp, ORCISH_SHORT_SWORD);
                            else if (rn2(2)) (void)mongets(mtmp, ORCISH_DAGGER);
			break;
		    default:
			if (mm != PM_ORC_SHAMAN && rn2(2)) 
                          (void)mongets(mtmp, (rn2(2) == 0) ? ORCISH_DAGGER : SCIMITAR);
		}
		break;
	    case S_OGRE:

		if(ptr == &mons[PM_WINE_VILLAGE_OGRE]) (void) mongets(mtmp, POT_CONFUSION);
		if(ptr == &mons[PM_ALEXIA_S_PLATEAU_SNEAKER]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

		if(ptr == &mons[PM_HUGE_OGRE_THIEF]) { (void) mongets(mtmp, MIRROR); (void) mongets(mtmp, MIRROR); }

		if (!rn2(mm == PM_OGRE_KING ? 3 : mm == PM_OGRE_LORD ? 6 : 12))
			/* level 0 ogres with battle-axes are insanely OP :P --Amy */
		    (void) mongets(mtmp, ptr->mlevel >= 4 ? BATTLE_AXE : CLUB);
		else
		    (void) mongets(mtmp, CLUB);
		break;
	    case S_KOBOLD:

			if(ptr == &mons[PM_KOBOLD_ARCHER] || ptr == &mons[PM_ENRAGED_SHAMAN] || ptr == &mons[PM_DEMENTED_SHAMAN] || ptr == &mons[PM_DERANGED_SHAMAN] || ptr == &mons[PM_DEPRAVED_SHAMAN] || ptr == &mons[PM_TELEPORTED_SHAMAN]) { (void) mongets(mtmp, BOW); m_initthrow(mtmp, ARROW, 30);}

			if (ptr == &mons[PM_KOBOLD_GUNMAN]) {
				(void) mongets(mtmp, FLINTLOCK);
		  		m_initthrow(mtmp, PISTOL_BULLET, 20);
			}
			if (ptr == &mons[PM_PEWSOUNDER]) {
				(void) mongets(mtmp, CROSSBOW);
		  		m_initthrow(mtmp, CROSSBOW_BOLT, 40);
			}
			if (ptr == &mons[PM_VULGOBOLD]) {
				(void) mongets(mtmp, VOULGE);
			}
			if (ptr == &mons[PM_SPIKEFLIER]) {
		  		m_initthrow(mtmp, SPIKE, 40);
			}
			if (ptr == &mons[PM_KOBOLD_ROCKER]) {
				(void) mongets(mtmp, SLING);
		  		m_initthrow(mtmp, ROCK, 30);
			}
			if (ptr == &mons[PM_KOBOLD_ROXXOR]) {
				(void) mongets(mtmp, SLING);
		  		m_initthrow(mtmp, FLINT, 40);
			}
			if (ptr == &mons[PM_WOA_R]) {
				(void) mongets(mtmp, BOW);
		  		m_initthrow(mtmp, ARROW, 30);
				(void) mongets(mtmp, TWO_HANDED_SWORD);
				(void) mongets(mtmp, CHAIN_MAIL);
				(void) mongets(mtmp, DWARVISH_CLOAK);
				(void) mongets(mtmp, DENTED_POT);
				(void) mongets(mtmp, SNEAKERS);
			}

			if(ptr == &mons[PM_KOBOLD_DIGGER]) (void) mongets(mtmp, WAN_DIGGING);
			if(ptr == &mons[PM_KOBOLD_ALCHEMIST]) (void) mongets(mtmp, POT_CYANIDE);
			if(ptr == &mons[PM_INSANE_KOBOLD]) (void) mongets(mtmp, WAN_STONING);
			if(ptr == &mons[PM_DISINTEGRATION_KOBOLD]) m_initthrow(mtmp, DART_OF_DISINTEGRATION, 20);
			if(ptr == &mons[PM_DRILLING_KOBOLD]) m_initthrow(mtmp, DART_OF_DISINTEGRATION, 30);
			if(ptr == &mons[PM_DISINTEGRATION_MASTER]) m_initthrow(mtmp, DART_OF_DISINTEGRATION, 50);

			if(ptr == &mons[PM_KNIFOLD]) m_initthrow(mtmp, KNIFE, 4);
			if(ptr == &mons[PM_UNKNIFOLD]) m_initthrow(mtmp, UNKNOWN_KNIFE, 4);
			if(ptr == &mons[PM_HOLIDAY_KOBOLD]) m_initthrow(mtmp, STACK_JAVELIN, 3);
			if(ptr == &mons[PM_RAPOLD]) (void) mongets(mtmp, RAPIER);
			if(ptr == &mons[PM_JAVOLD]) (void) mongets(mtmp, JAVELIN);
			if(ptr == &mons[PM_STACKOLD]) (void) mongets(mtmp, STACK_JAVELIN);
			if(ptr == &mons[PM_BARBOLD]) (void) mongets(mtmp, BARDICHE);

			if (ptr == &mons[PM_CROSS_KOBOLD]) {
				(void) mongets(mtmp, CROSSBOW);
		  		m_initthrow(mtmp, CROSSBOW_BOLT, 45);
			}
			if (ptr == &mons[PM_KOBOLD_ARROWHAILER]) {
				(void) mongets(mtmp, COMPOST_BOW);
		  		m_initthrow(mtmp, FORBIDDEN_ARROW, 40);
			}
			if (ptr == &mons[PM_KOBOLD_PEPPERMASTER]) {
				(void) mongets(mtmp, ORCISH_BOW);
		  		m_initthrow(mtmp, ORCISH_ARROW, 50);
		  		m_initthrow(mtmp, ORCISH_ARROW, 50);
		  		m_initthrow(mtmp, ORCISH_ARROW, 50);
			}
			if (ptr == &mons[PM_KOBOLD_PHAZER]) {
				(void) mongets(mtmp, PROCESS_CARD);
		  		m_initthrow(mtmp, RADIO, 50);
			}

			if (ptr == &mons[PM_SHIBOLD]) {
				(void) mongets(mtmp, SMALL_SHIELD);
				(void) mongets(mtmp, RUBBER_HOSE);
			}

			if (ptr == &mons[PM_HELMOLD]) {
				(void) mongets(mtmp, ORCISH_HELM);
				(void) mongets(mtmp, WAR_HAMMER);
			}
			if (ptr == &mons[PM_JAVA_KOBOLD]) {
		  		m_initthrow(mtmp, JAVELIN, 3);
			}
			if (ptr == &mons[PM_BROAD_KOBOLD]) {
				(void) mongets(mtmp, BROADSWORD);
			}
			if (ptr == &mons[PM_WIDE_KOBOLD]) {
				(void) mongets(mtmp, ELEGANT_BROADSWORD);
			}
			if (ptr == &mons[PM_AXOLD]) {
				(void) mongets(mtmp, AXE);
			}
			if (ptr == &mons[PM_AKKOLD]) {
				(void) mongets(mtmp, AKLYS);
			}
			if (ptr == &mons[PM_BLOWOLD]) {
				(void) mongets(mtmp, BLOW_AKLYS);
			}
			if (ptr == &mons[PM_BRONZE_KOBOLD]) {
				(void) mongets(mtmp, BRONZE_MACE);
			}
			if (ptr == &mons[PM_STAR_KOBOLD]) {
				(void) mongets(mtmp, MORNING_STAR);
			}

			if (ptr == &mons[PM_KOBOLD_SPELLSWINGER]) {
				(void) mongets(mtmp, ORCISH_HELM);
				(void) mongets(mtmp, QUARTERSTAFF);
			}

			if (ptr == &mons[PM_BOLD]) {
				(void) mongets(mtmp, BOW);
				(void) mongets(mtmp, HELMET);
		  		m_initthrow(mtmp, ARROW, 50);
			}

			if (ptr == &mons[PM_KOBOLD_BARLORD]) {
				(void) mongets(mtmp, ORCISH_CLOAK);
				(void) mongets(mtmp, LANCE);
				(void) mongets(mtmp, ANTENNA);
				(void) mongets(mtmp, GAUNTLETS);
				(void) mongets(mtmp, FIELD_BOOTS);
				(void) mongets(mtmp, BILL_GUISARME);
			}

                /* WAC gets orcish 1:4, otherwise darts
                        (used to be darts 1:4)
                   gets orcish short sword 1:4, otherwise orcish dagger */
                if (!rn2(4)) m_initthrow(mtmp, ORCISH_SPEAR, 1);
                   else if (rn2(2)) m_initthrow(mtmp, rn2(500) ? DART : DART_OF_DISINTEGRATION, 30);
                if (!rn2(4)) mongets(mtmp, ORCISH_SHORT_SWORD);
                   else if (rn2(2)) mongets(mtmp, ORCISH_DAGGER);
		break;

	    case S_CENTAUR:

		/* low-level ones would brutally murder you if they had a crossbow... gotta fix that --Amy */
		if (rn2(2) && ptr->mlevel >= 4) {
		    if(ptr == &mons[PM_FOREST_CENTAUR]) {
			(void)mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 35);
		    } else {
			(void)mongets(mtmp, CROSSBOW);
			m_initthrow(mtmp, CROSSBOW_BOLT, 50);
		    }
		}

		if (ptr == &mons[PM_CHESTAUR]) {
			(void) mongets(mtmp, CROSSBOW);
			m_initthrow(mtmp, CROSSBOW_BOLT, 50);
		}
		if (ptr == &mons[PM_BAUR]) {
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 35);
		}
		if (ptr == &mons[PM_KENTAURS]) {
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 35);
		}
		if (ptr == &mons[PM_KENTAURS_KNIGHT]) {
			(void) mongets(mtmp, SLING);
			m_initthrow(mtmp, ROCK, 50);
			m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_GUNNTAURS]) {
			(void) mongets(mtmp, PISTOL);
			m_initthrow(mtmp, PISTOL_BULLET, 50);
		}
		if (ptr == &mons[PM_FLINGAUR]) {
			(void) mongets(mtmp, BOW);
			(void) mongets(mtmp, ORCISH_HELM);
			m_initthrow(mtmp, ARROW, 35);
		}

		if (ptr == &mons[PM_SPEAUR]) {
			(void) mongets(mtmp, SPEAR);
			(void) mongets(mtmp, ORCISH_HELM);
			m_initthrow(mtmp, SPEAR, 5);
		}

		if (ptr == &mons[PM_LANAUR]) {
			(void) mongets(mtmp, LANCE);
			(void) mongets(mtmp, ORCISH_HELM);
		}

		if (ptr == &mons[PM_JAVAUR]) {
			(void) mongets(mtmp, JAVELIN);
			(void) mongets(mtmp, ORCISH_HELM);
			m_initthrow(mtmp, JAVELIN, 5);
		}

		if (ptr == &mons[PM_CENTAUR_PWNZ_R]) {
			(void) mongets(mtmp, SUBMACHINE_GUN);
			(void) mongets(mtmp, HELMET);
			m_initthrow(mtmp, SMG_BULLET, 50);
			m_initthrow(mtmp, SMG_BULLET, 50);
		}

		if (ptr == &mons[PM_CENTAUR_CH_AT_R]) {
			(void) mongets(mtmp, RAYGUN);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, HIGH_BOOTS);
			(void) mongets(mtmp, LEATHER_GLOVES);
			(void) mongets(mtmp, TWO_HANDED_SWORD);
			m_initthrow(mtmp, RAYGUN_BOLT, 50);
			m_initthrow(mtmp, RAYGUN_BOLT, 50);
		}

		if (ptr == &mons[PM_ALIG]) {
			(void) mongets(mtmp, HUGGING_BOOT);
			(void) mongets(mtmp, ORCISH_HELM);
			m_initthrow(mtmp, SHURIKEN, 50);
		}

		if (ptr == &mons[PM_LEOCENTAUR_STABBER]) {
			(void) mongets(mtmp, KNIFE);
			(void) mongets(mtmp, ORCISH_HELM);
			m_initthrow(mtmp, DAGGER, 5);
		}
		if (ptr == &mons[PM_LEOCENTAUR_SPECCOR]) {
			(void) mongets(mtmp, UNKNOWN_KNIFE);
			(void) mongets(mtmp, BASINET);
			(void) mongets(mtmp, GAUNTLETS_OF_PLUGSUIT);
			(void) mongets(mtmp, LOW_BOOTS);
			m_initthrow(mtmp, WONDER_DAGGER, 5);
		}

		break;
	    case S_UMBER:

		if(ptr == &mons[PM_HEADLESS_BRUTE]) { (void) mongets(mtmp, AXE); (void) mongets(mtmp, SMALL_SHIELD); }
		if(ptr == &mons[PM_DECAPITATED_DEFILER]) { (void) mongets(mtmp, AXE); (void) mongets(mtmp, SMALL_SHIELD); }

		if(mm == PM_SHOTGUN_HORROR || mm == PM_SHOTGUN_TERROR) { (void)mongets(mtmp, CROSSBOW);
		m_initthrow(mtmp, CROSSBOW_BOLT, 50); m_initthrow(mtmp, CROSSBOW_BOLT, 30);	}
		break;
	    case S_WRAITH:
		(void)mongets(mtmp, KNIFE);
		/* make long sword less common and prevent it at very low levels to protect low-HP starting chars --Amy */
		if (ptr->mlevel >= 3 && !rn2(2)) (void)mongets(mtmp, LONG_SWORD);

		if(mm == PM_BARROW_WARRIOR) {
			(void)mongets(mtmp, PICK_AXE);
			(void)mongets(mtmp, SCR_GRAVE);
			(void)mongets(mtmp, WAN_DIGGING);
		}
		if(mm == PM_GRAVE_WARRIOR) {
			(void)mongets(mtmp, PICK_AXE);
			(void)mongets(mtmp, WAN_DIGGING);
		}
		break;
	    case S_ZOMBIE:

		if(ptr == &mons[PM_SKELETON_ARCHER] || ptr == &mons[PM_ARCHER] || ptr == &mons[PM_NECRO_ARCHER] || ptr == &mons[PM_CORPSE_ARCHER] || ptr == &mons[PM_HORROR_ARCHER] || ptr == &mons[PM_PELLET_ARCHER] || ptr == &mons[PM_ECM_ARCHER] || ptr == &mons[PM_SCORCHED_ARCHER] || ptr == &mons[PM_ELECTRO_ARCHER] || ptr == &mons[PM_BURNING_ARCHER] || ptr == &mons[PM_BONE_ARCHER] || ptr == &mons[PM_RETURNED_ARCHER] || ptr == &mons[PM_ICE_ARCHER] || ptr == &mons[PM_FLAME_ARCHER] || ptr == &mons[PM_POISONOUS_ARCHER] || ptr == &mons[PM_GATLING_ARCHER] || ptr == &mons[PM_CRYO_ARCHER] || ptr == &mons[PM_SCREAM_ARCHER] || ptr == &mons[PM_STATIC_ARCHER] ) { (void) mongets(mtmp, BOW); m_initthrow(mtmp, ARROW, 30);
		}

		if(ptr == &mons[PM_UNDEAD_TEMPLAR]) { (void) mongets(mtmp, LONG_SWORD); (void) mongets(mtmp, LARGE_SHIELD); }

		if(ptr == &mons[PM_PALE_ASIAN_LADY]) (void) mongets(mtmp, AXE);

		if(ptr == &mons[PM_PIT_ARCHER]) { (void) mongets(mtmp, BOW); m_initthrow(mtmp, ORCISH_ARROW, 30); }
		if(ptr == &mons[PM_DUNGEON_ARCHER]) { (void) mongets(mtmp, BOW); m_initthrow(mtmp, ELVEN_ARROW, 30); }
		if(ptr == &mons[PM_SCORCHING_ARCHER]) { (void) mongets(mtmp, BOW); m_initthrow(mtmp, DARK_ELVEN_ARROW, 30); }

		if(ptr == &mons[PM_FULL_REFUGE] || ptr == &mons[PM_THE_ULTIMATE_REFUGE] || ptr == &mons[PM_REFUGE_UHLERT] || ptr == &mons[PM_MENISMAN] || ptr == &mons[PM_CLEAVED_ZOMBIE]) (void) mongets(mtmp, AXE);

		if (mm == PM_ZOMBIE_PROSTITUTE){
			(void)mongets(mtmp, BULLWHIP);
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		}

		if(ptr == &mons[PM_REFUGE_UHLERT]) (void) mongets(mtmp, BATTLE_AXE);

		if(ptr == &mons[PM_SICKLE_SKELETON] || ptr == &mons[PM_RAGE_SCYTHE] || ptr == &mons[PM_SHADOW_REAPER]) (void) mongets(mtmp, FAUCHARD);

		if(ptr == &mons[PM_POLICE_OFFICER]) (void) mongets(mtmp, SCR_FIRE);

		if(mm == PM_SKELETAL_PIRATE){
		    otmp = rn2(2) ? mksobj(SCIMITAR, FALSE, FALSE, FALSE) : mksobj(KNIFE, FALSE, FALSE, FALSE);
		    curse(otmp);
			otmp->oeroded = 1;
		    (void) mpickobj(mtmp, otmp, TRUE);
			
		    otmp = rn2(2) ? mksobj(HIGH_BOOTS, FALSE, FALSE, FALSE) : mksobj(LEATHER_JACKET, FALSE, FALSE, FALSE);
		    curse(otmp);
			otmp->oeroded2 = 1;
		    (void) mpickobj(mtmp, otmp, TRUE);
			break;
		}
		if (!rn2(4)) (void)mongets(mtmp, LEATHER_ARMOR);
		if (!rn2(4))
			(void)mongets(mtmp, (rn2(3) ? KNIFE : SHORT_SWORD));
		break;
	    case S_LIZARD:
		if (mm == PM_SALAMANDER)
			(void)mongets(mtmp, (rn2(7) ? SPEAR : rn2(3) ?
					     TRIDENT : STILETTO));
		if (mm == PM_POISON_WHIP_SALAMANDER) (void)mongets(mtmp, BULLWHIP);
		if (mm == PM_PARALYSIS_WHIP_SALAMANDER) (void)mongets(mtmp, BULLWHIP);
		if (mm == PM_COLEEN) (void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

		break;
	    case S_TROLL:

		if(ptr == &mons[PM_OGRE_TROLL]) (void) mongets(mtmp, IRON_CHAIN);
		if(ptr == &mons[PM_WAR_TROLL]) (void) mongets(mtmp, IRON_CHAIN);
		if(ptr == &mons[PM_TROLL_GIANT]) (void) mongets(mtmp, ROTATING_CHAIN);
		if(ptr == &mons[PM_OLOG_HAI_BERSERKER]) (void) mongets(mtmp, SCR_ENRAGE);
		if(ptr == &mons[PM_HOLA_HOLA_LANCER]) (void) mongets(mtmp, LANCE);

		if(ptr == &mons[PM_USENET_TROLL]) {
			(void) mongets(mtmp, SCR_TELEPORTATION);
			(void) mongets(mtmp, SCR_HEALING);
			(void) mongets(mtmp, SCR_CREATE_MONSTER);
		}

		if(ptr == &mons[PM_GRENEUVENIC_TOPMODEL]) (void) mongets(mtmp, HUGGING_BOOT);
		if(ptr == &mons[PM_BITCHY_LARA_S_BLOCK_HEELED_BOOT]) (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

		if(ptr == &mons[PM_YVONNE_S_VELVET_PUMP]) {
			(void) mongets(mtmp, SEXY_LEATHER_PUMP);
			(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		}

		if(ptr == &mons[PM_ANNOYING_TROLL]) (void) mongets(mtmp, RANSEUR);
		if(ptr == &mons[PM_OVERSLEPT_TROLL]) (void) mongets(mtmp, HUGGING_BOOT);
		if(ptr == &mons[PM_MEAN_TROLL]) (void) mongets(mtmp, PARTISAN);

		/* very low-level trolls shouldn't have weapons that could two-shot fragile level 1 chars --Amy */
		if (!rn2(2) && ptr->mlevel >= 3) switch (rn2(4)) {
		    case 0: (void)mongets(mtmp, RANSEUR); break;
		    case 1: (void)mongets(mtmp, PARTISAN); break;
		    case 2: (void)mongets(mtmp, GLAIVE); break;
		    case 3: (void)mongets(mtmp, SPETUM); break;
		}
		break;
	    case S_DEMON:

			if(ptr == &mons[PM_BLOODTHIRSTER]) (void) mongets(mtmp, BATTLE_AXE);
			if (mtmp->data == &mons[PM_HC_BRIDE]) (void) mongets(mtmp, LEATHER_PEEP_TOES);

			if(ptr == &mons[PM_CYBERDEMON]) {
			      (void)mongets(mtmp, ROCKET_LAUNCHER);
				m_initthrow(mtmp, ROCKET, 20);
			}
			if(ptr == &mons[PM_ROCKET_FATGUY]) {
			      (void)mongets(mtmp, ROCKET_LAUNCHER);
				m_initthrow(mtmp, ROCKET, 5);
			}

			if(ptr == &mons[PM_OREMORJ__THE_CYBERDEMON_LORD]) {
			      (void)mongets(mtmp, ROCKET_LAUNCHER);
			      (void)mongets(mtmp, ROCKET_LAUNCHER);
			      (void)mongets(mtmp, ROCKET_LAUNCHER);
				m_initthrow(mtmp, ROCKET, 20);
				m_initthrow(mtmp, ROCKET, 20);
				m_initthrow(mtmp, ROCKET, 20);
			}

			if (ptr == &mons[PM_AURORA_BOMBER]) {
				(void) mongets(mtmp, ROCKET_LAUNCHER);
			  	m_initthrow(mtmp, ROCKET, 3);
			}

			if (ptr == &mons[PM_STONE_DEVIL]) {
			  	(void) mongets(mtmp, BOULDER);
			  	(void) mongets(mtmp, BOULDER);
			  	(void) mongets(mtmp, BOULDER);
			  	(void) mongets(mtmp, BOULDER);

			}

			if (ptr == &mons[PM_STONE_DEMON]) { /* evil patch idea by jonadab */

				if (rn2(2)) (void) mongets(mtmp, TSURUGI);

				else {

					struct obj *otmpY = mksobj(CORPSE,TRUE,FALSE, FALSE);

					if (otmpY) {

						otmpY->spe = 0;
						otmpY->quan = 1;
						otmpY->owt = 30;
						otmpY->corpsenm = PM_COCKATRICE;
						start_corpse_timeout(otmpY); /* gotta make sure they time out after a while! --Amy */
						(void) mpickobj(mtmp,otmpY, TRUE);

					}

				}

			}

		switch (mm) {
			case PM_DAMNED_PIRATE:
				otmp = mksobj(SCIMITAR, FALSE, FALSE, FALSE);
				if (otmp) {
					curse(otmp);
					(void) mpickobj(mtmp, otmp, TRUE);
				}
				
				otmp = mksobj(LEATHER_ARMOR, FALSE, FALSE, FALSE);
				if (otmp) {
					curse(otmp);
					otmp->oeroded = 1;
					(void) mpickobj(mtmp, otmp, TRUE);
				}
			break;
		    case PM_BALROG:
			(void)mongets(mtmp, BULLWHIP);
			(void)mongets(mtmp, BROADSWORD);
			break;
		    case PM_ORCUS:
			(void)mongets(mtmp, WAN_DEATH); /* the Wand of Orcus */
			break;
		    case PM_HORNED_DEVIL:
			(void)mongets(mtmp, rn2(4) ? TRIDENT : BULLWHIP);
			break;
		    case PM_DRUG_DEALER:
			(void)mongets(mtmp, POT_RADIUM);
			break;
		    case PM_DISPATER:
			(void)mongets(mtmp, WAN_STRIKING);
			break;
		    case PM_YEENOGHU:
			(void)mongets(mtmp, FLAIL);
			break;
		}
		/* prevent djinnis and mail daemons from leaving objects when
		 * they vanish
		 */
		if (!is_demon(ptr) && mm != PM_DAMNED_PIRATE) break;
		/* fall thru */
/*
 *	Now the general case, Some chance of getting some type
 *	of weapon for "normal" monsters.  Certain special types
 *	of monsters will get a bonus chance or different selections.
 */
	    default:
	      /*m_initweap_normal(mtmp);*/
	      break;
	}

	if (!rn2(3)) m_initweap_normal(mtmp);

	if (!rn2(10)) m_initarmorpieces(mtmp);

	if (!rn2(ishaxor ? 20 : 40) ) (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
	if (!rn2(ishaxor ? 50 : 100) ) (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));

      if ((int) mtmp->m_lev > rn2(500))
		(void) mongets(mtmp, rnd_offensive_item(mtmp));
	if (!rn2(1200)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));

	if (mtmp->data->msound == MS_STENCH && !rn2(20)) {
		(void)mongets(mtmp, WILDHILD_BOW);
		m_initthrow(mtmp, ODOR_SHOT, 50);

	}

	if (mtmp->data->msound == MS_TREESQUAD) {
		(void)mongets(mtmp, rn2(2) ? QUARTERSTAFF : TORCH);
		(void)mongets(mtmp, rn2(2) ? LANCE : PITCHFORK);

	}

	if (attackdamagetype(mtmp->data, AT_GAZE, AD_SPC2) && !rn2(200)) {
		(void) mongets(mtmp, YITH_TENTACLE);
	}
	if (dmgtype(mtmp->data, AD_NAST) && !rn2(500)) {
		(void) mongets(mtmp, NASTYPOLE);
	}

}

#endif /* OVL2 */
#ifdef OVL1

#ifdef GOLDOBJ
/*
 *   Makes up money for monster's inventory.
 *   This will change with silver & copper coins
 */
void 
mkmonmoney(mtmp, amount)
struct monst *mtmp;
long amount;
{
    struct obj *gold = mksobj(GOLD_PIECE, FALSE, FALSE, FALSE);
    if (gold) {
	    gold->quan = amount;
	    add_to_minv(mtmp, gold);
    }
}
#endif

STATIC_OVL void
m_initinv(mtmp)
register struct	monst	*mtmp;
{
	register int cnt;
	register struct obj *otmp;
	register struct permonst *ptr = mtmp->data;
/* 	char *opera_cloak = "opera cloak";*/
	int i;

#ifdef REINCARNATION
	if (Is_rogue_level(&u.uz) && rn2(2) ) return;
#endif

/*
 *	Soldiers get armour & rations - armour approximates their ac.
 *	Nymphs may get mirror or potion of object detection.
 */

	/* Sometimes, monsters might be generated with eggs. --Amy */

	if (!rn2(lays_eggs(mtmp->data) ? 500 : 1000) ) {
		struct obj *otmpB = mksobj(EGG,TRUE,FALSE, FALSE);
		if (otmpB) {
			otmpB->spe = 0;
			if (!rn2(200)) otmpB->spe = 2;
			otmpB->quan = 1;
			while (!rn2(5)) otmpB->quan += 1;
			otmpB->owt = weight(otmpB);
			otmpB->corpsenm = egg_type_from_parent(mtmp->mnum, FALSE);
			attach_egg_hatch_timeout(otmpB);
			mpickobj(mtmp,otmpB, TRUE);
		}
	}

	if (!rn2(5000)) {
		struct obj *otmpC = mksobj(EGG,TRUE,FALSE, FALSE);
		if (otmpC) {
			otmpC->spe = 0;
			if (!rn2(200)) otmpC->spe = 2;
			otmpC->quan = 1;
			while (!rn2(25)) otmpC->quan += 1;
			otmpC->owt = weight(otmpC);
			if (otmpC->corpsenm > NON_PM) attach_egg_hatch_timeout(otmpC);
			mpickobj(mtmp,otmpC, TRUE);
		}
	}

	switch(ptr->mlet) {
	    case S_HUMAN:

		if (monsndx(ptr) == PM_HUMAN_WEREPROSTITUTESHOE) (void)mongets(mtmp, HIPPIE_HEELS);
		if (monsndx(ptr) == PM_HUMAN_WERESEXYLEATHERPUMP) (void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (monsndx(ptr) == PM_HUMAN_WEREWEDGESANDAL) (void)mongets(mtmp, WEDGE_SANDALS);
		if (monsndx(ptr) == PM_HUMAN_WEREUNFAIRSTILETTO) (void)mongets(mtmp, UNFAIR_STILETTOS);
		if (monsndx(ptr) == PM_HUMAN_WEREBEAUTIFULFUNNELHEELEDPUMP) (void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (monsndx(ptr) == PM_HUMAN_WEREPEEPTOE) (void)mongets(mtmp, LEATHER_PEEP_TOES);
		if (monsndx(ptr) == PM_HUMAN_WERECOMBATSTILETTO) (void)mongets(mtmp, COMBAT_STILETTOS);
		if (monsndx(ptr) == PM_HUMAN_WERESTILETTOSANDAL) (void)mongets(mtmp, HIGH_STILETTOS);

		if (ptr == &mons[PM_BOXER]) (void) mongets(mtmp, LARGE_BOX);
		if (ptr == &mons[PM_CHESTER]) (void) mongets(mtmp, CHEST);
		if (ptr == &mons[PM_MURRY_OLD_LADY]) (void) mongets(mtmp, UMBRELLA);
		if (ptr == &mons[PM_SUNBATH_WOMAN]) (void) mongets(mtmp, PARASOL);
		if (ptr == &mons[PM_AMBUSH_ELF]) (void) mongets(mtmp, QATAR);
		if (ptr == &mons[PM_DROW_OCCULTIST]) (void) mongets(mtmp, DROVEN_DAGGER);
		if (ptr == &mons[PM_SICKLY_GRANNY]) (void) mongets(mtmp, TROUTSTAFF);
		if (ptr == &mons[PM_BODYMORPHER]) (void) mongets(mtmp, WAN_POLYMORPH);
		if (ptr == &mons[PM_GIRL_OUTSIDE_GANG]) (void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		if (ptr == &mons[PM_YOUR_SISTER]) (void) mongets(mtmp, SWEET_MOCASSINS);
		if (ptr == &mons[PM_ARMED_MOON_ELF]) (void) mongets(mtmp, MOON_AXE);
		if (ptr == &mons[PM_ARYTOS_CAR]) (void) mongets(mtmp, PICK_AXE);
		if (ptr == &mons[PM_GRUDGING_DARK_RONIN]) (void) mongets(mtmp, OSBANE_KATANA);
		if (ptr == &mons[PM_TANKWIELDER]) (void) mongets(mtmp, BIDENHANDER);
		if (ptr == &mons[PM_STRONG_TANKWIELDER]) (void) mongets(mtmp, BIDENHANDER);
		if (ptr == &mons[PM_NOVICE_FENCER]) (void) mongets(mtmp, LEATHER_SABER);
		if (ptr == &mons[PM_WILD_LADY]) (void) mongets(mtmp, WILD_BLADE);
		if (ptr == &mons[PM_TENNIS_PLAYER]) (void) mongets(mtmp, TENNIS_RACKET);
		if (ptr == &mons[PM_ABUSER]) (void) mongets(mtmp, RIDING_CROP);
		if (ptr == &mons[PM_TOOL_USER]) (void) mongets(mtmp, NOVICE_HAMMER);
		if (ptr == &mons[PM_REGULAR_FISHERMAN]) (void) mongets(mtmp, FISHING_POLE);
		if (ptr == &mons[PM_GRAPPLE_STUNTER]) (void) mongets(mtmp, GRAPPLING_HOOK);
		if (ptr == &mons[PM_CAVE_EXPLORER]) (void) mongets(mtmp, TORCH);
		if (ptr == &mons[PM_COHEN_LEADER]) (void) mongets(mtmp, RAKUYO);
		if (ptr == &mons[PM_VICTIM]) (void) mongets(mtmp, VICTIM_KNIFE);
		if (ptr == &mons[PM_VIOLENT_WOMAN]) (void) mongets(mtmp, MARBLE_CHUNK);
		if (ptr == &mons[PM_HEAVEN_MASTER]) (void) mongets(mtmp, SKY_HORN);
		if (ptr == &mons[PM_NOBLER_WOMAN]) (void) mongets(mtmp, FLEECY_CORSET);
		if (ptr == &mons[PM_BIONDI_BARBARIAN]) (void) mongets(mtmp, GRINDER);
		if (ptr == &mons[PM_ELVEN_CANCERFAG]) (void) mongets(mtmp, CIGARETTE);
		if (ptr == &mons[PM_WOOD_ELVEN_ASSAILANT]) (void) mongets(mtmp, CESTUS);
		if (ptr == &mons[PM_FEMININE_ASSASSIN]) (void) mongets(mtmp, BELL_CLAWS);
		if (ptr == &mons[PM_SWIKNI]) (void) mongets(mtmp, SURVIVAL_KNIFE);
		if (mtmp->data == &mons[PM_MASK_MAN]) (void) mongets(mtmp, find_corona_mask());
		if (ptr == &mons[PM_REGULAR_JEDI]) (void) mongets(mtmp, BEAMSWORD);
		if (ptr == &mons[PM_LIGHTSABER_ART_JEDI]) (void) mongets(mtmp, BEAMSWORD);
		if (ptr == &mons[PM_PUMPS_GIRL]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (ptr == &mons[PM_PUMPS_WOMAN]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (ptr == &mons[PM_PUMPS_LADY]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (ptr == &mons[PM_RED_BLOODED_HARLOT]) (void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		if (ptr == &mons[PM_TELEPHONE_CELL_PROSTITUTE]) (void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		if (ptr == &mons[PM_STREETLINE_PROSTITUTE]) (void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		if (ptr == &mons[PM_VAMPIRATE]) (void) mongets(mtmp, RAPIER);
		if (ptr == &mons[PM_SPEARMASTER]) (void) mongets(mtmp, ATGEIR);
		if (ptr == &mons[PM_KHOTITE]) (void) mongets(mtmp, KHOPESH);
		if (ptr == &mons[PM_NIGHTMARE_WIZARD]) (void) mongets(mtmp, rnd_class(QUARTERSTAFF,PLATINUM_FIRE_HOOK));
		if (ptr == &mons[PM_HELL_WIZARD]) (void) mongets(mtmp, rnd_class(QUARTERSTAFF,PLATINUM_FIRE_HOOK));
		if (ptr == &mons[PM_SYSTEMLING]) (void) mongets(mtmp, HELMET);
		if (ptr == &mons[PM_SMOKER_HC_WOMAN]) (void) mongets(mtmp, CIGARETTE);
		if (ptr == &mons[PM_TUFTRIKE]) (void) mongets(mtmp, DANCING_SHOES);
		if (ptr == &mons[PM_COCK_MONK]) (void) mongets(mtmp, VIBROBLADE);

		if (ptr == &mons[PM_CHINESE_RADIO_BEACON_OFFICER]) {
			(void) mongets(mtmp, KATANA);
			(void) maketrap(mtmp->mx, mtmp->my, LOUDSPEAKER, 0, FALSE);
		}
		if (ptr == &mons[PM_WJLV_ETTICLOL__VALKYRIE]) {
			(void) mongets(mtmp, LONG_SWORD);
			(void) mongets(mtmp, SMALL_SHIELD);
		}
		if (ptr == &mons[PM_CLOCK_OLD_MARRIED_COUPLE]) {
			(void) mongets(mtmp, SHOTGUN);
			 m_initthrow(mtmp, SHOTGUN_SHELL, 30);
		}
		if (ptr == &mons[PM_BOS_SNIPER]) {
			(void) mongets(mtmp, SNIPER_RIFLE);
			 m_initthrow(mtmp, PLATINUM_SNIPER_BULLET, 40);
			(void) mongets(mtmp, FULL_PLATE_MAIL);
			(void) mongets(mtmp, PLASTEEL_HELM);
		}
		if (ptr == &mons[PM_ARCTIS_BITCH]) {
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, ARROW, 50);
			 m_initthrow(mtmp, ARROW, 50);
		}
		if (ptr == &mons[PM_VEGETABLE_FARMER]) {
			(void) mongets(mtmp, rnd_class(TRIPE_RATION,TIN));
			(void) mongets(mtmp, rnd_class(TRIPE_RATION,TIN));
			(void) mongets(mtmp, rnd_class(TRIPE_RATION,TIN));
		}
		if (ptr == &mons[PM_REDGUARD_BRAGBITCH]) {
			(void) mongets(mtmp, BANDED_MAIL);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, HIGH_BOOTS);
			(void) mongets(mtmp, LORICATED_CLOAK);
		}
		if (ptr == &mons[PM_UMA]) {
			(void) mongets(mtmp, PLATE_MAIL);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, HIGH_BOOTS);
			(void) mongets(mtmp, LORICATED_CLOAK);
			(void) mongets(mtmp, AXE);
			(void) mongets(mtmp, HEAVY_SHIELD);
		}
		if (ptr == &mons[PM_FORT_LUDIOS_GUARD]) {
			(void) mongets(mtmp, LOW_BOOTS);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, LEATHER_CLOAK);
			(void) mongets(mtmp, rnd_class(LONG_SWORD,GREAT_HOUCHOU));
			(void) mongets(mtmp, rnd_class(SMALL_SHIELD,SHIELD_OF_REFLECTION));
			(void) mongets(mtmp, rnd_class(PLATE_MAIL,ROBE_OF_WEAKNESS));
		}

		if (ptr == &mons[PM_VERA_THE_ICE_QUEEN]) {
			if ((find_cyan_sneakers()) != -1) (void)mongets(mtmp, find_cyan_sneakers());
			(void) mongets(mtmp, ATHAME);
			(void) mongets(mtmp, GAUNTLETS);
			(void) mongets(mtmp, AMULET_OF_REFLECTION);
			(void) mongets(mtmp, HIGH_BOOTS);
			(void) mongets(mtmp, CLOAK_OF_MAGIC_RESISTANCE);
		}
		if (ptr == &mons[PM_ELAINE_THE_ENCHANTRESS]) {
			if ((find_yellow_sneakers()) != -1) (void)mongets(mtmp, find_yellow_sneakers());
		}
		if (ptr == &mons[PM_BERNING_MAKER]) {
			(void) mongets(mtmp, ORGANOSHIELD);
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, AMBER_FRAGMENT, 30);
		}

		if (ptr == &mons[PM_GETAWAY_SOLDIER]) {
			  if (rn2(2)) {
				(void) mongets(mtmp, RIFLE);
		 		m_initthrow(mtmp, RIFLE_BULLET, 25);
		 		m_initthrow(mtmp, RIFLE_BULLET, 25);
			  } else {
				(void) mongets(mtmp, SUBMACHINE_GUN);
		 		m_initthrow(mtmp, SMG_BULLET, 25);
		 		m_initthrow(mtmp, SMG_BULLET, 25);
			  }
			(void)mongets(mtmp, rn2(2) ? KNIFE : DAGGER);
			if (rn2(2)) (void) mongets(mtmp, FRAG_GRENADE);
			(void)mongets(mtmp, HELMET);
			(void)mongets(mtmp, STUDDED_LEATHER_ARMOR);
			(void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, LOW_BOOTS);
			(void)mongets(mtmp, LEATHER_CLOAK);
		}

		if (ptr == &mons[PM_KAL_GUNNER]) {
			(void) mongets(mtmp, KALASHNIKOV);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 40);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 40);
		}
		if (ptr == &mons[PM_KAL_CAMPER]) {
			(void) mongets(mtmp, KALASHNIKOV);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 40);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 40);
		}
		if (ptr == &mons[PM_STUPID_CHEST_ADVENTURER]) {
			(void) mongets(mtmp, CHEST);
			(void) mongets(mtmp, LOW_BOOTS);
		}
		if (ptr == &mons[PM_CASINO_SECURITY]) {
			(void) mongets(mtmp, LEATHER_ARMOR);
			(void) mongets(mtmp, PISTOL);
			 m_initthrow(mtmp, PISTOL_BULLET, 50);
		}
		if (ptr == &mons[PM_TREBBER]) {
			(void) mongets(mtmp, LARGE_SHIELD);
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, METEOR_FRAGMENT, 20);
		}
		if (ptr == &mons[PM_NUKE_TREBBER]) {
			(void) mongets(mtmp, LARGE_SHIELD);
			(void) mongets(mtmp, LORICATED_CLOAK);
			(void) mongets(mtmp, RING_MAIL);
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, METEOR_FRAGMENT, 50);
			 m_initthrow(mtmp, METEOR_FRAGMENT, 50);
		}

		if(ptr == &mons[PM_ADORNING_FEMINIST]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, rnd_class(ELIF_S_JEWEL,DORA_S_JEWEL));
		}
		if(ptr == &mons[PM_BRYG_WGAT]) {
			(void) mongets(mtmp, HEAVY_IRON_BALL);
			(void) mongets(mtmp, STRIPED_SHIRT);
		}
		if(ptr == &mons[PM_DARTH_VADER]) {
			(void) mongets(mtmp, BLACK_LIGHTSABER);
			(void) mongets(mtmp, ROBE_OF_WEAKNESS);
		}
		if(ptr == &mons[PM_DAIMYO_OF_DOOM]) {
			(void) mongets(mtmp, HONOR_KATANA);
			(void) mongets(mtmp, SPLINT_MAIL);
			(void) mongets(mtmp, HIGH_BOOTS);
		}
		if(ptr == &mons[PM_CLIMATE_ACTIVIST]) {
			(void) mongets(mtmp, TREESTAFF);
			(void) mongets(mtmp, BAMBOO_MAIL);
		}
		if(ptr == &mons[PM_HOSTILE_CHARACTER]) {
			(void) mongets(mtmp, LASER_SWORD);
			(void) mongets(mtmp, rnd_defensive_item(mtmp));
			(void) mongets(mtmp, rnd_misc_item(mtmp));
			(void) mongets(mtmp, rnd_offensive_item(mtmp));
			if (!rn2(8)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
			if (!rn2(8)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
			if (!rn2(8)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		}
		if(ptr == &mons[PM_HOSTILE_ELITE_CHARACTER]) {
			(void) mongets(mtmp, LASER_SWORD);
			(void) mongets(mtmp, PLATE_MAIL);
			(void) mongets(mtmp, HIGH_BOOTS);
			(void) mongets(mtmp, DENTED_POT);
			(void) mongets(mtmp, rnd_defensive_item(mtmp));
			(void) mongets(mtmp, rnd_misc_item(mtmp));
			(void) mongets(mtmp, rnd_offensive_item(mtmp));
			(void) mongets(mtmp, rnd_defensive_item(mtmp));
			(void) mongets(mtmp, rnd_misc_item(mtmp));
			(void) mongets(mtmp, rnd_offensive_item(mtmp));
			if (!rn2(8)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
			if (!rn2(8)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
			if (!rn2(8)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
			if (!rn2(8)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
			if (!rn2(8)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
			if (!rn2(8)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
		}
		if(ptr == &mons[PM_GLAMOROUS_FEMINIST]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
			(void) mongets(mtmp, rnd_class(ELIF_S_JEWEL,DORA_S_JEWEL));
			(void) mongets(mtmp, rnd_class(ELIF_S_JEWEL,DORA_S_JEWEL));
			(void) mongets(mtmp, rnd_class(ELIF_S_JEWEL,DORA_S_JEWEL));
		}

		if (ptr == &mons[PM_GRAVITY_STRIKER]) {
			(void) mongets(mtmp, HAND_BLASTER);
			 m_initthrow(mtmp, BLASTER_BOLT, 30);
		}
		if (ptr == &mons[PM_BLUE_MAGE]) {
			(void) mongets(mtmp, BLUE_BOW);
			 m_initthrow(mtmp, ARROW, 30);
		}
		if (ptr == &mons[PM_BONE_ELF]) {
			(void) mongets(mtmp, ELVEN_BOW);
			 m_initthrow(mtmp, BONE_ARROW, 25);
		}
		if (ptr == &mons[PM_DIED_ELF_RANGER]) {
			(void) mongets(mtmp, ELVEN_BOW);
			 m_initthrow(mtmp, BONE_ARROW, 30);
		}
		if (ptr == &mons[PM_BLUE_ARCHER]) {
			(void) mongets(mtmp, BLUE_BOW);
			(void) mongets(mtmp, FISH_SCALE_MAIL);
			 m_initthrow(mtmp, ARROW, 40);
		}
		if (ptr == &mons[PM_SHOWSTOPPER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SALT_CHUNK, 30);
		}
		if (ptr == &mons[PM_REAL_SHOWSTOPPER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, CONUNDRUM_NUGGET, 40);
		}
		if (ptr == &mons[PM_D__ASSASSIN]) {
			(void) mongets(mtmp, QATAR);
			(void) mongets(mtmp, LEATHER_ARMOR);
			(void) mongets(mtmp, DENTED_POT);
		}
		if (ptr == &mons[PM_NATALJE_FROM_ACT_THREE]) {
			(void) mongets(mtmp, CESTUS);
			(void) mongets(mtmp, FLEECY_CORSET);
			(void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
			(void) mongets(mtmp, BUBBLETAR);
		}
		if (ptr == &mons[PM_FULLPOWER_JEDI]) {
			(void) mongets(mtmp, NANO_HAMMER);
			(void) mongets(mtmp, PLASTEEL_ARMOR);
			(void) mongets(mtmp, COLOR_CONE);
			(void) mongets(mtmp, ROCKET_GAUNTLETS);
			(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		}
		if (ptr == &mons[PM_SCENTING_KURWA]) {
			(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void) mongets(mtmp, SEXPLAY_WHIP);
			(void) mongets(mtmp, CHROME_HORN);
		}
		if (ptr == &mons[PM_STINKING_KURWA]) {
			(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
			(void) mongets(mtmp, DARK_HORN);
			(void) mongets(mtmp, CHROME_HORN);
		}
		if (ptr == &mons[PM_SUPERKURWA]) {
			(void) mongets(mtmp, UNFAIR_STILETTOS);
			(void) mongets(mtmp, ORGANOBLADE);
			(void) mongets(mtmp, CHROME_HORN);
		}
		if (ptr == &mons[PM_EXTRATERRESTRIAL_KURWA]) {
			(void) mongets(mtmp, STILETTO_SANDALS); /* M4_SANDALS */
			(void) mongets(mtmp, BLOCK_HEELED_SANDAL); /* M4_HAMMERSANDAL */
			(void) mongets(mtmp, CHROME_HORN);
		}
		if (ptr == &mons[PM_VERY_GAY_NINJA]) {
			 m_initthrow(mtmp, SOFT_STAR, 50);
		}
		if (ptr == &mons[PM_VERY_NORMAL_NINJA]) {
			 m_initthrow(mtmp, SHURIKEN, 30);
		}
		if (ptr == &mons[PM_GRIME_NINJA]) {
			 m_initthrow(mtmp, TAR_STAR, 30);
		}
		if (ptr == &mons[PM_NANO_NINJA]) {
			(void) mongets(mtmp, NANO_SUIT);
			 m_initthrow(mtmp, NANO_SHURIKEN, 30);
		}
		if (ptr == &mons[PM_MELEE_SORCERESS]) {
			(void) mongets(mtmp, CHEMISTRY_SPACE_AXE);
			(void) mongets(mtmp, BANDED_MAIL);
		}
		if (ptr == &mons[PM_ELVEN_TRUE_PRIEST]) {
			(void) mongets(mtmp, ELVEN_MACE);
			(void) mongets(mtmp, ELVEN_SHIELD);
		}
		if (ptr == &mons[PM_HIGH_ELVEN_WARRIOR]) {
			(void) mongets(mtmp, HIGH_ELVEN_WARSWORD);
			(void) mongets(mtmp, ELVEN_LEATHER_HELM);
			(void) mongets(mtmp, ELVEN_MITHRIL_COAT);
			(void) mongets(mtmp, ELVEN_SHIELD);
			(void) mongets(mtmp, ELVEN_BOOTS);
		}
		if (ptr == &mons[PM_MYTHICAL_ELF]) {
			(void) mongets(mtmp, MYTHICAL_SABLE);
			(void) mongets(mtmp, ELVEN_MITHRIL_COAT);
		}
		if (ptr == &mons[PM_SUISSE_SOLDIER]) {
			(void) mongets(mtmp, HUNTING_RIFLE);
			 m_initthrow(mtmp, RIFLE_BULLET, 50);
			(void) mongets(mtmp, SURVIVAL_KNIFE);
			(void) mongets(mtmp, LEATHER_CLOAK);
		}
		if (ptr == &mons[PM_SHOTGUN_SNIPER]) {
			(void) mongets(mtmp, AUTO_SHOTGUN);
			 m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 40);
		}
		if (ptr == &mons[PM_CHERRY_DENTIST]) {
			(void) mongets(mtmp, COMBAT_STILETTOS);
			(void) mongets(mtmp, SCALPEL);
		}
		if (ptr == &mons[PM_ELONGATED_KURWA]) {
			(void) mongets(mtmp, RED_SPELL_HEELS);
			(void) mongets(mtmp, rnd_offensive_item(mtmp));
			(void) mongets(mtmp, rnd_offensive_item(mtmp));
			(void) mongets(mtmp, rnd_offensive_item(mtmp));
			(void) mongets(mtmp, rnd_offensive_item(mtmp));
			(void) mongets(mtmp, rnd_offensive_item(mtmp));
		}

		if (mtmp->data == &mons[PM_TEAM_SPLAT_PLAYER]) {

			struct obj *otmpH = mksobj(EGG,TRUE,FALSE, FALSE);

			if (otmpH) {

				otmpH->spe = 0;
				otmpH->quan = rnd(5);
				otmpH->owt = weight(otmpH);
				otmpH->corpsenm = egg_type_from_parent(PM_COCKATRICE, FALSE);
				attach_egg_hatch_timeout(otmpH);
				kill_egg(otmp); /* make sure they're stale --Amy */
				(void) mpickobj(mtmp,otmpH, TRUE);
			}

		}
		if (ptr == &mons[PM_MEMBER_OF_THE_COCKATRICE_ORDER]) {

			(void) mongets(mtmp, GAUNTLETS_OF_FUMBLING);
			struct obj *otmpY = mksobj(CORPSE,TRUE,FALSE, FALSE);
			if (otmpY) {
				otmpY->spe = 0;
				otmpY->quan = 1;
				otmpY->owt = 30;
				otmpY->corpsenm = PM_COCKATRICE;
				start_corpse_timeout(otmpY); /* gotta make sure they time out after a while! --Amy */
				(void) mpickobj(mtmp,otmpY, TRUE);
			}
		}

		if (ptr == &mons[PM_PSYCHOPOMP]) {
			(void) mongets(mtmp, GENTLEMAN_S_SUIT);
			(void) mongets(mtmp, FUR);
			(void) mongets(mtmp, COLOR_CONE);
			(void) mongets(mtmp, ROCKET_GAUNTLETS);
			(void) mongets(mtmp, HEAVY_SHIELD);
			(void) mongets(mtmp, ATSUZOKO_BOOTS);
			(void) mongets(mtmp, LONG_STAKE);
			(void) mongets(mtmp, SHOTGUN);
			 m_initthrow(mtmp, LEAD_SHOT, 50);
		}

		if (ptr == &mons[PM_PURPLE_BOUNCING_GIRL]) {
			(void)mongets(mtmp, rnd_class(PARTISAN,BEC_DE_CORBIN));
		}

		if (ptr == &mons[PM_FEMALE_FEMMY]) {
			(void) mongets(mtmp, SCR_FEMINISM);
		}
		if (ptr == &mons[PM_AMBIGUOUS_GIRL]) {
			(void) mongets(mtmp, SCR_FEMINISM);
		}
		if (ptr == &mons[PM_BLADE_ELF]) {
			(void) mongets(mtmp, SHORT_BLADE);
		}
		if (ptr == &mons[PM_NORDIC_GIRL]) {
			(void) mongets(mtmp, SWEET_MOCASSINS);
		}
		if (ptr == &mons[PM_NORDIC_WOMAN]) {
			(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
			(void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
		}
		if (ptr == &mons[PM_NORDIC_LADY]) {
			(void) mongets(mtmp, SPIKED_BATTLE_BOOT);
		}
		if (ptr == &mons[PM_AMAZONAS_GIRL]) {
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
		}
		if (ptr == &mons[PM_AMAZONAS_WOMAN]) {
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
		}
		if (ptr == &mons[PM_AMAZONAS_LADY]) {
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
		}
		if (ptr == &mons[PM_OASIS_GIRL]) {
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
			(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		}
		if (ptr == &mons[PM_OASIS_WOMAN]) {
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
			(void) mongets(mtmp, BLOCK_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		}
		if (ptr == &mons[PM_DESERT_MAID]) {
			(void) mongets(mtmp, BLOCK_HEELED_SANDAL); /* M4_HAMMERSANDAL */
			(void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}
		if (ptr == &mons[PM_OASIS_LADY]) {
			(void) mongets(mtmp, STILETTO_SANDALS); /* M4_SANDALS */
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}
		if (ptr == &mons[PM_MECH_GIRL]) {
			(void) mongets(mtmp, PICK_AXE);
			(void) mongets(mtmp, rnd_misc_item(mtmp));
		}
		if (ptr == &mons[PM_MECH_WOMAN]) {
			(void) mongets(mtmp, PICK_AXE);
			(void) mongets(mtmp, rnd_misc_item(mtmp));
			(void) mongets(mtmp, rnd_misc_item(mtmp));
		}
		if (ptr == &mons[PM_MECH_LADY]) {
			(void) mongets(mtmp, PICK_AXE);
			(void) mongets(mtmp, rnd_misc_item(mtmp));
			(void) mongets(mtmp, rnd_misc_item(mtmp));
			(void) mongets(mtmp, rnd_misc_item(mtmp));
		}
		if (ptr == &mons[PM_SLEEPY_GIRL]) {
			(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		}
		if (ptr == &mons[PM_SLEEPY_WOMAN]) {
			(void) mongets(mtmp, SWEET_MOCASSINS);
		}
		if (ptr == &mons[PM_SLEEPY_LADY]) {
			(void) mongets(mtmp, HUGGING_BOOT);
		}
		if (ptr == &mons[PM_YOUNG_PADAWAN]) {
			(void) mongets(mtmp, MYSTERY_LIGHTSABER);
		}
		if (ptr == &mons[PM_SPEAR_EXPLORER]) {
			(void) mongets(mtmp, RANDOSPEAR);
		}
		if (ptr == &mons[PM_LOOK_FEMINIST]) {
			(void) mongets(mtmp, BLOCK_HEELED_SANDAL); /* M4_HAMMERSANDAL */
			(void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
			(void) mongets(mtmp, VICTORIAN_UNDERWEAR);
		}

		if (ptr == &mons[PM_ALABASTER_ELF]) {
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}
		if (ptr == &mons[PM_ALABASTER_ELF_ELDER]) {
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}

		if (ptr == &mons[PM_SHARPWOODSMAN]) {
			(void) mongets(mtmp, STRAW_HAT);
			(void) mongets(mtmp, SHARP_AXE);
		}
		if (ptr == &mons[PM_FATHER_ELIJAH]) {
			(void) mongets(mtmp, HEAVY_MACHINE_GUN);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
		}

		if (ptr == &mons[PM_IRON_TROOPER]) {
			(void) mongets(mtmp, ASSAULT_RIFLE);
			(void) mongets(mtmp, PLASTEEL_ARMOR);
			(void) mongets(mtmp, PLASTEEL_GLOVES);
			(void) mongets(mtmp, PLASTEEL_BOOTS);
			(void) mongets(mtmp, PLASTEEL_HELM);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 50);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 50);
		}
		if (ptr == &mons[PM_PLAYER_DYNAMO]) {
			(void) mongets(mtmp, SAWED_OFF_SHOTGUN);
			 m_initthrow(mtmp, SHOTGUN_SHELL, 30);
		}

		if (ptr == &mons[PM_RESERVE_MARINE]) {
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, SUBMACHINE_GUN);
			 m_initthrow(mtmp, LEAD_SMG_BULLET, 50);
		}
		if (ptr == &mons[PM_EVASIVE_RESERVE_MARINE]) {
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, SUBMACHINE_GUN);
			 m_initthrow(mtmp, LEAD_SMG_BULLET, 50);
		}
		if (ptr == &mons[PM_SHOOTING_RANGER]) {
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, PISTOL);
			 m_initthrow(mtmp, LEAD_PISTOL_BULLET, 50);
		}
		if (ptr == &mons[PM_EVASIVE_SHOOTING_RANGER]) {
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, PISTOL);
			 m_initthrow(mtmp, LEAD_PISTOL_BULLET, 50);
		}
		if (ptr == &mons[PM_COUNTRY_TROOPER]) {
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, RIFLE);
			 m_initthrow(mtmp, LEAD_RIFLE_BULLET, 50);
		}
		if (ptr == &mons[PM_EVASIVE_COUNTRY_TROOPER]) {
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, RIFLE);
			 m_initthrow(mtmp, LEAD_RIFLE_BULLET, 50);
		}
		if (ptr == &mons[PM_ARMED_FORCE]) {
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, ASSAULT_RIFLE);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 50);
		}
		if (ptr == &mons[PM_EVASIVE_ARMED_FORCE]) {
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, ASSAULT_RIFLE);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 50);
		}
		if (ptr == &mons[PM_SNIPER_ASSIE]) {
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, SNIPER_RIFLE);
			 m_initthrow(mtmp, LEAD_SNIPER_BULLET, 50);
		}
		if (ptr == &mons[PM_EVASIVE_SNIPER_ASSIE]) {
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, SNIPER_RIFLE);
			 m_initthrow(mtmp, LEAD_SNIPER_BULLET, 50);
		}
		if (ptr == &mons[PM_ASIAN_SECRETARY]) {
			(void) mongets(mtmp, SEXY_LEATHER_PUMP);
			(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
			(void) mongets(mtmp, VICTORIAN_UNDERWEAR);
			(void) mongets(mtmp, PISTOL);
			 m_initthrow(mtmp, LEAD_PISTOL_BULLET, 50);
		}

		if (ptr == &mons[PM_AKIRA_GIRL]) {
			(void)mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		}
		if (ptr == &mons[PM_PROMISCUOUS_LASS]) {
			(void)mongets(mtmp, SEXPLAY_WHIP);
		}
		if (ptr == &mons[PM_DESERT_GIRL]) {
			(void)mongets(mtmp, SAND_SWORD);
			(void)mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}
		if (ptr == &mons[PM_DESERT_LASS]) {
			(void)mongets(mtmp, SAND_SWORD);
			(void)mongets(mtmp, STILETTO_SANDALS); /* M4_SANDALS */
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}
		if (ptr == &mons[PM_DESERT_WOMAN]) {
			(void)mongets(mtmp, DESERT_SWORD);
			(void)mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}
		if (ptr == &mons[PM_DESERT_WOMAN]) {
			(void)mongets(mtmp, DESERT_SWORD);
			(void)mongets(mtmp, COMBAT_STILETTOS);
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}
		if (ptr == &mons[PM_DESERT_GRANNY]) {
			(void)mongets(mtmp, DESERT_SWORD);
			(void)mongets(mtmp, SWEET_MOCASSINS);
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}
		if (ptr == &mons[PM_BORD_KNIGHT]) {
			(void) mongets(mtmp, HEAVY_LONG_SWORD);
			(void) mongets(mtmp, META_BOW);
			 m_initthrow(mtmp, WONDER_ARROW, 20);
		}
		if (ptr == &mons[PM_NIGHTCLUB_THIEF]) {
			(void) mongets(mtmp, DARKNESS_CLUB);
			(void) mongets(mtmp, CAMOUFLAGED_CLOTHES);
		}
		if (ptr == &mons[PM_LEAD_KNIGHT]) {
			(void) mongets(mtmp, HEAVY_LONG_SWORD);
			(void) mongets(mtmp, LEADBAR);
			(void) mongets(mtmp, PLATE_MAIL);
			(void) mongets(mtmp, LORICATED_CLOAK);
			(void) mongets(mtmp, IRON_SHOES);
		}

		if (ptr == &mons[PM_CASE_SHOTTER]) {
			(void) mongets(mtmp, SHOTGUN);
			(void) mongets(mtmp, CHAIN_MAIL);
			 m_initthrow(mtmp, LEAD_SHOT, 30);
		}
		if (ptr == &mons[PM_EVASIVE_CASE_SHOTTER]) {
			(void) mongets(mtmp, SHOTGUN);
			(void) mongets(mtmp, CHAIN_MAIL);
			 m_initthrow(mtmp, LEAD_SHOT, 30);
		}

		if (ptr == &mons[PM_FAR_EAST_ELF]) {
			(void) mongets(mtmp, SAND_SWORD);
			 m_initthrow(mtmp, SAND_DART, 50);
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}
		if (ptr == &mons[PM_HARDCORE_ELF]) {
			(void) mongets(mtmp, SAND_SWORD);
			 m_initthrow(mtmp, SAND_DART, 50);
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}

		if (ptr == &mons[PM_SACRAL_PRIEST]) {
			(void) mongets(mtmp, SMALL_SHIELD);
			(void) mongets(mtmp, CERAMIC_KNIFE);
			(void) mongets(mtmp, rnd_class(ROBE,ROBE_OF_WEAKNESS));
		}

		if (ptr == &mons[PM_DIVERSE_SHOOTER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, !rn2(4) ? LEAD_CLUMP : !rn2(3) ? SLING_AMMO : !rn2(2) ? FLINT : BONE_FRAGMENT, 40);
		}

		if (ptr == &mons[PM_GOVERNOR_TARKIN]) {
			(void)mongets(mtmp, HAND_BLASTER);
			m_initthrow(mtmp, BLASTER_BOLT, 50);
		}
		if (ptr == &mons[PM_WOYZECK]) {
			(void)mongets(mtmp, SHORT_SWORD);
			(void)mongets(mtmp, LEATHER_ARMOR);
			(void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, LOW_BOOTS);
			(void)mongets(mtmp, HELMET);
			(void)mongets(mtmp, LARGE_SHIELD);
		}
		if (monsndx(ptr) == PM_EVRA_THE_MOP_LADY) {
			(void)mongets(mtmp, MOP);
			(void)mongets(mtmp, BROOM);
		}
		if (monsndx(ptr) == PM_YENDORIAN_GIRL) {
			(void)mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
		}
		if (monsndx(ptr) == PM_YENDORIAN_LASS) {
			(void)mongets(mtmp, BULLWHIP);
			(void)mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		}
		if (monsndx(ptr) == PM_YENDORIAN_WOMAN) {
			(void)mongets(mtmp, STEEL_CAPPED_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		}
		if (monsndx(ptr) == PM_YENDORIAN_LADY) {
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);
			(void)mongets(mtmp, LEATHER_PEEP_TOES);
		}
		if (monsndx(ptr) == PM_YENDORIAN_GRANNY) {
			(void)mongets(mtmp, SOFT_LADY_SHOE);
			(void)mongets(mtmp, DANCING_SHOES);
		}
		if (monsndx(ptr) == PM_YENDORIAN_DEMON_WOMAN) {
			(void)mongets(mtmp, SPIKED_BATTLE_BOOT);
			(void)mongets(mtmp, COMBAT_STILETTOS);
		}
		if (monsndx(ptr) == PM_YENDORIAN_HC_WOMAN) {
			(void)mongets(mtmp, HUGGING_BOOT);
			(void)mongets(mtmp, KATYUSHA);
			(void)mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		}
		if (monsndx(ptr) == PM_YENDORIAN_PERFUME_MODEL) {
			(void)mongets(mtmp, SOFT_LADY_SHOE);
			(void)mongets(mtmp, VICTORIAN_UNDERWEAR);
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		}
		if (monsndx(ptr) == PM_HC_FEMINIST) {
			(void)mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, VICTORIAN_UNDERWEAR);
		}
		if (monsndx(ptr) == PM_REAL_FEMINIST) {
			(void)mongets(mtmp, T_SHIRT);
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);
		}

		if (ptr == &mons[PM_RENEGADE_WATCHMAN]) {
			if (!rn2(2)) (void)mongets(mtmp, rn2(20) ? rnd_class(PARTISAN,BEC_DE_CORBIN) : GRINDER);
			(void)mongets(mtmp, (rn2(2)) ? KNIFE : DAGGER);
			if (!rn2(2)) (void)mongets(mtmp, (rn2(2)) ? SPEAR : SHORT_SWORD);
		}

		if (ptr == &mons[PM_RENEGADE_WATCH_CAPTAIN]) {
			(void)mongets(mtmp, (rn2(2)) ? LONG_SWORD : SILVER_SABER);
		}
		if (ptr == &mons[PM_HC_BEGINNER]) {
			(void)mongets(mtmp, SAND_SWORD);
		}
		if (ptr == &mons[PM_SWORD_SOLDIER]) {
			(void)mongets(mtmp, DENTED_POT);
			(void)mongets(mtmp, HEAVY_LONG_SWORD);
			(void)mongets(mtmp, STUDDED_LEATHER_ARMOR);
			(void)mongets(mtmp, PAPER_SHIELD);
			(void)mongets(mtmp, LOW_BOOTS);
			(void)mongets(mtmp, LEATHER_GLOVES);
		}

		if (ptr == &mons[PM_CHIEFBANE]) {
			(void)mongets(mtmp, TWO_HANDED_SWORD);
		}
		if (ptr == &mons[PM_WHITE_FEMMY]) {
			(void)mongets(mtmp, COMBAT_STILETTOS);
		}
		if (ptr == &mons[PM_LUKE_SKYWALKER]) {
			(void)mongets(mtmp, GREEN_LIGHTSABER);
		}

		if (ptr == &mons[PM_RENEGADE_WATCH_LIEUTENANT]) {
			(void)mongets(mtmp, (rn2(2)) ? LONG_SWORD : SILVER_SABER);
		}

		if (ptr == &mons[PM_AZTEC_SPEARTHROWER]) {
			m_initthrow(mtmp, SPEAR, 7);
		}
		if (ptr == &mons[PM_AZTEC_SPEARSHOTTER]) {
			(void)mongets(mtmp, BAMBOO_SPEAR);
			(void)mongets(mtmp, ATLATL);
			m_initthrow(mtmp, AMBER_FRAGMENT, 30);
		}
		if (ptr == &mons[PM_AZTEC_CLUBMAN]) {
			(void)mongets(mtmp, MACUAHUITL);
			(void)mongets(mtmp, rn2(2) ? HIDE : FUR);
		}

		if (ptr == &mons[PM_ANGRIER_SHOPKEEPER]) {
			(void)mongets(mtmp, (rn2(2)) ? SHOTGUN : SAWED_OFF_SHOTGUN);
			m_initthrow(mtmp, SHOTGUN_SHELL, 30);
		}

		if (ptr == &mons[PM_AK____SOLDIER]) {
			(void)mongets(mtmp, KALASHNIKOV);
			(void)mongets(mtmp, HELMET);
			(void)mongets(mtmp, STUDDED_LEATHER_ARMOR);
			(void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, LOW_BOOTS);
			(void)mongets(mtmp, LEATHER_CLOAK);
			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 40);
			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 40);
		}
		if (ptr == &mons[PM_RUSSIAN_SOLDIER]) {
			(void)mongets(mtmp, KALASHNIKOV);
			(void)mongets(mtmp, HELMET);
			(void)mongets(mtmp, STUDDED_LEATHER_ARMOR);
			(void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, LOW_BOOTS);
			(void)mongets(mtmp, LEATHER_CLOAK);
			m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 40);
			m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 40);
		}
		if (ptr == &mons[PM_ENGCHIP]) {
			(void)mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 30);
		}
		if (ptr == &mons[PM_TURMENE_GUNPOWDER_RESEARCHER]) {
			(void)mongets(mtmp, FLINTLOCK);
			(void)mongets(mtmp, FEDORA);
			m_initthrow(mtmp, LEAD_PISTOL_BULLET, 35);
		}
		if (ptr == &mons[PM_ZIEIEIER]) {
			(void)mongets(mtmp, BFG);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
		}
		if (ptr == &mons[PM_BRANTER_GUN]) {
			(void)mongets(mtmp, SUBMACHINE_GUN);
			m_initthrow(mtmp, SMG_BULLET, 50);
			m_initthrow(mtmp, SMG_BULLET, 50);
			m_initthrow(mtmp, SMG_BULLET, 50);
			m_initthrow(mtmp, SMG_BULLET, 50);
		}
		if (ptr == &mons[PM_SPARD]) {
			(void)mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 30);
			m_initthrow(mtmp, ARROW, 30);
			m_initthrow(mtmp, ARROW, 30);
			m_initthrow(mtmp, ARROW, 30);
		}
		if (ptr == &mons[PM_JAVA]) {
			m_initthrow(mtmp, JAVELIN, 5);
		}
		if (ptr == &mons[PM_FUNNY_JAVA]) {
			m_initthrow(mtmp, STACK_JAVELIN, 5);
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
			(void)mongets(mtmp, HAWAIIAN_SHIRT);
		}
		if (ptr == &mons[PM_GREURO]) {
			(void)mongets(mtmp, LANCE);
		}
		if (ptr == &mons[PM_EDWARD_NYGMA]) {
			(void)mongets(mtmp, WAN_CREATE_MONSTER);
		}
		if (ptr == &mons[PM_THE_MAN_IN_THE_MOON]) {
			(void)mongets(mtmp, WAN_TRAP_CREATION);
			int bossscrolls = rnd(5);
			while (bossscrolls > 0) {
				bossscrolls--;
				(void)mongets(mtmp, SCR_SUMMON_BOSS);
			}
		}
		if (ptr == &mons[PM_JAPURA]) {
			(void)mongets(mtmp, KATANA);
		}
		if (ptr == &mons[PM_HALLU_PARTIER]) {
			(void)mongets(mtmp, POT_ACID);
		}
		if (ptr == &mons[PM_PEEK_DUDE]) {
			(void)mongets(mtmp, UNICORN_HORN);
		}
		if (ptr == &mons[PM_GERTEUT]) {
			(void)mongets(mtmp, POT_RADIUM);
		}
		if (ptr == &mons[PM_CELTIC]) {
			(void)mongets(mtmp, POT_SPEED);
		}
		if (ptr == &mons[PM_FRO]) {
			(void)mongets(mtmp, AXE);
		}
		if (ptr == &mons[PM_KORONST]) {
			(void)mongets(mtmp, SLING);
			m_initthrow(mtmp, GRAPHITE, 50);
		}
		if (ptr == &mons[PM_VIETIS]) {
			(void)mongets(mtmp, PISTOL);
			m_initthrow(mtmp, LEAD_PISTOL_BULLET, 50);
		}
		if (ptr == &mons[PM_BOSSRUSHER]) {
			(void)mongets(mtmp, SCR_SUMMON_BOSS);
		}
		if (ptr == &mons[PM_DORIAN]) {
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		}
		if (ptr == &mons[PM_INHERITOR]) {
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		}
		if (ptr == &mons[PM_FRANC]) {
			(void)mongets(mtmp, SHARP_AXE);
		}
		if (ptr == &mons[PM_HERALD]) {
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 if (!rn2(2)) (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 if (!rn2(5)) (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
		}
		if (ptr == &mons[PM_BEGINNER]) {
			(void)mongets(mtmp, SHORT_BLADE);
			(void)mongets(mtmp, !rn2(4) ? LEATHER_CLOAK : !rn2(3) ? BUNNY_EAR : !rn2(2) ? PAPER_SHIELD : GNOMISH_BOOTS);
		}
		if (ptr == &mons[PM_MAYMES]) {
			(void)mongets(mtmp, COMPOST_BOW);
			m_initthrow(mtmp, FORBIDDEN_ARROW, 40);
		}
		if (ptr == &mons[PM_TURMENE]) {
			(void)mongets(mtmp, FLINTLOCK);
			m_initthrow(mtmp, PISTOL_BULLET, 35);
		}

		if (ptr == &mons[PM_EVIL_WATCH_LEADER]) {
			(void)mongets(mtmp, (rn2(2)) ? LONG_SWORD : SILVER_SABER);
			(void)mongets(mtmp, (!rn2(3)) ? RING_MAIL : rn2(2) ? CHAIN_MAIL : SPLINT_MAIL);
			(void)mongets(mtmp, HELMET);
			if (!rn2(3)) (void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, rn2(2) ? LOW_BOOTS : HIGH_BOOTS);
			(void)mongets(mtmp, SMALL_SHIELD);
		}

		if (ptr == &mons[PM_EVIL_WATCHMAN]) {
			if (!rn2(2)) (void)mongets(mtmp, rn2(20) ? rnd_class(PARTISAN,BEC_DE_CORBIN) : GRINDER);
			(void)mongets(mtmp, (rn2(2)) ? KNIFE : DAGGER);
			if (!rn2(2)) (void)mongets(mtmp, (rn2(2)) ? SPEAR : SHORT_SWORD);
			(void)mongets(mtmp, (!rn2(3)) ? RING_MAIL : rn2(2) ? CHAIN_MAIL : SPLINT_MAIL);
			(void)mongets(mtmp, HELMET);
			if (!rn2(3)) (void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, rn2(2) ? LOW_BOOTS : HIGH_BOOTS);
			(void)mongets(mtmp, SMALL_SHIELD);
		}

		if (ptr == &mons[PM_EVIL_WATCH_CAPTAIN]) {
			(void)mongets(mtmp, (rn2(2)) ? LONG_SWORD : SILVER_SABER);
			(void)mongets(mtmp, (!rn2(3)) ? RING_MAIL : rn2(2) ? CHAIN_MAIL : SPLINT_MAIL);
			(void)mongets(mtmp, HELMET);
			if (!rn2(3)) (void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, rn2(2) ? LOW_BOOTS : HIGH_BOOTS);
			(void)mongets(mtmp, SMALL_SHIELD);
		}

		if (ptr == &mons[PM_EVIL_MARKETEER]) {
			(void)mongets(mtmp, TWO_HANDED_SWORD);
			(void)mongets(mtmp, (!rn2(3)) ? RING_MAIL : rn2(2) ? CHAIN_MAIL : SPLINT_MAIL);
			(void)mongets(mtmp, HELMET);
			if (!rn2(3)) (void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, rn2(2) ? LOW_BOOTS : HIGH_BOOTS);
			(void)mongets(mtmp, SMALL_SHIELD);
		}

		if (ptr == &mons[PM_EVIL_WATCH_LIEUTENANT]) {
			(void)mongets(mtmp, (rn2(2)) ? LONG_SWORD : SILVER_SABER);
			(void)mongets(mtmp, (!rn2(3)) ? RING_MAIL : rn2(2) ? CHAIN_MAIL : SPLINT_MAIL);
			(void)mongets(mtmp, HELMET);
			if (!rn2(3)) (void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, rn2(2) ? LOW_BOOTS : HIGH_BOOTS);
			(void)mongets(mtmp, SMALL_SHIELD);
		}

		if (ptr == &mons[PM_EVIL_SHOPKEEPER]) {
			(void)mongets(mtmp, (rn2(2)) ? SHOTGUN : SAWED_OFF_SHOTGUN);
			m_initthrow(mtmp, SHOTGUN_SHELL, 30);
			(void)mongets(mtmp, (!rn2(3)) ? RING_MAIL : rn2(2) ? CHAIN_MAIL : SPLINT_MAIL);
			(void)mongets(mtmp, HELMET);
			if (!rn2(3)) (void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, rn2(2) ? LOW_BOOTS : HIGH_BOOTS);
			(void)mongets(mtmp, SMALL_SHIELD);
		}

		if (ptr == &mons[PM_RENEGADE_WATCH_LEADER]) {
			(void)mongets(mtmp, (rn2(2)) ? LONG_SWORD : SILVER_SABER);
		}

		if (monsndx(ptr) == PM_FORD_PERFECT || monsndx(ptr) == PM_ARTHUR_DENT) {
			mongets(mtmp,PEANUT_BAG);
		} 
		if (monsndx(ptr) == PM_FORD_PERFECT) {
			mongets(mtmp,TOWEL);
		}
		if (monsndx(ptr) == PM_TOTAL_WOUNDING_KNIGHT) {
			mongets(mtmp,SCR_WOUNDS);
			if (!rn2(2)) mongets(mtmp,SCR_WOUNDS);
			if (!rn2(3)) mongets(mtmp,SCR_WOUNDS);
			if (!rn2(5)) mongets(mtmp,SCR_WOUNDS);
			if (!rn2(7)) mongets(mtmp,SCR_WOUNDS);
		}
		if (ptr == &mons[PM_MAUD_AGENT] || ptr == &mons[PM_MUAD_AGENT] || ptr == &mons[PM_DUAM_XNAHT_AGENT]) (void) mongets(mtmp, POT_AMNESIA);

		if (ptr == &mons[PM_DELUGE_AGENT] || ptr == &mons[PM_FLOOD_SURFER] || ptr == &mons[PM_WATER_GIRL] || ptr == &mons[PM_WATER_LADY]) (void) mongets(mtmp, SCR_FLOOD);
		if (ptr == &mons[PM_LAVA_LOVER] || ptr == &mons[PM_CRISPY_BURNER] || ptr == &mons[PM_FIRE_GIRL] || ptr == &mons[PM_FIERY_LADY]) (void) mongets(mtmp, SCR_LAVA);
		if (ptr == &mons[PM_TREE_HUGGER] || ptr == &mons[PM_ECOFRIENDLY_RESEARCHER] || ptr == &mons[PM_NATURE_GIRL] || ptr == &mons[PM_NATURE_LADY]) (void) mongets(mtmp, SCR_GROWTH);
		if (ptr == &mons[PM_NORTHERNER] || ptr == &mons[PM_COLD_PERSON] || ptr == &mons[PM_ICE_GIRL] || ptr == &mons[PM_ICE_LADY]) (void) mongets(mtmp, SCR_ICE);
		if (ptr == &mons[PM_FORMER_PRISONER] || ptr == &mons[PM_JOBLESS_WARDEN] || ptr == &mons[PM_FEMALE_GUARD] || ptr == &mons[PM_FEMALE_YEOMAN]) (void) mongets(mtmp, SCR_BARRHING);
		if (ptr == &mons[PM_PARANOID_SCHIZO] || ptr == &mons[PM_SUPERSTITIOUS_PERSON] || ptr == &mons[PM_MENTAL_GIRL] || ptr == &mons[PM_MENTAL_LADY]) (void) mongets(mtmp, SCR_LOCKOUT);
		if (ptr == &mons[PM_ACID_TRIPPER] || ptr == &mons[PM_DRUG_ABUSER] || ptr == &mons[PM_DRUGGED_GIRL] || ptr == &mons[PM_CRACKWHORE]) (void) mongets(mtmp, POT_HALLUCINATION);
		if (ptr == &mons[PM_SNOWBALL_THROWER] || ptr == &mons[PM_ICE_REGENT] || ptr == &mons[PM_SNOW_GIRL] || ptr == &mons[PM_SNOW_QUEEN]) (void) mongets(mtmp, POT_ICE);
		if (ptr == &mons[PM_FRIGHTENING_CREEP] || ptr == &mons[PM_TEETHLESS_CRONE] || ptr == &mons[PM_DEFORMED_GIRL] || ptr == &mons[PM_FEMALE_HULL]) (void) mongets(mtmp, POT_FEAR);
		if (ptr == &mons[PM_FIREBREATHER] || ptr == &mons[PM_FLAME_PUNISHER] || ptr == &mons[PM_DRAGON_GIRL] || ptr == &mons[PM_DRAGON_LADY]) (void) mongets(mtmp, POT_FIRE);
		if (ptr == &mons[PM_ELECTRO_SHOCKER] || ptr == &mons[PM_TAZER] || ptr == &mons[PM_SADISTIC_GIRL] || ptr == &mons[PM_SADISTIC_LADY]) (void) mongets(mtmp, POT_STUNNING);
		if (ptr == &mons[PM_SQUEEZER] || ptr == &mons[PM_JAMCLAMPER] || ptr == &mons[PM_BDSM_GIRL] || ptr == &mons[PM_BDSM_LADY]) (void) mongets(mtmp, POT_NUMBNESS);
		if (ptr == &mons[PM_FIENDISH_WARLOCK] || ptr == &mons[PM_MAGICAL_GIRL]) (void) mongets(mtmp, SCR_BAD_EFFECT);
		if (ptr == &mons[PM_OCCULT_WARLOCK] || ptr == &mons[PM_MAGICAL_LADY]) (void) mongets(mtmp, WAN_BAD_EFFECT);

		if (ptr == &mons[PM_GIRLY_GIRL]) (void) mongets(mtmp, SCR_GIRLINESS);
		if (ptr == &mons[PM_FEMALE_GIRL]) (void) mongets(mtmp, WAN_SUMMON_SEXY_GIRL);

		if (ptr == &mons[PM_BOWAZON]) {
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 25);
		}
		if (ptr == &mons[PM_JAVAZON]) {
			(void) mongets(mtmp, JAVELIN);
			(void) mongets(mtmp, SMALL_SHIELD);
		}
		if (ptr == &mons[PM_MIXAZON]) {
			(void) mongets(mtmp, RANDOSPEAR);
			m_initthrow(mtmp, STACK_JAVELIN, 5);
		}
		if (ptr == &mons[PM_WONDER_ZON]) {
			(void) mongets(mtmp, META_BOW);
			m_initthrow(mtmp, WONDER_ARROW, 50);
		}
		if (ptr == &mons[PM_SPEARAZON]) {
			(void) mongets(mtmp, SPEAR);
			(void) mongets(mtmp, SMALL_SHIELD);
		}
		if (ptr == &mons[PM_FORKAZON]) {
			(void) mongets(mtmp, TRIDENT);
			(void) mongets(mtmp, SMALL_SHIELD);
		}
		if (ptr == &mons[PM_FLASHING_MISCHIEF_ZON]) {
			(void) mongets(mtmp, COURSE_JAVELIN);
			(void) mongets(mtmp, LARGE_SHIELD);
			m_initthrow(mtmp, JAVELIN, 8);
		}

		if (ptr == &mons[PM_DIVINE_SUMMONER]) (void) mongets(mtmp, SCR_SUMMON_ELM);
		if (ptr == &mons[PM_CELESTIAL_SUMMONER]) (void) mongets(mtmp, WAN_SUMMON_ELM);

		if (ptr == &mons[PM_ABALLINO]) (void) mongets(mtmp, WAN_TRAP_CREATION);
		if (ptr == &mons[PM_GENERAL_ZAROFF]) (void) mongets(mtmp, WAN_TRAP_CREATION);
		if (ptr == &mons[PM_JACK_THE_RIPPER]) (void) mongets(mtmp, WAN_TRAP_CREATION);
		if (ptr == &mons[PM_GENERAL_HEATHERSTONE]) (void) mongets(mtmp, WAN_TRAP_CREATION);
		if (ptr == &mons[PM_SERBIAN_THIEF]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (ptr == &mons[PM_RUSSIAN_THIEF]) (void) mongets(mtmp, SWEET_MOCASSINS);
		if (ptr == &mons[PM_STUPID_THIEVING_GIRL]) (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		if (ptr == &mons[PM_TURKISH_BANDIT]) (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

		if (ptr == &mons[PM_FOOTPAD]) (void) mongets(mtmp, SCR_TRAP_CREATION);
		if (ptr == &mons[PM_THIEF]) (void) mongets(mtmp, SCR_TRAP_CREATION);

		if (ptr == &mons[PM_STONER]) (void) mongets(mtmp, SCR_STONING);
		if (ptr == &mons[PM_DESTROYER]) (void) mongets(mtmp, SCR_DESTROY_ARMOR);
		if (ptr == &mons[PM_REAL_PUNISHER]) (void) mongets(mtmp, SCR_PUNISHMENT);
		if (ptr == &mons[PM_HEAVY_STONER]) (void) mongets(mtmp, WAN_STONING);
		if (ptr == &mons[PM_MASTER_PUNISHER]) (void) mongets(mtmp, WAN_PUNISHMENT);
		if (ptr == &mons[PM_MAUD_BADASS]) (void) mongets(mtmp, WAN_AMNESIA);

		if (ptr == &mons[PM_NOVICE_ARCHER] || ptr == &mons[PM_APPRENTICE_ARCHER]) {
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 25);
		}

		if (ptr == &mons[PM_SHARPSHOOTER]) {
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 25);
			m_initthrow(mtmp, ARROW, 25);
			m_initthrow(mtmp, ARROW, 25);
		}

		if (ptr == &mons[PM_SLINGSHOOTER]) {
			(void) mongets(mtmp, SLING);
			m_initthrow(mtmp, ROCK, 25);
			m_initthrow(mtmp, ROCK, 25);
		}

		if (ptr == &mons[PM_ENCLAVE_FRONT_TROOPER]) {
			mongets(mtmp, PLATE_MAIL);
			(void) mongets(mtmp, POWERFIST);
		}
		if (ptr == &mons[PM_ENCLAVE_POWERTROOPER]) {
			(void) mongets(mtmp, LASERFIST);
			(void) mongets(mtmp, PLASTEEL_HELM);
			(void) mongets(mtmp, FULL_PLATE_MAIL);
		}

		if (monsndx(ptr) == PM_ENCLAVE_SOLDIER || monsndx(ptr) == PM_EVASIVE_ENCLAVE_SOLDIER) {
			mongets(mtmp, HAND_BLASTER);
			mongets(mtmp, FULL_PLATE_MAIL);
			m_initthrow(mtmp, BLASTER_BOLT, 40);
		}

		if (monsndx(ptr) == PM_ENCLAVE_OFFICER || monsndx(ptr) == PM_EVASIVE_ENCLAVE_OFFICER) {
			mongets(mtmp, ARM_BLASTER);
			mongets(mtmp, LEATHER_ARMOR);
			m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		}

		if (monsndx(ptr) == PM_ENCLAVE_STORMTROOPER || monsndx(ptr) == PM_EVASIVE_ENCLAVE_STORMTROOPER) {
			mongets(mtmp, CUTTING_LASER);
			mongets(mtmp, FULL_PLATE_MAIL);
			m_initthrow(mtmp, LASER_BEAM, 50);
		}

		if (monsndx(ptr) == PM_ENCLAVE_ELITE_SOLDIER || monsndx(ptr) == PM_EVASIVE_ENCLAVE_ELITE_SOLDIER) {
			mongets(mtmp, RAYGUN);
			mongets(mtmp, FULL_PLATE_MAIL);
			m_initthrow(mtmp, RAYGUN_BOLT, 50);
		}

		if (monsndx(ptr) == PM_ATOMIC_SOLDIER || monsndx(ptr) == PM_EVASIVE_ATOMIC_SOLDIER) {
			mongets(mtmp, BFG);
			mongets(mtmp, COMMANDER_SUIT);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
		}

		if (ptr == &mons[PM_GUDRUN_S_COMBAT_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, WEDGE_SANDALS); } /* M4_SANDALS */
		if (ptr == &mons[PM_ELLA_S_WEDGE_SANDAL]) { (void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); (void) mongets(mtmp, WEDGE_SANDALS); } /* M4_HAMMERSANDAL|M4_SANDALS */
		if (ptr == &mons[PM_MELISSA_S_WEDGE_HEELED_COMBAT_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */
		if (ptr == &mons[PM_MANUELA_S_WHORE_BOOT]) { (void) mongets(mtmp, SPIKED_BATTLE_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */
		if (ptr == &mons[PM_BLOCK_HEELED_GIRL]) (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

		if(is_mercenary(ptr)
				|| ptr == &mons[PM_CHIEF_YEOMAN_WARDER]
				|| ptr == &mons[PM_YEOMAN_WARDER]
		) {
		    register int mac;

		    switch(monsndx(ptr)) {
			case PM_BEGINNER_MERC: mac = 10; break;
			case PM_UNARMORED_SOLDIER: mac = 10; break;
			case PM_WEAKISH_SOLDIER: mac = 10; break;
			case PM_LUSH_SOLDIER: mac = 10; break;
			case PM_NEWBIE_SOLDIER: mac = 10; break;
			case PM_RECRUIT_SOLDIER: mac = 10; break;
			case PM_GUARD: mac = -1; break;
			case PM_MASTER_GUARD: mac = -2; break;
			case PM_ELITE_GUARD: mac = -3; break;
			case PM_CROUPIER: mac = -1; break;
			case PM_MASTER_CROUPIER: mac = -2; break;
			case PM_ELITE_CROUPIER: mac = -3; break;
			case PM_PRISON_GUARD: mac = -2; break;
			case PM_SOLDIER: mac = 3; break;
			case PM_TEUTON_SOLDIER: mac = 3; break;
			case PM_FRANKISH_SOLDIER: mac = 3; break;
			case PM_BRITISH_SOLDIER: mac = 3; break;
			case PM_AMERICAN_SOLDIER: mac = 3; break;
			case PM_COPPER_SOLDIER: mac = 3; break;
			case PM_ARAB_SOLDIER: mac = 3; break;
			case PM_ASIAN_SOLDIER: mac = 3; break;
			case PM_PAD_SOLDIER: mac = 3; break;
			case PM_GAUCHE_SOLDIER: mac = 3; break;
			case PM_SEAFARING_SOLDIER: mac = 3; break;
			case PM_BYZANTINE_SOLDIER: mac = 3; break;
			case PM_CELTIC_SOLDIER: mac = 3; break;
			case PM_VANILLA_SOLDIER: mac = 3; break;
			case PM_VIKING_SOLDIER: mac = 3; break;
			case PM_MILITARY_GUY: mac = 3; break;
			case PM_SWAMP_SOLDIER: mac = 3; break;
			case PM_JAVA_SOLDIER: mac = 3; break;
			case PM_IBERIAN_SOLDIER: mac = 3; break;
			case PM_ROHIRRIM_SOLDIER: mac = 3; break;
			case PM_ILLUSIONARY_SOLDIER: mac = 3; break;
			case PM_SERGEANT: mac = 0; break;
			case PM_EXTRATERRESTRIAL_SERGEANT: mac = 0; break;
			case PM_MINOAN_SERGEANT: mac = 0; break;
			case PM_HUN_SERGEANT: mac = 0; break;
			case PM_MONGOL_SERGEANT: mac = 0; break;
			case PM_TWOWEAP_SERGEANT: mac = 0; break;
			case PM_PERSIAN_SERGEANT: mac = 0; break;
			case PM_LIEUTENANT: mac = -2; break;
			case PM_MILITARIZER: mac = -2; break;
			case PM_YAMATO_LIEUTENANT: mac = -2; break;
			case PM_CARTHAGE_LIEUTENANT: mac = -2; break;
			case PM_ROMAN_LIEUTENANT: mac = -2; break;
			case PM_CAPTAIN: mac = -3; break;
			case PM_COMMANDER_IN_CHIEF: mac = -3; break;
			case PM_GOTHIC_CAPTAIN: mac = -3; break;
			case PM_URBAN_CAMO_CAPTAIN: mac = -3; break;
			case PM_GENERAL: mac = -3; break;
			case PM_YEOMAN_WARDER:
			case PM_WATCHMAN: mac = 3; break;
			case PM_ANGRY_WATCHMAN: mac = 3; break;
			case PM_CHIEF_YEOMAN_WARDER:
				mongets(mtmp, TALLOW_CANDLE);
			case PM_WATCH_CAPTAIN: mac = -2; break;
			case PM_WATCH_LIEUTENANT: mac = -2; break;
			case PM_WATCH_LEADER: mac = -2; break;
			case PM_ANGRY_WATCH_CAPTAIN: mac = -2; break;
			case PM_ANGRY_WATCH_LIEUTENANT: mac = -2; break;
			case PM_ANGRY_WATCH_LEADER: mac = -2; break;
			default: impossible("odd mercenary %d?", monsndx(ptr));
				mac = 0;
				break;
		    }

		    if (mac < -1 && rn2(5))
			mac += 7 + mongets(mtmp, (rn2(5)) ?
					   PLATE_MAIL : CRYSTAL_PLATE_MAIL);
		    else if (mac < 3 && rn2(5))
			mac += 6 + mongets(mtmp, (rn2(3)) ?
					   SPLINT_MAIL : BANDED_MAIL);
		    else if (mac < 10 && rn2(5))
			mac += 3 + mongets(mtmp, (rn2(3)) ?
					   RING_MAIL : STUDDED_LEATHER_ARMOR);
		    else if (mac < 10)
			mac += 2 + mongets(mtmp, LEATHER_ARMOR);

		    if (mac < 10 && rn2(3))
			mac += 1 + mongets(mtmp, HELMET);
		    else if (mac < 10 && rn2(2))
			mac += 1 + mongets(mtmp, DENTED_POT);
		    if (mac < 10 && rn2(3))
			mac += 1 + mongets(mtmp, SMALL_SHIELD);
		    else if (mac < 10 && rn2(2))
			mac += 2 + mongets(mtmp, LARGE_SHIELD);
		    if (mac < 10 && rn2(3))
			mac += 1 + mongets(mtmp, LOW_BOOTS);
		    else if (mac < 10 && rn2(2))
			mac += 2 + mongets(mtmp, HIGH_BOOTS);
		    if (mac < 10 && rn2(3))
			mac += 1 + mongets(mtmp, LEATHER_GLOVES);
		    else if (mac < 10 && rn2(2))
			mac += 1 + mongets(mtmp, LEATHER_CLOAK);

		    if(ptr != &mons[PM_GUARD] &&
			ptr != &mons[PM_MASTER_GUARD] &&
			ptr != &mons[PM_ELITE_GUARD] &&
			ptr != &mons[PM_CROUPIER] &&
			ptr != &mons[PM_MASTER_CROUPIER] &&
			ptr != &mons[PM_ELITE_CROUPIER] &&
			ptr != &mons[PM_PRISON_GUARD] &&
			ptr != &mons[PM_WATCHMAN] &&
			ptr != &mons[PM_BEGINNER_MERC] &&
			ptr != &mons[PM_UNARMORED_SOLDIER] &&
			ptr != &mons[PM_NEWBIE_SOLDIER] &&
			ptr != &mons[PM_WEAKISH_SOLDIER] &&
			ptr != &mons[PM_LUSH_SOLDIER] &&
			ptr != &mons[PM_RECRUIT_SOLDIER] &&
			ptr != &mons[PM_ANGRY_WATCHMAN] &&
			ptr != &mons[PM_ANGRY_WATCH_LIEUTENANT] &&
			ptr != &mons[PM_ANGRY_WATCH_LEADER] &&
			ptr != &mons[PM_WATCH_LEADER] &&
			ptr != &mons[PM_ANGRY_WATCH_CAPTAIN] &&
			ptr != &mons[PM_WATCH_LIEUTENANT] &&
			ptr != &mons[PM_WATCH_CAPTAIN]) {
			if (!rn2(15)) (void) mongets(mtmp, K_RATION);
			if (!rn2(12)) (void) mongets(mtmp, C_RATION);
			if (ptr != &mons[PM_SOLDIER] && ptr != &mons[PM_TEUTON_SOLDIER] && ptr != &mons[PM_VANILLA_SOLDIER] && ptr != &mons[PM_VIKING_SOLDIER] && ptr != &mons[PM_SWAMP_SOLDIER] && ptr != &mons[PM_JAVA_SOLDIER] && ptr != &mons[PM_IBERIAN_SOLDIER] && ptr != &mons[PM_ROHIRRIM_SOLDIER] && ptr != &mons[PM_FRANKISH_SOLDIER] && ptr != &mons[PM_BRITISH_SOLDIER] && ptr != &mons[PM_AMERICAN_SOLDIER] && ptr != &mons[PM_COPPER_SOLDIER] && ptr != &mons[PM_ARAB_SOLDIER] && ptr != &mons[PM_ASIAN_SOLDIER] && ptr != &mons[PM_SEAFARING_SOLDIER] && ptr != &mons[PM_PAD_SOLDIER] && ptr != &mons[PM_GAUCHE_SOLDIER] && ptr != &mons[PM_BYZANTINE_SOLDIER] && ptr != &mons[PM_CELTIC_SOLDIER] && !rn2(3))
				(void) mongets(mtmp, BUGLE);
		    } else
			   if (ptr == &mons[PM_WATCHMAN] && rn2(3))
				(void) mongets(mtmp, TIN_WHISTLE);
		} else if (ptr == &mons[PM_TEACHER] && (!rn2(5)) ) {
			/* They're going to need it :-) */
			mongets(mtmp,rn2(3) ? RING_MAIL : PLATE_MAIL);
		} else if (ptr == &mons[PM_PRINCIPAL]) {
		    			/* They're going to need it :-) */
			mongets(mtmp,rn2(3) ? RING_MAIL : PLATE_MAIL);
		  
		}  else if (ptr == &mons[PM_SHOPKEEPER] || ptr == &mons[PM_MASTER_SHOPKEEPER] || ptr == &mons[PM_ELITE_SHOPKEEPER]) {
		    (void) mongets(mtmp,SKELETON_KEY);
		    /* STEPHEN WHITE'S NEW CODE                
		     *
		     * "Were here to pump *clap* YOU up!"  -Hans and Frans
		     *                                      Saterday Night Live
		     */
		    switch (rnd(4)) {
			/* MAJOR fall through ... */
			case 1: (void) mongets(mtmp,POT_HEALING);
			case 2: (void) mongets(mtmp,POT_EXTRA_HEALING);
			case 3: (void) mongets(mtmp,SCR_TELEPORTATION);
			case 4: (void) mongets(mtmp,WAN_TELEPORTATION);
			default:
				break;
		    }
		} else if (ptr->msound == MS_PRIEST || mtmp->data == &mons[PM_UNALIGNED_PRIEST] ||
			quest_mon_represents_role(ptr,PM_PRIEST)) {

		    /* evil patch idea by jonadab: 5% chance for aligned priests to be generated invisible */

		    (void) mongets(mtmp,
			    !rn2(20) ? CLOAK_OF_INVISIBILITY : rn2(7) ? rnd_class(ROBE,ROBE_OF_WEAKNESS) :
					     rn2(3) ? CLOAK_OF_PROTECTION :
						 CLOAK_OF_MAGIC_RESISTANCE);
		    (void) mongets(mtmp, SMALL_SHIELD);
#ifndef GOLDOBJ
		    mtmp->mgold = (long)rn1(10,20);
#else
		    mkmonmoney(mtmp,(long)rn1(10,20));
#endif
		} else if (quest_mon_represents_role(ptr,PM_MONK)) {
		    (void) mongets(mtmp, rn2(11) ? ROBE :
					     CLOAK_OF_MAGIC_RESISTANCE);
		}
		if (mtmp->data == &mons[PM_WIZARD_OF_YENDOR]) (void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if (ishaxor && mtmp->data == &mons[PM_WIZARD_OF_YENDOR]) (void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);

		break;

	    case S_PIERCER:

		if (mtmp->data == &mons[PM_DING_CLING_PIERCER]) (void) mongets(mtmp, SCR_STALACTITE);
		if (ptr == &mons[PM_CUTE_NICKNAME]) (void) mongets(mtmp, YITH_TENTACLE);
		if (ptr == &mons[PM_SPIRIT_AXER]) (void) mongets(mtmp, SPIRIT_AXE);
		if (ptr == &mons[PM_EVIL_PENGUIN]) (void) mongets(mtmp, PARASOL);
		if (ptr == &mons[PM_ROGUE_PENGUIN]) (void) mongets(mtmp, UMBRELLA);
		if (ptr == &mons[PM_NEW_POTATO_ER]) (void) mongets(mtmp, POTATO_BAG);
		if (ptr == &mons[PM_SMALL_POTATO_ER]) (void) mongets(mtmp, POTATO_BAG);
		if (ptr == &mons[PM_POTATO_ER]) (void) mongets(mtmp, POTATO_BAG);
		if (ptr == &mons[PM_OLDER_POTATO_ER]) (void) mongets(mtmp, POTATO_BAG);
		if (ptr == &mons[PM_LARGER_POTATO_ER]) (void) mongets(mtmp, POTATO_BAG);
		if (ptr == &mons[PM_OLD_POTATO_ER]) (void) mongets(mtmp, POTATO_BAG);
		if (ptr == &mons[PM_SPEAR_PENGUIN]) {
			 m_initthrow(mtmp, SPEAR, 5);
		}

		if (mtmp->data == &mons[PM_JIGEN_DAISUKE]) { (void) mongets(mtmp, ROCKET_LAUNCHER); (void) mongets(mtmp, ROCKET_LAUNCHER); m_initthrow(mtmp, ROCKET, 10); m_initthrow(mtmp, ROCKET, 10); m_initthrow(mtmp, ROCKET, 10); }
		if (mtmp->data == &mons[PM_JUEN_S_LEATHER_PEEP_TOE]) (void) mongets(mtmp, LEATHER_PEEP_TOES);
		if (mtmp->data == &mons[PM_WANDERING_PENGUIN]) {
			 (void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, ROCK, 50);
		}

		break;

	    case S_GOLEM:
		if (mtmp->data == &mons[PM_ROBO_KY]) { (void) mongets(mtmp, ROCKET_LAUNCHER); m_initthrow(mtmp, ROCKET, 10); }
		if (mtmp->data == &mons[PM_TGWTG]) { (void) mongets(mtmp, SUBMACHINE_GUN); m_initthrow(mtmp, SMG_BULLET, 50); m_initthrow(mtmp, SMG_BULLET, 50); }

		if (ptr == &mons[PM_HOT_PLATE]) {
			(void) maketrap(mtmp->mx, mtmp->my, FIRE_TRAP, 0, FALSE);
		}

		if (ptr == &mons[PM_RIM_GOLEM]) {
			(void) mongets(mtmp, SHOTGUN);
			 m_initthrow(mtmp, LEAD_SHOT, 30);
		}
		if (ptr == &mons[PM_EXTRACHROME_GOLEM]) {
			(void) mongets(mtmp, SHOTGUN);
			 m_initthrow(mtmp, CHROME_PELLET, 30);
		}
		if (ptr == &mons[PM_WAND_OF_WISHING_GOLEM]) {
			struct obj *lolwow = mksobj(WAN_WISHING, TRUE, 2, FALSE);
			if (lolwow) {
				lolwow->quan = 1;
				lolwow->spe = -1;
				lolwow->recharged = 1;
				lolwow->owt = weight(lolwow);
				(void) mpickobj(mtmp, lolwow, TRUE);
			}

		}

		if (ptr == &mons[PM_FESTIVUS_POLE]) {
			(void) mongets(mtmp, rnd_class(PARTISAN,BEC_DE_CORBIN));
		}

		if (ptr == &mons[PM_REFRACTOCHUCK]) {
			(void) mongets(mtmp, CRYSTAL_SWORD);
			(void) mongets(mtmp, CRYSTAL_SHIELD);
		}
		if (ptr == &mons[PM_SWORDPRESENT_GOLEM]) {
			(void) mongets(mtmp, LEATHER_SABER);
			(void) mongets(mtmp, LEATHER_SABER);
			(void) mongets(mtmp, LEATHER_SABER);
			(void) mongets(mtmp, LEATHER_SABER);
		}
		if (ptr == &mons[PM_BLACK_SOOTBALL]) {
			(void) mongets(mtmp, BITUKNIFE);
		}
		if (ptr == &mons[PM_KILLER_KATANA]) {
			(void) mongets(mtmp, KATANA);
		}
		if (ptr == &mons[PM_FLYING_UMBRELLA]) {
			(void) mongets(mtmp, UMBRELLA);
		}
		if (ptr == &mons[PM_STARFIGHTER]) {
			(void) mongets(mtmp, LASER_POLE);
		}
		if (ptr == &mons[PM_ARTISAN_FEMMY]) {
			(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		}
		if (ptr == &mons[PM_BARNACLE_ARMORED_GOLEM]) {
			(void) mongets(mtmp, BARNACLE_ARMOR);
		}
		if (ptr == &mons[PM_BURNING_TORCH]) {
			(void) mongets(mtmp, TORCH);
		}
		if (ptr == &mons[PM_FAN_GOLEM]) {
			(void) mongets(mtmp, CARDBOARD_FAN);
		}
		if (ptr == &mons[PM_STICKSHOE]) {
			(void) mongets(mtmp, STICKSHOE);
		}
		if (ptr == &mons[PM_WHIFF_GOLEM]) {
			(void) mongets(mtmp, PAPER_SWORD);
		}
		if (ptr == &mons[PM_BIG_DADDY]) {
			(void) mongets(mtmp, ASSAULT_RIFLE);
			 m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
			 m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 25);
		}
		if (ptr == &mons[PM_GARZIEM]) {
			(void) mongets(mtmp, HEAVY_MACHINE_GUN);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
		}
		if (ptr == &mons[PM_UTIMA_DESTROYER_OF_XEREN]) {
			(void) mongets(mtmp, SNIPER_RIFLE);
			 m_initthrow(mtmp, LEAD_SNIPER_BULLET, 50);
			 m_initthrow(mtmp, LEAD_SNIPER_BULLET, 50);
		}
		if (ptr == &mons[PM_PLASTIC_EXPLOSIVES_GOLEM]) {
			(void) mongets(mtmp, STICK_OF_DYNAMITE);
			 m_initthrow(mtmp, FRAG_GRENADE, 20);
		}
		if (ptr == &mons[PM_OCTIRON_GOLEM]) {
			(void) mongets(mtmp, PARTISAN);
			(void) mongets(mtmp, IRON_BAR);
		}
		if (ptr == &mons[PM_LEVEL_ONE_GOLEM]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, !rn2(3) ? TALC : !rn2(2) ? GRAPHITE : SMALL_PIECE_OF_UNREFINED_MITHR, 30);
		}
		if (ptr == &mons[PM_VALUABLE_GOLEM]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, DWARVISH_MITHRIL_COAT);
			(void) mongets(mtmp, HIGH_ELVEN_HELM);
			 m_initthrow(mtmp, SMALL_PIECE_OF_UNREFINED_MITHR, 40);
		}
		if (ptr == &mons[PM_VOLCANIC_GOLEM]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, DROVEN_SHORT_SWORD);
			(void) mongets(mtmp, CRYSTAL_PLATE_MAIL);
			 m_initthrow(mtmp, VOLCANIC_GLASS_FRAGMENT, 50);
		}
		if (mtmp->data == &mons[PM_THING_CUSTOMER_GOLEM]) (void) mongets(mtmp, FLY_SWATTER);
		if (mtmp->data == &mons[PM_BRITISH_ARMY_SURPLUS_BOOT]) (void) mongets(mtmp, LOW_BOOTS);

		if (mtmp->data == &mons[PM_ANIMATED_PAVEMENT_HEEL]) (void) mongets(mtmp, ITALIAN_HEELS); /* M4_SANDALS */
		if (mtmp->data == &mons[PM_KOP_HOSE]) (void) mongets(mtmp, RUBBER_HOSE);
		if (mtmp->data == &mons[PM_HOSE_SERGEANT]) (void) mongets(mtmp, RUBBER_HOSE);
		if (mtmp->data == &mons[PM_HOSE_LIEUTENANT]) (void) mongets(mtmp, RUBBER_HOSE);
		if (mtmp->data == &mons[PM_HOSE_KAPTAIN]) (void) mongets(mtmp, RUBBER_HOSE);
		if (mtmp->data == &mons[PM_HOSE_KOMMISSIONER]) (void) mongets(mtmp, RUBBER_HOSE);
		if (mtmp->data == &mons[PM_HOSE_KCHIEF]) (void) mongets(mtmp, RUBBER_HOSE);
		if (mtmp->data == &mons[PM_HOSE_KATCHER]) (void) mongets(mtmp, RUBBER_HOSE);
		if (mtmp->data == &mons[PM_HOSE_KRIMINOLOGIST]) (void) mongets(mtmp, RUBBER_HOSE);
		if (mtmp->data == &mons[PM_HOSE_KEELHAULER]) (void) mongets(mtmp, RUBBER_HOSE);
		if (mtmp->data == &mons[PM_HOSE_KLEEVER]) (void) mongets(mtmp, RUBBER_HOSE);

		if (ptr == &mons[PM_GAUNTPEEKER]) {
			(void) mongets(mtmp, UNKNOWN_KNIFE);
			(void) mongets(mtmp, LEATHER_GLOVES);
		}

		if (ptr == &mons[PM_LOVEHEEL_SHOE]) {
			register struct obj *lvhl;
			int objtyp = 0;
			int tryct = 0;

loveheeltry:
			objtyp = rn2(NUM_OBJECTS);
			if (objects[objtyp].oc_prob < 1) {
				tryct++;
				if (tryct < 50000) goto loveheeltry;
				else goto loveheelover;
			}

			if (objects[objtyp].oc_class != ARMOR_CLASS || !ishighheeledb(objtyp) ) {
				tryct++;
				if (tryct < 50000) goto loveheeltry;
				else goto loveheelover;
			}

			lvhl = mksobj(objtyp, TRUE, FALSE, FALSE);
			if (lvhl)
				(void) mpickobj(mtmp, lvhl, TRUE);

		}
loveheelover:

		if (ptr == &mons[PM_ONIJI_TANKOBO]) (void) mongets(mtmp, YITH_TENTACLE);
		if (ptr == &mons[PM_SINK_GOLEM]) (void) mongets(mtmp, SCR_SINKING);
		if (ptr == &mons[PM_CFOUR]) m_initthrow(mtmp, BOOMERANG, 1);
		if (ptr == &mons[PM_FRAGMENT_GOLEM]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, BONE_FRAGMENT, 30);
		}
		if (ptr == &mons[PM_CLUMPED_GOLEM]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, LEAD_CLUMP, 30);
		}
		if (ptr == &mons[PM_ROCKSHOT_GOLEM]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SLING_AMMO, 30);
		}

		if(mtmp->data == &mons[PM_MELUGAST_TYPEM]) {
			(void) mongets(mtmp, LONG_SWORD);
			(void) mongets(mtmp, ELVEN_CLOAK);
			(void) mongets(mtmp, ARM_BLASTER);
			 m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
			 m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);

		}
		if (ptr == &mons[PM_GL_GOLEM]) {
			(void) mongets(mtmp, GRENADE_LAUNCHER);
			m_initthrow(mtmp, FRAG_GRENADE, 25);
		}
		if (mtmp->data == &mons[PM_CHROME_GOLEM]) {
			(void) mongets(mtmp, SHOTGUN);
			m_initthrow(mtmp, SHOTGUN_SHELL, 30);
		}
		if(mtmp->data == &mons[PM_KONIGS_KATZE]) {
			(void) mongets(mtmp, ROCKET_LAUNCHER);
			 m_initthrow(mtmp, ROCKET, 30);
		}
		if(mtmp->data == &mons[PM_ZOIBO]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, ROCK, 50);
			 m_initthrow(mtmp, ROCK, 50);
		}

		if(mtmp->data == &mons[PM_GRAY_STONE_GOLEM]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, rnd_class(RIGHT_MOUSE_BUTTON_STONE,NASTY_STONE));
			(void) mongets(mtmp, rnd_class(RIGHT_MOUSE_BUTTON_STONE,NASTY_STONE));
		}
		if (mtmp->data == &mons[PM_DILDO_GOLEM]) {
			 (void) mongets(mtmp, VIBROBLADE);
		}
		if (mtmp->data == &mons[PM_MUSCLE_GOLEM]) {
			 (void) mongets(mtmp, CLUB);
			 m_initthrow(mtmp, JAVELIN, 4);
		}
		if (mtmp->data == &mons[PM_HC_DENTER]) {
			 (void) mongets(mtmp, TRIDENT);
		}
		if (mtmp->data == &mons[PM_UNICORN_GOLEM]) {
			 (void) mongets(mtmp, UNICORN_HORN);
		}
		if (mtmp->data == &mons[PM_BEARD_GOLEM]) {
			 (void) mongets(mtmp, HELMET_BEARD);
			 (void) mongets(mtmp, HELMET);
		}
		if (mtmp->data == &mons[PM_RETARDED_GOLEM]) {
			 (void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, ROCK, 30);
		}
		if (mtmp->data == &mons[PM_PUTIT_TANK]) {
			 (void) mongets(mtmp, PISTOL);
			 m_initthrow(mtmp, PISTOL_BULLET, 25);
		}
		if (mtmp->data == &mons[PM_YERLES_CONBAT_PLANE]) {
			 m_initthrow(mtmp, FRAG_GRENADE, 20);
		}
		if (mtmp->data == &mons[PM_TANJA_CONBAT_PLANE]) {
			 m_initthrow(mtmp, FRAG_GRENADE, 20);
		}
		if (mtmp->data == &mons[PM_LANCE_GOLEM]) {
			 (void) mongets(mtmp, LANCE);
			 (void) mongets(mtmp, ORCISH_HELM);
		}

		if (mtmp->data == &mons[PM_CHEMISTRY_GOLEM]) {
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
		}

		if (mtmp->data == &mons[PM_ZAP_GOLEM]) {
			 (void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM) );
			 (void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM) );
			 (void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM) );
			 (void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM) );
			 (void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM) );
		}

		if (mtmp->data == &mons[PM_READER_GOLEM]) {
			 (void) mongets(mtmp, rnd_class(SCR_CREATE_MONSTER, SCR_BLANK_PAPER) );
			 (void) mongets(mtmp, rnd_class(SCR_CREATE_MONSTER, SCR_BLANK_PAPER) );
			 (void) mongets(mtmp, rnd_class(SCR_CREATE_MONSTER, SCR_BLANK_PAPER) );
			 (void) mongets(mtmp, rnd_class(SCR_CREATE_MONSTER, SCR_BLANK_PAPER) );
			 (void) mongets(mtmp, rnd_class(SCR_CREATE_MONSTER, SCR_BLANK_PAPER) );
		}

		if (mtmp->data == &mons[PM_GIANT_PENIS_GOLEM]) {
			 (void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM) );
			 (void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM) );
			 (void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM) );
			 (void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM) );
			 (void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM) );
			 (void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM) );
			 (void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM) );
			 (void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM) );
			 (void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM) );
			 (void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM) );
		}

		if (mtmp->data == &mons[PM_ALCHEMY_GOLEM]) {
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
			 (void) mongets(mtmp, rnd_class(POT_BOOZE, POT_AMNESIA) );
		}

		if (mtmp->data == &mons[PM_WEAPON_GOLEM]) {
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		}

		if (mtmp->data == &mons[PM_ARMOR_GOLEM]) {
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
		}

		if (mtmp->data == &mons[PM_FIGHTER_GOLEM]) {
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		}

		if (mtmp->data == &mons[PM_PROTECTER_GOLEM]) {
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
		}

		if (mtmp->data == &mons[PM_SWINGER_GOLEM]) {
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		}

		if (mtmp->data == &mons[PM_TANKER_GOLEM]) {
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
		}

		if (mtmp->data == &mons[PM_HEAVILY_ARMED_GOLEM]) {
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		}

		if (mtmp->data == &mons[PM_TANK_GOLEM]) {
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
		}

		if (mtmp->data == &mons[PM_MILITARY_GOLEM]) {
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		}

		if (mtmp->data == &mons[PM_INDUSTRY_GOLEM]) {
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
			 (void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS) );
		}

		break;

	    case S_FELINE:
		if (mtmp->data == &mons[PM_CUTCAT]) {
			 (void) mongets(mtmp, CUTTING_LASER);
			 m_initthrow(mtmp, LASER_BEAM, 50);
		}
		if (mtmp->data == &mons[PM_DESERT_PERSIAN]) {
			 (void) mongets(mtmp, YATAGAN);
		}
		if (mtmp->data == &mons[PM_CATCALL_SELINA]) {
			 (void) mongets(mtmp, ETHER_WHIP);
		}
		if (mtmp->data == &mons[PM_SARS_SLINGER]) {
			 m_initthrow(mtmp, ASBESTOS_JAVELIN, 5);
		}
		if (ptr == &mons[PM_DAY_SLINGER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, LEAD_CLUMP, 30);
		}
		if (ptr == &mons[PM_SALT_SLINGER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SALT_CHUNK, 35);
		}
		if (ptr == &mons[PM_VOLCANIC_SLINGER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, VOLCANIC_GLASS_FRAGMENT, 40);
		}
		if (mtmp->data == &mons[PM_WEAPONBEARING_LION]) {
			 (void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, ARROW, 25);
		}
		if (mtmp->data == &mons[PM_MISS_ENTREPRENEURIAL]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (mtmp->data == &mons[PM_ELOJAGUAR_WARRIOR]) (void) mongets(mtmp, LONG_SWORD);
		if (mtmp->data == &mons[PM_ALIEN_IN_BRIDAL_DRESS]) (void) mongets(mtmp, GENTLEWOMAN_S_DRESS);
		if (mtmp->data == &mons[PM_NIGHT_HIDER]) (void) mongets(mtmp, LOWER_ARM_BLADE);

		break;

	    case S_ZOMBIE:

		if (mtmp->data == &mons[PM_FINGERNAIL_ZOMBIE]) (void) mongets(mtmp, LOWER_ARM_BLADE);
		if (mtmp->data == &mons[PM_ZOMBIE_WHORE]) (void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		if (ptr == &mons[PM_DOSTICH]) (void) mongets(mtmp, KHOPESH);

		if (mtmp->data == &mons[PM_ROBOT_TERMINATOR_ZOMBIE]) {
			 (void) mongets(mtmp, RED_LIGHTSABER);
		}
		if (mtmp->data == &mons[PM_DEEP_CRYPT_ZOMBIE]) {
			 (void) mongets(mtmp, SCR_CRYPT);
		}
		if (mtmp->data == &mons[PM_SHARP_BLACK_POISON]) {
			 (void) mongets(mtmp, OBSIDIAN_AXE);
		}
		if (mtmp->data == &mons[PM_BONE_THROW_BACK_AND_FORTH_SKELETON]) {
			 (void) mongets(mtmp, BONE_CLUB);
			 m_initthrow(mtmp, BONE_DAGGER, 7);
		}
		if (mtmp->data == &mons[PM_BOULDER_ZOMBIE]) {
			 (void) mongets(mtmp, BOULDER);
			 (void) mongets(mtmp, BOULDER);
			 (void) mongets(mtmp, BOULDER);
		}
		if (ptr == &mons[PM_MONEY_DECEASED]) {
		    mtmp->mgold += (long) rnd(200);
		}
		if (mtmp->data == &mons[PM_BARTOLI_MEANIE]) {
			(void) mongets(mtmp, PISTOL);
			 m_initthrow(mtmp, PISTOL_BULLET, 50);
		}
		if (mtmp->data == &mons[PM_DEADBONE_ARCHER]) {
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, BONE_ARROW, 40);
		}
		if (mtmp->data == &mons[PM_SILKMAN]) {
			 m_initthrow(mtmp, SOFT_STAR, 50);
		}
		if (mtmp->data == &mons[PM_BONEMAN]) {
			 m_initthrow(mtmp, SPIKE, 40);
		}
		if (mtmp->data == &mons[PM_TARMAN]) {
			 m_initthrow(mtmp, TAR_STAR, 30);
		}
		if (mtmp->data == &mons[PM_ETHERIC_UFO_PART]) {
			(void) mongets(mtmp, CROSSBOW);
			 m_initthrow(mtmp, ETHER_BOLT, 50);
		}
		if (mtmp->data == &mons[PM_CONSTRUCTED_UFO_PART]) {
			(void) mongets(mtmp, CROSSBOW);
			 m_initthrow(mtmp, MATERIAL_BOLT, 50);
		}
		if (mtmp->data == &mons[PM_MATURE_WEARER]) {
			 (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		}
		if (mtmp->data == &mons[PM_SKELETOR_IN_HEELS]) {
			 (void) mongets(mtmp, !rn2(3) ? LADY_BOOTS : !rn2(2) ? STILETTO_SANDALS : ITALIAN_HEELS); /* M4_BLOCKHEELBOOTS|M4_SANDALS */
		}
		if (mtmp->data == &mons[PM_ZOMBIE_GIRL]) {
			 (void) mongets(mtmp, SHORT_SWORD);
		}
		if (mtmp->data == &mons[PM_CHRISTMAS_MAN]) {
			 (void) mongets(mtmp, CHOCOLATE);
			 (void) mongets(mtmp, CHOCOEGG);
		}
		if (mtmp->data == &mons[PM_GOTHIC]) {
			 (void) mongets(mtmp, KATANA);
			 (void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, ROCK, 50);
		}
		if (mtmp->data == &mons[PM_REAL_NECRO_LANCER]) {
			 (void) mongets(mtmp, LANCE);
		}
		if (mtmp->data == &mons[PM_REQUIEM]) {
			 (void) mongets(mtmp, LONG_SWORD);
			 (void) mongets(mtmp, SNIPER_RIFLE);
			 m_initthrow(mtmp, SNIPER_BULLET, 50);
		}
		if (mtmp->data == &mons[PM_ZOMBIE_QUEEN]) {
			 (void) mongets(mtmp, BULLWHIP);
			 m_initthrow(mtmp, FRAG_GRENADE, 20);
		}
		if (mtmp->data == &mons[PM_SKELETON_HERO]) {
			 (void) mongets(mtmp, TWO_HANDED_SWORD);
		}
		if (mtmp->data == &mons[PM_ACTUAL_MINER_ZOMBIE]) {
			 (void) mongets(mtmp, PICK_AXE);
		}
		if (mtmp->data == &mons[PM_WALKING_STICK_BLUBBERER]) {
			 (void) mongets(mtmp, WALKING_STICK);
		}
		if (mtmp->data == &mons[PM_SPADE_TYPE]) {
			 (void) mongets(mtmp, PICK_AXE);
		}
		if (mtmp->data == &mons[PM_AXE_ZOMBIE]) {
			 (void) mongets(mtmp, AXE);
		}
		if (mtmp->data == &mons[PM_ACIDRAUGR]) {
			 (void) mongets(mtmp, WAN_ACID);
		}
		if (mtmp->data == &mons[PM_POT_SKELETON]) {
			(void) mongets(mtmp, POT_ACID);
			if (rn2(3)) {
				(void) mongets(mtmp, POT_ACID);
				if (!rn2(2)) (void) mongets(mtmp, POT_ACID);
			}
		}

		if (mtmp->data == &mons[PM_ZOMBIEMAN]) {
			if (!rn2(2)) {
				(void) mongets(mtmp, HAND_BLASTER);
				m_initthrow(mtmp, BLASTER_BOLT, 20);
			} else {
				(void) mongets(mtmp, SHOTGUN);
				 m_initthrow(mtmp, SHOTGUN_SHELL, 15);
			}
		}

		break;

	    case S_IMP:

		if (mtmp->data == &mons[PM_ENTERTAINER_IMP]) (void) mongets(mtmp, JARED_STONE);
		if (mtmp->data == &mons[PM_SHARP_SANDMAN]) (void) mongets(mtmp, QATAR);
		if (mtmp->data == &mons[PM_WRIST_TENGU]) (void) mongets(mtmp, LOWER_ARM_BLADE);
		if (mtmp->data == &mons[PM_EASTERN_FEMMY]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (mtmp->data == &mons[PM_UNLUCKY_GIRL]) (void) mongets(mtmp, DOGSHIT_BOOT);

		if (ptr == &mons[PM_ARENA_IMP]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, BONE_FRAGMENT, 10);
		}
		if (ptr == &mons[PM_MYSTERIOUS_NINJA]) {
			 m_initthrow(mtmp, MYSTERY_SHURIKEN, 70);
		}
		if (ptr == &mons[PM_MASTER_ARCH_VILE]) {
			 m_initthrow(mtmp, JUMPING_FLAMER, 50);
		}
		if (ptr == &mons[PM_EGELVEIL_THE_BIND]) {
			(void) mongets(mtmp, SMALL_SHIELD);
			(void) mongets(mtmp, PLATE_MAIL);
			(void) mongets(mtmp, LOW_BOOTS);
			 m_initthrow(mtmp, FRAG_GRENADE, 10);
		}
		if (ptr == &mons[PM_TALC_DEMON]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, ORCISH_HELM);
			 m_initthrow(mtmp, TALC, 20);
		}
		if (ptr == &mons[PM_FILLEMURE]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SMALL_PIECE_OF_UNREFINED_MITHR, 10);
		}
		if (mtmp->data == &mons[PM_LEGION_DEVIL_BUZZER]) {
			 (void) mongets(mtmp, HAND_BLASTER);
			m_initthrow(mtmp, BLASTER_BOLT, 40);
		}
		if (mtmp->data == &mons[PM_LEGION_DEVIL_LAUGHER]) {
			 (void) mongets(mtmp, GLAIVE);
			 (void) mongets(mtmp, HELMET);
			 (void) mongets(mtmp, LOW_BOOTS);
		}
		if (mtmp->data == &mons[PM_LEGION_DEVIL_ZAPPER]) {
			 (void) mongets(mtmp, ARM_BLASTER);
			m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		}
		if (mtmp->data == &mons[PM_LEGION_DEVIL_CUTTER]) {
			 (void) mongets(mtmp, CUTTING_LASER);
			m_initthrow(mtmp, LASER_BEAM, 50);
		}
		if (mtmp->data == &mons[PM_LEGION_DEVIL_RAYMAN]) {
			 (void) mongets(mtmp, RAYGUN);
			m_initthrow(mtmp, RAYGUN_BOLT, 50);
		}
		if (mtmp->data == &mons[PM_JESUS]) {
			 (void) mongets(mtmp, ARM_BLASTER);
			m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		}
		if (mtmp->data == &mons[PM_MEASURE_CROOK]) {
			m_initthrow(mtmp, KNIFE, 3);
		}
		if (mtmp->data == &mons[PM_MEDIUM_CROOK]) {
			m_initthrow(mtmp, UNKNOWN_KNIFE, 3);
			 (void) mongets(mtmp, LEATHER_CLOAK);
			 (void) mongets(mtmp, STUDDED_LEATHER_ARMOR);
			 (void) mongets(mtmp, CHAIN_COIF);
		}
		if (mtmp->data == &mons[PM_PRIME_KNIGHT]) {
			 (void) mongets(mtmp, HEAVY_LONG_SWORD);
			 (void) mongets(mtmp, NANO_SUIT);
			 (void) mongets(mtmp, ANCIENT_SHIELD);
		}

		if (mtmp->data == &mons[PM_ARROGANCE]) (void) mongets(mtmp, WAN_TRAP_CREATION);
		if (mtmp->data == &mons[PM_OCK]) (void) mongets(mtmp, MORNING_STAR);
		if (mtmp->data == &mons[PM_METAL_EMBATTLED_GIGANTIC_ULTIMATE_MIKI_IMPALER]) { (void) mongets(mtmp, ROCKET_LAUNCHER); m_initthrow(mtmp, ROCKET, 7);}
		if (mtmp->data == &mons[PM_MACROSS_VALKARIE]) { (void) mongets(mtmp, ROCKET_LAUNCHER); m_initthrow(mtmp, ROCKET, 10);}
		if (mtmp->data == &mons[PM_THE_WING_ZERO]) { (void) mongets(mtmp, ROCKET_LAUNCHER); m_initthrow(mtmp, ROCKET, 20);}

		if (mtmp->data == &mons[PM_ARCH_VILE]) (void) mongets(mtmp, WAN_CREATE_HORDE);
		if (mtmp->data == &mons[PM_HERRER]) (void) mongets(mtmp, WAN_CREATE_MONSTER);
		if (mtmp->data == &mons[PM_ANJA_S_SNEAKER]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (mtmp->data == &mons[PM_EVA_S_MOCASSIN]) { (void) mongets(mtmp, SWEET_MOCASSINS); (void) mongets(mtmp, SCR_TRAP_CREATION); }
		if (mtmp->data == &mons[PM_KLARA_S_HIGH_HEELED_SANDAL]) { (void) mongets(mtmp, HIGH_HEELED_SANDAL); (void) mongets(mtmp, WEDGE_SANDALS); (void) mongets(mtmp, SCR_TRAP_CREATION); (void) mongets(mtmp, POT_SPEED); } /* M4_HAMMERSANDAL|M4_SANDALS */
		if (mtmp->data == &mons[PM_LARISSA_S_GIRL_BOOT]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if (mtmp->data == &mons[PM_SANDRA_S_HIGH_HEELED_COMBAT_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, COMBAT_STILETTOS); (void) mongets(mtmp, SCR_TRAP_CREATION); }
		if (mtmp->data == &mons[PM_ANJA_S_EROTIC_BOOT]) { (void) mongets(mtmp, SPIKED_BATTLE_BOOT); (void) mongets(mtmp, COMBAT_STILETTOS); }
		if (mtmp->data == &mons[PM_NADJA_S_EROTIC_LADY_SHOE]) { (void) mongets(mtmp, LACQUERED_DANCING_SHOE); (void) mongets(mtmp, FEMININE_PUMPS); (void) mongets(mtmp, SCR_TRAP_CREATION); } /* M4_PUMPS */
		if (mtmp->data == &mons[PM_KLARA_S_SEXY_NURSE_PUMP]) { (void) mongets(mtmp, FEMININE_PUMPS); (void) mongets(mtmp, SEXY_LEATHER_PUMP); } /* M4_PUMPS */

		break;

	    case S_BAT:

		if (mtmp->data == &mons[PM_KILILI_JETTE]) (void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_INVINCIBLE_JETTE]) (void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_BEARD_SHEARER]) (void) mongets(mtmp, SCALPEL);

		if (mtmp->data == &mons[PM_POLE_DUCK]) {
			(void) mongets(mtmp, RUBBER_HOSE);
			m_initthrow(mtmp, CREAM_PIE, 2);
		}
		if (mtmp->data == &mons[PM_AA_SMALLPENIS]) {
			(void) mongets(mtmp, OSBANE_KATANA);
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, SCR_BULLSHIT);
			(void) mongets(mtmp, SCR_NASTINESS);
		}
		if (mtmp->data == &mons[PM_HOEING_BIRD]) {
			(void) mongets(mtmp, HOE_SABLE);
		}
		if (mtmp->data == &mons[PM_SPIKY_CROW]) {
			(void) mongets(mtmp, CROW_QUILL);
		}
		if (mtmp->data == &mons[PM_XTRA_SPIKY_CROW]) {
			(void) mongets(mtmp, CROW_QUILL);
		}
		if (mtmp->data == &mons[PM_GUY_WITH_THE_DOG]) {
			(void) mongets(mtmp, LEATHER_LEASH);
		}
		if (mtmp->data == &mons[PM_COOK_COOK]) {
			(void) mongets(mtmp, SCR_VISIBLE_ITEM);
		}
		if (mtmp->data == &mons[PM_FROM_THE_ASHES_PHOENIX]) {
			(void) mongets(mtmp, PHEONIX_STAFF);
		}
		if (mtmp->data == &mons[PM_BLOBAT]) {
			(void) mongets(mtmp, BOULDER);
			(void) mongets(mtmp, BOULDER);
			(void) mongets(mtmp, BOULDER);
		}

		if (ptr == &mons[PM_STINGSWEEPER]) {
			 m_initthrow(mtmp, SAND_DART, 50);
		}
		if (mtmp->data == &mons[PM_BUNTER]) {
			(void) mongets(mtmp, HUNTING_RIFLE);
			m_initthrow(mtmp, RIFLE_BULLET, 45);
		}
		if (mtmp->data == &mons[PM_REAL_ARROW_DUCK]) {
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 45);
		}
		if (mtmp->data == &mons[PM_REAL_BOLT_DUCK]) {
			(void) mongets(mtmp, CROSSBOW);
			m_initthrow(mtmp, CROSSBOW_BOLT, 55);
		}
		if (mtmp->data == &mons[PM_REAL_BULLET_DUCK]) {
			(void) mongets(mtmp, RIFLE);
			m_initthrow(mtmp, RIFLE_BULLET, 50);
		}
		if (mtmp->data == &mons[PM_PREDATOR_DRONE]) {
			(void) mongets(mtmp, ARM_BLASTER);
			m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
			m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		}
		if (mtmp->data == &mons[PM_HUNTBIRD]) {
			(void) mongets(mtmp, HUNTING_RIFLE);
			m_initthrow(mtmp, LEAD_RIFLE_BULLET, 45);
		}
		if (mtmp->data == &mons[PM_SCYTHING_BIRD]) {
			(void) mongets(mtmp, SCYTHE);
		}

		if (ptr == &mons[PM_SPERRBER]) {
			 m_initthrow(mtmp, SPEAR, 4);
		}

		if (mtmp->data == &mons[PM_BLUE_FEMMY]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if (mtmp->data == &mons[PM_BELINAY]) (void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_SUPER_MARIO_CONDOR]) (void) mongets(mtmp, SCR_SAND);
		if (mtmp->data == &mons[PM_CONFSHIFT_BAT]) (void) mongets(mtmp, WAN_POLYMORPH);
		if (mtmp->data == &mons[PM_DINGBAT]) (void) mongets(mtmp, BELL);

		if (mtmp->data == &mons[PM_ARCEUS]) (void) mongets(mtmp, WAN_CHROMATIC_BEAM);
		if (mtmp->data == &mons[PM_EXTRA_DONALD]) (void) mongets(mtmp, AMULET_OF_LIFE_SAVING);
		if (mtmp->data == &mons[PM_KARIN_S_FLAT_SANDAL]) (void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		if (mtmp->data == &mons[PM_JASIEEN_S_WEDGE_SANDAL]) { (void) mongets(mtmp, WEDGE_SANDALS); (void) mongets(mtmp, SCR_TRAP_CREATION); (void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); } /* M4_HAMMERSANDAL|M4_SANDALS */
		if (mtmp->data == &mons[PM_RITA_S_SWEET_STILETTO]) { (void) mongets(mtmp, FEMININE_PUMPS); (void) mongets(mtmp, SEXY_LEATHER_PUMP); } /* M4_PUMPS */
		if (mtmp->data == &mons[PM_PATRICIA_S_STEEL_CAPPED_SANDAL]) { (void) mongets(mtmp, STEEL_CAPPED_SANDAL); } /* M4_HAMMERSANDAL */
		if (mtmp->data == &mons[PM_KERSTIN_S_LOVELY_SNEAKER]) { (void) mongets(mtmp, SOFT_SNEAKERS); (void) mongets(mtmp, SOFT_GIRL_SNEAKER); } /* M4_SNEAKERS */
		if (mtmp->data == &mons[PM_MELTEM_S_COMBAT_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_KERSTIN_S_LOVELY_COMBAT_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_KARIN_S_COMBAT_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_KERSTIN_S_WOODEN_SANDAL]) { (void) mongets(mtmp, WEDGE_SANDALS); (void) mongets(mtmp, WOODEN_GETA); } /* M4_HAMMERSANDAL|M4_SANDALS */

		if (mtmp->data == &mons[PM_COM_BAT]) {
			(void) mongets(mtmp, HAND_BLASTER);
			m_initthrow(mtmp, BLASTER_BOLT, 50);
		}

		if (mtmp->data == &mons[PM_BIRD_ARCHER]) {
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 50);
			m_initthrow(mtmp, ARROW, 40);
		}

		if (mtmp->data == &mons[PM_GARUDA]) {
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 50);
			m_initthrow(mtmp, ARROW, 50);
		}

		if (mtmp->data == &mons[PM_LAST_RAVEN]) {
			(void) mongets(mtmp, RAYGUN);
			m_initthrow(mtmp, RAYGUN_BOLT, 50);
			m_initthrow(mtmp, RAYGUN_BOLT, 50);
		}

		if (mtmp->data == &mons[PM_KAPAPU_KAMUI]) {
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 50);
		}

		break;

	    case S_LIZARD:

		if (mtmp->data == &mons[PM_SPECTRAL_LIZARD]) (void) mongets(mtmp, SPIRIT_AXE);
		if (mtmp->data == &mons[PM_GIANT_SWAMP_FROG]) (void) mongets(mtmp, SCR_MOORLAND);
		if (mtmp->data == &mons[PM_GRAY_SLAAD]) (void) mongets(mtmp, TWO_HANDED_SWORD);
		if (mtmp->data == &mons[PM_DEATH_SLAAD]) (void) mongets(mtmp, TWO_HANDED_SWORD);
		if (mtmp->data == &mons[PM_CLAYMORE_DRAGONEWT]) (void) mongets(mtmp, TWO_HANDED_SWORD);
		if (mtmp->data == &mons[PM_LUSTY_ARGONIAN_MAID]) (void) mongets(mtmp, MAID_DRESS);
		if (mtmp->data == &mons[PM_PALMIAN_ETHER_SOLDIER]) (void) mongets(mtmp, ETHER_KNOUT);
		if (mtmp->data == &mons[PM_RUNE_LIZARD]) (void) mongets(mtmp, RUNED_ROD);
		if (mtmp->data == &mons[PM_STAR_SQUIRREL]) (void) mongets(mtmp, STAR_ROD);
		if (mtmp->data == &mons[PM_SCRAPER_TROGLODYTE]) (void) mongets(mtmp, INFERNAL_BARDICHE);
		if (mtmp->data == &mons[PM_SPACE_SITH]) (void) mongets(mtmp, SITH_STAFF);
		if (mtmp->data == &mons[PM_POWERFIST_DRACONIAN]) (void) mongets(mtmp, POWERFIST);
		if (mtmp->data == &mons[PM_PA_DRACONIAN]) (void) mongets(mtmp, POWERFIST);
		if (mtmp->data == &mons[PM_DIGLIZARD]) (void) mongets(mtmp, PICK_AXE);
		if (mtmp->data == &mons[PM_DIGGING_LIZARD]) (void) mongets(mtmp, PICK_AXE);
		if (mtmp->data == &mons[PM_PICK_DRACONIAN]) (void) mongets(mtmp, PICK_AXE);

		if (mtmp->data == &mons[PM_LIZARD_MAGE]) (void) mongets(mtmp, !rn2(3) ? SHORT_SWORD : !rn2(2) ? BROADSWORD : LONG_SWORD);

		if (ptr == &mons[PM_TALCUM_DRACONIAN]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, TALC, 25);
		}
		if (ptr == &mons[PM_ANTHRAZITE_DRACONIAN]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, GRAPHITE, 25);
		}
		if (ptr == &mons[PM_FRUSTRATED_TYRANNOSAURUS]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, RAZOR_WHIP);
			(void) mongets(mtmp, BARRIER_SHIELD);
			 m_initthrow(mtmp, SALT_CHUNK, 40);
		}
		if (mtmp->data == &mons[PM_NEVERENDING_ETHER_SOLDIER]) {
			(void) mongets(mtmp, CROSSBOW);
			 m_initthrow(mtmp, ETHER_BOLT, 50);
		}
		if (mtmp->data == &mons[PM_ELITE_SITH]) {
			(void) mongets(mtmp, SITH_STAFF);
			(void) mongets(mtmp, FUR);
			(void) mongets(mtmp, BARNACLE_ARMOR);
			(void) mongets(mtmp, HIGH_BOOTS);
		}

		if (ptr == &mons[PM_HAITIAN_GANGSTER]) {
			if (!rn2(3)) {
				(void) mongets(mtmp, SHOTGUN);
				 m_initthrow(mtmp, LEAD_SHOT, 50);
			} else if (!rn2(2)) {
				(void) mongets(mtmp, SAWED_OFF_SHOTGUN);
				 m_initthrow(mtmp, LEAD_SHOT, 50);
			} else {
				(void) mongets(mtmp, AUTO_SHOTGUN);
				 m_initthrow(mtmp, AUTO_LEAD_SHOT, 50);
			}

		}

		if (ptr == &mons[PM_AGGRAVATED_HAITIAN_GANGSTER]) {
			if (!rn2(3)) {
				(void) mongets(mtmp, SHOTGUN);
				 m_initthrow(mtmp, LEAD_SHOT, 50);
			} else if (!rn2(2)) {
				(void) mongets(mtmp, SAWED_OFF_SHOTGUN);
				 m_initthrow(mtmp, LEAD_SHOT, 50);
			} else {
				(void) mongets(mtmp, AUTO_SHOTGUN);
				 m_initthrow(mtmp, AUTO_LEAD_SHOT, 50);
			}
			(void) mongets(mtmp, T_SHIRT);
			(void) mongets(mtmp, LEATHER_SHOES);
		}

		if (ptr == &mons[PM_BOOMR]) m_initthrow(mtmp, BOOMERANG, 1);

		if (mtmp->data == &mons[PM_PINK_FEMMY]) {
			(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		}

		if (mtmp->data == &mons[PM_POISON_ARROW_FROG]) {
			(void) mongets(mtmp, CROSSBOW);
			m_initthrow(mtmp, CROSSBOW_BOLT, 40);
		}

		if (mtmp->data == &mons[PM_SEIASHIN]) {
			(void) mongets(mtmp, SLING);
			m_initthrow(mtmp, ROCK, 50);
			m_initthrow(mtmp, ROCK, 50);
		}

		if (mtmp->data == &mons[PM_ALMUTH_S_CUDDLY_SOFT_SNEAKER]) { (void) mongets(mtmp, SOFT_SNEAKERS); (void) mongets(mtmp, SOFT_GIRL_SNEAKER); } /* M4_SNEAKERS */
		if (mtmp->data == &mons[PM_YVONNE_S_SOFT_SNEAKER]) { (void) mongets(mtmp, SOFT_SNEAKERS); (void) mongets(mtmp, SOFT_GIRL_SNEAKER); } /* M4_SNEAKERS */
		if (mtmp->data == &mons[PM_JENNIFER_S_LOVELY_SNEAKER]) { (void) mongets(mtmp, SOFT_SNEAKERS); (void) mongets(mtmp, SOFT_GIRL_SNEAKER); } /* M4_SNEAKERS */
		if (mtmp->data == &mons[PM_JENNIFER_S_SOFT_COMBAT_BOOT]) { (void) mongets(mtmp, HIPPIE_HEELS); (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); } /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_MIRIAM_S_CONE_HEEL_BOOT]) (void) mongets(mtmp, COMBAT_STILETTOS);

		break;

	    case S_TROLL:

		if (ptr == &mons[PM_TIMBER_TROLL]) {
			(void) mongets(mtmp, DENTED_POT);
			(void) mongets(mtmp, SHARP_AXE);
		}
		if (ptr == &mons[PM_STD_CONTRACTOR]) {
			(void) mongets(mtmp, VICTORIAN_UNDERWEAR);
			(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		}
		if (ptr == &mons[PM_CUTDOWN_TROLL]) {
			(void) mongets(mtmp, BASINET);
			(void) mongets(mtmp, GROM_AXE);
		}
		if (ptr == &mons[PM_NECKY_TROLL]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, LEATHER_CLOAK);
			 m_initthrow(mtmp, TALC, 20);
		}
		if (ptr == &mons[PM_SALT_TROLL]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, MUMMY_WRAPPING);
			 m_initthrow(mtmp, SALT_CHUNK, 35);
		}

		if (mtmp->data == &mons[PM_SWEET_FEMMY]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (mtmp->data == &mons[PM_LEAD_TROLL]) (void) mongets(mtmp, LEAD_FILLED_MACE);
		if (mtmp->data == &mons[PM_YOU_TROLL]) (void) mongets(mtmp, SCR_BAD_EQUIPMENT);
		if (mtmp->data == &mons[PM_OFFSEEN_TROLL]) (void) mongets(mtmp, WAN_BAD_EQUIPMENT);
		if (mtmp->data == &mons[PM_OUTBIRTH_OF_UGLINESS]) (void) mongets(mtmp, ORCISH_CLOAK);
		if (mtmp->data == &mons[PM_GRIN_TROLL]) (void) mongets(mtmp, GRINDER);
		if (mtmp->data == &mons[PM_PERMANNOY_TROLL]) (void) mongets(mtmp, LASER_POLE);
		if (mtmp->data == &mons[PM_CIGAR_SMOKING_JUROR]) (void) mongets(mtmp, CIGAR);

		if (ptr == &mons[PM_BANGTROLL]) {
			(void) mongets(mtmp, SHOTGUN);
			 m_initthrow(mtmp, LEAD_SHOT, 25);
		}

		if (ptr == &mons[PM_HORN_TROLL]) (void) mongets(mtmp, UNICORN_HORN);
		if (ptr == &mons[PM_TRORODER]) (void) mongets(mtmp, WAN_ACID);
		if (ptr == &mons[PM_BLACK_FEMMY]) (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

		if (ptr == &mons[PM_AMMOROLL]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SLING_AMMO, 35);
		}

		if (mtmp->data == &mons[PM_ARMED_ISENGARD_TROLL]) {
			(void) mongets(mtmp, GRINDER);
			(void) mongets(mtmp, FIELD_PLATE);
		}
		if (mtmp->data == &mons[PM_ANTJE_S_DANCING_SHOE]) {
			(void) mongets(mtmp, DANCING_SHOES);
			(void) mongets(mtmp, SCR_PAVING);
		}
		if (mtmp->data == &mons[PM_KICKASS_TROLL]) {
			(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void) mongets(mtmp, ORCISH_HELM);
		}
		if (mtmp->data == &mons[PM_SPLASHER_TROLL]) {
			(void) mongets(mtmp, BARDICHE);
			(void) mongets(mtmp, HELMET);
		}
		if (mtmp->data == &mons[PM_HELLWEAP_TROLL]) {
			(void) mongets(mtmp, BILL_GUISARME);
			(void) mongets(mtmp, BATTLE_AXE);
			(void) mongets(mtmp, LEATHER_GLOVES);
			(void) mongets(mtmp, HELMET);
		}
		if (mtmp->data == &mons[PM_DETERMINED_TROLL]) {
			(void) mongets(mtmp, LUCERN_HAMMER);
			(void) mongets(mtmp, HELMET);
		}
		if (mtmp->data == &mons[PM_WHOLE_TROLL]) {
			(void) mongets(mtmp, HALBERD);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, ORCISH_CLOAK);
		}
		if (mtmp->data == &mons[PM_SPIRIT_THROWER_TROLL]) {
			(void) mongets(mtmp, SPIRIT_THROWER);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, GLAIVE);
			(void) mongets(mtmp, ELVEN_CLOAK);
		}
		if (mtmp->data == &mons[PM_ABNORMAL_OLOG_HAI]) {
			(void) mongets(mtmp, SICKLE);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, PAPER_SHIELD);
		}
		if (mtmp->data == &mons[PM_STAVE_TROLL]) {
			(void) mongets(mtmp, QUARTERSTAFF);
			(void) mongets(mtmp, SKULLCAP);
			(void) mongets(mtmp, HIGH_BOOTS);
		}
		if (mtmp->data == &mons[PM_OLOG_HAI_KLIEAUER]) {
			(void) mongets(mtmp, GLAIVE);
			(void) mongets(mtmp, HELMET);
			m_initthrow(mtmp, SHURIKEN, 50);
		}
		if (mtmp->data == &mons[PM_OLOG_HAI_LASERPOINTER]) {
			(void) mongets(mtmp, ARM_BLASTER);
			m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
			m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		}
		if (mtmp->data == &mons[PM_ELBOW_TROLL]) {
			(void) mongets(mtmp, YUMI);
			m_initthrow(mtmp, YA, 50);
		}
		if (mtmp->data == &mons[PM_SHOTTYTROLL]) {
			(void) mongets(mtmp, SHOTGUN);
			m_initthrow(mtmp, SHOTGUN_SHELL, 25);
		}
		if (mtmp->data == &mons[PM_CROSS_TROLL]) {
			(void) mongets(mtmp, CROSSBOW);
			m_initthrow(mtmp, CROSSBOW_BOLT, 45);
		}
		if (mtmp->data == &mons[PM_FLINTROLL]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, ORCISH_HELM);
			m_initthrow(mtmp, FLINT, 40);
		}
		if (mtmp->data == &mons[PM_UPCHARGE_TROLL]) {
			(void) mongets(mtmp, PHYSICIAN_BAR);
			(void) mongets(mtmp, HELMET);
		}

		break;

	    case S_COCKATRICE:

		if (mtmp->data == &mons[PM_MADELEINE_S_PLATEAU_BOOT]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if (mtmp->data == &mons[PM_MADELEINE_S_CALF_LEATHER_SANDAL]) (void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		if (mtmp->data == &mons[PM_ALIDA_S_HUGGING_BOOT]) (void) mongets(mtmp, HUGGING_BOOT);
		if (mtmp->data == &mons[PM_OUTLANDISH_FIELD_WORKER]) (void) mongets(mtmp, PLOW);
		if (mtmp->data == &mons[PM_COCKA_DOODLE_DOO]) (void) mongets(mtmp, PETRIFYIUM_BAR);
		if (mtmp->data == &mons[PM_REPULSIVE_CHAIN_SMOKER_ASSHOLE]) (void) mongets(mtmp, CIGARETTE);

		if (mtmp->data == &mons[PM_GLOVED_COCKATRICE]) (void) mongets(mtmp, rnd_class(PLASTEEL_GLOVES,GAUNTLETS_OF_DEXTERITY));

		if (mtmp->data == &mons[PM_GLOCKATRICE]) {
			(void) mongets(mtmp, PISTOL);
			m_initthrow(mtmp, PISTOL_BULLET, 36);
		}

		if (mtmp->data == &mons[PM_COCK_CARRIER]) {
			(void) mongets(mtmp, RING_MAIL);
			(void) mongets(mtmp, LEATHER_CLOAK);
			(void)mongets(mtmp, rnd_class(LONG_SWORD,GREAT_HOUCHOU));
		}

		if (mtmp->data == &mons[PM_COCKATRICE_CARRIER]) {
			(void) mongets(mtmp, LEATHER_GLOVES);
			{
				struct obj *otmpS = mksobj(CORPSE,TRUE,FALSE, FALSE);

				if (otmpS) {
					otmpS->spe = 0;
					otmpS->quan = 1;
					otmpS->owt = 30;
					otmpS->corpsenm = PM_COCKATRICE;
					start_corpse_timeout(otmpS); /* gotta make sure they time out after a while! --Amy */
					(void) mpickobj(mtmp,otmpS, TRUE);
				}
			}
		}

		if (ptr == &mons[PM_CUBAN_POTATO]) {
			(void) mongets(mtmp, FLINTLOCK);
			 m_initthrow(mtmp, LEAD_PISTOL_BULLET, 30);
		}

		if (mtmp->data == &mons[PM_HENATRICE]) {

			struct obj *otmpH = mksobj(EGG,TRUE,FALSE, FALSE);

			if (otmpH) {

				otmpH->spe = 0;
				otmpH->quan = rnd(3);
				otmpH->owt = weight(otmpH);
				otmpH->corpsenm = egg_type_from_parent(PM_COCKATRICE, FALSE);
				attach_egg_hatch_timeout(otmpH);
				(void) mpickobj(mtmp,otmpH, TRUE);
			}

		}

		break;

	    case S_RUBMONST:

		if (mtmp->data == &mons[PM_GRINDING_RUBBER]) (void) mongets(mtmp, GRINDER);
		if (mtmp->data == &mons[PM_CAMOUFLAGE_RUBBER]) (void) mongets(mtmp, CAMO_QATAR);
		if (mtmp->data == &mons[PM_FILLER_RUBBER]) (void) mongets(mtmp, QATAR);
		if (mtmp->data == &mons[PM_SPACKMATICIAN]) (void) mongets(mtmp, KNIFE);
		if (mtmp->data == &mons[PM_MICHELLE]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		if (ptr == &mons[PM_KNOLLER]) {
			(void) mongets(mtmp, SAWED_OFF_SHOTGUN);
			 m_initthrow(mtmp, LEAD_SHOT, 30);
		}
		if (ptr == &mons[PM_SEMINAR_LECTURER]) {
			 m_initthrow(mtmp, FRAG_GRENADE, 15);
		}
		if (ptr == &mons[PM_WYNAN_LORD_OF_THE_ANCIENT_CASTLE]) {
			(void) mongets(mtmp, QUARTERSTAFF);
			 m_initthrow(mtmp, DART, 25);
		}
		if (ptr == &mons[PM_MILKSHAKE_STICKER]) {
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
		}
		if (ptr == &mons[PM_SECRETORUBBER]) {
			(void) mongets(mtmp, SECRETION_DAGGER);
		}
		if (ptr == &mons[PM_RELIGIOUS_FEMMY]) {
			(void) mongets(mtmp, COMBAT_STILETTOS);
			(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		}
		if (ptr == &mons[PM_KNIFE_FUMBLE]) {
			(void) mongets(mtmp, VICTIM_KNIFE);
		}
		if (ptr == &mons[PM_BUBBLERUBBER]) {
			(void) mongets(mtmp, BUBBLEHORN);
		}
		if (ptr == &mons[PM_BUMBLERUMBLE]) {
			(void) mongets(mtmp, BUBBLEHORN);
		}
		if (ptr == &mons[PM_FOAMSLIPPER]) {
			(void) mongets(mtmp, FOAM_SHIRT);
		}
		if (ptr == &mons[PM_VAJRA_KAMEREL]) {
			(void) mongets(mtmp, KAMEREL_VAJRA);
		}
		if (ptr == &mons[PM_JENNY_KAMEREL]) {
			(void) mongets(mtmp, KAMEREL_VAJRA);
		}
		if (ptr == &mons[PM_SHOOM]) {
			(void) mongets(mtmp, FOAMY_STAFF);
		}
		if (ptr == &mons[PM_OFF_SHOOM]) {
			(void) mongets(mtmp, FOAMY_STAFF);
		}

		if (ptr == &mons[PM_SILVER_RUBBER]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, SILVER_SPEAR);
			(void) mongets(mtmp, SILVER_SHIELD);
			(void) mongets(mtmp, ORCISH_CHAIN_MAIL);
			 m_initthrow(mtmp, SILVER_SLINGSTONE, 40);
		}
		if (ptr == &mons[PM_CHESS_KNIGHT]) {
			if (!rn2(3)) {
				(void) mongets(mtmp, SLING);
				m_initthrow(mtmp, ROCK, 20);
			} else if (rn2(2)) {
				m_initthrow(mtmp, FRAG_GRENADE, 5);
			} else {
				m_initthrow(mtmp, SHURIKEN, 25);
			}
		}
		if (ptr == &mons[PM_KING]) {
			if (!rn2(3)) {
				(void) mongets(mtmp, SLING);
				m_initthrow(mtmp, ROCK, 30);
			} else if (rn2(2)) {
				m_initthrow(mtmp, FRAG_GRENADE, 8);
			} else {
				m_initthrow(mtmp, SHURIKEN, 35);
			}
		}
		if (mtmp->data == &mons[PM_GRANDMASTER]) {
			m_initthrow(mtmp, DART, 50);
		}
		if (mtmp->data == &mons[PM_SUPER_GRANDMASTER]) {
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 50);
		}

		if (ptr == &mons[PM_PENCIL_MOUNTED_ERASER]) {
			(void)mongets(mtmp, rnd_class(PARTISAN,BEC_DE_CORBIN));
		}

		if (mtmp->data == &mons[PM_JULCHEN_S_COMBAT_BOOT]) {
			(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		}
		if (mtmp->data == &mons[PM_BOLLER]) {
			(void) mongets(mtmp, SAWED_OFF_SHOTGUN);
			m_initthrow(mtmp, SHOTGUN_SHELL, 35);
		}
		if (mtmp->data == &mons[PM_JOHANETTA_S_POINTY_GIRL_SHOE]) (void) mongets(mtmp, DANCING_SHOES);
		if (mtmp->data == &mons[PM_JOHANETTA_S_WINTER_BOOT]) (void) mongets(mtmp, HUGGING_BOOT);
		if (mtmp->data == &mons[PM_THE_BLACK_LADY]) (void) mongets(mtmp, SCR_TRAP_CREATION);
		if (mtmp->data == &mons[PM_ACID_GURGLER]) (void) mongets(mtmp, POT_ACID);
		if (mtmp->data == &mons[PM_JULCHEN_S_LADY_BOOT]) {
			(void) mongets(mtmp, COMBAT_STILETTOS);
			(void) mongets(mtmp, SPIKED_BATTLE_BOOT);
		}
		if (mtmp->data == &mons[PM_CYAN_FEMMY]) {
			(void) mongets(mtmp, SWEET_MOCASSINS);
		}

		if (mtmp->data == &mons[PM_SPEAR_MONSTER]) {
			(void) mongets(mtmp, SPEAR);
			(void) mongets(mtmp, ORCISH_HELM);
		}
		if (mtmp->data == &mons[PM_RUB_LANCER]) {
			(void) mongets(mtmp, LANCE);
			(void) mongets(mtmp, ORCISH_HELM);
		}
		if (mtmp->data == &mons[PM_LANCE_BOUNCER]) {
			(void) mongets(mtmp, LANCE);
			(void) mongets(mtmp, ORCISH_HELM);
		}
		if (mtmp->data == &mons[PM_FAZOR_LANCER]) {
			(void) mongets(mtmp, LANCE);
			(void) mongets(mtmp, LEATHER_CLOAK);
			(void) mongets(mtmp, SMALL_SHIELD);
			(void) mongets(mtmp, ORCISH_HELM);
		}
		if (mtmp->data == &mons[PM_WINDSCREEN_FORCER]) {
			(void) mongets(mtmp, LANCE);
			(void) mongets(mtmp, LEATHER_CLOAK);
			(void) mongets(mtmp, SMALL_SHIELD);
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, UNICORN_HORN);
		}
		if (mtmp->data == &mons[PM_ANTI_ELBERETH_MASTER]) {
			(void) mongets(mtmp, LANCE);
			(void) mongets(mtmp, ORANGE_DRAGON_SCALE_MAIL);
			(void) mongets(mtmp, LEATHER_CLOAK);
			(void) mongets(mtmp, SMALL_SHIELD);
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, UNICORN_HORN);
		}
		if (mtmp->data == &mons[PM_LANCEHORN_MARINE]) {
			(void) mongets(mtmp, LANCE);
			(void) mongets(mtmp, UNICORN_HORN);
			(void) mongets(mtmp, ORCISH_HELM);
		}
		if (mtmp->data == &mons[PM_RUB_HORNSTER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			(void) mongets(mtmp, ORCISH_HELM);
		}

		break;

	    case S_BAD_COINS:

		if (mtmp->data == &mons[PM_SABRINA_S_BLOCK_HEELED_SANDAL]) { (void) mongets(mtmp, HIGH_HEELED_SANDAL); (void) mongets(mtmp, WEDGE_SANDALS); } /* M4_HAMMERSANDAL|M4_SANDALS */
		if (mtmp->data == &mons[PM_SUNALI_S_HIKING_BOOT]) (void) mongets(mtmp, HUGGING_BOOT);
		if (mtmp->data == &mons[PM_SCRATCHY_FEMMY]) (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		if (mtmp->data == &mons[PM_DORA_S_STINKING_LEATHER_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_CARINA_S_PROFILED_COMBAT_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_VERENA_S_WORN_OUT_COMBAT_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_VERENA_S_STILETTO_SANDAL]) { (void) mongets(mtmp, HIGH_HEELED_SANDAL); (void) mongets(mtmp, COMBAT_STILETTOS); } /* M4_HAMMERSANDAL */
		if (mtmp->data == &mons[PM_DORA_S_TENDER_STILETTO_SANDAL]) { (void) mongets(mtmp, HIGH_HEELED_SANDAL); (void) mongets(mtmp, COMBAT_STILETTOS); }
		if (mtmp->data == &mons[PM_NADINE_S_HIGH_HEELED_SANDAL]) { (void) mongets(mtmp, HIGH_HEELED_SANDAL); (void) mongets(mtmp, WEDGE_SANDALS); } /* M4_HAMMERSANDAL|M4_SANDALS */

		if (ptr == &mons[PM_PILE_OF_FRAGMENTATION_COINS]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, BONE_FRAGMENT, 25);
		}
		if (ptr == &mons[PM_RARE_GOLD_PIECE]) {
			(void) mongets(mtmp, LASERXBOW);
			 m_initthrow(mtmp, PIN_BOLT, 70);
		}
		if (ptr == &mons[PM_PILE_OF_UNKNOWN_COINS]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, CONUNDRUM_NUGGET, 50);
		}
		if (ptr == &mons[PM_PILE_OF_LIGHT_RADIUS_COINS]) {
			(void) mongets(mtmp, TORCH);
			(void) mongets(mtmp, TORCH);
			(void) mongets(mtmp, TORCH);
		}
		if (ptr == &mons[PM_FLIMSY_SHOTTER]) {
			(void) mongets(mtmp, PAPER_SHOTGUN);
			 m_initthrow(mtmp, SHOTGUN_SHELL, 10);
		}
		if (monsndx(ptr) == PM_STAFFDANCER) {
			(void) mongets(mtmp, CHROME_STAFF);
		}
		if (monsndx(ptr) == PM_BONZPICK) {
			(void) mongets(mtmp, BRONZE_LANCE);
		}
		if (ptr == &mons[PM_UEUEUEP_RUBY]) {
			(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		}
		if (ptr == &mons[PM_COLOR_PAINTER]) {
			(void) mongets(mtmp, MAGICAL_PAINTBRUSH);
		}
		if (ptr == &mons[PM_NANOFIGURE]) {
			(void) mongets(mtmp, NANO_AXE);
			(void) mongets(mtmp, NANO_SUIT);
		}
		if (ptr == &mons[PM_URCAGUARY]) {
			(void) mongets(mtmp, TWO_HANDED_SWORD);
		}
		if (ptr == &mons[PM_UEUEUEP_VANISHING_POINT]) {
			(void) mongets(mtmp, HEAVY_MACHINE_GUN);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
		}
		if (ptr == &mons[PM_STINOLKASTER_RING_CARRIER]) {
			(void)mongets(mtmp, rnd_class(RIN_ADORNMENT,RIN_TELEPORT_CONTROL));
		}
		if (ptr == &mons[PM_ROGUERY_NUMBER_TWO]) {
			(void) mongets(mtmp, BASEBALL_BAT);
		}
		if (ptr == &mons[PM_ROGUERY_ROGUE]) {
			(void) mongets(mtmp, IMPACT_STAFF);
		}
		if (ptr == &mons[PM_KINUESILI_MAZER]) {
			(void) mongets(mtmp, SKELETON_KEY);
		}
		if (ptr == &mons[PM_LAUGHTER_PLAYER]) {
			(void) mongets(mtmp, SCR_CREATE_MONSTER);
			(void) mongets(mtmp, SCR_CREATE_MONSTER);
			(void) mongets(mtmp, SCR_CREATE_MONSTER);
			(void) mongets(mtmp, SCR_CREATE_MONSTER);
			(void) mongets(mtmp, SCR_CREATE_MONSTER);
		}
		if (ptr == &mons[PM_ROGUERY_NUMBER_THREE]) {
			(void) mongets(mtmp, SHOTGUN);
			 m_initthrow(mtmp, SHOTGUN_SHELL, 20);
		}
		if (ptr == &mons[PM_MILK_BOY]) {
			 m_initthrow(mtmp, CREAM_PIE, 3);
		}
		if (ptr == &mons[PM_ROGUERY_NUMBER_FOUR]) {
			(void) mongets(mtmp, KALASHNIKOV);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 50);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 50);
		}
		if (ptr == &mons[PM_PILE_OF_AMORPHOUS_COINS]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, FEATHER_ARMOR);
			 m_initthrow(mtmp, TALC, 10);
		}
		if (ptr == &mons[PM_FLINGING_SILVER_COINS]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SILVER_SLINGSTONE, 40);
		}

		if (ptr == &mons[PM_PILE_OF_LEAD_CIRCLES]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, LEAD_CLUMP, 25);
		}
		if (ptr == &mons[PM_SLINGING_NANO_COINS]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SLING_AMMO, 30);
		}
		if (ptr == &mons[PM_SLINGING_TOPAZ_GEMS]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SLING_AMMO, 35);
		}
		if (ptr == &mons[PM_PILE_OF_DESTRUCTION_COINS]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SLING_AMMO, 50);
		}
		if (ptr == &mons[PM_PILE_OF_VERY_SICK_COINS]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SLING_AMMO, 50);
			 m_initthrow(mtmp, SLING_AMMO, 25);
		}

		if (mtmp->data == &mons[PM_TRACY]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (mtmp->data == &mons[PM_PILE_OF_BRAT_COINS]) (void) mongets(mtmp, UNICORN_HORN);

		if (mtmp->data == &mons[PM_RAZERS]) {
			m_initthrow(mtmp, SHURIKEN, 40);
			m_initthrow(mtmp, SHURIKEN, 40);
		}
		if (mtmp->data == &mons[PM_YERLES_MACHINE_INFANTRY]) {
			(void) mongets(mtmp, FLINTLOCK);
			m_initthrow(mtmp, PISTOL_BULLET, 30);
		}
		if (mtmp->data == &mons[PM_TANJA_MACHINE_INFANTRY]) {
			(void) mongets(mtmp, FLINTLOCK);
			m_initthrow(mtmp, PISTOL_BULLET, 30);
		}
		if (mtmp->data == &mons[PM_YERLES_SELF_PROPELLED_GUN]) {
			(void) mongets(mtmp, RIFLE);
			m_initthrow(mtmp, RIFLE_BULLET, 40);
		}
		if (mtmp->data == &mons[PM_TANJA_SELF_PROPELLED_GUN]) {
			(void) mongets(mtmp, RIFLE);
			m_initthrow(mtmp, RIFLE_BULLET, 40);
		}

		if (mtmp->data == &mons[PM_YERLES_ELITE_MACHINE_INFANTRY]) {
			(void) mongets(mtmp, ASSAULT_RIFLE);
			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
		}
		if (mtmp->data == &mons[PM_TANJA_ELITE_MACHINE_INFANTRY]) {
			(void) mongets(mtmp, ASSAULT_RIFLE);
			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
		}

		if (mtmp->data == &mons[PM_YERLES_CYBORG_SOLDIER]) (void) mongets(mtmp, BLUE_LIGHTSABER);
		if (mtmp->data == &mons[PM_TANJA_CYBORG_SOLDIER]) (void) mongets(mtmp, BLUE_LIGHTSABER);

		if (mtmp->data == &mons[PM_YERLES_LATEST_OUTFIT_SOLDIER]) {
			(void) mongets(mtmp, RAYGUN);
			(void) mongets(mtmp, ORCISH_CLOAK);
			m_initthrow(mtmp, RAYGUN_BOLT, 50);
		}
		if (mtmp->data == &mons[PM_TANJA_LATEST_OUTFIT_SOLDIER]) {
			(void) mongets(mtmp, RAYGUN);
			(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
			m_initthrow(mtmp, RAYGUN_BOLT, 50);
		}

		if (mtmp->data == &mons[PM_PILE_OF_SLINGER_COINS]) {
			(void) mongets(mtmp, SLING);
			m_initthrow(mtmp, ROCK, 40);
		}
		if (mtmp->data == &mons[PM_LARGE_PILE_OF_SLINGER_COINS]) {
			(void) mongets(mtmp, SLING);
			m_initthrow(mtmp, ROCK, 50);
		}
		if (mtmp->data == &mons[PM_SLINGING_MITHRIL_COINS]) {
			(void) mongets(mtmp, SLING);
			m_initthrow(mtmp, ROCK, 50);
		}
		if (mtmp->data == &mons[PM_SLINGING_OPAL_GEMS]) {
			(void) mongets(mtmp, SLING);
			m_initthrow(mtmp, ROCK, 40);
			m_initthrow(mtmp, ROCK, 40);
		}
		if (mtmp->data == &mons[PM_PILE_OF_DEATH_COINS]) {
			(void) mongets(mtmp, SLING);
			m_initthrow(mtmp, FLINT, 40);
			m_initthrow(mtmp, FLINT, 40);
		}
		if (mtmp->data == &mons[PM_PILE_OF_VERY_LAZY_COINS]) {
			(void) mongets(mtmp, SLING);
			m_initthrow(mtmp, FLINT, 50);
			m_initthrow(mtmp, FLINT, 50);
		}

		break;

	    case S_KOBOLD:

		if (ptr == &mons[PM_SHARPOLD]) {
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, SHARP_AXE);
		}
		if (ptr == &mons[PM_DOUBLECONTOKOBOLD]) {
			(void) mongets(mtmp, SPETUM);
		}
		if (ptr == &mons[PM_BACKPACK_CLICKER]) {
			(void) mongets(mtmp, SPIKED_CLUB);
		}
		if (ptr == &mons[PM_SECRETIVE_KOBOLD]) {
			(void) mongets(mtmp, SECRETION_DAGGER);
		}

		if (ptr == &mons[PM_DEADMAN_KOBOLD]) {
			(void) mongets(mtmp, ORCISH_BOW);
			 m_initthrow(mtmp, BONE_ARROW, 25);
		}
		if (ptr == &mons[PM_DEADMAN_MOOGLE]) {
			(void) mongets(mtmp, ORCISH_BOW);
			 m_initthrow(mtmp, BONE_ARROW, 25);
		}

		if (ptr == &mons[PM_MEAGER_KOBOLD]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, ORCISH_RING_MAIL);
			 m_initthrow(mtmp, GRAPHITE, 15);
		}
		if (ptr == &mons[PM_FLINTERKOBOLD]) {
			 m_initthrow(mtmp, FLINT_SPEAR, 10);
		}
		if (ptr == &mons[PM_THROWBOLD]) {
			 m_initthrow(mtmp, CRAPPY_SPEAR, 10);
		}
		if (ptr == &mons[PM_KOBOLD_SABER]) {
			(void) mongets(mtmp, IRON_SABER);
			(void) mongets(mtmp, PISTOL);
			 m_initthrow(mtmp, PISTOL_BULLET, 50);
		}
		if (ptr == &mons[PM_KOBOLD_BLASTER]) {
			(void) mongets(mtmp, PISTOL);
			 m_initthrow(mtmp, PISTOL_BULLET, 50);
			 m_initthrow(mtmp, PISTOL_BULLET, 50);
		}
		if (ptr == &mons[PM_KOBOLD_PINNER]) {
			(void) mongets(mtmp, CROSSBOW);
			 m_initthrow(mtmp, PIN_BOLT, 25);
		}
		if (ptr == &mons[PM_SILVOLD]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, GAUNTLETS);
			 m_initthrow(mtmp, SILVER_SLINGSTONE, 30);
		}
		if(mtmp->data == &mons[PM_SKI_FEMMY]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if(mtmp->data == &mons[PM_KOBOLD_GRINNER]) (void) mongets(mtmp, SPEAR);
		if(mtmp->data == &mons[PM_BATTLEBOLD]) (void) mongets(mtmp, BATLETH);
		if(mtmp->data == &mons[PM_IRON_KLINGON]) (void) mongets(mtmp, BATLETH);
		if(mtmp->data == &mons[PM_ARAB_KOBOLD]) (void) mongets(mtmp, SAND_SWORD);
		if(mtmp->data == &mons[PM_HARDCORE_KOBOLD]) (void) mongets(mtmp, DESERT_SWORD);
		if(mtmp->data == &mons[PM_ARAB_KOBOLD_SHAMAN]) {
			(void) mongets(mtmp, SAND_SWORD);
			(void) mongets(mtmp, STILETTO_SANDALS); /* M4_SANDALS */
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}
		if(mtmp->data == &mons[PM_HARDCORE_KOBOLD_SHAMAN]) {
			(void) mongets(mtmp, DESERT_SWORD);
			(void) mongets(mtmp, RAPIRAPI);
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}
		if(mtmp->data == &mons[PM_KOBOLD_MACEBIMMER]) (void) mongets(mtmp, MACE);
		if (ptr == &mons[PM_KOBOLD_WOARER]) {
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		}
		if (ptr == &mons[PM_KOBOLD_FRAGMENTER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, BONE_FRAGMENT, 20);
		}
		if (ptr == &mons[PM_KOBOLD_LEADOR]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, LEAD_CLUMP, 25);
		}
		if (ptr == &mons[PM_WY_KOBOLD]) {
			 m_initthrow(mtmp, WONDER_DAGGER, 3);
		}
		if (ptr == &mons[PM_DIFFUSE_KOBOLD]) {
			 m_initthrow(mtmp, WONDER_DAGGER, 4);
			(void) mongets(mtmp, SMALL_SHIELD);
			(void) mongets(mtmp, ORCISH_HELM);
		}
		if (ptr == &mons[PM_KOBOLD_ANALYTIC_ASSOCIATE]) {
			 m_initthrow(mtmp, WONDER_DAGGER, 6);
			(void) mongets(mtmp, SHORT_BLADE);
			(void) mongets(mtmp, MEDIUM_MITHRIL_COAT);
			(void) mongets(mtmp, ELVEN_HELM);
		}
		if (ptr == &mons[PM_KLINGON_LASS]) {
			(void) mongets(mtmp, BATLETH);
			(void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		}
		if (ptr == &mons[PM_KLINGON_SPACELEADER]) {
			(void) mongets(mtmp, ELITE_BATLETH);
			(void) mongets(mtmp, SAILOR_BLOUSE);
			(void) mongets(mtmp, ORCISH_HELM);
		}
		if (ptr == &mons[PM_KLINGON_UPPER_COMMANDER]) {
			(void) mongets(mtmp, ELITE_BATLETH);
			(void) mongets(mtmp, COMMANDER_SUIT);
			(void) mongets(mtmp, BASINET);
			(void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		}
		if (ptr == &mons[PM_KLINGON_LADY]) {
			(void) mongets(mtmp, ELITE_BATLETH);
			(void) mongets(mtmp, STILETTO_SANDALS); /* M4_SANDALS */
			(void) mongets(mtmp, FEMINISM_DRAGON_SCALES);
			m_initthrow(mtmp, CUBIC_STAR, 50);
		}
		if (ptr == &mons[PM_ARCHAIC_KOBOLD]) {
			(void) mongets(mtmp, FLINTLOCK);
			(void) mongets(mtmp, DROVEN_HELM);
			m_initthrow(mtmp, LEAD_PISTOL_BULLET, 20);
		}
		if(mtmp->data == &mons[PM_EKIKOBOLD]) {
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, LEATHER_GLOVES);
		}

		break;

	    case S_MIMIC:

		if (mtmp->data == &mons[PM_SIMONE_S_THICK_HUGGING_BOOT]) (void) mongets(mtmp, HUGGING_BOOT);
		if (mtmp->data == &mons[PM_SISIS_WEP]) {
			(void) mongets(mtmp, TRIDENT);
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 30);
		}

		if (mtmp->data == &mons[PM_SONJA_S_TORN_SNEAKER]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (ptr == &mons[PM_KLINGELING_WENCH]) (void) mongets(mtmp, YITH_TENTACLE);
		if (ptr == &mons[PM_ROUND_TUIT]) (void) mongets(mtmp, POT_SPEED);
		if (ptr == &mons[PM_ANGULAR_TUIT]) (void) mongets(mtmp, POT_SPEED);
		if (ptr == &mons[PM_TENDER_HIGH_HEEL_PRINCESS]) (void) mongets(mtmp, ITALIAN_HEELS); /* M4_SANDALS */
		if (ptr == &mons[PM_SECRO_MIMIC]) (void) mongets(mtmp, SECRET_WHIP);
		if (ptr == &mons[PM_SECRO_PERMAMIMIC]) (void) mongets(mtmp, SECRET_WHIP);

		if (mtmp->data == &mons[PM_POTION_MIMIC]) (void) mongets(mtmp, POT_FULL_HEALING);
		if (mtmp->data == &mons[PM_SCROLL_MIMIC]) (void) mongets(mtmp, SCR_TELEPORTATION);
		if (mtmp->data == &mons[PM_RING_MIMIC]) (void) mongets(mtmp, RIN_TIMELY_BACKUP);
		if (mtmp->data == &mons[PM_POTION_PERMAMIMIC]) (void) mongets(mtmp, POT_FULL_HEALING);
		if (mtmp->data == &mons[PM_SCROLL_PERMAMIMIC]) (void) mongets(mtmp, SCR_TELEPORTATION);
		if (mtmp->data == &mons[PM_RING_PERMAMIMIC]) (void) mongets(mtmp, RIN_TIMELY_BACKUP);
		if (mtmp->data == &mons[PM_CLOAKER]) (void) mongets(mtmp, ELVEN_CLOAK);
		if (mtmp->data == &mons[PM_PERMACLOAKER]) (void) mongets(mtmp, ELVEN_CLOAK);
		if (mtmp->data == &mons[PM_MYSTPICK]) (void) mongets(mtmp, MYSTERY_PICK);

		/* jonadab wants these things to spawn mumak; I'll just let them spawn random stuff with a scroll. --Amy */
		if (mtmp->data == &mons[PM_LARGE_SPAWN_MIMIC]) (void) mongets(mtmp, SCR_CREATE_MONSTER);
		if (mtmp->data == &mons[PM_GIANT_SPAWN_MIMIC]) (void) mongets(mtmp, SCR_CREATE_MONSTER);
		if (mtmp->data == &mons[PM_LARGE_SPAWN_PERMAMIMIC]) (void) mongets(mtmp, SCR_CREATE_MONSTER);
		if (mtmp->data == &mons[PM_GIANT_SPAWN_PERMAMIMIC]) (void) mongets(mtmp, SCR_CREATE_MONSTER);

		break;

	    case S_WORM:

		if (mtmp->data == &mons[PM_MEDIUM_LENGTH_WORM]) (void) mongets(mtmp, UNKNOWN_KNIFE);
		if (mtmp->data == &mons[PM_KANCHO_ASSAILANT]) (void) mongets(mtmp, QATAR);
		if (mtmp->data == &mons[PM_VEEN]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		if (mtmp->data == &mons[PM_TANISHA]) {
			(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
			(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
			(void) mongets(mtmp, PISTOL);
			m_initthrow(mtmp, PISTOL_BULLET, 50);
		}
		if (mtmp->data == &mons[PM_GRAND_LEECH]) {
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 40);
		}
		if (mtmp->data == &mons[PM_BIND_DEVIL_WORM]) {
			m_initthrow(mtmp, SHURIKEN, 50);
		}
		if (mtmp->data == &mons[PM_REAL_DEVIL_WORM]) {
			m_initthrow(mtmp, SHURIKEN, 50);
		}
		if (mtmp->data == &mons[PM_ELONIC_ROCK_WORM]) {
			(void) mongets(mtmp, PISTOL);
			m_initthrow(mtmp, PISTOL_BULLET, 50);
		}
		if (ptr == &mons[PM_WOUWOU_LEYDE]) {
			(void)mongets(mtmp, rnd_class(WEDGE_SANDALS,ITALIAN_HEELS));
		}

		if (ptr == &mons[PM_BEAUTY_FROM_WOMAN_CITY]) {
			(void)mongets(mtmp, rnd_class(WEDGED_LITTLE_GIRL_SANDAL,PROSTITUTE_SHOE));
			(void)mongets(mtmp, rnd_class(WEDGE_SANDALS,ITALIAN_HEELS));
		}

		if (mtmp->data == &mons[PM_SAND_MAGGOT]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 1;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_SAND_MAGGOT, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}

		if (mtmp->data == &mons[PM_FOREST_MAGGOT]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 1;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_FOREST_MAGGOT, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}

		if (mtmp->data == &mons[PM_DARK_MAGGOT]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 1;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_DARK_MAGGOT, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}

		if (mtmp->data == &mons[PM_UNDEAD_WORM]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 1;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_UNDEAD_WORM, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}

		if (mtmp->data == &mons[PM_ROCK_WORM]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 2;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_ROCK_WORM, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}

		if (mtmp->data == &mons[PM_STEEL_MAGGOT]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 2;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_STEEL_MAGGOT, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}

		if (mtmp->data == &mons[PM_DEVOURER]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 3;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_DEVOURER, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}

		if (mtmp->data == &mons[PM_GIANT_ERROR]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 3;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(rndmonnum(), FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}

		if (mtmp->data == &mons[PM_PETTY_GIANT_ERROR]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 3;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(rndmonnum(), FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}

		if (mtmp->data == &mons[PM_GIANT_LAMPREY]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 4;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_GIANT_LAMPREY, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}

		if (mtmp->data == &mons[PM_CAVE_WORM]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 4;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_CAVE_WORM, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}

		if (mtmp->data == &mons[PM_CAVE_ERROR]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 4;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_CAVE_ERROR, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}

		if (mtmp->data == &mons[PM_WORLD_KILLER]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 5;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_WORLD_KILLER, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}
		if (mtmp->data == &mons[PM_TURBO_WORLD_KILLER]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 10;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_TURBO_WORLD_KILLER, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}

		if (mtmp->data == &mons[PM_SPEEDSTER_MAGGOT]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 7;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_SPEEDSTER_MAGGOT, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}

		if (mtmp->data == &mons[PM_NYMPHOMANIAC]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 7;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_NYMPHOMANIAC, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}

		if (mtmp->data == &mons[PM_BIRD_SPAWNER]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 3;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_ASSERTION_FAILURE, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}
		if (mtmp->data == &mons[PM_GLOAM_SPAWNER]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 3;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_GREENER_SPIRIT, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}

		if (mtmp->data == &mons[PM_BREEDER]) (void) mongets(mtmp, EGG);

		if (mtmp->data == &mons[PM_TOEMODEL]) (void) mongets(mtmp, LEATHER_PEEP_TOES);

		if (mtmp->data == &mons[PM_YASAMAN_S_LEATHER_BOOT]) (void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_YASAMAN_S_WEDGE_SANDAL]) {
			(void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
			(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		}

		if (mtmp->data == &mons[PM_FLESH_SPAWNER] || mtmp->data == &mons[PM_GIANT_DOG]) { (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG);
		}
		if (mtmp->data == &mons[PM_STYGIAN_HAG]) { (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG);
		}
		if (mtmp->data == &mons[PM_GROTESQUE]) { (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG);
		}

		if (mtmp->data == &mons[PM_CLOCK_WOLF]) { (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG);
		}

		if (mtmp->data == &mons[PM_LEVEL_FILLER]) { (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG); (void) mongets(mtmp, EGG);
		}

		if (mtmp->data == &mons[PM_SALLY_S_VELCRO_SNEAKER]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

		break;

	    case S_WORM_TAIL:

		if (mtmp->data == &mons[PM_HILTED_POLEARM]) (void) mongets(mtmp, RANSEUR);
		if (ptr == &mons[PM_OH__THERE_IS_A_STARLIT_SKY_]) (void) mongets(mtmp, WAN_FLEECY_TERRAIN);

		if (mtmp->data == &mons[PM_BOW_ROW]) {
			(void)mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 50);
			m_initthrow(mtmp, ARROW, 50);
			m_initthrow(mtmp, ARROW, 50);
			m_initthrow(mtmp, ARROW, 50);
		}

		if (mtmp->data == &mons[PM_WILD_HILD]) {
			(void)mongets(mtmp, WILDHILD_BOW);
			m_initthrow(mtmp, ODOR_SHOT, 50);
			m_initthrow(mtmp, ODOR_SHOT, 50);
		}

		break;

	    case S_BAD_FOOD:

		if (mtmp->data == &mons[PM_NOISY_NERVE_SAW]) (void) mongets(mtmp, CHAINSWORD);
		if (mtmp->data == &mons[PM_HARROWBARK_WALKER]) m_initthrow(mtmp, JAVELIN, 5);
		if (mtmp->data == &mons[PM_HARROWBARK_WANDLE]) m_initthrow(mtmp, SPEAR, 5);
		if (mtmp->data == &mons[PM_BANG_PEALER]) m_initthrow(mtmp, FRAG_GRENADE, 5);
		if (mtmp->data == &mons[PM_SHURIKEN_PLANT]) m_initthrow(mtmp, SHURIKEN, 40);
		if (mtmp->data == &mons[PM_RUNNING_SHURIKEN_PLANT]) m_initthrow(mtmp, SHURIKEN, 40);
		if (mtmp->data == &mons[PM_SNICKERING_PEA_IN_BLOCK_HEEL_BOOTS]) (void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */

		if (ptr == &mons[PM_LUCKILY_STALLE]) {
			  if (rn2(2)) {
				(void) mongets(mtmp, RIFLE);
		 		m_initthrow(mtmp, RIFLE_BULLET, 25);
		 		m_initthrow(mtmp, RIFLE_BULLET, 25);
			  } else {
				(void) mongets(mtmp, SUBMACHINE_GUN);
		 		m_initthrow(mtmp, SMG_BULLET, 25);
		 		m_initthrow(mtmp, SMG_BULLET, 25);
			  }
			(void)mongets(mtmp, (rn2(2)) ? KNIFE : DAGGER);
			if (rn2(2)) (void) mongets(mtmp, FRAG_GRENADE);
			(void) mongets(mtmp, RING_MAIL);
			(void) mongets(mtmp, LOW_BOOTS);
			(void) mongets(mtmp, DENTED_POT);
			(void) mongets(mtmp, LEATHER_CLOAK);
			if (rn2(2)) (void) mongets(mtmp, LEATHER_GLOVES);
		}

		if (mtmp->data == &mons[PM_KOP_PIE]) m_initthrow(mtmp, CREAM_PIE, 2);
		if (mtmp->data == &mons[PM_PIE_SERGEANT]) m_initthrow(mtmp, CREAM_PIE, 2);
		if (mtmp->data == &mons[PM_PIE_LIEUTENANT]) m_initthrow(mtmp, CREAM_PIE, 2);
		if (mtmp->data == &mons[PM_PIE_KAPTAIN]) m_initthrow(mtmp, CREAM_PIE, 2);
		if (mtmp->data == &mons[PM_PIE_KOMMISSIONER]) m_initthrow(mtmp, CREAM_PIE, 2);
		if (mtmp->data == &mons[PM_PIE_KCHIEF]) m_initthrow(mtmp, CREAM_PIE, 2);
		if (mtmp->data == &mons[PM_PIE_KATCHER]) m_initthrow(mtmp, CREAM_PIE, 2);
		if (mtmp->data == &mons[PM_PIE_KRIMINOLOGIST]) m_initthrow(mtmp, CREAM_PIE, 2);
		if (mtmp->data == &mons[PM_PIE_KEELHAULER]) m_initthrow(mtmp, CREAM_PIE, 2);
		if (mtmp->data == &mons[PM_PIE_KLEEVER]) m_initthrow(mtmp, CREAM_PIE, 2);
		if(ptr == &mons[PM_VAMPIRE_STEAK]) (void) mongets(mtmp, WOODEN_STAKE);
		if(ptr == &mons[PM_NATURAL_BORN_SURVIVOR]) (void) mongets(mtmp, SURVIVAL_KNIFE);
		if(ptr == &mons[PM_SWORD_FLOWEY]) (void) mongets(mtmp, WHITE_FLOWER_SWORD);
		if(ptr == &mons[PM_SWALLOSWORD]) (void) mongets(mtmp, MEATSWORD);
		if(ptr == &mons[PM_ORGANIC_IVY]) (void) mongets(mtmp, ORGANOBLADE);
		if(ptr == &mons[PM_SMALL_GARDEN_SCYTHE]) (void) mongets(mtmp, SICKLE);
		if(ptr == &mons[PM_GARDEN_SCYTHE]) (void) mongets(mtmp, SICKLE);
		if(ptr == &mons[PM_ELFIN_SCYTHE]) (void) mongets(mtmp, ELVEN_SICKLE);
		if(ptr == &mons[PM_PASTAFARIAN_ACOLYTE]) (void) mongets(mtmp, PASTA);
		if(ptr == &mons[PM_PASTAFARIAN_PRIEST]) (void) mongets(mtmp, PASTA);
		if(ptr == &mons[PM_STUTTERING_HARLOT]) (void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		if(ptr == &mons[PM_GRAVE_MEWLIP]) (void) mongets(mtmp, BONE_DAGGER);
		if(ptr == &mons[PM_PASTAFARIAN_HIGH_PRIEST]) {
			(void) mongets(mtmp, PASTA);
			(void) mongets(mtmp, PASTA);
			(void) mongets(mtmp, PASTA);
		}

		if (mtmp->data == &mons[PM_CHOCOBONE]) {
			 (void) mongets(mtmp, CHOCOLATE);
			 (void) mongets(mtmp, CHOCOEGG);
		}
		if (mtmp->data == &mons[PM_FLUIDATOR_TRER]) {
			 (void) mongets(mtmp, QUARTERSTAFF);
			 (void) mongets(mtmp, LANCE);
		}
		if (ptr == &mons[PM_PUMPKIN]) {
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
		}
		if (ptr == &mons[PM_GREATER_PUMPKIN]) {
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
		}
		if (ptr == &mons[PM_HALLOWEEN_NIGHTMARE]) {
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
		}
		if (ptr == &mons[PM_VAMPKIN]) {
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
		}

		if (ptr == &mons[PM_COKE_TYPE]) {
			(void) mongets(mtmp, ASSAULT_RIFLE);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 50);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 50);
		}
		if (ptr == &mons[PM_EREGK]) {
			(void) mongets(mtmp, LONG_SWORD);
			(void) mongets(mtmp, LARGE_SHIELD);
			(void) mongets(mtmp, HELMET);
		}
		if (ptr == &mons[PM_KETAMINE_GLADIATOR]) {
			(void) mongets(mtmp, IRON_SABER);
			(void) mongets(mtmp, LARGE_SHIELD);
		}
		if (ptr == &mons[PM_DIAZ_GANG_MEMBER]) {
			(void) mongets(mtmp, ASSAULT_RIFLE);
			(void) mongets(mtmp, HAWAIIAN_SHIRT);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 50);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 50);
		}
		if (ptr == &mons[PM_METALLIC_MUSHROOM]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, SCALE_MAIL);
			 m_initthrow(mtmp, SMALL_PIECE_OF_UNREFINED_MITHR, 25);
		}

		if (ptr == &mons[PM_BOWN_MUSHROOM]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, BONE_FRAGMENT, 25);
		}
		if (ptr == &mons[PM_PEW_MUSHROOM]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SLING_AMMO, 25);
		}

		if (mtmp->data == &mons[PM_VALENSINA]) {
			(void)mongets(mtmp, COMBAT_STILETTOS);
			(void)mongets(mtmp, BAD_SHIRT);
			(void)mongets(mtmp, GENTLEWOMAN_S_DRESS);
			(void)mongets(mtmp, BAG_OF_TRICKS);
		}

		if (mtmp->data == &mons[PM_ORANGE_FEMMY]) {
			(void) mongets(mtmp, SWEET_MOCASSINS);
		}

		if (mtmp->data == &mons[PM_SIERRA]) {
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
			(void)mongets(mtmp, FLINTLOCK);
			m_initthrow(mtmp, PISTOL_BULLET, 30);
		}
		if (mtmp->data == &mons[PM_SLING_MUSHROOM]) {
			(void)mongets(mtmp, SLING);
			m_initthrow(mtmp, ROCK, 20);
		}

		if (mtmp->data == &mons[PM_NIN_NINZIN]) {
			m_initthrow(mtmp, SHURIKEN, 50);
			m_initthrow(mtmp, SHURIKEN, 50);
		}

		if (mtmp->data == &mons[PM_CYBER_FLOWER]) {
			(void)mongets(mtmp, ROCKET_LAUNCHER);
			m_initthrow(mtmp, ROCKET, 25);
		}

		if (mtmp->data == &mons[PM_SKOGSRA]) {
			(void)mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 40);
		}

		if (mtmp->data == &mons[PM_GUARDIAN_O__THE_FOREST]) m_initthrow(mtmp, SPIRIT_THROWER, 5);
		if (mtmp->data == &mons[PM_BASTARD_OF_THE_FOREST]) m_initthrow(mtmp, TORPEDO, 5);

		if (mtmp->data == &mons[PM_HARROWBARK_FIEND]) m_initthrow(mtmp, SPIRIT_THROWER, 5);
		if (mtmp->data == &mons[PM_HARROWBARK_BOO]) m_initthrow(mtmp, ELVEN_SPEAR, 5);

		if (mtmp->data == &mons[PM_QUIVER_SLOT]) { (void) mongets(mtmp, BOW); m_initthrow(mtmp, ARROW, 35);}

		if (mtmp->data == &mons[PM_MACHIEVALLIAN_MOSS]) (void) mongets(mtmp, SCR_TRAP_CREATION);
		if (mtmp->data == &mons[PM_SWEET_ASIAN_POISON_IVY]) (void) mongets(mtmp, HUGGING_BOOT);

		if (mtmp->data == &mons[PM_ROSY_S_LEATHER_PUMP]) { (void) mongets(mtmp, FEMININE_PUMPS); (void) mongets(mtmp, SEXY_LEATHER_PUMP); } /* M4_PUMPS */

		break;

	    case S_NAGA:
		if (mtmp->data == &mons[PM_TU_TARA_SHIELDSNAPPER]) { (void) mongets(mtmp, BOW); m_initthrow(mtmp, ARROW, 35);}
		if (mtmp->data == &mons[PM_TU_TARA_EDGECUTTER]) (void) mongets(mtmp, BEC_DE_CORBIN);
		if (mtmp->data == &mons[PM_TU_TARA_WARMONGER]) (void) mongets(mtmp, KATANA);
		if (mtmp->data == &mons[PM_ORNATE_NAGA_HATCHLING]) (void) mongets(mtmp, ORNATE_MACE);
		if (mtmp->data == &mons[PM_ORNATE_NAGA]) (void) mongets(mtmp, ORNATE_MACE);
		if (mtmp->data == &mons[PM_GRAPNEPTO]) (void) mongets(mtmp, GRAPPLING_HOOK);
		if (mtmp->data == &mons[PM_TU_TARA_SPELLSWINGER]) (void) mongets(mtmp, EAGLE_BALL);
		if (mtmp->data == &mons[PM_CYAN_NAGA_HATCHLING]) (void) mongets(mtmp, CYAN_DOUBLE_LIGHTSABER);
		if (mtmp->data == &mons[PM_CYAN_NAGA]) (void) mongets(mtmp, CYAN_DOUBLE_LIGHTSABER);

		if (ptr == &mons[PM_ABNORM_DRUG_ADDICT]) {
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
		}

		if (ptr == &mons[PM_TU_TARA_BATTLEMOWER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, BONE_FRAGMENT, 40);
		}
		if (ptr == &mons[PM_TU_TARA_WEAPONPACKER]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, FOURDENT);
			(void) mongets(mtmp, LANCE);
			 m_initthrow(mtmp, SPEAR, 5);
			 m_initthrow(mtmp, GRAPHITE, 30);
		}

		if (ptr == &mons[PM_CLEANER]) {
			struct obj *otmpX = mksobj(POT_SALT_WATER, TRUE, FALSE, FALSE);
			if (otmpX) {
				otmpX->finalcancel = TRUE;
				otmpX->quan = 5;
				otmpX->owt = weight(otmpX);
				mpickobj(mtmp, otmpX, TRUE);
			}
		}

		if (mtmp->data == &mons[PM_SNAKE_WOMAN]) (void) mongets(mtmp, SCALPEL);
		if (mtmp->data == &mons[PM_MEASURER_ALIEN]) (void) mongets(mtmp, MEASURER);
		if (mtmp->data == &mons[PM_RED_NINJA]) {
		  	m_initthrow(mtmp, SHURIKEN, 30);
		}

		if (mtmp->data == &mons[PM_HYDRA_SNAKE]) {
		  	(void) mongets(mtmp, HYDRA_BOW);
		  	m_initthrow(mtmp, GOLDEN_ARROW, 40);
		}
		if (mtmp->data == &mons[PM_NIGERIAN_PRINCE]) {
		  	(void) mongets(mtmp, AMULET_OF_LIFE_SAVING);
		  	(void) mongets(mtmp, RIN_TIMELY_BACKUP);
		}
		if (mtmp->data == &mons[PM_YELLOW_FEMMY]) {
		  	(void) mongets(mtmp, HUGGING_BOOT);
		  	(void) mongets(mtmp, WAN_TELE_LEVEL);
		}

		break;

	    case S_LIGHT:
		if (mtmp->data == &mons[PM_FIERY_EFFULGENCE]) m_initthrow(mtmp, FRAG_GRENADE, 5);
		if (mtmp->data == &mons[PM_SCISSOR_SHARPENER]) (void) mongets(mtmp, SCALPEL);
		if (mtmp->data == &mons[PM_DARKMAKER_GHOST]) (void) mongets(mtmp, DARKNESS_CLUB);
		if (mtmp->data == &mons[PM_HALLOW_GLOAM]) (void) mongets(mtmp, DARKNESS_CLUB);
		if (mtmp->data == &mons[PM_LANTURN_LIGHT]) (void) mongets(mtmp, POLE_LANTERN);

		if (mtmp->data == &mons[PM_DENISE_S_GIRL_SHOE]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (mtmp->data == &mons[PM_FRESH_FEMMY]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (mtmp->data == &mons[PM_TORCH_CONVERTER]) (void) mongets(mtmp, TORCH);
		if (mtmp->data == &mons[PM_REDUCTION_JET]) (void) mongets(mtmp, WAN_STAT_REDUCTION);
		if (mtmp->data == &mons[PM_BULBLIGHT]) (void) mongets(mtmp, EAGLE_BALL);
		if (mtmp->data == &mons[PM_DRAGOLIGHT]) (void) mongets(mtmp, JARED_STONE);
		if (mtmp->data == &mons[PM_BROWNLIGHT_BULB]) (void) mongets(mtmp, LIGHTBULB);
		if (mtmp->data == &mons[PM_HEATHEN_LIGHT]) (void) mongets(mtmp, HEATH_BALL);
		if (mtmp->data == &mons[PM_SPEEDING_LASERBEAM]) (void) mongets(mtmp, BLACK_LIGHTSABER);

		if (mtmp->data == &mons[PM_COLORLESS_WASER]) m_initweap_normal(mtmp);
		if (mtmp->data == &mons[PM_WYPSILON_WASER]) m_initweap_normal(mtmp);
		if (mtmp->data == &mons[PM_WEOWEO_WASER]) m_initweap_normal(mtmp);
		if (mtmp->data == &mons[PM_WHITE_WASER]) m_initweap_normal(mtmp);
		if (mtmp->data == &mons[PM_YELLOW_WASER]) m_initweap_normal(mtmp);
		if (mtmp->data == &mons[PM_BLACK_WASER]) m_initweap_normal(mtmp);
		if (mtmp->data == &mons[PM_SPHERICAL_WASER]) m_initweap_normal(mtmp);
		if (mtmp->data == &mons[PM_ALARM_WASER]) m_initweap_normal(mtmp);
		if (mtmp->data == &mons[PM_DARK_WASER]) m_initweap_normal(mtmp);
		if (mtmp->data == &mons[PM_PSI_WASER]) m_initweap_normal(mtmp);
		if (mtmp->data == &mons[PM_FAMISHED_WASER]) m_initweap_normal(mtmp);
		if (mtmp->data == &mons[PM_PESTILENT_WASER]) m_initweap_normal(mtmp);
		if (mtmp->data == &mons[PM_DEATHLY_WASER]) m_initweap_normal(mtmp);

		break;
	    case S_GNOME:

		if (mtmp->data == &mons[PM_GNOME_RESEARCHER]) (void) mongets(mtmp, PLATINUM_SABER);
		if (mtmp->data == &mons[PM_GNOME_HARLOT]) (void) mongets(mtmp, PROSTITUTE_SHOE);
		if (mtmp->data == &mons[PM_ALIEN_PHALANX]) (void) mongets(mtmp, HALBERD);
		if (mtmp->data == &mons[PM_GNOME_MACER]) (void) mongets(mtmp, MACE);
		if (mtmp->data == &mons[PM_GNOME_BADASS]) (void) mongets(mtmp, WAN_REMOVE_RESISTANCE);
		if (mtmp->data == &mons[PM_GNOMISH_SLIME_MAGE]) (void) mongets(mtmp, POT_SLIME);
		if (mtmp->data == &mons[PM_NASTY_GRIFFIN]) (void) mongets(mtmp, SCR_MEGALOAD);
		if (mtmp->data == &mons[PM_GNOME_ROGUE_LEADER]) (void) mongets(mtmp, SCR_TRAP_CREATION);
		if (mtmp->data == &mons[PM_NAUTILUS_STEERSMAN]) (void) mongets(mtmp, SCR_TRAP_CREATION);
		if (mtmp->data == &mons[PM_NAUTILUS_NEER_DO_WELL]) (void) mongets(mtmp, SCR_TRAP_CREATION);
		if (mtmp->data == &mons[PM_ARMOR_GNOME]) (void) mongets(mtmp, PLATE_MAIL);
		if (mtmp->data == &mons[PM_UNDERPANTS_GNOME]) (void) mongets(mtmp, VICTORIAN_UNDERWEAR);
		if (mtmp->data == &mons[PM_HC_BEARDFREAK]) m_initthrow(mtmp, FRAG_GRENADE, 8);
		if (mtmp->data == &mons[PM_BOMB_THROWER]) m_initthrow(mtmp, FRAG_GRENADE, 10);
		if (mtmp->data == &mons[PM_ROCK_THROWER]) m_initthrow(mtmp, ROCK, 10);
		if (mtmp->data == &mons[PM_GWAWOL]) (void) mongets(mtmp, WAN_LIGHTNING);
		if (mtmp->data == &mons[PM_CLOCKWORK_CLAW]) (void) mongets(mtmp, QATAR);
		if (mtmp->data == &mons[PM_SWISS_CLAW]) (void) mongets(mtmp, QATAR);
		if (mtmp->data == &mons[PM_GNOME_LASERER]) (void) mongets(mtmp, LASER_SWORD);
		if (mtmp->data == &mons[PM_GNOME_HUSSY]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (mtmp->data == &mons[PM_WEED_GNOME]) (void) mongets(mtmp, POT_HALLUCINATION);
		if (mtmp->data == &mons[PM_GIGGNOLL]) (void) mongets(mtmp, PICK_AXE);
		if (mtmp->data == &mons[PM_GEOLOGY_GNOME]) (void) mongets(mtmp, CONGLOMERATE_PICK);
		if (mtmp->data == &mons[PM_SEXY_OPERATOR]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		if (ptr == &mons[PM_NEUTRAL_GNOME]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SALT_CHUNK, 30);
		}
		if (ptr == &mons[PM_UPPER_COMMANDER]) {
			(void) mongets(mtmp, COMMANDER_SUIT);
			(void) mongets(mtmp, COMMANDER_GLOVES);
		}
		if (ptr == &mons[PM_NEEDLE_GNOME]) {
			(void) mongets(mtmp, CROSSBOW);
			 m_initthrow(mtmp, PIN_BOLT, 30);
		}
		if (ptr == &mons[PM_BERNING_STONE_MANUFACTURER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, AMBER_FRAGMENT, 50);
		}
		if (ptr == &mons[PM_HALL_GNOME]) {
			(void) mongets(mtmp, CROSSBOW);
			 m_initthrow(mtmp, PIN_BOLT, 40);
		}
		if (ptr == &mons[PM_GNOME_GNASHER]) {
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, BONE_ARROW, 30);
		}

		if (ptr == &mons[PM_DOTZ_GNOME]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SLING_AMMO, 25);
		}
		if (ptr == &mons[PM_HEAVY_ARM_CHEST_GNOME]) {
			(void) mongets(mtmp, CROSSBOW);
			 m_initthrow(mtmp, HEAVY_CROSSBOW_BOLT, 50);
		}
		if (ptr == &mons[PM_LITHGNOME]) {
			(void) mongets(mtmp, FLINTLOCK);
			(void) mongets(mtmp, TARRIER);
			 m_initthrow(mtmp, LEAD_PISTOL_BULLET, 20);
		}
		if (ptr == &mons[PM_GNOMISH_WOARER]) {
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		}

		if (mtmp->data == &mons[PM_SHURIGNOME]) {
			m_initthrow(mtmp, SHURIKEN, 50);
			m_initthrow(mtmp, SHURIKEN, 50);
		}
		if (mtmp->data == &mons[PM_SAMURAI_GNOME]) {
			(void) mongets(mtmp, KATANA);
			(void) mongets(mtmp, SPLINT_MAIL);
		}
		if (mtmp->data == &mons[PM_NUUB_GNOME]) {
			(void) mongets(mtmp, NOOB_POLLAX);
		}
		if (mtmp->data == &mons[PM_GLOVE_LORD]) {
			(void) mongets(mtmp, AXE);
			(void) mongets(mtmp, LEATHER_GLOVES);
		}

		if (mtmp->data == &mons[PM_GNOMISH_GUNMAN]) {
		  	(void) mongets(mtmp, FLINTLOCK);
		  	m_initthrow(mtmp, PISTOL_BULLET, 20);
		}
		if (mtmp->data == &mons[PM_HOF_GNOME]) {
		  	(void) mongets(mtmp, HAND_BLASTER);
		  	m_initthrow(mtmp, BLASTER_BOLT, 40);
		}
		if (mtmp->data == &mons[PM_ROCK_GNOME]) {
		  	(void) mongets(mtmp, SLING);
		  	m_initthrow(mtmp, ROCK, 30);
		}
		if (mtmp->data == &mons[PM_CLOCKWORK_ASSIE]) {
			if (rn2(2)) {
			  	(void) mongets(mtmp, SUBMACHINE_GUN);
			  	m_initthrow(mtmp, SMG_BULLET, 50);
			} else {
			  	m_initthrow(mtmp, FRAG_GRENADE, 20);
			}
		  	(void) mongets(mtmp, HELMET);
		  	(void) mongets(mtmp, RING_MAIL);
		  	(void) mongets(mtmp, IRON_SHOES);
		  	(void) mongets(mtmp, LARGE_SHIELD);
		}
		if (mtmp->data == &mons[PM_SWISS_ASSIE]) {
			if (rn2(2)) {
			  	(void) mongets(mtmp, SUBMACHINE_GUN);
			  	m_initthrow(mtmp, SMG_BULLET, 50);
			} else {
			  	m_initthrow(mtmp, FRAG_GRENADE, 20);
			}
		  	(void) mongets(mtmp, HELMET);
		  	(void) mongets(mtmp, RING_MAIL);
		  	(void) mongets(mtmp, IRON_SHOES);
		  	(void) mongets(mtmp, LARGE_SHIELD);
		}

		if (mtmp->data == &mons[PM_BOWME]) {
		  	(void) mongets(mtmp, BOW);
		  	m_initthrow(mtmp, ARROW, 35);
		}
		if (mtmp->data == &mons[PM_INTERCROME]) {
		  	(void) mongets(mtmp, CROSSBOW);
		  	m_initthrow(mtmp, CROSSBOW_BOLT, 45);
		}
		if (mtmp->data == &mons[PM_LOWERCROME]) {
		  	(void) mongets(mtmp, CROSSBOW);
		  	m_initthrow(mtmp, INFERIOR_BOLT, 40);
		}
		if (mtmp->data == &mons[PM_SKY_GNOME_LORD]) {
		  	(void) mongets(mtmp, CROSSBOW);
		  	(void) mongets(mtmp, GNOMISH_HELM);
		  	(void) mongets(mtmp, TWO_HANDED_SWORD);
		  	m_initthrow(mtmp, CROSSBOW_BOLT, 50);
		}
		if (mtmp->data == &mons[PM_VERY_GOOD_GNOME]) {
		  	(void) mongets(mtmp, CROSSBOW);
		  	(void) mongets(mtmp, GNOMISH_HELM);
		  	(void) mongets(mtmp, GNOMISH_SUIT);
		  	(void) mongets(mtmp, GREAT_DAGGER);
		  	m_initthrow(mtmp, CROSSBOW_BOLT, 50);
		}
		if (mtmp->data == &mons[PM_SABI_GNOME]) {
		  	(void) mongets(mtmp, BILL_GUISARME);
		  	(void) mongets(mtmp, GNOMISH_HELM);
		  	(void) mongets(mtmp, GNOMISH_SUIT);
		  	(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		  	m_initthrow(mtmp, SPEAR, 10);
		}
		if (mtmp->data == &mons[PM_DRAINER_GNOME]) {
		  	(void) mongets(mtmp, CROSSBOW);
		  	(void) mongets(mtmp, GNOMISH_HELM);
		  	(void) mongets(mtmp, GNOMISH_SUIT);
		  	(void) mongets(mtmp, FLY_SWATTER);
		  	m_initthrow(mtmp, CROSSBOW_BOLT, 50);
		}
		if (mtmp->data == &mons[PM_DEEP_TARGETTER]) {
		  	(void) mongets(mtmp, CROSSBOW);
		  	m_initthrow(mtmp, CROSSBOW_BOLT, 45);
		}
		if (mtmp->data == &mons[PM_CROSSLORD]) {
		  	(void) mongets(mtmp, CROSSBOW);
		  	m_initthrow(mtmp, CROSSBOW_BOLT, 45);
		}
		if (mtmp->data == &mons[PM_GNOME_PEWER]) {
		  	(void) mongets(mtmp, CROSSBOW);
		  	(void) mongets(mtmp, GNOMISH_HELM);
		  	m_initthrow(mtmp, CROSSBOW_BOLT, 45);
		}
		if (mtmp->data == &mons[PM_ROYAL_GNOME]) {
		  	(void) mongets(mtmp, CROSSBOW);
		  	(void) mongets(mtmp, IRON_SABER);
		  	(void) mongets(mtmp, GNOMISH_HELM);
		  	m_initthrow(mtmp, CROSSBOW_BOLT, 50);
		}
		if (mtmp->data == &mons[PM_GNOME_ADVENTUREDIN]) {
		  	(void) mongets(mtmp, CROSSBOW);
		  	(void) mongets(mtmp, LEATHER_CLOAK);
		  	(void) mongets(mtmp, GNOMISH_SUIT);
		  	(void) mongets(mtmp, LEATHER_GLOVES);
		  	(void) mongets(mtmp, LONG_SWORD);
		  	(void) mongets(mtmp, GNOMISH_HELM);
		  	m_initthrow(mtmp, CROSSBOW_BOLT, 50);
		}
		if (mtmp->data == &mons[PM_COWARDLY_LADY]) {
		  	(void) mongets(mtmp, HIGH_BOOTS);
		  	m_initthrow(mtmp, SHURIKEN, 45);
		}

		if (!rn2(5)) { (void)mongets(mtmp, GNOMISH_HELM); }
		if (!rn2(10)) { (void)mongets(mtmp, GNOMISH_BOOTS); }
		if (!rn2(15)) { (void)mongets(mtmp, GNOMISH_SUIT); }
		break;
	    case S_NYMPH:

		if (mtmp->data == &mons[PM_VAPE_PUSSY]) (void) mongets(mtmp, ELECTRIC_CIGARETTE);
		if (mtmp->data == &mons[PM_SHERWOOD_NYMPH]) (void) mongets(mtmp, QATAR);
		if (mtmp->data == &mons[PM_SCRATCH_NYMPH]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

	      if(mtmp->data == &mons[PM_SATYR]){
	        if(!rn2(2)) (void) mongets(mtmp, POT_BOOZE);
	        (void) mongets(mtmp, WOODEN_FLUTE);
		}
		if (ptr == &mons[PM_CANDLE_NYMPH]) {
			(void) mongets(mtmp, TALLOW_CANDLE);
		}
		if (ptr == &mons[PM_LIGHTDANCER]) {
			(void) mongets(mtmp, LASER_POLE);
		}
		if (ptr == &mons[PM_FRANCESCA_DUMMTRULLA]) {
			(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		}
		if (ptr == &mons[PM_SORROW_GIRL]) {
			(void) mongets(mtmp, STRIPE_MAIL);
		}
		if (ptr == &mons[PM_CIGAR_SELLER]) {
			(void) mongets(mtmp, CIGAR);
		}

		if (ptr == &mons[PM_LUMBERJACK_NYMPH]) {
			(void) mongets(mtmp, SHARP_AXE);
			(void) mongets(mtmp, CHAIN_COIF);
		}
		if (ptr == &mons[PM_BUSTY_BEAUTY]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, VICTORIAN_UNDERWEAR);
			 m_initthrow(mtmp, SALT_CHUNK, 30);
		}
		if (ptr == &mons[PM_CUTE_NYMPH]) {
			(void) mongets(mtmp, SHORT_BLADE);
		}
		if (ptr == &mons[PM_ELPHIC_PLAYMATE]) {
			(void) mongets(mtmp, ETHER_WHIP);
		}
		if (ptr == &mons[PM_AMURDAD]) {
			(void) mongets(mtmp, SCYTHE);
		}
		if (ptr == &mons[PM_PLAYFUL_GIRL]) {
			(void) mongets(mtmp, BLOCK_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		}

		if (ptr == &mons[PM_BONE_NYMPH]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
			 m_initthrow(mtmp, BONE_FRAGMENT, 30);
		}
		if (ptr == &mons[PM_HIGH_PIXIE]) {
			(void) mongets(mtmp, LEATHER_GLOVES);
			(void) mongets(mtmp, CROSSBOW);
			 m_initthrow(mtmp, HEAVY_CROSSBOW_BOLT, 50);
		}
		if (ptr == &mons[PM_COLLECTOR_NYMPH]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, ROCKET_GAUNTLETS);
			(void) mongets(mtmp, BASINET);
			(void) mongets(mtmp, TAPERED_MAIL);
			(void) mongets(mtmp, LORICATED_CLOAK);
			(void) mongets(mtmp, ITALIAN_HEELS); /* M4_SANDALS */
			 m_initthrow(mtmp, LEAD_CLUMP, 40);
		}

		if (ptr == &mons[PM_GLITTERISHA]) {
			(void) mongets(mtmp, COMBAT_STILETTOS);
			(void) mongets(mtmp, INKA_BOOT);
			(void) mongets(mtmp, INKA_MITHRIL_COAT);
		}

		if (ptr == &mons[PM_SLEXY_POLEARM_DANCER]) {
			(void) mongets(mtmp, rnd_class(PARTISAN,BEC_DE_CORBIN));
		}

		if (ptr == &mons[PM_GUN_CHICK]) {
			(void) mongets(mtmp, FLINTLOCK);
	  		m_initthrow(mtmp, PISTOL_BULLET, 20);
		}
		if (ptr == &mons[PM_GUN_CRUMPET]) {
			(void) mongets(mtmp, FLINTLOCK);
	  		m_initthrow(mtmp, LEAD_PISTOL_BULLET, 20);
		}
		if (ptr == &mons[PM_SUBMACHINE_NYMPH]) {
			(void) mongets(mtmp, SUBMACHINE_GUN);
	  		m_initthrow(mtmp, SMG_BULLET, 50);
		}
		if (ptr == &mons[PM_SEXY_HEXY]) {
			(void) mongets(mtmp, CUTTING_LASER);
	  		m_initthrow(mtmp, LASER_BEAM, 50);
		}
		if (ptr == &mons[PM_SNIPER_BUNDLE_HEAD]) {
			(void) mongets(mtmp, SNIPER_RIFLE);
	  		m_initthrow(mtmp, SNIPER_BULLET, 50);
		}
		if (ptr == &mons[PM_GIGANTIC_FAIRY]) {
			(void) mongets(mtmp, BOW);
	  		m_initthrow(mtmp, ARROW, 50);
		}
		if (ptr == &mons[PM_TEASING_NYMPH]) {
	  		m_initthrow(mtmp, SPIKE, 50);
		}

		if (mtmp->data == &mons[PM_DOWNPULLMONDAINE]) (void) mongets(mtmp, IRON_SABER);

		if (mtmp->data == &mons[PM_TREE_NYMPH]) {
			(void) mongets(mtmp, MACE);
			(void) mongets(mtmp, SMALL_SHIELD);
		}

		if (mtmp->data == &mons[PM_ARMPIXIE]) {
			(void) mongets(mtmp, LEATHER_GLOVES);
			(void) mongets(mtmp, CROSSBOW);
	  		m_initthrow(mtmp, CROSSBOW_BOLT, 45);
		}

		if (mtmp->data == &mons[PM_PENG_NAIAD]) {
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, SLING);
	  		m_initthrow(mtmp, ROCK, 50);
		}

		if (mtmp->data == &mons[PM_OAK_NYMPH]) {
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, QUARTERSTAFF);
		}

		if (mtmp->data == &mons[PM_MARE_NYMPH]) {
			(void) mongets(mtmp, STUDDED_LEATHER_ARMOR);
			(void) mongets(mtmp, TRIDENT);
		}

		if (mtmp->data == &mons[PM_YELLOWIE]) {
			(void) mongets(mtmp, WAR_HAMMER);
			(void) mongets(mtmp, LEATHER_ARMOR);
		}

		if (mtmp->data == &mons[PM_HAND_OTYUGH]) {
			(void) mongets(mtmp, TWO_HANDED_SWORD);
			(void) mongets(mtmp, HELMET);
		}

		if (mtmp->data == &mons[PM_TIMER_NYMPH]) {
			(void) mongets(mtmp, GLAIVE);
			(void) mongets(mtmp, HELMET);
		}

		if (mtmp->data == &mons[PM_DAMAGE_NYMPH]) {
			(void) mongets(mtmp, FLY_SWATTER);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, RING_MAIL);
		}

		if (mtmp->data == &mons[PM_PEDIGREE_SLUTTON]) {
			(void) mongets(mtmp, SCHOOL_UNIFORM);
			(void) mongets(mtmp, KNIFE);
	  		m_initthrow(mtmp, KNIFE, 5);
			(void) mongets(mtmp, SCHOOL_CAP);
		}

		if (mtmp->data == &mons[PM_CURSOR_NYMPH]) {
			(void) mongets(mtmp, BAMBOO_MAIL);
			(void) mongets(mtmp, ASSAULT_RIFLE);
	  		m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
			(void) mongets(mtmp, SKULLCAP);
		}

		if (mtmp->data == &mons[PM_SOLDIER_NYMPH]) {
			(void) mongets(mtmp, SPEAR);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, STUDDED_LEATHER_ARMOR);
			(void) mongets(mtmp, LOW_BOOTS);
			(void) mongets(mtmp, RIFLE);
	  		m_initthrow(mtmp, RIFLE_BULLET, 20);
		}

		if (mtmp->data == &mons[PM_SHOCKING_NYMPH]) {
			(void) mongets(mtmp, HAND_BLASTER);
	  		m_initthrow(mtmp, BLASTER_BOLT, 30);
			(void) mongets(mtmp, MACE);
		}

		if (mtmp->data == &mons[PM_HALF_NYMPH]) {
			(void) mongets(mtmp, FLAIL);
			(void) mongets(mtmp, CHAIN_MAIL);
		}

		if (mtmp->data == &mons[PM_STEALSTEALSTEAL_NYMPH]) {
			(void) mongets(mtmp, RAPIER);
			(void) mongets(mtmp, HELMET);
		}

		if (mtmp->data == &mons[PM_SUPER_THIEVING_NYMPH]) {
			(void) mongets(mtmp, BATTLE_AXE);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
			(void) mongets(mtmp, LEATHER_GLOVES);
			(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
			(void) mongets(mtmp, BLUE_DRAGON_SCALE_MAIL);
			(void) mongets(mtmp, ASSAULT_RIFLE);
	  		m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
	  		m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
		}

		if (mtmp->data == &mons[PM_OLZER]) {
			(void) mongets(mtmp, SMALL_SHIELD);
			(void) mongets(mtmp, BOW);
	  		m_initthrow(mtmp, ARROW, 30);
		}

		if (mtmp->data == &mons[PM_OOD_NYMPH]) {
			(void) mongets(mtmp, SMALL_SHIELD);
			(void) mongets(mtmp, CLUB);
			(void) mongets(mtmp, BAMBOO_MAIL);
		}

		if (mtmp->data == &mons[PM_WET_AREA_NYMPH]) {
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, SCYTHE);
			(void) mongets(mtmp, LEATHER_JACKET);
		}

		if (mtmp->data == &mons[PM_NATALIYA_S_WEDGE_SANDAL]) { (void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); (void) mongets(mtmp, WEDGE_SANDALS); } /* M4_HAMMERSANDAL|M4_SANDALS */

		if (mtmp->data == &mons[PM_ELIANE_S_VULNERABLE_SNEAKER]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (mtmp->data == &mons[PM_ELIANE_S_SANDAL]) (void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		if (mtmp->data == &mons[PM_APHRODITE]) (void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if (mtmp->data == &mons[PM_FILTHY_GUTTERSNIPE]) (void) mongets(mtmp, WAN_BAD_LUCK);
		if (mtmp->data == &mons[PM_INCONTINENT_NYMPH]) (void) mongets(mtmp, POT_URINE);
		if (mtmp->data == &mons[PM_FREAKING_DRYAD]) (void) mongets(mtmp, SCR_GROWTH);
		if (mtmp->data == &mons[PM_DIGGING_NYMPH]) (void) mongets(mtmp, WAN_DIGGING);
		if (mtmp->data == &mons[PM_PHASER_GIANT_OREAD]) (void) mongets(mtmp, BOULDER);
		if (mtmp->data == &mons[PM_OBNOXIOUS_NAIAD]) (void) mongets(mtmp, SCR_FLOOD);
		if (mtmp->data == &mons[PM_HC_THIEF]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if (ishaxor && mtmp->data == &mons[PM_APHRODITE]) (void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if(!rn2(5)) (void) mongets(mtmp, MIRROR);
		if(!rn2(10)) (void) mongets(mtmp, POT_OBJECT_DETECTION);

		/* evil patch idea by jonadab: levelwarping nymphs. To avoid annoying segfaults I'll have them do it via item. --Amy */
		if(!rn2(200)) (void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if (ptr == &mons[PM_NYMPH_QUEEN]) {
			struct obj *otmp = mksobj(SKELETON_KEY,TRUE,FALSE, FALSE);
			if (otmp) {
				otmp = oname(otmp,artiname(ART_KEY_OF_ACCESS));
				mpickobj(mtmp,otmp, TRUE);
			}
		}
		break;

	    case S_QUADRUPED:

		if (mtmp->data == &mons[PM_F_B_I_]) (void) mongets(mtmp, LUCERN_HAMMER);
		if (mtmp->data == &mons[PM_SCOTLAND_YARD_AGENT]) (void) mongets(mtmp, LUCERN_HAMMER);
		if (mtmp->data == &mons[PM_KSK_TYPE]) (void) mongets(mtmp, LUCERN_HAMMER);

		if (ptr == &mons[PM_SOLDIERCROTTA]) {
			  if (rn2(2)) {
				(void) mongets(mtmp, RIFLE);
		 		m_initthrow(mtmp, RIFLE_BULLET, 25);
		 		m_initthrow(mtmp, RIFLE_BULLET, 25);
			  } else {
				(void) mongets(mtmp, SUBMACHINE_GUN);
		 		m_initthrow(mtmp, SMG_BULLET, 25);
		 		m_initthrow(mtmp, SMG_BULLET, 25);
			  }
			(void)mongets(mtmp, rn2(2) ? KNIFE : DAGGER);
			if (rn2(2)) (void) mongets(mtmp, FRAG_GRENADE);
			(void)mongets(mtmp, HELMET);
			(void)mongets(mtmp, STUDDED_LEATHER_ARMOR);
			(void)mongets(mtmp, LEATHER_GLOVES);
			(void)mongets(mtmp, LOW_BOOTS);
			(void)mongets(mtmp, LEATHER_CLOAK);
		}
		if (ptr == &mons[PM_CAREBEAR_IN_HIGH_HEELS]) {
			(void)mongets(mtmp, rnd_class(WEDGE_SANDALS,ITALIAN_HEELS));
		}
		if (ptr == &mons[PM_BLASTPIG]) {
			 m_initthrow(mtmp, FRAG_GRENADE, 10);
		}
		if (ptr == &mons[PM_SPRAYGANGER]) {
			(void) mongets(mtmp, SPRAY_BOX);
		}
		if (ptr == &mons[PM_CIGARETTE_BEAR]) {
			(void) mongets(mtmp, CIGARETTE);
		}
		if (ptr == &mons[PM_OGF_MOBSTER]) {
			(void) mongets(mtmp, SPRAY_BOX);
		}
		if (ptr == &mons[PM_NEKO]) {
			(void) mongets(mtmp, TINSEL_LONGSWORD);
		}
		if (ptr == &mons[PM_EGGNOG_BUSTER]) {
			(void) mongets(mtmp, TINSEL_LONGSWORD);
			 m_initthrow(mtmp, FRAG_GRENADE, 20);
		}
		if (ptr == &mons[PM_SEAFARE_BEAR]) {
			(void) mongets(mtmp, FLINTLOCK);
			 m_initthrow(mtmp, PISTOL_BULLET, 50);
		}
		if (ptr == &mons[PM_SHERIFF_D__THE_GELORDLY]) {
			(void) mongets(mtmp, PISTOL);
			(void) mongets(mtmp, LEATHER_JACKET);
			(void) mongets(mtmp, ELVEN_LEATHER_HELM);
			(void) mongets(mtmp, FLINTLOCK);
			 m_initthrow(mtmp, PISTOL_BULLET, 40);
			 m_initthrow(mtmp, PISTOL_BULLET, 40);
		}
		if (ptr == &mons[PM_VOLDEPORK]) {
			(void) mongets(mtmp, WAN_DEATH);
			(void) mongets(mtmp, SHOTGUN);
			 m_initthrow(mtmp, SHOTGUN_SHELL, 25);
		}
		if (ptr == &mons[PM_BIG_SMOKER_ASSHOLE]) {
			(void) mongets(mtmp, GREEN_SABER);
			(void) mongets(mtmp, CIGARETTE);
		}
		if (ptr == &mons[PM_RUTHLESS_RASHER]) {
			(void) mongets(mtmp, TUBING_PLIERS);
		}
		if (ptr == &mons[PM_ESKETEPANSA]) {
			(void) mongets(mtmp, GIANT_SEA_ANEMONE);
		}
		if (ptr == &mons[PM_DARKMOON_CLAN]) {
			(void) mongets(mtmp, MOON_AXE);
		}
		if (ptr == &mons[PM_SAINT_MARKS_MAFIA_TYPE]) {
			(void) mongets(mtmp, PISTOL);
			(void) mongets(mtmp, CAMOUFLAGED_CLOTHES);
			 m_initthrow(mtmp, LEAD_PISTOL_BULLET, 50);
		}
		if (ptr == &mons[PM_KILL_YA_MAFIA_TYPE]) {
			(void) mongets(mtmp, SHOTGUN);
			(void) mongets(mtmp, CAMOUFLAGED_CLOTHES);
			 m_initthrow(mtmp, LEAD_SHOT, 40);
		}
		if (ptr == &mons[PM_GUN_BALLAS]) {
			(void) mongets(mtmp, SAWED_OFF_SHOTGUN);
			 m_initthrow(mtmp, SHOTGUN_SHELL, 40);
		}
		if (ptr == &mons[PM_CUNT_VAGO]) {
			(void) mongets(mtmp, HUNTING_RIFLE);
			 m_initthrow(mtmp, RIFLE_BULLET, 40);
		}
		if (ptr == &mons[PM_AZTEC_BANGER]) {
			(void) mongets(mtmp, SUBMACHINE_GUN);
			 m_initthrow(mtmp, SMG_BULLET, 50);
		}
		if (ptr == &mons[PM_GANG_YAKUZA]) {
			if (rn2(2)) {
				(void) mongets(mtmp, PISTOL);
				 m_initthrow(mtmp, LEAD_PISTOL_BULLET, 50);
			} else {
				(void) mongets(mtmp, SUBMACHINE_GUN);
				 m_initthrow(mtmp, SMG_BULLET, 50);
			}
		}
		if (ptr == &mons[PM_PANLANTIC_COLOMBIAN_POTATO]) {
			if (rn2(2)) {
				(void) mongets(mtmp, PISTOL);
				 m_initthrow(mtmp, LEAD_PISTOL_BULLET, 50);
			} else {
				(void) mongets(mtmp, SUBMACHINE_GUN);
				 m_initthrow(mtmp, LEAD_SMG_BULLET, 50);
			}
			(void) mongets(mtmp, HIGH_BOOTS);
			(void) mongets(mtmp, FEDORA);
		}
		if (ptr == &mons[PM_SHORESIDE_COLOMBIAN_POTATO]) {
			if (rn2(2)) {
				(void) mongets(mtmp, PISTOL);
				 m_initthrow(mtmp, LEAD_PISTOL_BULLET, 50);
			} else {
				(void) mongets(mtmp, SUBMACHINE_GUN);
				 m_initthrow(mtmp, LEAD_SMG_BULLET, 50);
			}
			(void) mongets(mtmp, LEATHER_SHOES);
			(void) mongets(mtmp, HAWAIIAN_SHIRT);
		}
		if (ptr == &mons[PM_BUFF_COLOMBIAN_POTATO]) {
			(void) mongets(mtmp, KALASHNIKOV);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 50);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 50);
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, DWARVISH_CLOAK);
			(void) mongets(mtmp, HIGH_BOOTS);
		}
		if (ptr == &mons[PM_PURPLE_NINE]) {
			(void) mongets(mtmp, SUBMACHINE_GUN);
			 m_initthrow(mtmp, LEAD_SMG_BULLET, 50);
			 m_initthrow(mtmp, LEAD_SMG_BULLET, 25);
			(void) mongets(mtmp, RING_MAIL);
		}
		if (ptr == &mons[PM_RUMBLER_RED_JACK]) {
			(void) mongets(mtmp, PISTOL);
			 m_initthrow(mtmp, LEAD_PISTOL_BULLET, 50);
			(void) mongets(mtmp, RING_MAIL);
			(void) mongets(mtmp, BASEBALL_BAT);
		}
		if (ptr == &mons[PM_FISH_TRIAD]) {
			(void) mongets(mtmp, GNOMISH_HELM);
			if (!rn2(2)) (void) mongets(mtmp, BASEBALL_BAT);
			else {
				(void) mongets(mtmp, PISTOL);
		  		m_initthrow(mtmp, LEAD_PISTOL_BULLET, 20);

			}
		}

		if (ptr == &mons[PM_RAY_BEAR]) {
			(void) mongets(mtmp, RAYGUN);
	  		m_initthrow(mtmp, RAYGUN_BOLT, 50);
		}
		if (mtmp->data == &mons[PM_LANCEGOAT]) (void) mongets(mtmp, LANCE);
		if (mtmp->data == &mons[PM_KILLING_ANTEATER]) (void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);

		if (ptr == &mons[PM_EVIL_MAMMOTH]) {
			(void) mongets(mtmp, SCR_EVIL_VARIANT);
		}
		if (ptr == &mons[PM_ESCAPEGOAT]) {
			(void) mongets(mtmp, SNIPER_RIFLE);
	  		m_initthrow(mtmp, SNIPER_BULLET, 50);
		}
		if (ptr == &mons[PM_MEDICINE_STUDENT]) {
			(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
			(void) mongets(mtmp, QUARTERSTAFF);
		}
		if (ptr == &mons[PM_HAUGHTY_PHYSICIAN]) {
			(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
			(void) mongets(mtmp, QUARTERSTAFF);
		}

		if (ptr == &mons[PM_DOBIEL]) {
		  	(void) mongets(mtmp, BALLISTA);
		  	m_initthrow(mtmp, CROSSBOW_BOLT, 50);
		  	m_initthrow(mtmp, CROSSBOW_BOLT, 50);
		}

		if (mtmp->data == &mons[PM_KIRIN_BEAST]) (void) mongets(mtmp, KATANA);
		if (mtmp->data == &mons[PM_ARKTOUROS]) (void) mongets(mtmp, BARDICHE);
		if (mtmp->data == &mons[PM_FARMING_COW]) (void) mongets(mtmp, SCR_FARMING);
		if (mtmp->data == &mons[PM_REAL_MARSH_CLAN]) (void) mongets(mtmp, SCR_MOORLAND);
		if (mtmp->data == &mons[PM_REAL_ASH_CLAN]) (void) mongets(mtmp, SCR_ASH);

		if (mtmp->data == &mons[PM_PURE_CHAOS_HORDE]) (void) mongets(mtmp, SCR_CHAOS_TERRAIN);
		if (mtmp->data == &mons[PM_CORINA_S_SPECIAL_COMBAT_BOOT]) (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

		if (mtmp->data == &mons[PM_SOPHIE_S_COMBAT_BOOT]) (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		if (mtmp->data == &mons[PM_BEA_S_COMBAT_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_THAI_S_COMBAT_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_CORINA_S_STILETTO_BOOT]) (void) mongets(mtmp, COMBAT_STILETTOS);

			if(ptr == &mons[PM_EXIT]) (void) mongets(mtmp, !rn2(3) ? SCR_WARPING : !rn2(2) ? SCR_ROOT_PASSWORD_DETECTION : SCR_TELEPORTATION);

		break;

	    case S_ANT:

		if (mtmp->data == &mons[PM_GREAT_PARALYSATOR_FLY]) (void) mongets(mtmp, WAN_PARALYSIS);
		if (mtmp->data == &mons[PM_TEAM_NASTYTRAP_MEMBER]) (void) mongets(mtmp, SCR_NASTINESS);
		if (mtmp->data == &mons[PM_INSECT_HUNTER]) (void) mongets(mtmp, LASER_SWATTER);
		if (mtmp->data == &mons[PM_BALLANT]) (void) mongets(mtmp, EAGLE_BALL);
		if (mtmp->data == &mons[PM_NAIL_ASSASSIN_BUG]) (void) mongets(mtmp, QATAR);
		if (mtmp->data == &mons[PM_CLAW_ANT]) (void) mongets(mtmp, QATAR);

		if (mtmp->data == &mons[PM_JELLY_BEE]) (void) mongets(mtmp, LUMP_OF_ROYAL_JELLY);
		if (mtmp->data == &mons[PM_CROWNED_QUEEN_BEE]) (void) mongets(mtmp, LUMP_OF_ROYAL_JELLY);
		if (mtmp->data == &mons[PM_GIANT_JELLY_BEE]) (void) mongets(mtmp, LUMP_OF_ROYAL_JELLY);

		if (mtmp->data == &mons[PM_MARIKE_S_WORN_OUT_SNEAKER]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (mtmp->data == &mons[PM_JEANETTA_S_LITTLE_GIRL_BOOT]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if (ptr == &mons[PM_CATERPILLAR_SNIPER]) {
		  	(void) mongets(mtmp, SNIPER_RIFLE);
		  	m_initthrow(mtmp, SNIPER_BULLET, 20);
		}
		if (ptr == &mons[PM_SPIKE_BEE]) {
		  	m_initthrow(mtmp, SPIKE, 20);
		}
		if (ptr == &mons[PM_LIEUTEN_ANT]) {
		  	(void) mongets(mtmp, HEAVY_MACHINE_GUN);
		  	m_initthrow(mtmp, MG_BULLET, 50);
		  	m_initthrow(mtmp, MG_BULLET, 50);
		  	m_initthrow(mtmp, MG_BULLET, 50);
		  	m_initthrow(mtmp, MG_BULLET, 50);
		}
		if (ptr == &mons[PM_REAL_SOLDIER_ANT]) {
		  	(void) mongets(mtmp, PISTOL);
		  	m_initthrow(mtmp, PISTOL_BULLET, 10);
			if (!rn2(2)) m_initthrow(mtmp, FRAG_GRENADE, 5);
		}
		if (ptr == &mons[PM_SUPER_SOLDIER_ANT]) {
		  	(void) mongets(mtmp, SUBMACHINE_GUN);
		  	(void) mongets(mtmp, HELMET);
		  	(void) mongets(mtmp, ORCISH_CLOAK);
		  	(void) mongets(mtmp, RING_MAIL);
		  	m_initthrow(mtmp, SMG_BULLET, 20);
			if (!rn2(2)) m_initthrow(mtmp, FRAG_GRENADE, 5);
		}
		if (ptr == &mons[PM_RIFLE_BULLET_ANT]) {
		  	(void) mongets(mtmp, RIFLE);
		  	m_initthrow(mtmp, RIFLE_BULLET, 30);
		}
		if (ptr == &mons[PM_SPLICE_BULLET_ANT]) {
		  	(void) mongets(mtmp, SUBMACHINE_GUN);
		  	m_initthrow(mtmp, SMG_BULLET, 50);
		}
		if (ptr == &mons[PM_JANE_SANDRA]) {
		  	(void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		  	(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		  	(void) mongets(mtmp, ROCKET_GAUNTLETS);
		  	(void) mongets(mtmp, WAN_SPEED_MONSTER);
		  	(void) mongets(mtmp, POT_FULL_HEALING);
		}
		if (ptr == &mons[PM_OMEGA_HERAKLES]) {

			if (!rn2(3)) {
			  	(void) mongets(mtmp, ASSAULT_RIFLE);
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
			} else if (!rn2(2)) {
			  	(void) mongets(mtmp, SUBMACHINE_GUN);
			  	m_initthrow(mtmp, SMG_BULLET, 50);
			} else {
			  	(void) mongets(mtmp, RIFLE);
			  	m_initthrow(mtmp, RIFLE_BULLET, 50);
			}
		}
		if (ptr == &mons[PM_CRAZY_IVAN]) {
			if (!rn2(2)) m_initthrow(mtmp, FRAG_GRENADE, 30);
			else {
			  	(void) mongets(mtmp, KALASHNIKOV);
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
			}
		}

		break;

	    case S_CENTAUR:

		if(ptr == &mons[PM_REAL_DEGA]) (void) mongets(mtmp, PICK_AXE);
		if(ptr == &mons[PM_OLF_KARTOFFELKOPF]) (void) mongets(mtmp, BUNNY_UNIFORM);
		if(ptr == &mons[PM_RIVOLE_SPICERO]) (void) mongets(mtmp, ITALIAN_HEELS); /* M4_SANDALS */

		if (ptr == &mons[PM_HEAVY_CENTAUR]) {
			(void) mongets(mtmp, FLINTLOCK);
	  		m_initthrow(mtmp, LEAD_PISTOL_BULLET, 20);
		}
		if (ptr == &mons[PM_BAB]) {
	  		m_initthrow(mtmp, FRAG_GRENADE, 25);
		}
		if (ptr == &mons[PM_CAST_CENTAUR]) {
			(void) mongets(mtmp, BOW);
	  		m_initthrow(mtmp, BRONZE_ARROW, 50);
		}
		if (ptr == &mons[PM_POOR_CENTAUR]) {
			(void) mongets(mtmp, BIDENHANDER);
			(void) mongets(mtmp, BOW);
	  		m_initthrow(mtmp, PAPER_ARROW, 30);
		}
		if (ptr == &mons[PM_ORPHE_CHAOS_FOLLOWER]) {
			(void) mongets(mtmp, BROADSWORD);
			(void) mongets(mtmp, WAN_CREATE_HORDE);
		}
		if (ptr == &mons[PM_CENTAUR_QUACKSTER]) {
			(void) mongets(mtmp, CROSSBOW);
	  		m_initthrow(mtmp, POISON_BOLT, 50);
		}
		if (ptr == &mons[PM_CYBRACK_THE_CRUCIFIER]) {
			(void) mongets(mtmp, WOODEN_STAKE);
		}
		if (ptr == &mons[PM_ETHER_CENTAUR]) {
			(void) mongets(mtmp, CROSSBOW);
	  		m_initthrow(mtmp, ETHER_BOLT, 40);
		}
		if (ptr == &mons[PM_MATSPAM_CENTAUR]) {
			(void) mongets(mtmp, CROSSBOW);
	  		m_initthrow(mtmp, MATERIAL_BOLT, 35);
		}
		if (ptr == &mons[PM_CENTAUR_ZOOMER]) {
			(void) mongets(mtmp, ZOOM_SHOT_CROSSBOW);
	  		m_initthrow(mtmp, PIN_BOLT, 50);
		}
		if (ptr == &mons[PM_REUSE_CENTAUR]) {
			(void) mongets(mtmp, CROSSBOW);
	  		m_initthrow(mtmp, HEAVY_CROSSBOW_BOLT, 40);
	  		m_initthrow(mtmp, HEAVY_CROSSBOW_BOLT, 40);
		}
		if (ptr == &mons[PM_DOUBLESLING_CENTAUR]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, TALC, 20);
			 m_initthrow(mtmp, GRAPHITE, 20);
		}
		if (ptr == &mons[PM_SALTY_CENTAUR]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, RAPIRAPI);
			 m_initthrow(mtmp, SALT_CHUNK, 30);
		}

		if (ptr == &mons[PM_AMMOTAUR]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, BASINET);
			 m_initthrow(mtmp, BONE_FRAGMENT, 25);
		}

		if (ptr == &mons[PM_HYDRA_CENTAUR]) {
		  	(void) mongets(mtmp, HYDRA_BOW);
		  	m_initthrow(mtmp, GOLDEN_ARROW, 40);
		}
		if (ptr == &mons[PM_ROQTAUR]) {
		  	(void) mongets(mtmp, SLING);
		  	m_initthrow(mtmp, ROCK, 25);
		}
		if (ptr == &mons[PM_VILLAGE_CENTAUR]) {
		  	(void) mongets(mtmp, SLING);
		  	m_initthrow(mtmp, FLINT, 30);
		}
		if (ptr == &mons[PM_BOOMBOOM_CENTAUR]) {
		  	m_initthrow(mtmp, BOOMERANG, 3);
		}
		if (ptr == &mons[PM_MAGNETO_CENTAUR]) {
		  	(void) mongets(mtmp, FLINTLOCK);
		  	m_initthrow(mtmp, PISTOL_BULLET, 20);
		}
		if (ptr == &mons[PM_VARIED_CENTAUR]) {
		  	(void) mongets(mtmp, SLING);
		  	m_initthrow(mtmp, FLINT, 40);
		  	(void) mongets(mtmp, UNICORN_HORN);
		  	(void) mongets(mtmp, SMALL_SHIELD);
		  	(void) mongets(mtmp, IRON_SHOES);
		}
		if (ptr == &mons[PM_LEFT_CENTAUR]) {
		  	(void) mongets(mtmp, LEATHER_GLOVES);
		  	m_initthrow(mtmp, FLIMSY_DART, 40);
		}
		if (ptr == &mons[PM_FITH_CENTAUR]) {
		  	(void) mongets(mtmp, PLASTEEL_HELM);
		  	m_initthrow(mtmp, FRAG_GRENADE, 20);
		}
		if (ptr == &mons[PM_STAB_CENTAUR]) {
		  	(void) mongets(mtmp, KNIFE);
		}
		if (ptr == &mons[PM_STABRIDER]) {
		  	(void) mongets(mtmp, LANCE);
		}

		if (mtmp->data == &mons[PM_HC_LADY]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if(ptr == &mons[PM_HC_LANCE_CARRIER]) (void) mongets(mtmp, LANCE);
		if(ptr == &mons[PM_CENTAUR_HIGHWAYMAN]) (void) mongets(mtmp, SCR_HIGHWAY);
		if(ptr == &mons[PM_CENTAUR_SPEAROR]) m_initthrow(mtmp, SPEAR, 7);

		break;

	    case S_DOG:

		if (ptr == &mons[PM_DESERT_FOX]) {
			(void) mongets(mtmp, DESERT_SWORD);
			 m_initthrow(mtmp, SAND_DART, 50);
			 m_initthrow(mtmp, SAND_DART, 50);
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}
		if (ptr == &mons[PM_SLY_DESERT_FOX]) {
			(void) mongets(mtmp, DESERT_SWORD);
			 m_initthrow(mtmp, SAND_DART, 50);
			 m_initthrow(mtmp, SAND_DART, 50);
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}
		if (ptr == &mons[PM_RUM_RUNNER]) {
			(void) mongets(mtmp, POT_CONFUSION);
			(void) mongets(mtmp, POT_BOOZE);
		}
		if (ptr == &mons[PM_HOT_DOG_VAN]) {
			(void) mongets(mtmp, FOOD_RATION);
			(void) mongets(mtmp, TRIPE_RATION);
		}
		if(ptr == &mons[PM_BELMONT_CLAN_MEMBER]) (void) mongets(mtmp, WOODEN_STAKE);
		if(ptr == &mons[PM_WALDOGGO]) (void) mongets(mtmp, BOBBLE_HAT);

		if (ptr == &mons[PM_SARACEN_CONQUEROR]) {
			(void) mongets(mtmp, DESERT_SWORD);
			 m_initthrow(mtmp, SAND_DART, 50);
			 m_initthrow(mtmp, SAND_DART, 50);
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}
		if (ptr == &mons[PM_POISON_DOCTOR]) {
			(void) mongets(mtmp, DESERT_SWORD);
			 m_initthrow(mtmp, SAND_DART, 50);
			 m_initthrow(mtmp, SAND_DART, 50);
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}

		if (mtmp->data == &mons[PM_ALIEN_DEMONSTRANT]) {
			if (!rn2(2)) (void)mongets(mtmp, rnd_class(PARTISAN,BEC_DE_CORBIN));
		}

		if (mtmp->data == &mons[PM_NOZZLE_IMPULSE]) (void) mongets(mtmp, ROCKET_GAUNTLETS);
		if (mtmp->data == &mons[PM_HELL_BRIDE]) (void) mongets(mtmp, DANCING_SHOES);
		if (mtmp->data == &mons[PM_GREUVENENE]) (void) mongets(mtmp, SCR_LOCKOUT);
		if (mtmp->data == &mons[PM_SUE_LYN_S_PLATEAU_BOOT]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if (mtmp->data == &mons[PM_CRAPDOG]) (void) mongets(mtmp, SCR_BULLSHIT);
		if (mtmp->data == &mons[PM_ELEMENTAL_GIRL]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (mtmp->data == &mons[PM_SUE_LYN_S_THICK_WINTER_BOOT]) { (void) mongets(mtmp, HUGGING_BOOT); (void) mongets(mtmp, SCR_TRAP_CREATION); }
		if (mtmp->data == &mons[PM_AMATEURHOUR]) (void) mongets(mtmp, BOBBLE_HAT);
		if (mtmp->data == &mons[PM_AMATEURHOUR_JR_]) (void) mongets(mtmp, BOBBLE_HAT);

		if (mtmp->data == &mons[PM_BOW_WOLF]) {
		  	(void) mongets(mtmp, BOW);
		  	m_initthrow(mtmp, ANCIENT_ARROW, 35);
		}

		if (mtmp->data == &mons[PM_SHINING_SILVER_WOLF]) {
		  	(void) mongets(mtmp, RAYGUN);
		  	(void) mongets(mtmp, WHITE_LIGHTSABER);
		  	m_initthrow(mtmp, RAYGUN_BOLT, 50);
		  	m_initthrow(mtmp, RAYGUN_BOLT, 50);
		}

		if (mtmp->data == &mons[PM_COMMAND_WOLF]) {
			switch (rnd(5)) {
				case 1:
				  	(void) mongets(mtmp, BOW);
				  	m_initthrow(mtmp, ANCIENT_ARROW, 35);
				  	m_initthrow(mtmp, ANCIENT_ARROW, 35);
					break;
				case 2:
				  	(void) mongets(mtmp, POWER_CROSSBOW);
				  	m_initthrow(mtmp, CROSSBOW_BOLT, 50);
				  	m_initthrow(mtmp, CROSSBOW_BOLT, 50);
					break;
				case 3:
				  	(void) mongets(mtmp, CATAPULT);
				  	m_initthrow(mtmp, FLINT, 50);
				  	m_initthrow(mtmp, FLINT, 50);
					break;
				case 4:
				  	(void) mongets(mtmp, ASSAULT_RIFLE);
				  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
				  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
					break;
				case 5:
				  	(void) mongets(mtmp, AUTO_SHOTGUN);
				  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 40);
				  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 40);
					break;
			}
		}

		if (mtmp->data == &mons[PM_DOG_COP]) {
			(void)mongets(mtmp, RUBBER_HOSE);
			m_initthrow(mtmp, CREAM_PIE, 2);
		}

		break;

	    case S_GHOST:

		if (ptr == &mons[PM_GUN_SPIRIT]) {
		  	(void) mongets(mtmp, FLINTLOCK);
		  	m_initthrow(mtmp, PISTOL_BULLET, 10);
		}
		if (ptr == &mons[PM_COP_BIKE]) {

			otmp = mksobj(PISTOL, FALSE, FALSE, FALSE);
			if (otmp) {
				otmp->spe += 2;
				(void) mpickobj(mtmp, otmp, TRUE);
			}
		  	m_initthrow(mtmp, PISTOL_BULLET, 50);
		  	m_initthrow(mtmp, PISTOL_BULLET, 25);
		}
		if (ptr == &mons[PM_SECTION_SHADOW]) {
		  	(void) mongets(mtmp, SHADOWBLADE);
		}
		if (ptr == &mons[PM_CYAN_BLADE_GHOST]) {
		  	(void) mongets(mtmp, KNIFE);
		}
		if (ptr == &mons[PM_SITH_GHOST]) {
		  	(void) mongets(mtmp, SITH_STAFF);
		}
		if (ptr == &mons[PM_BRIGHTER_SHADOW]) {
		  	(void) mongets(mtmp, LIGHTWHIP);
		}
		if (ptr == &mons[PM_ACID_SHADOW]) {
		  	(void) mongets(mtmp, SHADOW_HORN);
		}
		if (ptr == &mons[PM_CHTO]) {
		  	(void) mongets(mtmp, KHOPESH);
		}
		if (ptr == &mons[PM_TRAVELTRAIN]) {
		  	(void) mongets(mtmp, SCR_COURSE_TRAVELING);
		}
		if (ptr == &mons[PM_D_TRAIN]) {
		  	(void) mongets(mtmp, SCR_COURSE_TRAVELING);
		}
		if (ptr == &mons[PM_ELVIN_PRESS]) {
		  	(void) mongets(mtmp, AIR_PRESSURE_HAMMER);
		}
		if (ptr == &mons[PM_SMOKING_LIBAVIUS_SPIRIT]) {
		  	(void) mongets(mtmp, rn2(2) ? CIGARETTE : CIGAR);
		}
		if (ptr == &mons[PM_BRIGHTFLARE_GHOST]) {
		  	(void) mongets(mtmp, TORCH);
		  	(void) mongets(mtmp, TORCH);
		  	(void) mongets(mtmp, TORCH);
		}
		if (ptr == &mons[PM_SYLPH_SPIRIT]) {
		  	(void) mongets(mtmp, BOW);
		  	(void) mongets(mtmp, LONG_SWORD);
		  	(void) mongets(mtmp, LEATHER_CLOAK);
		  	m_initthrow(mtmp, ARROW, 50);
		}
		if (ptr == &mons[PM_CHAOS_HUNTER]) {
		  	(void) mongets(mtmp, BOW);
		  	m_initthrow(mtmp, ARROW, 50);
		}
		if (ptr == &mons[PM_WASTELAND_BOO]) {
		  	(void) mongets(mtmp, SAND_SWORD);
		  	(void) mongets(mtmp, RAPIRAPI);
		  	(void) mongets(mtmp, TAR_CHAIN_MAIL);
		}
		if (ptr == &mons[PM_UNIQUE_GHOSTLY_SITH_MASTER]) {
		  	(void) mongets(mtmp, ELITE_BATLETH);
		  	(void) mongets(mtmp, HEAVY_SHIELD);
		  	(void) mongets(mtmp, FULL_PLATE_MAIL);
		  	(void) mongets(mtmp, PLASTEEL_HELM);
		}
		if (ptr == &mons[PM_FETTER_GHOST]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, IRON_CHAIN);
			 m_initthrow(mtmp, TALC, 25);
		}
		if (ptr == &mons[PM_SALTSHADE]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, ORCISH_CLOAK);
			(void) mongets(mtmp, STRAW_HAT);
			 m_initthrow(mtmp, SALT_CHUNK, 35);
		}
		if (mtmp->data == &mons[PM_ALIEN_IN_PUMPS]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		if (mtmp->data == &mons[PM_PAPER_WEIGHT]) (void) mongets(mtmp, WEIGHTED_FLAIL);
		if (mtmp->data == &mons[PM_FULL_NETHER_GHOST]) (void) mongets(mtmp, SCR_NETHER);
		if (mtmp->data == &mons[PM_CACKLING_SPIRIT]) (void) mongets(mtmp, WAN_TRAP_CREATION);
		if (mtmp->data == &mons[PM_HAUNTED_SPIRIT]) (void) mongets(mtmp, WAN_CURSE_ITEMS);
		if (mtmp->data == &mons[PM_SUMMONING_SPIRIT]) (void) mongets(mtmp, SCR_SUMMON_GHOST);
		if (mtmp->data == &mons[PM_HOMING_THUNDER_CALLER]) (void) mongets(mtmp, WAN_DRAIN_MANA);
		if (mtmp->data == &mons[PM_ELENA_S_COMBAT_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_KATHARINA_S_LOVELY_GIRL_BOOT]) { (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS); (void) mongets(mtmp, LEATHER_PEEP_TOES); }
		if (mtmp->data == &mons[PM_SADISTIC_ASIAN_GIRL]) (void) mongets(mtmp, HUGGING_BOOT);
		if (mtmp->data == &mons[PM_MUM]) (void) mongets(mtmp, SWEET_MOCASSINS);
		if (mtmp->data == &mons[PM_FINGER_SMASHER]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (mtmp->data == &mons[PM_TENDER_FEMMY]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if (mtmp->data == &mons[PM_BEAUTIFUL_FEMMY]) (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		if (mtmp->data == &mons[PM_DUNGEON_COLLAPSE]) {
			(void) mongets(mtmp, SCR_LOCKOUT);
			(void) mongets(mtmp, SCR_EARTH);
		}
		if (mtmp->data == &mons[PM_HIGH_HEEL_SPIRIT]) {
			(void) mongets(mtmp, SEXY_LEATHER_PUMP);
			(void) mongets(mtmp, COMBAT_STILETTOS);
		}
		if (mtmp->data == &mons[PM_HC_MOM]) (void) mongets(mtmp, SWEET_MOCASSINS);

		break;

	    case S_PUDDING:

		if (mtmp->data == &mons[PM_AQUA_PUDDING]) (void) mongets(mtmp, POT_SANITY);
		if (mtmp->data == &mons[PM_COLLUDED_HUNGER]) (void) mongets(mtmp, DARKNESS_CLUB);
		if (mtmp->data == &mons[PM_BUBBLE_SLIME]) (void) mongets(mtmp, SCR_BUBBLE_BOBBLE);
		if (mtmp->data == &mons[PM_CUD_CURD]) (void) mongets(mtmp, CUDSWORD);
		if (mtmp->data == &mons[PM_CHANOP]) (void) mongets(mtmp, HEAVY_HAMMER);
		if (mtmp->data == &mons[PM_RARE_ARMOR_WEARER]) (void) mongets(mtmp, OLD_MAIL);
		if (mtmp->data == &mons[PM_POWERED_PACI_FIST]) (void) mongets(mtmp, POWERFIST);
		if (ptr == &mons[PM_MILITARY_PUTIT]) {
		  	(void) mongets(mtmp, FLINTLOCK);
		  	m_initthrow(mtmp, PISTOL_BULLET, 15);
		}
		if (ptr == &mons[PM_PRIESTEFIX]) {
		  	(void) mongets(mtmp, STARWARS_MACE);
		  	(void) mongets(mtmp, SMALL_SHIELD);
		}
		if (ptr == &mons[PM_PISTOL_PUDDING]) {
		  	(void) mongets(mtmp, PISTOL);
		  	m_initthrow(mtmp, PISTOL_BULLET, 40);
		}
		if (ptr == &mons[PM_PUNK]) {
		  	(void) mongets(mtmp, FLINTLOCK);
		  	m_initthrow(mtmp, PISTOL_BULLET, 5);
		}
		if (ptr == &mons[PM_GRAPHITE_PUDDING]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, GRAPHITE, 25);
		}
		if (ptr == &mons[PM_RIFLE_PUDDING]) {
		  	(void) mongets(mtmp, RIFLE);
		  	m_initthrow(mtmp, RIFLE_BULLET, 50);
		}
		if (ptr == &mons[PM_SHOTTY_PUDDING]) {
		  	(void) mongets(mtmp, SHOTGUN);
		  	m_initthrow(mtmp, SHOTGUN_SHELL, 30);
		}
		if (ptr == &mons[PM_AUTOSHOT_PUDDING]) {
		  	(void) mongets(mtmp, AUTO_SHOTGUN);
		  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 50);
		}
		if (ptr == &mons[PM_LEADDY_PUDDING]) {
		  	(void) mongets(mtmp, AUTO_SHOTGUN);
		  	m_initthrow(mtmp, AUTO_LEAD_SHOT, 50);
		}
		if (ptr == &mons[PM_SMG_PUDDING]) {
		  	(void) mongets(mtmp, SUBMACHINE_GUN);
		  	m_initthrow(mtmp, SMG_BULLET, 30);
		  	m_initthrow(mtmp, SMG_BULLET, 30);
		}
		if (ptr == &mons[PM_ASSAULT_PUDDING]) {
		  	(void) mongets(mtmp, ASSAULT_RIFLE);
		  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
		  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
		}
		if (ptr == &mons[PM_HEAVY_WEAPON_PUDDING]) {
		  	(void) mongets(mtmp, HEAVY_MACHINE_GUN);
		  	m_initthrow(mtmp, MG_BULLET, 50);
		  	m_initthrow(mtmp, MG_BULLET, 50);
		  	m_initthrow(mtmp, MG_BULLET, 50);
		  	m_initthrow(mtmp, MG_BULLET, 50);
		}
		if (ptr == &mons[PM_BIG_FUCKING_PUDDING]) {
		  	(void) mongets(mtmp, BFG);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		}
		if (ptr == &mons[PM_DOOMGUY_PUDDING]) {
		  	(void) mongets(mtmp, BFG);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	(void) mongets(mtmp, HEAVY_MACHINE_GUN);
		  	m_initthrow(mtmp, MG_BULLET, 50);
		  	m_initthrow(mtmp, MG_BULLET, 50);
		  	m_initthrow(mtmp, MG_BULLET, 50);
		  	m_initthrow(mtmp, MG_BULLET, 50);
		  	m_initthrow(mtmp, MG_BULLET, 50);
		}

		break;

	    case S_FUNGUS:

		if (mtmp->data == &mons[PM_PLEASING_FUNGUS]) (void) mongets(mtmp, SCR_IMMOBILITY);
		if (mtmp->data == &mons[PM_PLEASING_WARP_FUNGUS]) (void) mongets(mtmp, WAN_IMMOBILITY);
		if (mtmp->data == &mons[PM_PLEASING_PATCH]) (void) mongets(mtmp, SCR_EGOISM);
		if (mtmp->data == &mons[PM_PLEASING_WARP_PATCH]) (void) mongets(mtmp, WAN_EGOISM);
		if (ptr == &mons[PM_GWEN_ACTOR]) (void) mongets(mtmp, YITH_TENTACLE);
		if (ptr == &mons[PM_HC_FISHER]) (void) mongets(mtmp, FISHING_POLE);
		if (ptr == &mons[PM_EURGH_SMOKER]) (void) mongets(mtmp, CIGARETTE);
		if (ptr == &mons[PM_LUISA_S_DANCING_SHOE]) (void) mongets(mtmp, DANCING_SHOES);
		if (ptr == &mons[PM_LAS_VENTURAS_GANMBLER]) mtmp->mgold += (long) rnd(100);

		if (ptr == &mons[PM_WOODFALLER_BRIGADE]) {
			(void) mongets(mtmp, SHARP_AXE);
			(void) mongets(mtmp, HELMET);
		}
		if (ptr == &mons[PM_ACTUAL_EVIL_PATCH]) {
			(void) mongets(mtmp, SCR_EVIL_VARIANT);
		}
		if (ptr == &mons[PM_ANTI_HAND_FEMMY]) {
			(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		}
		if (ptr == &mons[PM_TOILET_FEMMY]) {
			(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		}
		if (ptr == &mons[PM_SOBER_THE_DRUNK]) {
			(void) mongets(mtmp, POT_CONFUSION);
			(void) mongets(mtmp, POT_CONFUSION);
			(void) mongets(mtmp, POT_CONFUSION);
		}

		if (ptr == &mons[PM_HOT_MUSHROOM_TEACHER]) {
			(void) mongets(mtmp, ROCKET_LAUNCHER);
			 m_initthrow(mtmp, ROCKET, 20);
		}
		if (ptr == &mons[PM_BRAVITY_MODDED_PERSON]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, GRAPHITE, 20);
		}
		if (ptr == &mons[PM_INFECTED_YERLES_SOLDIER]) {
			(void) mongets(mtmp, LONG_SWORD);
			(void) mongets(mtmp, ASSAULT_RIFLE);
			 m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
			 m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 25);
		}
		if (ptr == &mons[PM_INFECTED_TANJA_SOLDIER]) {
			(void) mongets(mtmp, LONG_SWORD);
			(void) mongets(mtmp, ASSAULT_RIFLE);
			 m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
			 m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 25);
		}

		if (ptr == &mons[PM_VOLCANIC_NOLD]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, DROVEN_HELM);
			 m_initthrow(mtmp, VOLCANIC_GLASS_FRAGMENT, 40);
		}

		if (ptr == &mons[PM_FRENCH_GANGMAN]) {
			(void) mongets(mtmp, SPLINT_MAIL);
			(void) mongets(mtmp, KALASHNIKOV);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 50);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 50);
		}

		if (ptr == &mons[PM_RHED_MUSHROOM]) {
		  	(void) mongets(mtmp, SLING);
		  	m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_THIEF_GUILD_MEMBER]) {
		  	m_initthrow(mtmp, SHURIKEN, 30);
		  	m_initthrow(mtmp, DAGGER, 5);
		  	m_initthrow(mtmp, KNIFE, 5);
		}

		if (monsndx(ptr) == PM_LASERGUS) {
			(void) mongets(mtmp, HAND_BLASTER);
			m_initthrow(mtmp, BLASTER_BOLT, 50);
		}

		if (ptr == &mons[PM_SALMA]) {
		  	(void) mongets(mtmp, SWEET_MOCASSINS);
		  	(void) mongets(mtmp, AMULET_OF_LIFE_SAVING);
		}

		if (mtmp->data == &mons[PM_YITHGUS]) (void) mongets(mtmp, WAN_INSANITY);
		if (mtmp->data == &mons[PM_CURING_LEADER]) (void) mongets(mtmp, SCR_URINE);

		if (mtmp->data == &mons[PM_NATALJE_S_PLATEAU_SANDAL]) { (void) mongets(mtmp, HIGH_HEELED_SANDAL); (void) mongets(mtmp, SCR_TRAP_CREATION); (void) mongets(mtmp, WEDGE_SANDALS); } /* M4_HAMMERSANDAL|M4_SANDALS */

		break;

	    case S_KOP:

		if (ptr == &mons[PM_WHITLEVEL_KOP] || ptr == &mons[PM_BLAKLEVEL_KOP] || ptr == &mons[PM_GREYLEVEL_KOP] || ptr == &mons[PM_RNGED_KOP] || ptr == &mons[PM_EXMINATOR_KOP]) {
			(void) maketrap(mtmp->mx, mtmp->my, KOP_CUBE, 0, FALSE);
		}

		if (ptr == &mons[PM_JEMIMA]) (void) mongets(mtmp, COMBAT_STILETTOS);
		if (ptr == &mons[PM_HISTORY_FEMMY]) (void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		if (ptr == &mons[PM_WATER_MATERIAL_BLONDE]) (void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		if (ptr == &mons[PM_FARMER_FEMMY]) {
			(void)mongets(mtmp, rnd_class(WEDGE_SANDALS,ITALIAN_HEELS));
		  	(void) mongets(mtmp, RIDING_CROP);
		}

		if (ptr == &mons[PM_FREEMASON_CASER]) {
		  	(void) mongets(mtmp, AUTO_SHOTGUN);
		  	m_initthrow(mtmp, AUTO_LEAD_SHOT, 50);
		}
		if (ptr == &mons[PM_SACK_STUFF_POLICE]) {
		  	(void) mongets(mtmp, PISTOL);
		  	m_initthrow(mtmp, PISTOL_BULLET, 30);
		}
		if (ptr == &mons[PM_BRUTAL_KOP]) {
		  	(void) mongets(mtmp, FLOGGER);
		}
		if (ptr == &mons[PM_HIPPIE_FEMMY]) {
		  	(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		  	(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		}
		if (ptr == &mons[PM_EXPERIENCED_GENDAME]) {
		  	(void) mongets(mtmp, METEORIC_STEEL_SHIELD);
		}
		if (ptr == &mons[PM_ELITE_GENDAME]) {
		  	(void) mongets(mtmp, METEORIC_STEEL_SHIELD);
		  	(void) mongets(mtmp, VIPERWHIP);
		}
		if (ptr == &mons[PM_WHIPSTERMAN]) {
		  	(void) mongets(mtmp, LIGHTWHIP);
		}
		if (ptr == &mons[PM_PROPER_TORCHBEARER]) {
		  	(void) mongets(mtmp, TORCH);
		}
		if (ptr == &mons[PM_TORCHBEARER_MOB]) {
		  	(void) mongets(mtmp, TORCH);
		}
		if (ptr == &mons[PM_FULL_NANO_OFFICER]) {
		  	(void) mongets(mtmp, NANO_POLE);
		  	(void) mongets(mtmp, NANO_SUIT);
		}
		if (ptr == &mons[PM_PLASTOKOP]) {
		  	(void) mongets(mtmp, PLASTIC_MACE);
		  	(void) mongets(mtmp, PLASTEEL_ARMOR);
		}
		if (ptr == &mons[PM_CASER_KOP_KCHIEF]) {
		  	(void) mongets(mtmp, SHOTGUN);
		  	m_initthrow(mtmp, LEAD_SHOT, 30);
		}
		if (ptr == &mons[PM_FREEMASON_LEADER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, LEAD_CLUMP, 25);
		}
		if (ptr == &mons[PM_FREEMASON_SLAMMER]) {
			(void) mongets(mtmp, SHOTGUN);
			(void) mongets(mtmp, BASINET);
			 m_initthrow(mtmp, LEAD_SHOT, 40);
		}
		if (ptr == &mons[PM_FREEMASON_DILIGENT_SEARCHER]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, BASINET);
			(void) mongets(mtmp, LORICATED_CLOAK);
			(void) mongets(mtmp, ROCKET_GAUNTLETS);
			(void) mongets(mtmp, LARGE_SHIELD);
			 m_initthrow(mtmp, SLING_AMMO, 40);
		}

		if (ptr == &mons[PM_FREEMASON_SLINGER]) {
			(void)mongets(mtmp, SLING);
		  	m_initthrow(mtmp, ROCK, 40);
		}
		if (ptr == &mons[PM_FREEMASON_BOWMAN]) {
			(void)mongets(mtmp, BOW);
		  	m_initthrow(mtmp, ARROW, 30);
		}
		if (ptr == &mons[PM_FREEMASON_SHOOTER]) {
			(void)mongets(mtmp, AUTO_SHOTGUN);
		  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 40);
		}
		if (ptr == &mons[PM_FREEMASON_PEEKER]) {
		  	m_initthrow(mtmp, JAVELIN, 7);
		}
		if (ptr == &mons[PM_FREEMASON_STACKER]) {
		  	m_initthrow(mtmp, STACK_JAVELIN, 7);
		}
		if (ptr == &mons[PM_FREEMASON_RAYER]) {
			(void)mongets(mtmp, ARM_BLASTER);
		  	m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		  	m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		}
		if (ptr == &mons[PM_FREEMASON_SUPERBITCH]) {
		  	m_initthrow(mtmp, SHURIKEN, 50);
		  	m_initthrow(mtmp, SHURIKEN, 50);
		}
		if (ptr == &mons[PM_FREEMASON_SPEARLORD]) {
		  	m_initthrow(mtmp, SPEAR, 10);
		}

		if (ptr == &mons[PM_THE_HIGH_HEEL_LOVING_ASIAN_GIRL_HER_SEXY_WEDGE_SANDAL]) {
			(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
			(void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
		}

		if (ptr == &mons[PM_EQ_KOP]) {
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
		}
		if (ptr == &mons[PM_EQ_SERGEANT]) {
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
		}
		if (ptr == &mons[PM_EQ_LIEUTENANT]) {
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
		}
		if (ptr == &mons[PM_EQ_KAPTAIN]) {
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
		}
		if (ptr == &mons[PM_EQ_KOMMISSIONER]) {
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
		}
		if (ptr == &mons[PM_EQ_KCHIEF]) {
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
		}
		if (ptr == &mons[PM_EQ_KATCHER]) {
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
		}
		if (ptr == &mons[PM_EQ_KRIMINOLOGIST]) {
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
		}
		if (ptr == &mons[PM_EQ_KEELHAULER]) {
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
		}
		if (ptr == &mons[PM_EQ_KLEEVER]) {
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
		}

		if (ptr == &mons[PM_OFFICER_JENNY]) {
			 (void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		}

		if (ptr == &mons[PM_OFFICER_ALINA]) {
			 (void) mongets(mtmp, SOFT_GIRL_SNEAKER);
			 (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		}

		if (ptr == &mons[PM_OFFICER_HANNA]) {
			 (void) mongets(mtmp, HUGGING_BOOT);
		}

		if (ptr == &mons[PM_OFFICER_JULIA]) {
			 (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			 (void) mongets(mtmp, COMBAT_STILETTOS);
		}

		if (ptr == &mons[PM_OFFICER_KATHARINA]) {
			 (void) mongets(mtmp, SWEET_MOCASSINS);
			 (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		}

		if (ptr == &mons[PM_OFFICER_NATALIA]) {
			 (void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
			 (void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		}

		if (ptr == &mons[PM_OFFICER_VICTORIA]) {
			 (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			 (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		}
		if (ptr == &mons[PM_OFFICER_INA]) {
			 (void) mongets(mtmp, HUGGING_BOOT);
		}
		if (ptr == &mons[PM_OFFICER_HANH]) {
			 (void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		}

		if (ptr == &mons[PM_NAZI_ROCKETEER]) {
			 (void) mongets(mtmp, ROCKET_LAUNCHER);
			 m_initthrow(mtmp, ROCKET, 25);
		}

		if (ptr == &mons[PM_ARMED_KOP_KOMMISSIONER]) {
			(void) mongets(mtmp, FLINTLOCK);
	  		m_initthrow(mtmp, PISTOL_BULLET, 20);
		}

		if (ptr == &mons[PM_ANTIMATTER_KOMMISSIONER]) {
			(void) mongets(mtmp, FLINTLOCK);
	  		m_initthrow(mtmp, ANTIMATTER_PISTOL_BULLET, 20);
		}

		if (ptr == &mons[PM_ANTIMATTER_KCHIEF]) {
			(void) mongets(mtmp, SNIPER_RIFLE);
	  		m_initthrow(mtmp, ANTIMATTER_SNIPER_BULLET, 50);
		}

		if (ptr == &mons[PM_ANTIMATTER_KATCHER]) {
			(void) mongets(mtmp, SUBMACHINE_GUN);
	  		m_initthrow(mtmp, ANTIMATTER_SMG_BULLET, 50);
		}

		if (ptr == &mons[PM_ANTIMATTER_KRIMINOLOGIST]) {
			(void) mongets(mtmp, ASSAULT_RIFLE);
	  		m_initthrow(mtmp, ANTIMATTER_ASSAULT_RIFLE_BULLE, 50);
	  		m_initthrow(mtmp, ANTIMATTER_ASSAULT_RIFLE_BULLE, 50);
		}
		if (ptr == &mons[PM_ANTIMATTER_KEELHAULER]) {
			(void) mongets(mtmp, ASSAULT_RIFLE);
	  		m_initthrow(mtmp, ANTIMATTER_ASSAULT_RIFLE_BULLE, 50);
	  		m_initthrow(mtmp, ANTIMATTER_ASSAULT_RIFLE_BULLE, 50);
		}
		if (ptr == &mons[PM_ANTIMATTER_KLEEVER]) {
			(void) mongets(mtmp, ASSAULT_RIFLE);
	  		m_initthrow(mtmp, ANTIMATTER_ASSAULT_RIFLE_BULLE, 50);
	  		m_initthrow(mtmp, ANTIMATTER_ASSAULT_RIFLE_BULLE, 50);
	  		m_initthrow(mtmp, ANTIMATTER_ASSAULT_RIFLE_BULLE, 50);
		}

		if (ptr == &mons[PM_ARMED_KOP_KCHIEF]) {
			(void) mongets(mtmp, SHOTGUN);
	  		m_initthrow(mtmp, SHOTGUN_SHELL, 25);
		}

		if (ptr == &mons[PM_ARMED_KOP_KATCHER]) {
			(void) mongets(mtmp, HAND_BLASTER);
			m_initthrow(mtmp, BLASTER_BOLT, 40);
		}

		if (ptr == &mons[PM_ARMED_KOP_KRIMINOLOGIST]) {
			(void) mongets(mtmp, RAYGUN);
			m_initthrow(mtmp, RAYGUN_BOLT, 50);
		}
		if (ptr == &mons[PM_ARMED_KOP_KEELHAULER]) {
			(void) mongets(mtmp, RAYGUN);
			m_initthrow(mtmp, RAYGUN_BOLT, 50);
		}
		if (ptr == &mons[PM_ARMED_KOP_KLEEVER]) {
			(void) mongets(mtmp, RAYGUN);
			m_initthrow(mtmp, RAYGUN_BOLT, 50);
			m_initthrow(mtmp, RAYGUN_BOLT, 50);
		}

		if (ptr == &mons[PM_ROADBLOCK_KOP]) {
			m_initthrow(mtmp, CALTROP, 50);
		}

		if (ptr == &mons[PM_BARRIER_KOP]) {
			m_initthrow(mtmp, SPIKE, 50);
		}

		if (ptr == &mons[PM_TRAFFIC_KOP]) {
			m_initthrow(mtmp, NEEDLE, 50);
		}

		if (ptr == &mons[PM_ANTITANK_KOP]) (void) mongets(mtmp, nastymusableitem() );

		if (ptr == &mons[PM_NETHER_KOP]) (void) mongets(mtmp, WAN_NETHER_BEAM);
		if (ptr == &mons[PM_AURORA_KOP]) (void) mongets(mtmp, WAN_AURORA_BEAM);
		if (ptr == &mons[PM_INFERNAL_KOP]) (void) mongets(mtmp, WAN_INFERNO);
		if (ptr == &mons[PM_ICY_KOP]) (void) mongets(mtmp, WAN_ICE_BEAM);
		if (ptr == &mons[PM_THUNDEROUS_KOP]) (void) mongets(mtmp, WAN_THUNDER);
		if (ptr == &mons[PM_SPILL_KOP]) (void) mongets(mtmp, WAN_SLUDGE);
		if (ptr == &mons[PM_TOXIC_KOP]) (void) mongets(mtmp, WAN_TOXIC);
		if (ptr == &mons[PM_GAS_KOP]) (void) mongets(mtmp, WAN_CHLOROFORM);
		if (ptr == &mons[PM_GRAVITY_KOP]) (void) mongets(mtmp, WAN_GRAVITY_BEAM);
		if (ptr == &mons[PM_BUBBLING_KOP]) (void) mongets(mtmp, WAN_BUBBLEBEAM);
		if (ptr == &mons[PM_DREAMING_KOP]) (void) mongets(mtmp, WAN_DREAM_EATER);
		if (ptr == &mons[PM_NIGHTLY_KOP]) (void) mongets(mtmp, WAN_GOOD_NIGHT);
		if (ptr == &mons[PM_HYPER_KOP]) (void) mongets(mtmp, WAN_HYPER_BEAM);

		break;

	    case S_TRAPPER:

		if (ptr == &mons[PM_CELESTIAL_POKER]) (void) mongets(mtmp, CELESTIAL_POLE);
		if (ptr == &mons[PM_ALIEN_POKER]) (void) mongets(mtmp, ZEBES_POLE);

		if (ptr == &mons[PM_DEMOLITIONS_EXPERT]) {
			m_initthrow(mtmp, FRAG_GRENADE, 15);
			(void) mongets(mtmp, SCR_TRAP_CREATION);
		}
		if (ptr == &mons[PM_TUODA]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, TALC, 20);
		}
		if (ptr == &mons[PM_TAWNY]) {
			(void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		}
		if (ptr == &mons[PM_DROPTREE_BEAR]) {
			(void) mongets(mtmp, SCR_GROWTH);
		}
		if (ptr == &mons[PM_THAI_MASSEUSE]) {
			(void) mongets(mtmp, UNFAIR_STILETTOS);
		}
		if (ptr == &mons[PM_RAINBOW_DRESSER]) {
			(void) mongets(mtmp, WAN_UNDRESSING);
		}
		if (ptr == &mons[PM_ALIEN_SLAVE_OF_A_MAN]) (void) mongets(mtmp, !rn2(2) ? IRON_CHAIN : HEAVY_IRON_BALL);

		if (mtmp->data == &mons[PM_FIRE_METROID]) (void) mongets(mtmp, SCR_FLOODING);
		if(ptr == &mons[PM_CARNIVOROUS_BAG]) (void) mongets(mtmp, BAG_OF_TRICKS);
		if(ptr == &mons[PM_TRAPPER_CART]) (void) mongets(mtmp, SCR_TRAP_CREATION);
		if (monsndx(ptr) == PM_JANE_S_HUGGING_BOOT) { (void) mongets(mtmp, HUGGING_BOOT); (void) mongets(mtmp, SCR_TELEPORTATION); }

		if (mtmp->data == &mons[PM_SMALL_TRICKSTER]) (void) mongets(mtmp, VOULGE);
		if (mtmp->data == &mons[PM_ULTRA_EVIL_TRAPPER]) (void) mongets(mtmp, SCR_OFFLEVEL_ITEM);
		if (mtmp->data == &mons[PM_NOROELA_TRAPPER]) {
			(void) mongets(mtmp, SCR_OFFLEVEL_ITEM);
			(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		}
		if (mtmp->data == &mons[PM_TRICKSTER]) (void) mongets(mtmp, FAUCHARD);
		if (ptr == &mons[PM_TRICKSTER_CANDIDATE]) {
			(void) mongets(mtmp, RANSEUR);
			(void) mongets(mtmp, ORCISH_HELM);
		}
		if (ptr == &mons[PM_TRICKSTER_DECIDER]) {
			(void) mongets(mtmp, PARTISAN);
			(void) mongets(mtmp, ORCISH_HELM);
		}
		if (ptr == &mons[PM_TRICKSTER_DRESSER]) {
			(void) mongets(mtmp, GUISARME);
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, HIGH_BOOTS);
		}
		if (ptr == &mons[PM_TRANS_TRICKSTER]) {
			(void) mongets(mtmp, BARDICHE);
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, SWEET_MOCASSINS);
		}
		if (ptr == &mons[PM_MOTOR_TRICKSTER]) {
			(void) mongets(mtmp, HALBERD);
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, COMBAT_STILETTOS);
		}
		if (ptr == &mons[PM_RUNNER_TRICKSTER]) {
			(void) mongets(mtmp, GARDEN_FORK);
			(void) mongets(mtmp, ELVEN_CLOAK);
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		}
		if (ptr == &mons[PM_RARE_TRICKSTER]) {
			(void) mongets(mtmp, BILL_GUISARME);
			(void) mongets(mtmp, ELVEN_CLOAK);
			(void) mongets(mtmp, YELLOW_DRAGON_SCALES);
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		}

		if (ptr == &mons[PM_ERROR_TRICKSTER]) {
			(void) mongets(mtmp, TRAFFIC_LIGHT);
			(void) mongets(mtmp, ELVEN_CLOAK);
			(void) mongets(mtmp, ORANGE_DRAGON_SCALE_MAIL);
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, GAUNTLETS);
			(void) mongets(mtmp, SNIPER_RIFLE);
			m_initthrow(mtmp, SNIPER_BULLET, 50);
			(void) mongets(mtmp, DUMMY_BOOTS_A);
		}

		if (ptr == &mons[PM_LASER_METROID]) {
			(void) mongets(mtmp, HAND_BLASTER);
			m_initthrow(mtmp, BLASTER_BOLT, 40);
		}

		if (ptr == &mons[PM_NERVOUS_BEANPOLE]) {
			(void) mongets(mtmp, YUMI);
			m_initthrow(mtmp, YA, 30);
		}

		if (ptr == &mons[PM_ZEBETITE_METROID]) {
			(void) mongets(mtmp, CUTTING_LASER);
			m_initthrow(mtmp, LASER_BEAM, 50);
		}

		if (ptr == &mons[PM_LIGHTSCREEN_METROID]) {
			(void) mongets(mtmp, RAYGUN);
			m_initthrow(mtmp, RAYGUN_BOLT, 50);
		}

		if (ptr == &mons[PM_SUPREME_METROID]) {
			(void) mongets(mtmp, ARM_BLASTER);
			m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		}

		break;

	    case S_JABBERWOCK:

		if (mtmp->data == &mons[PM_FUMBLING_MONSTER]) (void) mongets(mtmp, WAN_FUMBLING);
		if (mtmp->data == &mons[PM_JURE_FANATIC]) (void) mongets(mtmp, SCR_HEALING);
		if (mtmp->data == &mons[PM_GLIB_MONSTER]) (void) mongets(mtmp, WAN_FINGER_BENDING);
		if (mtmp->data == &mons[PM_GREATER_STUN_MONSTER]) (void) mongets(mtmp, WAN_STUN_MONSTER);
		if (mtmp->data == &mons[PM_TOURETTE_ALIEN]) (void) mongets(mtmp, SWEET_MOCASSINS);
		if (mtmp->data == &mons[PM_PUBLIC_PERFORMER]) m_initthrow(mtmp, ROCK, 5);
		if (mtmp->data == &mons[PM_ROVID]) (void) mongets(mtmp, TRIDENT);
		if (mtmp->data == &mons[PM_JAPONSES_MONSTER]) (void) mongets(mtmp, OTAMA);
		if (mtmp->data == &mons[PM_BOSS_FEMMY]) (void) mongets(mtmp, LEATHER_PEEP_TOES);
		if (mtmp->data == &mons[PM_HUSSY_FEMMY]) (void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		if (mtmp->data == &mons[PM_BLACKLIGHT_MONSTER]) (void) mongets(mtmp, BLACK_LIGHTSABER);
		if (mtmp->data == &mons[PM_GRAVEWALL_FEMMY]) (void) mongets(mtmp, SCR_GRAVE);
		if(ptr == &mons[PM_ASIATIC_FEMMY]) {
			(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			(void) mongets(mtmp, LEATHER_PEEP_TOES);
		}
		if(ptr == &mons[PM_STROKING_JOANNA]) {
			(void) mongets(mtmp, FISHNET);
			(void) mongets(mtmp, LEATHER_PEEP_TOES);
		}
		if(ptr == &mons[PM_SUMATRA_CHIEF]) {
			 m_initthrow(mtmp, rnd_class(JAVELIN, STACK_JAVELIN), 5);
			 m_initthrow(mtmp, rnd_class(JAVELIN, STACK_JAVELIN), 5);
			 m_initthrow(mtmp, rnd_class(JAVELIN, STACK_JAVELIN), 5);
			 m_initthrow(mtmp, rnd_class(JAVELIN, STACK_JAVELIN), 5);
			 m_initthrow(mtmp, rnd_class(JAVELIN, STACK_JAVELIN), 5);
		}

		break;

	    case S_UMBER:

		if (mtmp->data == &mons[PM_WISE_GREEN_SMOKER]) (void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_GLUTTONOUS_HULK]) (void) mongets(mtmp, WAN_STARVATION);
		if (mtmp->data == &mons[PM_DENRYU]) (void) mongets(mtmp, KATANA);
		if (mtmp->data == &mons[PM_CHAOS_HORROR]) (void) mongets(mtmp, WAN_CHAOS_TERRAIN);
		if (mtmp->data == &mons[PM_ATHACH]) (void) mongets(mtmp, MORNING_STAR);
		if (mtmp->data == &mons[PM_HAMMER_ATHACH]) (void) mongets(mtmp, WAR_HAMMER);
		if (mtmp->data == &mons[PM_MACE_ATHACH]) (void) mongets(mtmp, MACE);
		if (mtmp->data == &mons[PM_ACID_SOURCE]) (void) mongets(mtmp, POT_ACID);
		if (mtmp->data == &mons[PM_RNG_DICER]) (void) mongets(mtmp, ARCANE_HORN);
		if (mtmp->data == &mons[PM_CATTLE_THRESHER]) (void) mongets(mtmp, FLOGGER);
		if (mtmp->data == &mons[PM_SPECIAL_HULK]) (void) mongets(mtmp, SPEC_LANCE);
		if (mtmp->data == &mons[PM_UMBER_DIGGER]) (void) mongets(mtmp, BRONZE_PICK);
		if (mtmp->data == &mons[PM_UMBRAGE_PROFESSOR]) (void) mongets(mtmp, CROW_QUILL);
		if (mtmp->data == &mons[PM_AMBER_FEMMY]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (mtmp->data == &mons[PM_STEELFIST]) (void) mongets(mtmp, POWERFIST);
		if (mtmp->data == &mons[PM_DIGGER_HULK]) (void) mongets(mtmp, CONGLOMERATE_PICK);
		if (mtmp->data == &mons[PM_STOIAKMIDM]) (void) mongets(mtmp, SPEAR);

		if (mtmp->data == &mons[PM_UNWISE_BLUE_SMOKER]) {
			(void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
			(void) mongets(mtmp, CIGARETTE);
		}
		if (mtmp->data == &mons[PM_JEDI_HORROR]) {
			(void) mongets(mtmp, CYAN_DOUBLE_LIGHTSABER);
			(void) mongets(mtmp, ROBE);
		}
		if(ptr == &mons[PM_YITH_DAEMON]) {
			(void) mongets(mtmp, YITH_TENTACLE);
		}
		if(ptr == &mons[PM_NEOPHYTE_YITH_DAEMON]) {
			(void) mongets(mtmp, YITH_TENTACLE);
		}
		if(ptr == &mons[PM_LESSER_YITH_DAEMON]) {
			(void) mongets(mtmp, YITH_TENTACLE);
		}
		if(ptr == &mons[PM_CIGARETTE_SMOKING_FEMMY]) {
			(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
			(void) mongets(mtmp, CIGARETTE);
		}
		if(ptr == &mons[PM_UROLOGIST]) {
			(void) mongets(mtmp, KNIFE);
			(void) mongets(mtmp, LAB_COAT);
		}
		if (ptr == &mons[PM_METAL_MINE_HULK]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, PICK_AXE);
			 m_initthrow(mtmp, SMALL_PIECE_OF_UNREFINED_MITHR, 20);
		}

		if (ptr == &mons[PM_METAL_MINE_HULK]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, PICK_AXE);
			 m_initthrow(mtmp, SMALL_PIECE_OF_UNREFINED_MITHR, 20);
		}
		if (ptr == &mons[PM_SILVERPACK_HULK]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, SILVER_SHIELD);
			(void) mongets(mtmp, ELVEN_TOGA);
			 m_initthrow(mtmp, SILVER_SLINGSTONE, 40);
		}

		if (mtmp->data == &mons[PM_KUNG_FU_FEMMY]) (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

		if (mtmp->data == &mons[PM_PSEUDO_EROTIC_SMOKER_BITCH]) {
			(void) mongets(mtmp, SEXY_LEATHER_PUMP);
			(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		}
		if (mtmp->data == &mons[PM_UNFAIR_SLUTTY_SMOKER_BITCH]) {
			(void) mongets(mtmp, CIGARETTE);
			(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		}
		if (mtmp->data == &mons[PM_SHIELDON_MUTANT]) {
			(void) mongets(mtmp, WONDER_DAGGER);
			(void) mongets(mtmp, SMALL_SHIELD);
		}

		if (mtmp->data == &mons[PM_TATJANA]) {
			(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			(void) mongets(mtmp, BUNNY_EAR);
			(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
			(void) mongets(mtmp, LAB_COAT);
			(void) mongets(mtmp, POT_EXTRA_HEALING);
		}

		if (ptr == &mons[PM_CUTTING_HORROR] || ptr == &mons[PM_CUTTING_TERROR]) {
			(void) mongets(mtmp, CUTTING_LASER);
			m_initthrow(mtmp, LASER_BEAM, 50);
		}

		break;

	    case S_GREMLIN:

		if (mtmp->data == &mons[PM_GREMGARGOYLE]) (void) mongets(mtmp, POT_CANCELLATION);
		if (mtmp->data == &mons[PM_BRONZE_GLADIATOR]) (void) mongets(mtmp, BRONZE_SPEAR);
		if (mtmp->data == &mons[PM_ANITA_S_SEXY_LEATHER_PUMP]) { (void) mongets(mtmp, SEXY_LEATHER_PUMP); (void) mongets(mtmp, FEMININE_PUMPS); } /* M4_PUMPS */
		if (mtmp->data == &mons[PM_BASHFLIND]) (void) mongets(mtmp, FLINDBAR);
		if (mtmp->data == &mons[PM_BASHFLIND_LORD]) (void) mongets(mtmp, FLINDBAR);
		if (mtmp->data == &mons[PM_JAPASURA]) (void) mongets(mtmp, MASSAGER);
		if (mtmp->data == &mons[PM_JAPANESE_TORTURER]) (void) mongets(mtmp, MASSAGER);
		if (mtmp->data == &mons[PM_NAIL_GREMLIN]) (void) mongets(mtmp, QATAR);

		if (mtmp->data == &mons[PM_GREMLIN_SMASHER]) (void) mongets(mtmp, WAR_HAMMER);
		if (mtmp->data == &mons[PM_ORMOR_CLOW]) {
			(void) mongets(mtmp, SPLINT_MAIL);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, AXE);
			if (!rn2(3)) (void) mongets(mtmp, LARGE_SHIELD);
		}

		if (ptr == &mons[PM_MITHRAGOYLE]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SMALL_PIECE_OF_UNREFINED_MITHR, 30);
		}
		if (ptr == &mons[PM_ALLOY_GLADIATOR]) {
			(void) mongets(mtmp, BRONZE_SPEAR);
			 m_initthrow(mtmp, BRONZE_SPEAR, 5);
		}

		if (ptr == &mons[PM_BONEGOYLE]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, BONE_FRAGMENT, 35);
		}

		if (mtmp->data == &mons[PM_SMASHLIN]) {
			(void) mongets(mtmp, PLATE_MAIL);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, BATTLE_AXE);
			(void) mongets(mtmp, SHIELD);
		}

		break;

	    case S_BLOB:
		if (mtmp->data == &mons[PM_OEOEPSJEDI]) (void) mongets(mtmp, LASER_SWATTER);
		if (mtmp->data == &mons[PM_SELFIT_CUBE]) (void) mongets(mtmp, CHEST);
		if (mtmp->data == &mons[PM_BOXIT_CUBE]) (void) mongets(mtmp, LARGE_BOX);
		if (mtmp->data == &mons[PM_POTATO_CUBE]) (void) mongets(mtmp, POTATO_BAG);
		if (mtmp->data == &mons[PM_UPCUTTER]) (void) mongets(mtmp, KNIFE);

		if (ptr == &mons[PM_DEEPSPAWN]) {
			(void) mongets(mtmp, WAN_CREATE_MONSTER);
		}
		if (ptr == &mons[PM_FUZZY_BLOB]) {
			(void) mongets(mtmp, CERAMIC_SPEAR);
		}
		if (ptr == &mons[PM_LITTLE_FEMMY]) {
			(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		}
		if (ptr == &mons[PM_CLOTHING_STORE_RANDALATOR]) {
			(void) mongets(mtmp, LOW_BOOTS);
			(void) mongets(mtmp, T_SHIRT);
			(void) mongets(mtmp, LORICATED_CLOAK);
			(void) mongets(mtmp, ROCKET_GAUNTLETS);
			(void) mongets(mtmp, BRONZE_PLATE_MAIL);
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}
		if (ptr == &mons[PM_FUNNY_ITALIAN]) {
			(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		}
		if (ptr == &mons[PM_ROYAL_MAGENATA]) {
			(void) mongets(mtmp, GLAIVE);
		}
		if (ptr == &mons[PM_EAR_FIG_MACHINE]) {
			(void)mongets(mtmp, rnd_class(SCR_LAVA,SCR_LOCKOUT));
		}
		if (ptr == &mons[PM_POLEPOKER]) {
			(void)mongets(mtmp, rnd_class(PARTISAN,BEC_DE_CORBIN));
		}
		if (ptr == &mons[PM_OUT_OF_DEEPSPAWN]) {
			(void) mongets(mtmp, WAN_CREATE_MONSTER);
			(void) mongets(mtmp, SCR_CREATE_MONSTER);
			(void) mongets(mtmp, WAN_CREATE_MONSTER);
		}

		if (ptr == &mons[PM_EXPLODING_GREASEBALL]) {
			m_initthrow(mtmp, CREAM_PIE, 2);
		}

		if (ptr == &mons[PM_EPS_BLOB]) {
			(void) mongets(mtmp, CROSSBOW);
			m_initthrow(mtmp, CROSSBOW_BOLT, 30);
		}
		if (ptr == &mons[PM_TEST_BLOB]) {
			(void) mongets(mtmp, CROSSBOW);
			m_initthrow(mtmp, HEAVY_CROSSBOW_BOLT, 40);
		}

		if (ptr == &mons[PM_DISTURBMENT_HEAD]) {
			(void) mongets(mtmp, SLING);
			m_initthrow(mtmp, FLINT, 30);
		}

		if (ptr == &mons[PM_ONANOCTER__A]) {
			(void) mongets(mtmp, PISTOL);
			m_initthrow(mtmp, PISTOL_BULLET, 25);
		}

		if (ptr == &mons[PM_FORTRESSNAIL]) {
			(void) mongets(mtmp, HEAVY_MACHINE_GUN);
			m_initthrow(mtmp, MG_BULLET, 50);
			m_initthrow(mtmp, MG_BULLET, 50);
			m_initthrow(mtmp, MG_BULLET, 50);
			m_initthrow(mtmp, MG_BULLET, 50);
		}

		if (ptr == &mons[PM_ONANOCTER__B]) {
			(void) mongets(mtmp, DAGGER);
			(void) mongets(mtmp, RIFLE);
			m_initthrow(mtmp, RIFLE_BULLET, 25);
		}

		if (ptr == &mons[PM_ONANOCTER__C]) {
			(void) mongets(mtmp, SHORT_SWORD);
			(void) mongets(mtmp, SUBMACHINE_GUN);
			m_initthrow(mtmp, SMG_BULLET, 50);
		}

		if (ptr == &mons[PM_ONANOCTER__D]) {
			(void) mongets(mtmp, BROADSWORD);
			(void) mongets(mtmp, SHOTGUN);
			m_initthrow(mtmp, SHOTGUN_SHELL, 20);
		}

		if (ptr == &mons[PM_ONANOCTER__E]) {
			(void) mongets(mtmp, JAGGED_STAR);
			(void) mongets(mtmp, ASSAULT_RIFLE);
			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 75);
		}

		if (ptr == &mons[PM_ONANOCTER__F]) {
			(void) mongets(mtmp, STYGIAN_PIKE);
			(void) mongets(mtmp, AUTO_SHOTGUN);
			m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 20);
			(void) mongets(mtmp, SNIPER_RIFLE);
			m_initthrow(mtmp, SNIPER_BULLET, 50);
		}

		if (ptr == &mons[PM_ONANOCTER__G]) {
			(void) mongets(mtmp, MALLET);
			(void) mongets(mtmp, OBSID);
			(void) mongets(mtmp, HEAVY_MACHINE_GUN);
			m_initthrow(mtmp, MG_BULLET, 50);
			m_initthrow(mtmp, MG_BULLET, 50);
			m_initthrow(mtmp, MG_BULLET, 50);
			m_initthrow(mtmp, MG_BULLET, 50);
			(void) mongets(mtmp, ROCKET_LAUNCHER);
			m_initthrow(mtmp, ROCKET, 3);
		}

		if (ptr == &mons[PM_ONANOCTER__H]) {
			(void) mongets(mtmp, DROVEN_SPEAR);
			(void) mongets(mtmp, TWO_HANDED_FLAIL);
			(void) mongets(mtmp, BFG);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			(void) mongets(mtmp, CUTTING_LASER);
			m_initthrow(mtmp, LASER_BEAM, 50);
		}

		if (ptr == &mons[PM_ONANOCTER___O]) {
			(void) mongets(mtmp, TSURUGI);
			(void) mongets(mtmp, CATAPULT);
			m_initthrow(mtmp, FLINT, 50);
			m_initthrow(mtmp, FLINT, 50);
			m_initthrow(mtmp, FLINT, 50);

		}

		break;

	    case S_RUSTMONST:

		if (mtmp->data == &mons[PM_MASTER_DISINTEGRATOR]) (void) mongets(mtmp, WAN_DISINTEGRATION);
		if (mtmp->data == &mons[PM_HAR_HAR_DISENCHANTER]) (void) mongets(mtmp, WAN_DISENCHANTMENT);
		if (mtmp->data == &mons[PM_DISINTEGRATOR_LORD]) (void) mongets(mtmp, WAN_DISINTEGRATION_BEAM);
		if (mtmp->data == &mons[PM_GREAT_ACID_MONSTER]) (void) mongets(mtmp, WAN_CORROSION);
		if (mtmp->data == &mons[PM_TANJA_S_SOFT_SNEAKER]) { (void) mongets(mtmp, SOFT_SNEAKERS); (void) mongets(mtmp, SOFT_GIRL_SNEAKER); } /* M4_SNEAKERS */
		if (mtmp->data == &mons[PM_LOU_S_DANCING_SHOE]) { (void) mongets(mtmp, LACQUERED_DANCING_SHOE); (void) mongets(mtmp, DANCING_SHOES); }
		if (mtmp->data == &mons[PM_CLAWCAMO_RUST_MONSTER]) (void) mongets(mtmp, CAMO_QATAR);
		if (mtmp->data == &mons[PM_AZTEC_MONSTER]) (void) mongets(mtmp, TECPATL);
		if (mtmp->data == &mons[PM_PROVINZKAJA]) (void) mongets(mtmp, TENNIS_RACKET);

		if (mtmp->data == &mons[PM_BLASTER_DISINTEGRATOR]) {
			 (void) mongets(mtmp, ARM_BLASTER);
			m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		}

		if (mtmp->data == &mons[PM_CHRISTINE]) (void) mongets(mtmp, LAB_COAT);
		if (mtmp->data == &mons[PM_ETHER_MONSTER]) (void) mongets(mtmp, ETHER_HORN);
		if (mtmp->data == &mons[PM_POLE_CHANTER]) (void) mongets(mtmp, GUISARME);
		if (mtmp->data == &mons[PM_LUSTER_MONSTER]) (void) mongets(mtmp, LANCE);
		if (mtmp->data == &mons[PM_BAR_DISINTEGRATOR]) (void) mongets(mtmp, DISINTEGRATION_BAR);

		if (ptr == &mons[PM_VOLCANO_MUNCHER]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, HELMET);
			 m_initthrow(mtmp, VOLCANIC_GLASS_FRAGMENT, 50);
		}

		if (mtmp->data == &mons[PM_OWN_EATER]) {
			m_initthrow(mtmp, DAGGER, 6);
		}
		if (mtmp->data == &mons[PM_KNIFE_SUPPLIER]) {
			m_initthrow(mtmp, KNIFE, 5);
		}

		if (mtmp->data == &mons[PM_METAL_EATER]) {
			 (void) mongets(mtmp, CATAPULT);
			m_initthrow(mtmp, ROCK, 50);
			m_initthrow(mtmp, ROCK, 50);
		}

		if (mtmp->data == &mons[PM_SILVER_SUCKER]) {
			 (void) mongets(mtmp, PILE_BUNKER);
			m_initthrow(mtmp, KOKKEN, 50);
			m_initthrow(mtmp, KOKKEN, 30);
		}

		if (mtmp->data == &mons[PM_NEEDLE_MONSTER]) {
			m_initthrow(mtmp, NEEDLE, 50);
			m_initthrow(mtmp, NEEDLE, 50);
		}

		if (mtmp->data == &mons[PM_SPIKER]) {
			m_initthrow(mtmp, SPIKE, 50);
			m_initthrow(mtmp, SPIKE, 50);
		}

		break;

          case S_RODENT:
		if (mtmp->data == &mons[PM_THE_RAT_KING]) (void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if (ishaxor && mtmp->data == &mons[PM_THE_RAT_KING]) (void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if (mtmp->data == &mons[PM_REVIVED_FEMMY]) (void) mongets(mtmp, DANCING_SHOES);
		if (mtmp->data == &mons[PM_PLAYFUL_FEMMY]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (mtmp->data == &mons[PM_EAR_SHOOM]) (void) mongets(mtmp, FOAMY_STAFF);
		if (mtmp->data == &mons[PM_DIG_MOLE]) (void) mongets(mtmp, PICK_AXE);
		if (mtmp->data == &mons[PM_MARTINA_S_COMBAT_BOOT]) (void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_CLAUDIA_S_HIGH_HEELED_WOODEN_SANDAL]) (void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		if (mtmp->data == &mons[PM_ANNIE_S_SNEAKER]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (mtmp->data == &mons[PM_MARGRET_S_STILETTO_PUMP]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		if (ptr == &mons[PM_SEXTARIAN_CUTIE]) {
			(void) mongets(mtmp, BLOCK_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		}
		if (ptr == &mons[PM_SCIENTITS]) {
			(void) mongets(mtmp, CANDY_BRA);
		}
		if (ptr == &mons[PM_CHERRY_MOUSE]) {
			(void) mongets(mtmp, CHERRY);
		}
		if (ptr == &mons[PM_SAN_FIERRO_LADY]) {
			(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		}
		if (ptr == &mons[PM_PRICK_BEARER]) {
			(void) mongets(mtmp, BATLETH);
		}
		if (ptr == &mons[PM_RELIGIOUS_COQUETTE]) {
			(void) mongets(mtmp, SWEET_MOCASSINS);
		}
		if (ptr == &mons[PM_SILVER_EYED_WITCH]) {
			(void) mongets(mtmp, TWO_HANDED_SWORD);
		}
		if (ptr == &mons[PM_SANDRA_EYED_WITCH]) {
			(void) mongets(mtmp, TWO_HANDED_SWORD);
		}
		if (ptr == &mons[PM_H_SISTER]) {
			(void) mongets(mtmp, TWO_HANDED_SWORD);
		}
		if (ptr == &mons[PM_SANDRA_SISTER]) {
			(void) mongets(mtmp, TWO_HANDED_SWORD);
		}

		if (mtmp->data == &mons[PM_HAM_TAIROU]) {
			(void) mongets(mtmp, QUARTERSTAFF);
			(void) mongets(mtmp, SHORT_SWORD);
		}
		if (mtmp->data == &mons[PM_EASTER_HARE]) {
			 (void) mongets(mtmp, CHOCOLATE);
			 (void) mongets(mtmp, CHOCOEGG);
		}
		if (mtmp->data == &mons[PM_EASTER]) { 
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = rnd(4);
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_EASTER, FALSE);
				attach_egg_hatch_timeout(otmpX);
				kill_egg(otmpX); /* make sure they're stale --Amy */
				mpickobj(mtmp,otmpX, TRUE);
			}
		}
		if (ptr == &mons[PM_STAR_STINGEL]) {
			(void) mongets(mtmp, SAND_SWORD);
			 m_initthrow(mtmp, SAND_DART, 50);
			 m_initthrow(mtmp, SAND_DART, 50);
		}
		if (ptr == &mons[PM_LONGRANGE_PRICK]) {
			 m_initthrow(mtmp, DART, 50);
			 m_initthrow(mtmp, DART, 50);
		}
		if (mtmp->data == &mons[PM_HERHARAT]) {
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, ORCISH_CLOAK);
			(void) mongets(mtmp, SMALL_SHIELD);
			(void) mongets(mtmp, ELVEN_SPEAR);
		}
		if (mtmp->data == &mons[PM_DISASTER]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, SCYTHE);
			m_initthrow(mtmp, ROCK, 50);
		}
		if (mtmp->data == &mons[PM_CARNAGE_RAT]) {
			(void) mongets(mtmp, SLING);
			m_initthrow(mtmp, ROCK, 50);
			m_initthrow(mtmp, ROCK, 50);
		}
		if (mtmp->data == &mons[PM_SHOOTING_HAMSTER]) {
			(void) mongets(mtmp, PISTOL);
			m_initthrow(mtmp, PISTOL_BULLET, 30);
		}

		if (mtmp->data == &mons[PM_QUILL_RAT]) m_initthrow(mtmp, DART, 3);
		if (mtmp->data == &mons[PM_PRICK_RAT]) m_initthrow(mtmp, DART, 3);
		if (mtmp->data == &mons[PM_TERRORISM_SQUIRREL]) m_initthrow(mtmp, FRAG_GRENADE, 30);

		if (mtmp->data == &mons[PM_HC_BITCH]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (mtmp->data == &mons[PM_HUGE_TUNNEL_MOLE]) (void) mongets(mtmp, SCR_TUNNELS);

		if (mtmp->data == &mons[PM_SPIKE_FIEND]) m_initthrow(mtmp, DART, 5);
		if (mtmp->data == &mons[PM_THORN_BEAST]) m_initthrow(mtmp, DART, 7);

		if (mtmp->data == &mons[PM_RAZOR_SPINE]) m_initthrow(mtmp, DART, 10);
		if (mtmp->data == &mons[PM_BLADE_BACK]) m_initthrow(mtmp, DART, 10);

		if (mtmp->data == &mons[PM_DESERT_PRICK]) m_initthrow(mtmp, DART, 12);

		if (mtmp->data == &mons[PM_JUNGLE_URCHIN]) m_initthrow(mtmp, DART, 15);
		if (mtmp->data == &mons[PM_SHRUB_THORN]) m_initthrow(mtmp, DART, 15);

		if (mtmp->data == &mons[PM_THORN_RAT]) m_initthrow(mtmp, DART, 18);
		if (mtmp->data == &mons[PM_SNIPER_FIEND]) m_initthrow(mtmp, DART, 20);
		if (mtmp->data == &mons[PM_PRICK_MONSTER]) m_initthrow(mtmp, DART, 20);
		if (mtmp->data == &mons[PM_BIMMELING_RAT]) m_initthrow(mtmp, DART, 25);

		if (mtmp->data == &mons[PM_SCAVENGER]) (void) mongets(mtmp, DANCING_SHOES);
		if (mtmp->data == &mons[PM_ANASTASIA_S_DANCING_SHOE]) (void) mongets(mtmp, DANCING_SHOES);
		if (mtmp->data == &mons[PM_ANASTASIA_S_SNEAKER]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (mtmp->data == &mons[PM_ANASTASIA_S_HIGH_HEEL]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (mtmp->data == &mons[PM_PLAGUE_EATER]) (void) mongets(mtmp, SWEET_MOCASSINS);
		if (mtmp->data == &mons[PM_SOLVEJG_S_MOCASSIN]) (void) mongets(mtmp, SWEET_MOCASSINS);
		if (mtmp->data == &mons[PM_JESSICA_S_MOCASSIN]) (void) mongets(mtmp, SWEET_MOCASSINS);
		if (mtmp->data == &mons[PM_SHADOW_BEAST]) (void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		if (mtmp->data == &mons[PM_RUEA_S_LADY_SANDAL]) (void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		if (mtmp->data == &mons[PM_BONE_GASHER]) (void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_LUDGERA_S_HIKING_BOOT]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if (mtmp->data == &mons[PM_MAILIE_S_THICK_GIRL_BOOT]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);

		if (mtmp->data == &mons[PM_MAGDALENA_S_STINKING_COMBAT_BOOT]) { (void) mongets(mtmp, HIPPIE_HEELS);  (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); } /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_ELIF_S_BLOCK_HEELED_COMBAT_BOOT]) { (void) mongets(mtmp, HIPPIE_HEELS);  (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); } /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_RUEA_S_STILETTO_BOOT]) { (void) mongets(mtmp, SPIKED_BATTLE_BOOT); (void) mongets(mtmp, SCR_TRAP_CREATION);  (void) mongets(mtmp, COMBAT_STILETTOS); }
		if (mtmp->data == &mons[PM_JESSICA_S_STILETTO_BOOT]) { (void) mongets(mtmp, SPIKED_BATTLE_BOOT);  (void) mongets(mtmp, COMBAT_STILETTOS); (void) mongets(mtmp, WAN_TRAP_CREATION);}

		if (mtmp->data == &mons[PM_KATRIN_S_DANCING_SHOE]) { (void) mongets(mtmp, SCR_TRAP_CREATION);  (void) mongets(mtmp, LACQUERED_DANCING_SHOE); (void) mongets(mtmp, DANCING_SHOES); }
		if (mtmp->data == &mons[PM_ELIF_S_SNEAKER]) { (void) mongets(mtmp, SOFT_GIRL_SNEAKER); (void) mongets(mtmp, SOFT_SNEAKERS); } /* M4_SNEAKERS */
		if (mtmp->data == &mons[PM_KATRIN_S_HIGH_HEELED_PUMP]) { (void) mongets(mtmp, FEMININE_PUMPS); (void) mongets(mtmp, SEXY_LEATHER_PUMP); } /* M4_PUMPS */
		if (mtmp->data == &mons[PM_WENDY_S_SEXY_LEATHER_PUMP]) { (void) mongets(mtmp, FEMININE_PUMPS); (void) mongets(mtmp, SEXY_LEATHER_PUMP); } /* M4_PUMPS */
		if (mtmp->data == &mons[PM_SOLVEJG_S_LEATHER_PUMP]) { (void) mongets(mtmp, FEMININE_PUMPS); (void) mongets(mtmp, SEXY_LEATHER_PUMP); } /* M4_PUMPS */

		if (ptr == &mons[PM_MUTATED_BATTLE_BUNNY]) (void) mongets(mtmp, rn2(10) ? POT_MUTATION : WAN_MUTATION);

		break;

	    case S_UNICORN:

		if (mtmp->data == &mons[PM_RONJA_S_BLOCK_HEELED_COMBAT_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_HORN_HORSE]) (void) mongets(mtmp, UNICORN_HORN);
		if (mtmp->data == &mons[PM_HORNPEEK_HORSE]) (void) mongets(mtmp, UNICORN_HORN);
		if (mtmp->data == &mons[PM_ROTATING_THROUGH_UNICORN]) (void) mongets(mtmp, UNICORN_HORN);
		if (mtmp->data == &mons[PM_CANCER_INHALER]) (void) mongets(mtmp, CIGARETTE);
		if (mtmp->data == &mons[PM_PICK_HORN]) (void) mongets(mtmp, PICK_AXE);

		if (mtmp->data == &mons[PM_POLECORN]) (void) mongets(mtmp, SPETUM);
		if (mtmp->data == &mons[PM_HUGE_POLECORN]) (void) mongets(mtmp, HALBERD);
		if (mtmp->data == &mons[PM_IVANA]) (void) mongets(mtmp, COMBAT_STILETTOS);
		if (mtmp->data == &mons[PM_WHITE_UNIHORN]) (void) mongets(mtmp, UNICORN_HORN);
		if (mtmp->data == &mons[PM_BLACK_UNIHORN]) (void) mongets(mtmp, UNICORN_HORN);
		if (mtmp->data == &mons[PM_GRAY_UNIHORN]) (void) mongets(mtmp, UNICORN_HORN);
		if (mtmp->data == &mons[PM_ETHER_UNICORN]) (void) mongets(mtmp, ETHER_SAW);
		if (mtmp->data == &mons[PM_SELF_FLAGELLATING_UNICORN]) (void) mongets(mtmp, RIDING_CROP);

		if (mtmp->data == &mons[PM_RIDABLE_HUMPER] || mtmp->data == &mons[PM_SADDLE_NIGHTMARE] || mtmp->data == &mons[PM_READY_BATTLEHORSE]) {
			struct obj *osaddle;
			if (!!(osaddle = mksobj(LEATHER_SADDLE, TRUE, FALSE, FALSE))) {
				if (mpickobj(mtmp, osaddle, TRUE)) { /* it became a gold piece (e.g. minimalist) --Amy */
					if (wizard) impossible("merged saddle?");
				} else {
					mtmp->misc_worn_check |= W_SADDLE;
					osaddle->dknown = osaddle->bknown = osaddle->rknown = 1;
					osaddle->owornmask = W_SADDLE;
					osaddle->leashmon = mtmp->m_id;
					update_mon_intrinsics(mtmp, osaddle, TRUE, TRUE);
				}
			}
		}
		if (mtmp->data == &mons[PM_INKA_HUMPER] || mtmp->data == &mons[PM_COCKAHORSE]) {
			struct obj *osaddle;
			if (!!(osaddle = mksobj(INKA_SADDLE, TRUE, FALSE, FALSE))) {
				if (mpickobj(mtmp, osaddle, TRUE)) { /* it became a gold piece (e.g. minimalist) --Amy */
					if (wizard) impossible("merged saddle?");
				} else {
					mtmp->misc_worn_check |= W_SADDLE;
					osaddle->dknown = osaddle->bknown = osaddle->rknown = 1;
					osaddle->owornmask = W_SADDLE;
					osaddle->leashmon = mtmp->m_id;
					update_mon_intrinsics(mtmp, osaddle, TRUE, TRUE);
				}
			}
		}

		if (mtmp->data == &mons[PM_EVIL_SAVIOR]) {
			(void) mongets(mtmp, rnd_class(WAN_LIGHT, WAN_PSYBEAM));
			(void) mongets(mtmp, rnd_offensive_item(mtmp));
		}
		if (mtmp->data == &mons[PM_BERNIE]) {
			(void) mongets(mtmp, SLING);
			m_initthrow(mtmp, AMBER_FRAGMENT, 50);
			m_initthrow(mtmp, AMBER_FRAGMENT, 50);
		}

		if (mtmp->data == &mons[PM_WIMPDAG_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			m_initthrow(mtmp, ORCISH_DAGGER, 5);
		}
		if (mtmp->data == &mons[PM_BUBBLE_BANGER]) {
			(void) mongets(mtmp, BUBBLEHORN);
			(void) mongets(mtmp, BUBBLETAR);
		}
		if (mtmp->data == &mons[PM_DARK_BANGER]) {
			(void) mongets(mtmp, DARK_HORN);
		}
		if (mtmp->data == &mons[PM_ARCANE_BANGER]) {
			(void) mongets(mtmp, ARCANE_HORN);
		}
		if (mtmp->data == &mons[PM_GRIND_BANGER]) {
			(void) mongets(mtmp, GRINDER);
			(void) mongets(mtmp, BUBBLEHORN);
		}
		if (mtmp->data == &mons[PM_AVARICIOUS_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			m_initthrow(mtmp, STILETTO, 5);
		}

		if (mtmp->data == &mons[PM_SLING_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			(void) mongets(mtmp, SLING);
			m_initthrow(mtmp, ROCK, 30);
		}
		if (mtmp->data == &mons[PM_TALC_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			(void) mongets(mtmp, SLING);
			m_initthrow(mtmp, TALC, 20);
		}
		if (mtmp->data == &mons[PM_EX_SLING_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			(void) mongets(mtmp, SLING);
			m_initthrow(mtmp, SLING_AMMO, 40);
		}

		if (mtmp->data == &mons[PM_FLINT_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			(void) mongets(mtmp, SLING);
			m_initthrow(mtmp, FLINT, 40);
		}

		if (mtmp->data == &mons[PM_DAT_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			m_initthrow(mtmp, DART, 35);
		}

		if (mtmp->data == &mons[PM_BOW_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 30);
		}

		if (mtmp->data == &mons[PM_PISTOL_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			(void) mongets(mtmp, PISTOL);
			m_initthrow(mtmp, PISTOL_BULLET, 30);
		}
		if (mtmp->data == &mons[PM_LEAD_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			(void) mongets(mtmp, PISTOL);
			m_initthrow(mtmp, LEAD_PISTOL_BULLET, 25);
		}

		if (mtmp->data == &mons[PM_SPEA_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			m_initthrow(mtmp, SPEAR, 5);
		}

		if (mtmp->data == &mons[PM_XBOW_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			(void) mongets(mtmp, CROSSBOW);
			m_initthrow(mtmp, CROSSBOW_BOLT, 45);
		}
		if (mtmp->data == &mons[PM_FLEECE_BANGER]) {
			(void) mongets(mtmp, DARK_HORN);
			(void) mongets(mtmp, CROSSBOW);
			m_initthrow(mtmp, FLEECE_BOLT, 40);
		}

		if (mtmp->data == &mons[PM_SHOTTY_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			(void) mongets(mtmp, SHOTGUN);
			m_initthrow(mtmp, SHOTGUN_SHELL, 25);
		}

		if (mtmp->data == &mons[PM_SHURI_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			m_initthrow(mtmp, SHURIKEN, 50);
		}

		if (mtmp->data == &mons[PM_SMG_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			(void) mongets(mtmp, SUBMACHINE_GUN);
			m_initthrow(mtmp, SMG_BULLET, 35);
			m_initthrow(mtmp, SMG_BULLET, 35);
		}

		if (mtmp->data == &mons[PM_LASER_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			(void) mongets(mtmp, HAND_BLASTER);
			m_initthrow(mtmp, BLASTER_BOLT, 40);
		}
		if (mtmp->data == &mons[PM_ETHER_BANGER]) {
			(void) mongets(mtmp, ARCANE_HORN);
			(void) mongets(mtmp, CROSSBOW);
			m_initthrow(mtmp, ETHER_BOLT, 40);
		}

		if (mtmp->data == &mons[PM_ASSAULT_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			(void) mongets(mtmp, ASSAULT_RIFLE);
			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 45);
			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 45);
		}

		if (mtmp->data == &mons[PM_JAV_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			m_initthrow(mtmp, JAVELIN, 10);
		}

		if (mtmp->data == &mons[PM_AUTOSHOT_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			(void) mongets(mtmp, AUTO_SHOTGUN);
			m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 50);
		}

		if (mtmp->data == &mons[PM_ARMSTREAM_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			(void) mongets(mtmp, ARM_BLASTER);
			m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
			m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		}

		if (mtmp->data == &mons[PM_BIG_FUCKING_BANGER]) {
			(void) mongets(mtmp, UNICORN_HORN);
			(void) mongets(mtmp, BFG);
			m_initthrow(mtmp, BFG_AMMO, 40);
			m_initthrow(mtmp, BFG_AMMO, 40);
			m_initthrow(mtmp, BFG_AMMO, 40);
			m_initthrow(mtmp, BFG_AMMO, 40);
			m_initthrow(mtmp, BFG_AMMO, 40);
			m_initthrow(mtmp, BFG_AMMO, 40);
			m_initthrow(mtmp, BFG_AMMO, 40);
			m_initthrow(mtmp, BFG_AMMO, 40);
			m_initthrow(mtmp, BFG_AMMO, 40);
			m_initthrow(mtmp, BFG_AMMO, 40);
		}

		if (mtmp->data == &mons[PM_BADFICINA]) {
			(void) mongets(mtmp, SCR_EARTH);
			(void) mongets(mtmp, WAN_TIDAL_WAVE);
			(void) mongets(mtmp, SCR_WARPING);
			(void) mongets(mtmp, SCR_SUMMON_ELM);
			(void) mongets(mtmp, SCR_CREATE_VICTIM);
		}

		if (mtmp->data == &mons[PM_BALLISTALLION]) {
			(void) mongets(mtmp, BALLISTA);
			m_initthrow(mtmp, CROSSBOW_BOLT, 50);
		}

		break;

          case S_SNAKE:
		if (mtmp->data == &mons[PM_CLOUD_CATTLE]) (void) mongets(mtmp, SCR_CLOUDS);
		if (mtmp->data == &mons[PM_HC_STENGLER]) (void) mongets(mtmp, BARDICHE);
		if (mtmp->data == &mons[PM_INDOCTRINATED_ALIEN]) (void) mongets(mtmp, NASTYPOLE);
		if (mtmp->data == &mons[PM_ARMVIPER]) (void) mongets(mtmp, VIPERWHIP);
		if (mtmp->data == &mons[PM_DIRE_MASK_WOMAN]) (void) mongets(mtmp, find_corona_mask());
		if (mtmp->data == &mons[PM_VACCINATION_GESTAPO]) (void) mongets(mtmp, SCALPEL);
		if (mtmp->data == &mons[PM_HORNY_FEMMY]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		if (ptr == &mons[PM_WOODFALL_CATTLE]) {
			(void) mongets(mtmp, SHARP_AXE);
		}
		if (ptr == &mons[PM_SLOOB] && !rn2(5)) {
			(void) mongets(mtmp, POT_INVISIBILITY);
		}
		if (ptr == &mons[PM_BOWSERVOLCANIC_CATTLE]) {
			(void) mongets(mtmp, VOLCANIC_BROADSWORD);
		}
		if (ptr == &mons[PM_FAT_ETRUSCIAN_BITCH]) {
			(void) mongets(mtmp, ROMAN_SWORD);
		}

		if (mtmp->data == &mons[PM_ARMED_SNAKE]) { (void) mongets(mtmp, ORCISH_BOW); m_initthrow(mtmp, ARROW, 30);}

		if (mtmp->data == &mons[PM_NUNSISTER]) {
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}

		if (ptr == &mons[PM_GRAPH_SNAKE]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, GRAPHITE, 25);
		}

		if (mtmp->data == &mons[PM_SNAKE_ARCHER]) { (void) mongets(mtmp, BOW); m_initthrow(mtmp, ARROW, 30);}
		if (mtmp->data == &mons[PM_VIPER_ARCHER]) { (void) mongets(mtmp, BOW); m_initthrow(mtmp, ORCISH_ARROW, 30);}
		if (mtmp->data == &mons[PM_SNAKE_SNIPER]) { (void) mongets(mtmp, SNIPER_RIFLE); m_initthrow(mtmp, SNIPER_BULLET, 25);}
		if (mtmp->data == &mons[PM_CLOCK_FOREST_ARCHER]) { (void) mongets(mtmp, DARK_ELVEN_BOW); m_initthrow(mtmp, ORCISH_ARROW, 35);}
		if (mtmp->data == &mons[PM_WIND_BOWMAN]) { (void) mongets(mtmp, DARK_ELVEN_BOW); m_initthrow(mtmp, DARK_ELVEN_ARROW, 35);}

		if (mtmp->data == &mons[PM_SIBEL]) {
			(void) mongets(mtmp, BOW);
			(void) mongets(mtmp, SILVER_SABER);
			m_initthrow(mtmp, SILVER_ARROW, 50);
		}
		if (mtmp->data == &mons[PM_LEGSNAKE]) {
			(void) mongets(mtmp, WONDER_DAGGER);
			(void) mongets(mtmp, LOW_BOOTS);
		}
		if (mtmp->data == &mons[PM_PROCESS_SNAKE]) {
			(void) mongets(mtmp, PROCESS_CARD);
			m_initthrow(mtmp, RADIO, 50);

		}

		if (mtmp->data == &mons[PM_SNAKE_ELITE_SNIPER]) {
			 (void) mongets(mtmp, HELO_CROSSBOW);
			m_initthrow(mtmp, CROSSBOW_BOLT, 50);
			m_initthrow(mtmp, CROSSBOW_BOLT, 25);
		}

		if (mtmp->data == &mons[PM_RHEA_S_LADY_PUMP]) { (void) mongets(mtmp, FEMININE_PUMPS); (void) mongets(mtmp, SEXY_LEATHER_PUMP); (void) mongets(mtmp, SCR_TRAP_CREATION); } /* M4_PUMPS */

		break;
	    case S_GIANT:
		if (ptr == &mons[PM_MINOTAUR]) {
		    if (!rn2(3) || (in_mklev && Is_earthlevel(&u.uz)))
			(void) mongets(mtmp, WAN_DIGGING);
		} else if (ptr == &mons[PM_CHEATING_MINOTAUR]) { /* evil patch idea by jonadab */
			if (!rn2(3)) (void) mongets(mtmp, WAN_LIGHTNING);
			else if (!rn2(2)) (void) mongets(mtmp, AMULET_OF_LIFE_SAVING);
			else (void) mongets(mtmp, AMULET_OF_REFLECTION);
		} else if (is_giant(ptr) && mtmp->m_lev > 1) {
		    for (cnt = rn2((int)(mtmp->m_lev / 2)); cnt; cnt--) {

			if (!rn2(3)) { /* greatly lowered chance --Amy */
			otmp = mksobj(rnd_class(DILITHIUM_CRYSTAL,LUCKSTONE-1),
				      FALSE, FALSE, FALSE);
			if (otmp) {
				otmp->quan = rnd(3); /* lower amount */
				otmp->owt = weight(otmp);
				if(!rn2(8)) {
					otmp->spe = rne(2);
					if (rn2(2)) otmp->blessed = rn2(2);
					 else	blessorcurse(otmp, 3);
				} else if(!rn2(10)) {
					if (rn2(10)) curse(otmp);
					 else	blessorcurse(otmp, 3);
					otmp->spe = -rne(2);
				} else	blessorcurse(otmp, 10);
				(void) mpickobj(mtmp, otmp, TRUE);
				}
			}

		    }
		}

		if (ptr == &mons[PM_STAHNGNIR__THE_STEEL_GIANT_LORD]) {
		    otmp = mksobj(AIR_PRESSURE_HAMMER, FALSE, FALSE, FALSE);

		    if (otmp) {

			otmp = oname(otmp, artiname(ART_STAHNGNIR_S_BASHHUNK));
			(void) mpickobj(mtmp, otmp, TRUE);

		    }

		    int stahngnirminions = rn1(10, 10);
		    while (stahngnirminions > 0) {
				(void) makemon(&mons[PM_STEEL_GIANT], mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				stahngnirminions--;
		    }

		}

		if (ptr == &mons[PM_POLEARM_MASTER]) (void)mongets(mtmp, rnd_class(PARTISAN,BEC_DE_CORBIN));

		if (ptr == &mons[PM_ERR_AXE_MINOTAUR]) (void)mongets(mtmp, BATTLE_AXE);
		if (ptr == &mons[PM_NORDIC_WALKING_GIANT]) (void)mongets(mtmp, CLIMBING_STICK);
		if (ptr == &mons[PM_LAVA_SPAWN_GIANT]) (void)mongets(mtmp, GRINDER);
		if (ptr == &mons[PM_STEELED_GIANT]) (void)mongets(mtmp, HEAVY_GRINDER);
		if (ptr == &mons[PM_DOGSHIT_FEMMY]) (void)mongets(mtmp, DOGSHIT_BOOT);
		if (ptr == &mons[PM_STONER_GIANT]) (void)mongets(mtmp, POT_HALLUCINATION);
		if (ptr == &mons[PM_COW_HILL_GIANT]) (void)mongets(mtmp, SACK);
		if (ptr == &mons[PM_IT_S_TOO_HEAVY_FOR_YOUR_HILL_GIANT]) (void)mongets(mtmp, TREASURE_CHEST);
		if (ptr == &mons[PM_BRIDGING_FEMMY]) (void)mongets(mtmp, BRIDGHITTE_SKI_HEELS);

		if (ptr == &mons[PM_GUDRUN_THE_FEMINIST]) {
			(void)mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		}
		if (ptr == &mons[PM_VEHEMENT_FEMMY]) {
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);
		}
		if (ptr == &mons[PM_MILL_GIANT]) {
			(void)mongets(mtmp, BATTLE_AXE);
		}
		if (ptr == &mons[PM_LIGHT_GIANT]) {
			(void)mongets(mtmp, LIGHTWHIP);
		}
		if (ptr == &mons[PM_ATLAS]) {
			(void)mongets(mtmp, HEAVY_HAMMER);
			(void)mongets(mtmp, SLING);
		  	m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_GRANIT_AUTO]) {
			(void)mongets(mtmp, SLING);
		  	m_initthrow(mtmp, FLINT, 40);
		}
		if (ptr == &mons[PM_PURPLE_SHOOTER_PANTS]) {
			(void)mongets(mtmp, FLINTLOCK);
		  	m_initthrow(mtmp, PISTOL_BULLET, 40);
		}
		if (ptr == &mons[PM_FILL_GIANT]) {
			(void)mongets(mtmp, SCR_FLOODING);
		}
		if (ptr == &mons[PM_QUILL_GIANT]) {
		  	m_initthrow(mtmp, DART, 20);
		}
		if (ptr == &mons[PM_PILL_GIANT]) {
			(void)mongets(mtmp, PILL);
		}
		if (ptr == &mons[PM_THRILL_GIANT]) {
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);
		}

		if (ptr == &mons[PM_LION_S_GIRLFRIEND]) {
			(void)mongets(mtmp, ITALIAN_HEELS); /* M4_SANDALS */
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);
		}
		if (ptr == &mons[PM_MINOTAUR_BALLERINA]) (void)mongets(mtmp, SWEET_MOCASSINS);
		if (ptr == &mons[PM_SWEET_LARVA_LINE]) (void)mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if (ptr == &mons[PM_DARK_STARWARS_MASTER]) {
			(void)mongets(mtmp, RED_DOUBLE_LIGHTSABER);
			(void)mongets(mtmp, ARM_BLASTER);
		  	m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		  	m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		}
		if (ptr == &mons[PM_LOONIE_BOSS]) {
			(void)mongets(mtmp, PISTOL);
		  	m_initthrow(mtmp, PISTOL_BULLET, 50);
		}
		if (ptr == &mons[PM_VIET_BOSS]) {
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		}
		if (ptr == &mons[PM_LERA_CUDDLE_BUNDLE]) (void)mongets(mtmp, SWEET_MOCASSINS);
		if (ptr == &mons[PM_SMITHS_HUSSY]) (void)mongets(mtmp, SWEET_MOCASSINS);
		if (ptr == &mons[PM_NICE_EVIL_GIRL]) (void)mongets(mtmp, SWEET_MOCASSINS);
		if (ptr == &mons[PM_TAPIA]) {
			(void)mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
			(void)mongets(mtmp, KNIFE);
		}
		if (ptr == &mons[PM_INDIAN_QUEEN]) (void)mongets(mtmp, HUGGING_BOOT);
		if (ptr == &mons[PM_MERRY_GIRL]) (void)mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if (ptr == &mons[PM_VERY_THICK_GIRL]) (void)mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if (ptr == &mons[PM_YOUR_ONE_WAY_GIRLFRIEND]) (void)mongets(mtmp, SOFT_LADY_SHOE);
		if (ptr == &mons[PM_ABSOLUTELY_CUDDLY_GIRL]) (void)mongets(mtmp, HUGGING_BOOT);
		if (ptr == &mons[PM_KING_OF_ROCK__N_ROLL]) (void)mongets(mtmp, ELVIS_SHOES);
		if (ptr == &mons[PM_NOBLE_GIRL_FROM_BEING_MOUNTAIN]) (void)mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (ptr == &mons[PM_FREAKY_GANG_GIRL]) (void)mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (ptr == &mons[PM_NICE_AUNTIE_HILDA]) (void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (ptr == &mons[PM_TURKISH_GIRL_THAT_LIKES_THE_COLOR_LILAC]) (void)mongets(mtmp, STILETTO_SANDALS); /* M4_SANDALS */
		if (ptr == &mons[PM_GIRL_WITH_THE_MOST_BEAUTIFUL_SHOES_IN_THE_WORLD]) (void)mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (ptr == &mons[PM_FINGERSMASHING_WATERGIRL]) {
			(void)mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
			(void)mongets(mtmp, SCR_FLOOD);
		}
		if (ptr == &mons[PM_WONDERBLONDE]) {
			(void)mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
			(void)mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		}
		if (ptr == &mons[PM_AUNT_NINA]) {
			(void)mongets(mtmp, SILK_MAIL);
			(void)mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		}
		if (ptr == &mons[PM_SQUEEZE_HUSSY]) {
			(void)mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
			(void)mongets(mtmp, SCR_FLOOD);
		}
		if (ptr == &mons[PM_CUDDLY_TURN_SHOE_QUEEN]) {
			(void)mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
			(void)mongets(mtmp, SOFT_GIRL_SNEAKER);
		}
		if (ptr == &mons[PM_BLOND_SWOON_BUNDLE_HARE]) {
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			(void)mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		}
		if (ptr == &mons[PM_AUNTIE_WENDY]) {
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);
		}
		if (ptr == &mons[PM_MINOTARD]) (void)mongets(mtmp, T_SHIRT);
		if (ptr == &mons[PM_BEER_BELLY]) {
			(void)mongets(mtmp, POT_CONFUSION);
			(void)mongets(mtmp, POT_CONFUSION);
			(void)mongets(mtmp, POT_CONFUSION);
		}

		if (ptr == &mons[PM_MIGIANT]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SMALL_PIECE_OF_UNREFINED_MITHR, 20);
		}

		if (ptr == &mons[PM_SILVER_GIANT]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SILVER_SLINGSTONE, 40);
		}
		if (ptr == &mons[PM_RUBY_BOSS]) {
			(void) mongets(mtmp, CATAPULT);
			 m_initthrow(mtmp, RUBY, 30);
		}

		if (ptr == &mons[PM_SHOTTIANT]) {
			(void) mongets(mtmp, SHOTGUN);
			(void) mongets(mtmp, BASINET);
			 m_initthrow(mtmp, LEAD_SHOT, 30);
		}
		if (ptr == &mons[PM_GREJAGIANT]) {
			 m_initthrow(mtmp, JAVELIN, 3);
		}

		if (ptr == &mons[PM_SPECHOTAUR]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, RAPIRAPI);
			 m_initthrow(mtmp, SLING_AMMO, 40);
		}
		if (ptr == &mons[PM_FROST_SLINGER]) {
			(void)mongets(mtmp, SLING);
		  	m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_SLAMOFF_GIANT]) {
			(void)mongets(mtmp, SAWED_OFF_SHOTGUN);
			(void)mongets(mtmp, DENTED_POT);
		  	m_initthrow(mtmp, SHOTGUN_SHELL, 30);
		}
		if (ptr == &mons[PM_BRA_GIANT]) {
			(void)mongets(mtmp, SLING);
		  	m_initthrow(mtmp, ROCK, 35);
		  	m_initthrow(mtmp, ROCK, 35);
		}
		if (ptr == &mons[PM_LITTLE_SLIANT]) {
			(void)mongets(mtmp, SLING);
			(void)mongets(mtmp, ORCISH_HELM);
		  	m_initthrow(mtmp, ROCK, 40);
		}
		if (ptr == &mons[PM_SLEEPING_GIANT]) {
			(void)mongets(mtmp, SLING);
		  	m_initthrow(mtmp, ROCK, 50);
		  	m_initthrow(mtmp, ROCK, 50);
		  	m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_CHIHYU]) {
			(void)mongets(mtmp, BOW);
		  	m_initthrow(mtmp, ARROW, 40);
		}
		if (ptr == &mons[PM_MOLOCH]) {
			(void)mongets(mtmp, BARDICHE);
			(void)mongets(mtmp, SLING);
		  	m_initthrow(mtmp, ROCK, 50);
		  	m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_ASTERIOS]) {
			(void)mongets(mtmp, BARDICHE);
			(void)mongets(mtmp, SLING);
		  	m_initthrow(mtmp, ROCK, 50);
		  	m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_SLIANT]) {
			(void)mongets(mtmp, SLING);
			(void)mongets(mtmp, ORCISH_HELM);
		  	m_initthrow(mtmp, ROCK, 40);
		}
		if (ptr == &mons[PM_HILL_SLIANT]) {
			(void)mongets(mtmp, SLING);
			(void)mongets(mtmp, ORCISH_HELM);
		  	m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_FIRE_SLIANT]) {
			(void)mongets(mtmp, SLING);
			(void)mongets(mtmp, ORCISH_HELM);
		  	m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_JOUST_SLINGER]) {
			(void)mongets(mtmp, SLING);
			(void)mongets(mtmp, ORCISH_HELM);
		  	m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_CHALLENGING_SLINGER]) {
			(void)mongets(mtmp, SLING);
			(void)mongets(mtmp, GREEN_DRAGON_SCALE_MAIL);
			(void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			(void)mongets(mtmp, ORCISH_HELM);
		  	m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_ROCKTAUR]) {
			(void)mongets(mtmp, SLING);
			(void)mongets(mtmp, ORCISH_HELM);
		  	m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_RETARDED_CURD_GIANT]) {
			(void)mongets(mtmp, SLING);
			(void)mongets(mtmp, ICKY_BLADE);
			(void)mongets(mtmp, ORCISH_HELM);
		  	m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_KUYD_GIANT]) {
			(void)mongets(mtmp, SLING);
			(void)mongets(mtmp, BLUE_DRAGON_SCALE_SHIELD);
			(void)mongets(mtmp, GREAT_DAGGER);
			(void)mongets(mtmp, ORCISH_HELM);
		  	m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_MR_GIANT]) {
			(void)mongets(mtmp, SLING);
			(void)mongets(mtmp, ORCISH_HELM);
		  	m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_CHARCOAL_GIANT]) {
			(void)mongets(mtmp, SLING);
			(void)mongets(mtmp, PAPER_SHIELD);
			(void)mongets(mtmp, HIGH_BOOTS);
			(void)mongets(mtmp, POT_BLINDNESS);
			(void)mongets(mtmp, ORCISH_HELM);
		  	m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_SOW_STUPID_FATHER_THAT_IS_REALLY_BATSHIT_CRAZY]) {
			(void)mongets(mtmp, SLING);
			(void)mongets(mtmp, MALLET);
			(void)mongets(mtmp, ORCISH_HELM);
		  	m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_SLITAN]) {
			(void)mongets(mtmp, SLING);
			(void)mongets(mtmp, SUGUHANOKEN);
			(void)mongets(mtmp, ORCISH_HELM);
		  	m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_GREATER_SLITAN]) {
			(void)mongets(mtmp, SLING);
			(void)mongets(mtmp, HIGH_BOOTS);
			(void)mongets(mtmp, ORCISH_CLOAK);
			(void)mongets(mtmp, TWO_HANDED_SWORD);
			(void)mongets(mtmp, ORCISH_HELM);
		  	m_initthrow(mtmp, ROCK, 50);
		}

		if (ptr == &mons[PM_SABINE_S_BLOCK_HEELED_SANDAL]) (void)mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		if (ptr == &mons[PM_BANG_GANG_GIRL]) (void)mongets(mtmp, DANCING_SHOES);
		if (ptr == &mons[PM_CLIMBING_GIANT]) (void)mongets(mtmp, SCR_MOUNTAINS);

		break;

	    case S_TURRET:

		if (!rn2(25)) (void)mongets(mtmp, POT_INVISIBILITY);

		if (ptr == &mons[PM_CAMPCAMPCAMP_TURRET]) {
			(void) mongets(mtmp, KALASHNIKOV);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 40);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 40);
		}
		if (ptr == &mons[PM_CHILD_MAKING_MACHINE]) {
			(void) mongets(mtmp, EGG);
			(void) mongets(mtmp, EGG);
			(void) mongets(mtmp, EGG);
			(void) mongets(mtmp, EGG);
			(void) mongets(mtmp, EGG);
			(void) mongets(mtmp, EGG);
			(void) mongets(mtmp, EGG);
			(void) mongets(mtmp, EGG);
			(void) mongets(mtmp, EGG);
			(void) mongets(mtmp, EGG);
		}

		if (ptr == &mons[PM_MYSTERY_BOX]) (void)mongets(mtmp, CRYPTIC_POLE);

		if (ptr == &mons[PM_BONER_TURRET]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, BONE_FRAGMENT, 25);
		}
		if (ptr == &mons[PM_LEADEN_TURRET]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, LEAD_CLUMP, 25);
		}
		if (ptr == &mons[PM_ROCKY_TURRET]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SLING_AMMO, 25);
		}
		if (ptr == &mons[PM_PITCHING_MACHINE]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, ROCK, 50);
			 m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_BOELLERBOELLER_MACHINE]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, ROCK, 50);
			 m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_AMBER_TURRET]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, AMBER_FRAGMENT, 25);
		}
		if (ptr == &mons[PM_GRAPHIC_TURRET]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, GRAPHITE, 35);
		}
		if (ptr == &mons[PM_SALTED_TURRET]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SALT_CHUNK, 40);
		}
		if (ptr == &mons[PM_SILVER_TURRET]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SILVER_SLINGSTONE, 45);
		}

		if (ptr == &mons[PM_FRAGGER_TURRET]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, BONE_FRAGMENT, 40);
		}
		if (ptr == &mons[PM_SUPERHEAVY_TURRET]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, LEAD_CLUMP, 40);
		}
		if (ptr == &mons[PM_APEC_TURRET]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SLING_AMMO, 40);
		}

		if (ptr == &mons[PM_CRUDE_TURRET]) m_initthrow(mtmp, ORCISH_DAGGER, 3);
		if (ptr == &mons[PM_DAGGER_TURRET]) m_initthrow(mtmp, DAGGER, 3);
		if (ptr == &mons[PM_DROVEN_TURRET]) m_initthrow(mtmp, DARK_ELVEN_DAGGER, 3);
		if (ptr == &mons[PM_THRUSTING_TURRET]) (void)mongets(mtmp, LUCERN_HAMMER);
		if (ptr == &mons[PM_SCYTHING_TURRET]) (void)mongets(mtmp, BEC_DE_CORBIN);
		if (ptr == &mons[PM_SPEAR_TURRET]) m_initthrow(mtmp, SPEAR, 3);

		if (ptr == &mons[PM_ARROW_TURRET]) {
		  	(void) mongets(mtmp, ORCISH_BOW);
		  	m_initthrow(mtmp, ORCISH_ARROW, 25);
		}
		if (ptr == &mons[PM_LARGE_ARROW_TURRET]) {
		  	(void) mongets(mtmp, BOW);
		  	m_initthrow(mtmp, ARROW, 35);
		}
		if (ptr == &mons[PM_ELVEN_TURRET]) {
		  	(void) mongets(mtmp, ELVEN_BOW);
		  	m_initthrow(mtmp, ELVEN_ARROW, 30);
		}
		if (ptr == &mons[PM_DARK_ELVEN_TURRET]) {
		  	(void) mongets(mtmp, DARK_ELVEN_BOW);
		  	m_initthrow(mtmp, DARK_ELVEN_ARROW, 35);
		}
		if (ptr == &mons[PM_SAMU_TURRET]) {
		  	(void) mongets(mtmp, YUMI);
		  	m_initthrow(mtmp, YA, 40);
		}
		if (ptr == &mons[PM_PREHISTORIC_TURRET]) {
		  	(void) mongets(mtmp, SLING);
		  	m_initthrow(mtmp, ROCK, 50);
		}
		if (ptr == &mons[PM_NEOLITHIC_TURRET]) {
		  	(void) mongets(mtmp, SLING);
		  	m_initthrow(mtmp, FLINT, 25);
		}
		if (ptr == &mons[PM_HARDLOAD_TURRET]) {
		  	(void) mongets(mtmp, SLING);
		  	m_initthrow(mtmp, LOADSTONE, 5);
		}
		if (ptr == &mons[PM_GIGALOAD_TURRET]) {
		  	(void) mongets(mtmp, SLING);
		  	m_initthrow(mtmp, LOADBOULDER, 5);
		}
		if (ptr == &mons[PM_GUN_TURRET]) {
		  	(void) mongets(mtmp, PISTOL);
		  	m_initthrow(mtmp, PISTOL_BULLET, 25);
		}
		if (ptr == &mons[PM_SMG_TURRET]) {
		  	(void) mongets(mtmp, SUBMACHINE_GUN);
		  	m_initthrow(mtmp, SMG_BULLET, 50);
		}
		if (ptr == &mons[PM_GATLING_TURRET]) {
		  	(void) mongets(mtmp, HEAVY_MACHINE_GUN);
		  	m_initthrow(mtmp, MG_BULLET, 50);
		  	m_initthrow(mtmp, MG_BULLET, 50);
		}
		if (ptr == &mons[PM_CUNTGUN_TURRET]) {
		  	(void) mongets(mtmp, RIFLE);
		  	m_initthrow(mtmp, RIFLE_BULLET, 25);
		}
		if (ptr == &mons[PM_AUTOMATIC_TURRET]) {
		  	(void) mongets(mtmp, ASSAULT_RIFLE);
		  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
		}
		if (ptr == &mons[PM_SNIPER_TURRET]) {
		  	(void) mongets(mtmp, SNIPER_RIFLE);
		  	m_initthrow(mtmp, SNIPER_BULLET, 25);
		}
		if (ptr == &mons[PM_PELLET_TURRET]) {
		  	(void) mongets(mtmp, SHOTGUN);
		  	m_initthrow(mtmp, SHOTGUN_SHELL, 20);
		}
		if (ptr == &mons[PM_CITYKILLER_TURRET]) {
		  	(void) mongets(mtmp, AUTO_SHOTGUN);
		  	m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 20);
		}
		if (ptr == &mons[PM_ROCKET_TURRET]) {
		  	(void) mongets(mtmp, ROCKET_LAUNCHER);
		  	m_initthrow(mtmp, ROCKET, 10);
		}
		if (ptr == &mons[PM_GL_TURRET] || ptr == &mons[PM_DEATH_SENTRY]) {
		  	(void) mongets(mtmp, GRENADE_LAUNCHER);
		  	m_initthrow(mtmp, FRAG_GRENADE, 10);
		}
		if (ptr == &mons[PM_SHOOTER_TURRET]) {
		  	(void) mongets(mtmp, CROSSBOW);
		  	m_initthrow(mtmp, CROSSBOW_BOLT, 40);
		  	m_initthrow(mtmp, CROSSBOW_BOLT, 20);
		}
		if (ptr == &mons[PM_OBSIDIAN_TURRET]) {
		  	(void) mongets(mtmp, DROVEN_CROSSBOW);
		  	m_initthrow(mtmp, DROVEN_BOLT, 50);
		  	m_initthrow(mtmp, DROVEN_BOLT, 20);
		}
		if (ptr == &mons[PM_GLASS_TURRET]) {
		  	(void) mongets(mtmp, DROVEN_BOW);
		  	m_initthrow(mtmp, DROVEN_ARROW, 50);
		}
		if (ptr == &mons[PM_ANCIENT_TURRET]) {
		  	(void) mongets(mtmp, BOW);
		  	m_initthrow(mtmp, ANCIENT_ARROW, 35);
		}
		if (ptr == &mons[PM_HYDRA_TURRET]) {
		  	(void) mongets(mtmp, HYDRA_BOW);
		  	m_initthrow(mtmp, GOLDEN_ARROW, 40);
		}
		if (ptr == &mons[PM_LASER_TURRET]) {
		  	(void) mongets(mtmp, HAND_BLASTER);
		  	m_initthrow(mtmp, BLASTER_BOLT, 40);
		}
		if (ptr == &mons[PM_BLASTER_TURRET]) {
		  	(void) mongets(mtmp, ARM_BLASTER);
		  	m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		}
		if (ptr == &mons[PM_CUTTING_TURRET]) {
		  	(void) mongets(mtmp, CUTTING_LASER);
		  	m_initthrow(mtmp, LASER_BEAM, 50);
		}
		if (ptr == &mons[PM_RAY_TURRET]) {
		  	(void) mongets(mtmp, RAYGUN);
		  	m_initthrow(mtmp, RAYGUN_BOLT, 50);
		}
		if (ptr == &mons[PM_ATOMIC_TURRET]) {
		  	(void) mongets(mtmp, BFG);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		  	m_initthrow(mtmp, BFG_AMMO, 50);
		}

		if (ptr == &mons[PM_DART_TURRET]) m_initthrow(mtmp, DART, 35);
		if (ptr == &mons[PM_NINJA_TURRET]) m_initthrow(mtmp, SHURIKEN, 50);

		break;

	    case S_EEL:

		if (ptr == &mons[PM_CRYSTAL_FISH]) (void)mongets(mtmp, SCR_CRYSTALLIZATION);
		if (ptr == &mons[PM_FLOWER_CORAL]) (void)mongets(mtmp, SPEAR);
		if (ptr == &mons[PM_BAY_CORAL]) (void)mongets(mtmp, SPEAR);
		if (ptr == &mons[PM_WHIP_SHARK]) (void)mongets(mtmp, BULLWHIP);
		if (ptr == &mons[PM_ASITEAN]) (void)mongets(mtmp, BAMBOO_SPEAR);
		if (ptr == &mons[PM_BARNAMUSSLE]) (void)mongets(mtmp, BARNACLE_ARMOR);
		if (ptr == &mons[PM_CLOTHED_WATER_PEOPLE]) (void)mongets(mtmp, GIANT_SEA_ANEMONE);
		if (ptr == &mons[PM_WEALTHY_ATLANTEAN]) (void)mongets(mtmp, GIANT_SEA_ANEMONE);
		if (ptr == &mons[PM_FIRST_MATE]) (void)mongets(mtmp, GIANT_SEA_ANEMONE);
		if (ptr == &mons[PM_POKEMON_RESELLER]) (void)mongets(mtmp, GIANT_SEA_ANEMONE);
		if (ptr == &mons[PM_SCALEFISH]) (void)mongets(mtmp, FISH_SCALE_MAIL);
		if (ptr == &mons[PM_THICKFISH]) (void)mongets(mtmp, FISH_SCALE_MAIL);
		if (ptr == &mons[PM_STEALTH_FISH]) (void)mongets(mtmp, CAMO_QATAR);
		if (ptr == &mons[PM_POSEIDONIC_ATLANTEAN]) (void)mongets(mtmp, LASERDENT);
		if (ptr == &mons[PM_AVENGERIC_ATLANTEAN]) (void)mongets(mtmp, LASERDENT);
		if (ptr == &mons[PM_GRACHTELS_WHALE]) (void)mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */

		if (ptr == &mons[PM_REVOLUTINO_MARI]) {
			(void)mongets(mtmp, BASTERD_SWORD);
			(void)mongets(mtmp, COMBAT_STILETTOS);
		}
		if (ptr == &mons[PM_BONING_EEL]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, BONE_FRAGMENT, 30);
		}
		if (ptr == &mons[PM_SIEGE_CANNON]) {
			(void) mongets(mtmp, SNIPER_RIFLE);
			 m_initthrow(mtmp, SNIPER_BULLET, 50);
			 m_initthrow(mtmp, SNIPER_BULLET, 50);
		}
		if (ptr == &mons[PM_SKILLFISH]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SLING_AMMO, 40);
		}
		if (ptr == &mons[PM_LEAD_FISH]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, LEAD_CLUMP, 40);
		}

		if (ptr == &mons[PM_FRESHWATER_GIRL]) {
			(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
			(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		}
		if (ptr == &mons[PM_SALTWATER_FISH]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SALT_CHUNK, 40);
		}
		if (ptr == &mons[PM_OPEN_SEA_FISH]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SALT_CHUNK, 40);
		}
		if (ptr == &mons[PM_SILVERFISH]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, SILVER_SPEAR);
			(void) mongets(mtmp, SILVER_MACE);
			(void) mongets(mtmp, SILVER_SHIELD);
			 m_initthrow(mtmp, SILVER_SLINGSTONE, 50);
		}
		if (ptr == &mons[PM_REFLECTORFISH]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, SILVER_SPEAR);
			(void) mongets(mtmp, SILVER_MACE);
			(void) mongets(mtmp, SILVER_SHIELD);
			 m_initthrow(mtmp, SILVER_SLINGSTONE, 50);
		}
		if (ptr == &mons[PM_EKROFISH]) {
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, SMALL_SHIELD);

		}
		if (ptr == &mons[PM_SHELBY]) {
			(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void) mongets(mtmp, INKA_SHACKLE);
			(void) mongets(mtmp, CLOAK_OF_MAGIC_RESISTANCE);

		}

		if (ptr == &mons[PM_LASER_SHARK]) {
			(void) mongets(mtmp, HAND_BLASTER);
	  		m_initthrow(mtmp, BLASTER_BOLT, 40);
		}
		if (ptr == &mons[PM_STARWARS_SHARK]) {
			(void) mongets(mtmp, ARM_BLASTER);
	  		m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
	  		m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		}

		if (ptr == &mons[PM_POOR_FISH]) {
			(void) mongets(mtmp, FLINTLOCK);
	  		m_initthrow(mtmp, LEAD_PISTOL_BULLET, 20);
		}
		if (ptr == &mons[PM_DROPLET_INFECTION_FISH]) {
			(void) mongets(mtmp, CROSSBOW);
	  		m_initthrow(mtmp, POISON_BOLT, 40);
		}

		if (ptr == &mons[PM_FLINTFISH]) {
			(void) mongets(mtmp, FLINTLOCK);
	  		m_initthrow(mtmp, PISTOL_BULLET, 20);
		}

		if (ptr == &mons[PM_SNIPE_HERMIT]) {
			(void) mongets(mtmp, SNIPER_RIFLE);
	  		m_initthrow(mtmp, SNIPER_BULLET, 50);
		}
		if (ptr == &mons[PM_HECK_HERMIT]) {
			(void) mongets(mtmp, SNIPER_RIFLE);
	  		m_initthrow(mtmp, SNIPER_BULLET, 50);
		}

		if (ptr == &mons[PM_CUTTERFISH]) {
			(void) mongets(mtmp, CUTTING_LASER);
	  		m_initthrow(mtmp, LASER_BEAM, 50);
		}

		if (ptr == &mons[PM_ANNOYING_FISH]) {
	  		m_initthrow(mtmp, CALTROP, 50);
		}

		if (ptr == &mons[PM_CATFISH]) {
			(void) mongets(mtmp, CATAPULT);
	  		m_initthrow(mtmp, ROCK, 50);
	  		m_initthrow(mtmp, ROCK, 50);
	  		m_initthrow(mtmp, ROCK, 50);
		}

		if (ptr == &mons[PM_VERY_ANNOYING_FISH]) {
	  		m_initthrow(mtmp, SPIKE, 50);
	  		m_initthrow(mtmp, SPIKE, 50);
		}

		if (ptr == &mons[PM_EXTREMELY_ANNOYING_FISH]) {
	  		m_initthrow(mtmp, NEEDLE, 50);
	  		m_initthrow(mtmp, NEEDLE, 50);
	  		m_initthrow(mtmp, NEEDLE, 50);
	  		m_initthrow(mtmp, NEEDLE, 50);
		}

		if (ptr == &mons[PM_GREEK_FISH]) {
			(void) mongets(mtmp, HELO_CROSSBOW);
	  		m_initthrow(mtmp, CROSSBOW_BOLT, 50);
	  		m_initthrow(mtmp, CROSSBOW_BOLT, 25);
		}

		if (ptr == &mons[PM_SOLDIER_STINKER]) 

			{
			  (void) mongets(mtmp, SUBMACHINE_GUN);
		  	  m_initthrow(mtmp, SMG_BULLET, 25);
		  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  (void) mongets(mtmp, DAGGER);
			  (void) mongets(mtmp, FRAG_GRENADE);
			}

		if (ptr == &mons[PM_BATTLE_TANK]) 

			{
			  (void) mongets(mtmp, HEAVY_MACHINE_GUN);
		  	  m_initthrow(mtmp, MG_BULLET, 25);
		  	  m_initthrow(mtmp, MG_BULLET, 25);
		  	  m_initthrow(mtmp, MG_BULLET, 25);
		  	  m_initthrow(mtmp, MG_BULLET, 25);
			  (void) mongets(mtmp, JAGGED_STAR);
			}

		if (ptr == &mons[PM_LIVING_CANNON]) 

			{
			  (void) mongets(mtmp, ROCKET_LAUNCHER);
		  	  m_initthrow(mtmp, ROCKET, 5);
			  (void) mongets(mtmp, MALLET);
			}

		break;

	    case S_WRAITH:
	    if (!rn2(2)) (void)mongets(mtmp, ROBE);

		if (mtmp->data == &mons[PM_BROWN_FEMMY]) (void) mongets(mtmp, DANCING_SHOES);
		if (mtmp->data == &mons[PM_CORONA_WRAITH]) (void) mongets(mtmp, POT_INVISIBILITY);
		if (mtmp->data == &mons[PM_WANG_OF_DEATH]) (void) mongets(mtmp, WAN_DEATH);
		if (mtmp->data == &mons[PM_CLANG_CLANG]) (void) mongets(mtmp, IRON_CHAIN);
		if (mtmp->data == &mons[PM_ANTI_COVID_FIGHTER]) (void) mongets(mtmp, POISON_REPELLANT_ARMOR);
		if (mtmp->data == &mons[PM_STEEL_WRAITH]) (void) mongets(mtmp, WRAITHBLADE);
		if (mtmp->data == &mons[PM_JAYCEE]) (void) mongets(mtmp, RAZOR_WHIP);
		if (mtmp->data == &mons[PM_WASHING_WOMAN]) (void) mongets(mtmp, DENTED_POT);
		if (mtmp->data == &mons[PM_DARKHORN_WRAITH]) (void) mongets(mtmp, DARK_HORN);
		if (mtmp->data == &mons[PM_BELLY_NAVEL_PIERCED_GIRL]) (void) mongets(mtmp, VICTORIAN_UNDERWEAR);
		if (mtmp->data == &mons[PM_RUSSIAN_FEMMY]) (void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

		if (ptr == &mons[PM_FLINGER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SLING_AMMO, 50);
		}

		if (ptr == &mons[PM_SHAMBLE_FLING]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, LEATHER_ARMOR);
			(void) mongets(mtmp, SNEAKERS);
			 m_initthrow(mtmp, TALC, 10);
		}
		if (ptr == &mons[PM_VOLCALINGER]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, SPLINT_MAIL);
			 m_initthrow(mtmp, VOLCANIC_GLASS_FRAGMENT, 50);
		}

		if (ptr == &mons[PM_DRESS_WIGHT]) {
			(void) mongets(mtmp, ELEGANT_BROADSWORD);
			(void) mongets(mtmp, VICTORIAN_UNDERWEAR);
			(void) mongets(mtmp, KITCHEN_APRON);
		}

		if (ptr == &mons[PM_SOPHIA_S_HIGH_HEELED_LADY_S_SHOE]) { (void)mongets(mtmp, COMBAT_STILETTOS); (void)mongets(mtmp, SPIKED_BATTLE_BOOT); }

		if (ptr == &mons[PM_NAZGUL]) {
			otmp = mksobj(RIN_INVISIBILITY, FALSE, FALSE, FALSE);
			if (otmp) {
				curse(otmp);
				(void) mpickobj(mtmp, otmp, TRUE);
			}
		}
		if (ptr == &mons[PM_WOODICLOUDY]) (void)mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */

		if (ptr == &mons[PM_BLEACH_GHOST]) m_initthrow(mtmp, CALTROP, 50);
		if (ptr == &mons[PM_SERBIAN_BOSS]) (void)mongets(mtmp, SWEET_MOCASSINS);
		if (ptr == &mons[PM_GLAMOUR_HC_BITCH]) (void)mongets(mtmp, LEATHER_PEEP_TOES);
		if (ptr == &mons[PM_SWARMING_GIRL]) (void)mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		if (ptr == &mons[PM_GENTLE_GIRL]) (void)mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

		if (ptr == &mons[PM_SWIGHT]) (void)mongets(mtmp, BROADSWORD);
		if (ptr == &mons[PM_REAL_TUNNEL_WIGHT]) (void)mongets(mtmp, PICK_AXE);
		if (ptr == &mons[PM_WREAPUS]) (void)mongets(mtmp, SHIELD);
		if (ptr == &mons[PM_POLEGUL]) (void)mongets(mtmp, RANSEUR);
		if (ptr == &mons[PM_BANE_WIGHT]) {
			(void)mongets(mtmp, BOW);
			(void)mongets(mtmp, ORCISH_HELM);
	  		m_initthrow(mtmp, ARROW, 30);
		}
		if (ptr == &mons[PM_WERIPON_WIGHT]) {
			(void)mongets(mtmp, SLING);
			(void)mongets(mtmp, ORCISH_HELM);
	  		m_initthrow(mtmp, FLINT, 50);
	  		m_initthrow(mtmp, SILK_SPEAR, 5);
		}
		if (ptr == &mons[PM_SUMP_WIGHT]) {
			(void)mongets(mtmp, ELVEN_LANCE);
			(void)mongets(mtmp, ELVEN_SHIELD);
			(void)mongets(mtmp, ELVEN_LEATHER_HELM);
	  		m_initthrow(mtmp, ELVEN_SPEAR, 5);
		}
		if (ptr == &mons[PM_MESO_WIGHT]) {
			(void)mongets(mtmp, PIKE);
			(void)mongets(mtmp, ORCISH_HELM);
	  		m_initthrow(mtmp, INKA_SPEAR, 5);
		}

		break;

	    case S_ORC:

		if (mtmp->data == &mons[PM_PILL_ORC]) (void) mongets(mtmp, PILL);
		if (mtmp->data == &mons[PM_DIGORC]) (void) mongets(mtmp, PICK_AXE);
		if (mtmp->data == &mons[PM_PILL_GOBLIN]) (void) mongets(mtmp, PILL);
		if (mtmp->data == &mons[PM_OPHTHALMOCTOR]) (void) mongets(mtmp, STETHOSCOPE);
		if (mtmp->data == &mons[PM_CHROME_CAPTAIN]) (void) mongets(mtmp, CHROME_BLADE);
		if (mtmp->data == &mons[PM_SHINE_CULTIST]) (void) mongets(mtmp, SHINY_STAR);
		if (mtmp->data == &mons[PM_SPEAR_ORC]) (void) mongets(mtmp, ORCISH_SPEAR);
		if (mtmp->data == &mons[PM_ORC_SPEAR_CARRIER]) (void) mongets(mtmp, ORCISH_SPEAR);
		if (mtmp->data == &mons[PM_ORC_ANTI_CAVALRY]) (void) mongets(mtmp, rnd_class(PARTISAN,BEC_DE_CORBIN));

		if (ptr == &mons[PM_DARKLAND_ORC]) {
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, ORCISH_ARROW, 40);
		}
		if (ptr == &mons[PM_COCKGANGER_ORC]) {
			(void) mongets(mtmp, ORCISH_SPEAR);
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, AMBER_FRAGMENT, 25);
		}
		if (ptr == &mons[PM_ORC_SPEARSTOPPER]) {
			(void) mongets(mtmp, ORCISH_SPEAR);
			 m_initthrow(mtmp, ORCISH_SPEAR, 5);
		}
		if (ptr == &mons[PM_SPEARTHROW_ORC]) {
			 m_initthrow(mtmp, ORCISH_SPEAR, 5);
		}
		if (ptr == &mons[PM_ORC_TOSSER]) {
			 m_initthrow(mtmp, ORCISH_SPEAR, 8);
		}
		if (ptr == &mons[PM_ORC_SPEAR_RUNNER]) {
			 m_initthrow(mtmp, ORCISH_SPEAR, 10);
		}
		if (ptr == &mons[PM_GREY_SENTAI]) {
			 m_initthrow(mtmp, ORCISH_SPEAR, 7);
		}
		if (ptr == &mons[PM_ORC_SOLDIER]) {
			(void) mongets(mtmp, ORCISH_DAGGER);
			(void) mongets(mtmp, ORCISH_SHORT_SWORD);
			 m_initthrow(mtmp, ORCISH_SPEAR, 8);
		}
		if (ptr == &mons[PM_ORC_ARMY_MEMBER]) {
			(void) mongets(mtmp, ORCISH_DAGGER);
			(void) mongets(mtmp, ORCISH_SHORT_SWORD);
			 m_initthrow(mtmp, ORCISH_SPEAR, 8);
		}
		if (ptr == &mons[PM_SPEARSNIPE_ORC]) {
			 m_initthrow(mtmp, ORCISH_SPEAR, 5);
		}
		if (ptr == &mons[PM_ORC_BALLERER]) {
			 m_initthrow(mtmp, ORCISH_SPEAR, 5);
		}
		if (ptr == &mons[PM_DEADMAN_ORC]) {
			(void) mongets(mtmp, ORCISH_BOW);
			 m_initthrow(mtmp, BONE_ARROW, 30);
		}
		if (ptr == &mons[PM_ORC_CAMO_TROOP]) {
			(void) mongets(mtmp, ORCISH_SPEAR);
			(void) mongets(mtmp, ORCISH_BOW);
			 m_initthrow(mtmp, ORCISH_ARROW, 30);
		}
		if (ptr == &mons[PM_DEADMAN_SNIPORC]) {
			(void) mongets(mtmp, ORCISH_BOW);
			 m_initthrow(mtmp, BONE_ARROW, 30);
		}
		if (ptr == &mons[PM_DEADMAN_SENTAI]) {
			(void) mongets(mtmp, ORCISH_BOW);
			 m_initthrow(mtmp, BONE_ARROW, 30);
		}
		if (ptr == &mons[PM_ORC_ARCHER]) {
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, ORCISH_ARROW, 20);
		}
		if (ptr == &mons[PM_ORC_MARKSMAN]) {
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, ORCISH_ARROW, 30);
		}
		if (ptr == &mons[PM_ORC_LIGHTFOOT]) {
			(void) mongets(mtmp, BOW);
			(void) mongets(mtmp, ORCISH_DAGGER);
			 m_initthrow(mtmp, ORCISH_ARROW, 30);
		}
		if (ptr == &mons[PM_ORC_SHOOTER]) {
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, ORCISH_ARROW, 40);
		}
		if (ptr == &mons[PM_ORC_RINGTHIEF]) {
			(void) mongets(mtmp, BOW);
			(void) mongets(mtmp, ORCISH_RING_MAIL);
			(void) mongets(mtmp, ORCISH_SHORT_SWORD);
			 m_initthrow(mtmp, ORCISH_ARROW, 40);
		}
		if (ptr == &mons[PM_CRUDE_GOBLIN]) {
			(void) mongets(mtmp, TRASH_SWORD);
		}
		if (ptr == &mons[PM_BITCHORCAIUZ_OF_SCREWORCTOWNIS]) {
			(void) mongets(mtmp, ORCISH_BOW);
			 m_initthrow(mtmp, ORCISH_ARROW, 50);
			 m_initthrow(mtmp, ORCISH_ARROW, 50);
		}
		if (ptr == &mons[PM_YEEK_ARCHER]) {
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, ARROW, 10);
		}
		if (ptr == &mons[PM_ARCHAYEEK]) {
			(void) mongets(mtmp, SPEAR);
		}
		if (ptr == &mons[PM_ARCHAYEEK_GUNNER]) {
			(void) mongets(mtmp, PISTOL);
			 m_initthrow(mtmp, PISTOL_BULLET, 25);
		}
		if (ptr == &mons[PM_DWELL_ORC]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, ROCK, 30);
		}
		if (ptr == &mons[PM_UNCOOL_GOBLIN]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, BAR_CHAIN_MAIL);
			 m_initthrow(mtmp, TALC, 20);
		}
		if (ptr == &mons[PM_SCRIBBLE_SENTAI]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, ANTENNA);
			 m_initthrow(mtmp, GRAPHITE, 30);
		}
		if (ptr == &mons[PM_ORC_MITHRAR]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, RHYTHMIC_STAR);
			(void) mongets(mtmp, HIGH_ELVEN_HELM);
			(void) mongets(mtmp, MEDIUM_MITHRIL_COAT);
			 m_initthrow(mtmp, SMALL_PIECE_OF_UNREFINED_MITHR, 50);
		}
		if (ptr == &mons[PM_COOL_GOBLIN]) {
			(void) mongets(mtmp, SHORT_BLADE);
			(void) mongets(mtmp, ORCISH_HELM);
		}
		if (ptr == &mons[PM_ISENGARD_SUPPLIER]) {
			(void) mongets(mtmp, SHORT_BLADE);
			(void) mongets(mtmp, MEDIUM_MITHRIL_COAT);
			(void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		}
		if (ptr == &mons[PM_RANDORGE_ORC]) {
	  		m_initthrow(mtmp, RANDOSPEAR, 5);
		}

		if (ptr == &mons[PM_FAM_SENTAI]) {
			(void) mongets(mtmp, FLINTLOCK);
	  		m_initthrow(mtmp, LEAD_PISTOL_BULLET, 20);
		}
		if (ptr == &mons[PM_GOO_HOBGOBLIN]) {
			(void) mongets(mtmp, COLOR_CONE);
	  		m_initthrow(mtmp, WONDER_DAGGER, 3);
		}
		if (ptr == &mons[PM_DESU_SENTAI]) {
			(void) mongets(mtmp, FLINTLOCK);
	  		m_initthrow(mtmp, PISTOL_BULLET, 20);
		}
		if (ptr == &mons[PM_BANG_SENTAI]) {
			(void) mongets(mtmp, SHOTGUN);
			 m_initthrow(mtmp, LEAD_SHOT, 25);
		}
		if (ptr == &mons[PM_CORPSE_LOOTER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, BONE_FRAGMENT, 30);
		}
		if (ptr == &mons[PM_ORC_KITTER]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, MEDIUM_MITHRIL_COAT);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, SMALL_SHIELD);
			 m_initthrow(mtmp, SLING_AMMO, 40);
		}
		if (ptr == &mons[PM_ORC_WONDERER]) {
			(void) mongets(mtmp, RAPIRAPI);
			(void) mongets(mtmp, MECHA_IRAZU);
			 m_initthrow(mtmp, UNKNOWN_KNIFE, 5);
			 m_initthrow(mtmp, WONDER_DAGGER, 5);
		}
		if (ptr == &mons[PM_SAMURUKHAI]) {
			(void) mongets(mtmp, ELVEN_CLOAK);
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, ORCISH_SHIELD);
			(void) mongets(mtmp, ELVEN_DAGGER);
			(void) mongets(mtmp, LOW_BOOTS);
		}
		if (ptr == &mons[PM_ORCHAEALOGIST]) {
			(void) mongets(mtmp, WAN_DIGGING);
			(void) mongets(mtmp, PICK_AXE);
		}
		if (ptr == &mons[PM_ORC_SCIENTIST]) {
			(void) mongets(mtmp, WAN_DIGGING);
			(void) mongets(mtmp, PICK_AXE);
		}

		if (ptr == &mons[PM_GOBLIN_WOARER]) {
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		}

		if (ptr == &mons[PM_BORC]) {
			(void) mongets(mtmp, BOW);
	  		m_initthrow(mtmp, ARROW, 25);
		}
		if (ptr == &mons[PM_DIE_HAVER]) {
			(void) mongets(mtmp, BOW);
	  		m_initthrow(mtmp, ARROW, 50);
		}
		if (ptr == &mons[PM_URUTRACTOR]) {
			(void) mongets(mtmp, CROSSBOW);
	  		m_initthrow(mtmp, CROSSBOW_BOLT, 40);
		}
		if (ptr == &mons[PM_SLINGING_OVAL]) {
			(void) mongets(mtmp, SLING);
	  		m_initthrow(mtmp, ROCK, 35);
		}
		if (ptr == &mons[PM_TOTES_SENTAI]) {
			(void) mongets(mtmp, SHOTGUN);
	  		m_initthrow(mtmp, SHOTGUN_SHELL, 25);
		}
		if (ptr == &mons[PM_LASER_SENTAI]) {
			(void) mongets(mtmp, HAND_BLASTER);
	  		m_initthrow(mtmp, BLASTER_BOLT, 35);
		}
		if (ptr == &mons[PM_GAY_SENTAI]) {
			(void) mongets(mtmp, CROSSBOW);
	  		m_initthrow(mtmp, CROSSBOW_BOLT, 45);
		}
		if (ptr == &mons[PM_FINTH_SENTAI]) {
			(void) mongets(mtmp, SLING);
	  		m_initthrow(mtmp, FLINT, 40);
			(void) mongets(mtmp, TARRIER);
			(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
			(void) mongets(mtmp, COMMANDER_GLOVES);
			(void) mongets(mtmp, STRAW_HAT);
			(void) mongets(mtmp, PLASTEEL_CLOAK);
		}
		if (ptr == &mons[PM_POWL_ORC]) {
			(void) mongets(mtmp, FAUCHARD);
		}
		if (ptr == &mons[PM_GOBLIN_STAFFER]) {
			(void) mongets(mtmp, QUARTERSTAFF);
		}
		if (ptr == &mons[PM_ORC_STAFFER]) {
			(void) mongets(mtmp, QUARTERSTAFF);
		}

		if (ptr == &mons[PM_GOBLIN_DART_THROWER]) {
	  		m_initthrow(mtmp, DART, 35);
		}
		if (ptr == &mons[PM_GOBLIN_RANDARTER]) {
	  		m_initthrow(mtmp, RANDOM_DART, 40);
		}
		if (ptr == &mons[PM_DAGGING_HOBGOBLIN]) {
	  		m_initthrow(mtmp, DAGGER, 3);
		}
		if (ptr == &mons[PM_CURVED_ALIEN]) {
	  		m_initthrow(mtmp, KNIFE, 4);
		}
		if (ptr == &mons[PM_SPURIOUS_ORC]) {
	  		m_initthrow(mtmp, SPEAR, 5);
		}
		if (ptr == &mons[PM_SLITTER_ORC]) {
	  		m_initthrow(mtmp, SHURIKEN, 50);
		}

		if (ptr == &mons[PM_GOBLIN_GRENADIER]) {
	  		m_initthrow(mtmp, FRAG_GRENADE, 10);
		}

		if (mtmp->data == &mons[PM_HC_PSEUDOLADY]) (void) mongets(mtmp, SWEET_MOCASSINS);

		if (mtmp->data == &mons[PM_LEATHER_DOMINATOR_ORC_BOSS]) (void) mongets(mtmp, BULLWHIP);
		if (mtmp->data == &mons[PM_CLUBBELGOBLIN]) (void) mongets(mtmp, CLUB);

		if (mtmp->data == &mons[PM_WIDE_SENTAI]) (void) mongets(mtmp, TRIDENT);

		if (mtmp->data == &mons[PM_ARMORC]) {
			(void) mongets(mtmp, SCALE_MAIL);
			(void) mongets(mtmp, HIGH_BOOTS);
			(void) mongets(mtmp, SHORT_SWORD);
		}

		if (mtmp->data == &mons[PM_DEEP_ARMORC]) {
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, HIGH_BOOTS);
			(void) mongets(mtmp, BROADSWORD);
		}

		if (mtmp->data == &mons[PM_GREAT_ARMORC]) {
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, HIGH_BOOTS);
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, MACE);
		}

		if (mtmp->data == &mons[PM_BLUE_GOBLIN]) {
			(void) mongets(mtmp, SILK_MAIL);
			(void) mongets(mtmp, QUARTERSTAFF);
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, LEATHER_GLOVES);
		}

		if (mtmp->data == &mons[PM_COLORED_ORC]) {
			(void) mongets(mtmp, BANDED_MAIL);
			(void) mongets(mtmp, WAR_HAMMER);
	  		m_initthrow(mtmp, SHURIKEN, 30);
		}

		if (mtmp->data == &mons[PM_ORC_BELLER]) {
			(void) mongets(mtmp, ORCISH_SHIELD);
			(void) mongets(mtmp, SKULLCAP);
	  		m_initthrow(mtmp, KNIFE, 5);
	  		m_initthrow(mtmp, DAGGER, 5);
		}

		if (mtmp->data == &mons[PM_FIERY_SENTAI]) {
			(void) mongets(mtmp, BANDED_MAIL);
			(void) mongets(mtmp, FLAIL);
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, BOW);
	  		m_initthrow(mtmp, DART, 40);
	  		m_initthrow(mtmp, ARROW, 30);
		}

		if (ptr == &mons[PM_SMUT_ORC]) {
			if (!rn2(3)) (void) mongets(mtmp, WAN_SUMMON_SEXY_GIRL);
			else if (!rn2(2)) (void) mongets(mtmp, SCR_GIRLINESS);
			else 	(void) maketrap(mtmp->mx, mtmp->my, rn2(2) ? FART_TRAP : HEEL_TRAP, 0, TRUE);
		}
		break;

	    case S_NEMESE:
		if (mtmp->data == &mons[PM_NEMESIS]) (void) mongets(mtmp, TRIDENT);
		break;

	    case S_FLYFISH:

		if (mtmp->data == &mons[PM_FLYSH_EEL]) (void) mongets(mtmp, SCR_DIVING);
		if (mtmp->data == &mons[PM_MUMMY_FISH]) (void) mongets(mtmp, MUMMY_WRAPPING);
		if (mtmp->data == &mons[PM_CHICKMAGNET]) (void) mongets(mtmp, GRINDER);
		if (mtmp->data == &mons[PM_ALGAE_HAIR]) (void) mongets(mtmp, GRINDER);
		if (mtmp->data == &mons[PM_HOLLANDIC_FEMMY]) (void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_FLYING_STEALTH_FISH]) (void) mongets(mtmp, CAMO_QATAR);
		if (mtmp->data == &mons[PM_ANOREXIC_FEMMY]) (void) mongets(mtmp, HUGGING_BOOT);
		if (mtmp->data == &mons[PM_UTE_S_PEEP_TOE]) (void) mongets(mtmp, LEATHER_PEEP_TOES);
		if (mtmp->data == &mons[PM_UTE_S_SEXY_HIGH_HEELED_SANDAL]) (void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */

		if (mtmp->data == &mons[PM_ANNE_S_SNEAKER]) {
			(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
			(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		}
		if (ptr == &mons[PM_DEEP_SLEEP_VARIANT]) {
			(void) mongets(mtmp, POT_SLEEPING);
			(void) mongets(mtmp, POT_SLEEPING);
		}
		if (ptr == &mons[PM_MYSTERY_COMPENDIUM]) {
			(void) mongets(mtmp, POT_SLEEPING);
			(void) mongets(mtmp, POT_SLEEPING);
		}
		if (ptr == &mons[PM_GREEN_SUPPLIER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, TALC, 10);
		}
		if (ptr == &mons[PM_WOODWIELDER]) {
			 m_initthrow(mtmp, BAMBOO_SPEAR, 8);
		}
		if (ptr == &mons[PM_SEA_FALLEN_ANGEL]) {
			 m_initthrow(mtmp, FRAG_GRENADE, 15);
		}
		if (ptr == &mons[PM_MARE_FALLEN_ANGEL]) {
			 m_initthrow(mtmp, FRAG_GRENADE, 15);
		}
		if (ptr == &mons[PM_BLACK_SUPPLIER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, GRAPHITE, 15);
		}
		if (ptr == &mons[PM_BLUE_SUPPLIER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SMALL_PIECE_OF_UNREFINED_MITHR, 25);
		}
		if (ptr == &mons[PM_SILVER_SUPPLIER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SILVER_SLINGSTONE, 40);
		}

		if (mtmp->data == &mons[PM_ROXY]) {
			(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
			(void) mongets(mtmp, CROSSBOW);
			m_initthrow(mtmp, CROSSBOW_BOLT, 50);
			m_initthrow(mtmp, CROSSBOW_BOLT, 50);
		}

		if (mtmp->data == &mons[PM_CAPTAIN_SHARK]) {
			m_initthrow(mtmp, FRAG_GRENADE, 25);
		}
		if (mtmp->data == &mons[PM_RAYFISH]) {
			(void) mongets(mtmp, RAYGUN);
			m_initthrow(mtmp, RAYGUN_BOLT, 40);
			m_initthrow(mtmp, RAYGUN_BOLT, 40);
		}

		if (mtmp->data == &mons[PM_SAILOR_SHARK]) {
			m_initthrow(mtmp, FRAG_GRENADE, 25);
		}
		if (mtmp->data == &mons[PM_DARTFISH]) {
			m_initthrow(mtmp, DART, 35);
		}
		if (mtmp->data == &mons[PM_RUNLOSS_FISH]) {
			m_initthrow(mtmp, RANDOM_DART, 35);
		}

		if (mtmp->data == &mons[PM_GUNFISH]) {
			(void) mongets(mtmp, HAND_BLASTER);
			m_initthrow(mtmp, BLASTER_BOLT, 20);
		}

		if (mtmp->data == &mons[PM_DARK_FORCE_GIRL]) {
			(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		}

		if (ptr == &mons[PM_FLYING_HYDRA]) {
			(void) mongets(mtmp, HYDRA_BOW);
			m_initthrow(mtmp, ANCIENT_ARROW, 50);
			m_initthrow(mtmp, GOLDEN_ARROW, 50);
		}

		break;

	    case S_LICH:

		if (mtmp->data == &mons[PM_SUESCHEN_S_COMBAT_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */

		if (ptr == &mons[PM_EAGLE_LICH]) (void) mongets(mtmp, EAGLE_BALL);
		if (ptr == &mons[PM_JARED_LICH]) (void) mongets(mtmp, JARED_STONE);
		if (ptr == &mons[PM_LIGHTLICH]) (void) mongets(mtmp, LIGHTBULB);
		if (ptr == &mons[PM_HEATH_LICH]) (void) mongets(mtmp, HEATH_BALL);
		if (ptr == &mons[PM_PORT_LUNA]) (void) mongets(mtmp, SCR_RAIN);
		if (ptr == &mons[PM_ACIDER_LICH]) (void) mongets(mtmp, WAN_ACID);
		if (ptr == &mons[PM_ELUSIVE_LICH]) (void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if (ishaxor && ptr == &mons[PM_ELUSIVE_LICH]) (void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if (ptr == &mons[PM_ORE_LICH]) (void) mongets(mtmp, WAN_SUMMON_UNDEAD);
		if (ptr == &mons[PM_MIKSCXIFONA]) (void) mongets(mtmp, SCYTHE);
		if (ptr == &mons[PM_FLASHLIGHT_QUEEN]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (ptr == &mons[PM_CLICK_QUEEN]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (ptr == &mons[PM_PROFANITY_PRIEST]) (void) mongets(mtmp, SCYTHE);
		if (ptr == &mons[PM_L_S_BELLS]) (void) mongets(mtmp, BELL);
		if (ptr == &mons[PM_HARDFOUGHT_LYNCH_MOB_MEMBER]) (void) mongets(mtmp, PITCHFORK);

		if (ptr == &mons[PM_ELLA_THE_FEMINIST]) {
			(void)mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
			(void)mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		}

		if (ptr == &mons[PM_MESSENGER_OF_DEATH]) {
			(void) mongets(mtmp, SCYTHE);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, FLINT, 40);
		}
		if (ptr == &mons[PM_GREEN_REAPER]) {
			(void) mongets(mtmp, SCYTHE);
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, FLINT, 40);
		}
		if (ptr == &mons[PM_REAPERSAN]) {
			(void) mongets(mtmp, SCYTHE);
		}
		if (ptr == &mons[PM_DIRTY_FEMMY]) {
			(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		}

		if (ptr == &mons[PM_SILVER_LICH]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, SILVER_SABER);
			(void) mongets(mtmp, SILVER_SHIELD);
			 m_initthrow(mtmp, SILVER_SLINGSTONE, 40);
		}

		if (ptr == &mons[PM_LEAD_LICH]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, HEAVY_LONG_SWORD);
			 m_initthrow(mtmp, LEAD_CLUMP, 50);
			 m_initthrow(mtmp, LEAD_CLUMP, 50);
		}
		if (ptr == &mons[PM_BASIN_LICH]) {
			(void) mongets(mtmp, BASINET);
			(void) mongets(mtmp, ASSAULT_RIFLE);
			(void) mongets(mtmp, BRONZE_PLATE_MAIL);
			 m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 50);
		}
		if (ptr == &mons[PM_LIVE_KNIGHT]) {
			(void) mongets(mtmp, HEAVY_LONG_SWORD);
			(void) mongets(mtmp, BANDED_MAIL);
			(void) mongets(mtmp, MUMMY_WRAPPING);
			(void) mongets(mtmp, CROWN);
			(void) mongets(mtmp, FIELD_GLOVES);
			(void) mongets(mtmp, HEAVY_SHIELD);
			(void) mongets(mtmp, CRYSTAL_BOOTS);
		}

		if (ptr == &mons[PM_YICH]) (void) mongets(mtmp, YITH_TENTACLE);
		if (ptr == &mons[PM_SWORD_LICH]) (void) mongets(mtmp, SHORT_SWORD);
		if (ptr == &mons[PM_STARLICH]) (void) mongets(mtmp, MORNING_STAR);
		if (ptr == &mons[PM_HELMLICH]) {
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, CROSSBOW);
			m_initthrow(mtmp, CROSSBOW_BOLT, 50);
		}
		if (ptr == &mons[PM_KNIFE_LICH]) {
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, KNIFE);
			m_initthrow(mtmp, KNIFE, 5);
		}
		if (ptr == &mons[PM_POLICH]) {
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, GUISARME);
			(void) mongets(mtmp, PLATE_MAIL);
		}
		if (ptr == &mons[PM_WHIPLICH]) {
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, CHAINWHIP);
			(void) mongets(mtmp, ELVEN_CLOAK);
			(void) mongets(mtmp, CRYSTAL_PLATE_MAIL);
		}
		if (ptr == &mons[PM_AXLICH]) {
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, AXE);
			(void) mongets(mtmp, ICKY_SHIELD);
			(void) mongets(mtmp, ELVEN_CLOAK);
			(void) mongets(mtmp, PARTIAL_PLATE_MAIL);
		}
		if (ptr == &mons[PM_DOUBLE_HAND_LICH]) {
			(void) mongets(mtmp, TWO_HANDED_SWORD);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, HIGH_BOOTS);
			(void) mongets(mtmp, ELVEN_CLOAK);
			(void) mongets(mtmp, PLATE_MAIL);
		}
		if (ptr == &mons[PM_LONG_LICH]) {
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, LEATHER_GLOVES);
			(void) mongets(mtmp, LONG_SWORD);
			(void) mongets(mtmp, LEATHER_CLOAK);
			(void) mongets(mtmp, BANDED_MAIL);
		}
		if (ptr == &mons[PM_BROAD_LICH]) {
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, LEATHER_GLOVES);
			(void) mongets(mtmp, BROADSWORD);
			(void) mongets(mtmp, URUK_HAI_SHIELD);
			(void) mongets(mtmp, BANDED_MAIL);
		}
		if (ptr == &mons[PM_DAGICH]) {
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, DAGGER);
			(void) mongets(mtmp, LARGE_SHIELD);
			(void) mongets(mtmp, SPLINT_MAIL);
			m_initthrow(mtmp, DAGGER, 10);
		}
		if (ptr == &mons[PM_HAMMER_LICH]) {
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, WAR_HAMMER);
			(void) mongets(mtmp, SHIELD);
			(void) mongets(mtmp, RED_DRAGON_SCALES);
		}
		if (ptr == &mons[PM_SPEAR_LICH]) {
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, SPEAR);
			m_initthrow(mtmp, SPEAR, 5);
		}
		if (ptr == &mons[PM_BOW_LICH]) {
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, SPLINT_MAIL);
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 50);
		}
		if (ptr == &mons[PM_JAVA_LICH]) {
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, PAPER_SHIELD);
			(void) mongets(mtmp, JAVELIN);
			m_initthrow(mtmp, JAVELIN, 5);
		}
		if (ptr == &mons[PM_RATATA_LICH]) {
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, BRONZE_PLATE_MAIL);
			(void) mongets(mtmp, ASSAULT_RIFLE);
			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
		}
		if (ptr == &mons[PM_PUMPSHOT_LICH]) {
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, ORCISH_CLOAK);
			(void) mongets(mtmp, RIBBED_PLATE_MAIL);
			(void) mongets(mtmp, SHOTGUN);
			m_initthrow(mtmp, SHOTGUN_SHELL, 30);
		}
		if (ptr == &mons[PM_MATLICH]) {
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, SNEAKERS);
			(void) mongets(mtmp, ORCISH_CLOAK);
			(void) mongets(mtmp, PARTIAL_PLATE_MAIL);
			(void) mongets(mtmp, DWARVISH_MATTOCK);
		}

		if (ptr == &mons[PM_LIESER]) {
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, COMBAT_STILETTOS);
			(void) mongets(mtmp, ELVEN_CLOAK);
			(void) mongets(mtmp, FULL_PLATE_MAIL);
			(void) mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */
			m_initthrow(mtmp, INKA_STINGER, 50);
		}
		if (ptr == &mons[PM_SLIGON]) {
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, CATAPULT);
			(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
			(void) mongets(mtmp, ELVEN_CLOAK);
			(void) mongets(mtmp, PARTIAL_PLATE_MAIL);
			(void) mongets(mtmp, HUGGING_BOOT);
			m_initthrow(mtmp, FLINT, 50);
			m_initthrow(mtmp, FLINT, 50);
			m_initthrow(mtmp, FLINT, 50);
		}

		if (ptr == &mons[PM_BERTHMARTAR]) {
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, BATTLE_AXE);
			(void) mongets(mtmp, TRAFFIC_LIGHT);
			(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void) mongets(mtmp, HIDE);
			(void) mongets(mtmp, WAN_FULL_HEALING);
			(void) mongets(mtmp, ROBE);
		}

		if (ptr == &mons[PM_CUTLICH]) {
			(void) mongets(mtmp, CUTTING_LASER);
			m_initthrow(mtmp, LASER_BEAM, 50);
		}

		if (ptr == &mons[PM_BANG_LICH]) {
			(void) mongets(mtmp, SHOTGUN);
			m_initthrow(mtmp, SHOTGUN_SHELL, 30);
		}

		if (ptr == &mons[PM_FLINT_LICH]) {
			(void) mongets(mtmp, FLINTLOCK);
			m_initthrow(mtmp, PISTOL_BULLET, 25);
		}

		if (ptr == &mons[PM_ANTI_UNDEAD_LICH]) {
			(void) mongets(mtmp, DEMON_CROSSBOW);
			m_initthrow(mtmp, KOKKEN, 50);
			m_initthrow(mtmp, KOKKEN, 30);
		}

		if (ptr == &mons[PM_HELLISH_LICH]) {
			(void) mongets(mtmp, DEMON_CROSSBOW);
			m_initthrow(mtmp, CROSSBOW_BOLT, 50);
			m_initthrow(mtmp, CROSSBOW_BOLT, 25);
		}

		if (ptr == &mons[PM_PSCHI_LICH]) {
			(void) mongets(mtmp, PILE_BUNKER);
			m_initthrow(mtmp, CROSSBOW_BOLT, 50);
			m_initthrow(mtmp, CROSSBOW_BOLT, 20);
		}

		if (ptr == &mons[PM_SNIPER_LICH]) {
			(void) mongets(mtmp, HELO_CROSSBOW);
			m_initthrow(mtmp, DROVEN_BOLT, 50);
			m_initthrow(mtmp, DROVEN_BOLT, 20);
		}

		if (ptr == &mons[PM_CAT_LICH]) {
			(void) mongets(mtmp, CATAPULT);
			m_initthrow(mtmp, ROCK, 50);
			m_initthrow(mtmp, ROCK, 50);
		}

		if (ptr == &mons[PM_HYDRA_LICH]) {
			(void) mongets(mtmp, HYDRA_BOW);
			m_initthrow(mtmp, ANCIENT_ARROW, 50);
			m_initthrow(mtmp, GOLDEN_ARROW, 50);
		}

		if (ptr == &mons[PM_GUN_LICH]) {
			(void) mongets(mtmp, PISTOL);
			m_initthrow(mtmp, PISTOL_BULLET, 25);
			m_initthrow(mtmp, PISTOL_BULLET, 25);
		}

		if (ptr == &mons[PM_EGYPTIAN_PHARAO]) {
			(void) mongets(mtmp, ARM_BLASTER);
			m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		}

		if (ptr == &mons[PM_MASTER_LICH] && !rn2(13))
			(void)mongets(mtmp, (rn2(7) ? ATHAME : WAN_NOTHING));
		else if (ptr == &mons[PM_ARCH_LICH] && !rn2(3)) {
			otmp = mksobj(rn2(3) ? ATHAME : QUARTERSTAFF,
				      TRUE, rn2(13) ? FALSE : TRUE, FALSE);
			if (otmp) {
				if (otmp->spe < 2) otmp->spe = rnd(3);
				if (!rn2(4)) otmp->oerodeproof = 1;
				(void) mpickobj(mtmp, otmp, TRUE);
			}
		}
		else if (ptr == &mons[PM_PHARAO]) {
			if (rn2(5)) {
			  	(void) mongets(mtmp, ASSAULT_RIFLE);
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 60);
			  	m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 60);
			} else {
			  	(void) mongets(mtmp, HEAVY_MACHINE_GUN);
			  	m_initthrow(mtmp, MG_BULLET, 60);
			  	m_initthrow(mtmp, MG_BULLET, 60);
			}

		}
		else if (ptr == &mons[PM_ANCIENT_PHARAO]) {
		  	(void) mongets(mtmp, HEAVY_MACHINE_GUN);
		  	m_initthrow(mtmp, MG_BULLET, 60);
		  	m_initthrow(mtmp, MG_BULLET, 60);
		}
		break;

	    case S_OGRE:

		if (ptr == &mons[PM_HULL_USING_CRIMINAL]) {
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}

		if (monsndx(ptr) == PM_POUR_OGRE) (void) mongets(mtmp, POURED_CLUB);
		if (monsndx(ptr) == PM_METOGRE) (void) mongets(mtmp, ALLOY_CLUB);
		if (monsndx(ptr) == PM_SIGNON) (void) mongets(mtmp, FIELD_PLATE);
		if (monsndx(ptr) == PM_BONE_OGRE) (void) mongets(mtmp, BONE_CLUB);
		if (monsndx(ptr) == PM_CLUBBELOGRE) (void) mongets(mtmp, POURED_CLUB);
		if (monsndx(ptr) == PM_HIDEOUS_OGRE_MAGE) (void) mongets(mtmp, SCR_TRAP_CREATION);
		if (monsndx(ptr) == PM_GROTESQUE_OGRE_SHAMAN) (void) mongets(mtmp, SCR_TRAP_CREATION);
		if (monsndx(ptr) == PM_OGRE_STAFFER) (void) mongets(mtmp, QUARTERSTAFF);
		if (monsndx(ptr) == PM_LASERSMASH_OGRE) (void) mongets(mtmp, STARWARS_MACE);
		if (monsndx(ptr) == PM_LASERHORDE_OGRE) (void) mongets(mtmp, STARWARS_MACE);
		if (monsndx(ptr) == PM_OGRE_YARDSTICK) (void) mongets(mtmp, PIKE);
		if (ptr == &mons[PM_OGRE_WOARER]) {
			(void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		}
		if (ptr == &mons[PM_ALL_TIME_OGRE]) {
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, BONE_ARROW, 30);
		}
		if (ptr == &mons[PM_SMASH_OGRE]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, WAR_HAMMER);
			 m_initthrow(mtmp, FLINT, 20);
		}
		if (ptr == &mons[PM_OGRE_METALSHOOTER]) {
			(void) mongets(mtmp, BOW);
	  		m_initthrow(mtmp, BRONZE_ARROW, 50);
		}
		if (ptr == &mons[PM_SKELETTED_OGRE]) {
			(void) mongets(mtmp, BONE_CLUB);
			(void) mongets(mtmp, BARRIER_SHIELD);
		}
		if (ptr == &mons[PM_SLASH_OGRE]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, KATANA);
			 m_initthrow(mtmp, FLINT, 30);
		}
		if (ptr == &mons[PM_SHINE_OGRE]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, FLINT, 40);
		}

		if (ptr == &mons[PM_SMEARY_OGRE]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, SHIELD);
			 m_initthrow(mtmp, TALC, 20);
		}
		if (ptr == &mons[PM_CAT_OGRE]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, PLATE_MAIL);
			(void) mongets(mtmp, SHORT_SWORD);
			(void) mongets(mtmp, HIDE_SHIELD);
			 m_initthrow(mtmp, SILVER_SLINGSTONE, 50);
		}

		if (ptr == &mons[PM_PRISON_HEHEHE_GUARD]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, SEXPLAY_WHIP);
			 m_initthrow(mtmp, SLING_AMMO, 40);
		}
		if (ptr == &mons[PM_CLASHING_OGRE]) {
			(void) mongets(mtmp, SHORT_BLADE);
			(void) mongets(mtmp, COMMANDER_GLOVES);
			 m_initthrow(mtmp, RANDOSPEAR, 3);
		}

		if (monsndx(ptr) == PM_OGRE_AXMAN) (void) mongets(mtmp, AXE);
		if (monsndx(ptr) == PM_OGRE_HELMER) (void) mongets(mtmp, ORCISH_HELM);
		if (monsndx(ptr) == PM_OGRE_SLINGER) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, ORCISH_HELM);
			m_initthrow(mtmp, ROCK, 40);
		}
		if (monsndx(ptr) == PM_DEPTH_OGRE) {
			(void) mongets(mtmp, BLACK_AESTIVALIS);
			(void) mongets(mtmp, LARGE_SHIELD);
			(void) mongets(mtmp, ORCISH_HELM);
			m_initthrow(mtmp, DART, 30);
		}
		if (monsndx(ptr) == PM_WHOLE_OGRE) {
			(void) mongets(mtmp, PISTOL);
			(void) mongets(mtmp, LONG_SWORD);
			(void) mongets(mtmp, PAPER_SHIELD);
			(void) mongets(mtmp, ORCISH_HELM);
			m_initthrow(mtmp, PISTOL_BULLET, 30);
		}
		if (monsndx(ptr) == PM_MILITARY_OGRE) {
			(void) mongets(mtmp, SPEAR);
			(void) mongets(mtmp, LARGE_SHIELD);
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, HIGH_BOOTS);
			m_initthrow(mtmp, FRAG_GRENADE, 10);
		}
		if (monsndx(ptr) == PM_SLASHING_OGRE) {
			(void) mongets(mtmp, SHORT_SWORD);
			(void) mongets(mtmp, ORCISH_HELM);
			m_initthrow(mtmp, FLINT_SPEAR, 3);
		}
		if (monsndx(ptr) == PM_OGRE_SWORD_ARTIST) {
			(void) mongets(mtmp, TWO_HANDED_SWORD);
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, HIGH_BOOTS);
		}

		if (monsndx(ptr) == PM_THIEVER_OGRE) {
			(void) mongets(mtmp, CROSSBOW);
			(void) mongets(mtmp, ORCISH_HELM);
			m_initthrow(mtmp, CROSSBOW_BOLT, 45);
		}

		if (monsndx(ptr) == PM_OGRE_SPEARMAN) {
			(void) mongets(mtmp, SPEAR);
			(void) mongets(mtmp, ORCISH_HELM);
			m_initthrow(mtmp, BRITTLE_SPEAR, 7);
		}
		if (monsndx(ptr) == PM_STAB_OGRE) {
			(void) mongets(mtmp, KNIFE);
		}
		if (monsndx(ptr) == PM_NESTOGRE) {
			(void) mongets(mtmp, NASTYPOLE);
		}
		if (monsndx(ptr) == PM_SHUR_OGRE) {
			m_initthrow(mtmp, SHURIKEN, 50);
		}
		if (ptr == &mons[PM_TSCHAMM_OGRE]) {
			(void) mongets(mtmp, CROSSBOW);
			m_initthrow(mtmp, CROSSBOW_BOLT, 45);
		}
		if (ptr == &mons[PM_SCHRACK_OGRE]) {
			(void) mongets(mtmp, GRINDER);
			(void) mongets(mtmp, STRIPE_MAIL);
		}
		if (ptr == &mons[PM_NUCLEAR_OGRE]) {
			(void) mongets(mtmp, BFG);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
		}

		if (ptr == &mons[PM_CUTTER_OGRE]) {
			(void) mongets(mtmp, CUTTING_LASER);
			m_initthrow(mtmp, LASER_BEAM, 50);
		}
		break;

	    case S_MUMMY:
		if (rn2(7)) (void)mongets(mtmp, MUMMY_WRAPPING);

		if (monsndx(ptr) == PM_SHADOWY_MUMMY) (void) mongets(mtmp, QATAR);
		if (monsndx(ptr) == PM_DRAUGR_MEGASLEEPER) (void) mongets(mtmp, POT_PARALYSIS);
		if (monsndx(ptr) == PM_JULIETTEN_WOMAN) (void) mongets(mtmp, LACQUERED_DANCING_SHOE);
		if (monsndx(ptr) == PM_MEASURER_MAN) (void) mongets(mtmp, MEASURER);
		if (monsndx(ptr) == PM_HIRED_MEASURER_MAN) (void) mongets(mtmp, MEASURER);
		if (monsndx(ptr) == PM_BEAUTIFUL_MUSEUM_GUIDE) (void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		if (monsndx(ptr) == PM_ANGRY_MOB_FARMER) (void) mongets(mtmp, PITCHFORK);
		if (monsndx(ptr) == PM_MORNING_STAR_FIGHTER) (void) mongets(mtmp, METAL_STAR);
		if (monsndx(ptr) == PM_ELITE_MORNING_STAR_FIGHTER) (void) mongets(mtmp, STONE_STAR);
		if (monsndx(ptr) == PM_REACHES_MUMMY) (void) mongets(mtmp, REACH_TRIDENT);
		if (mtmp->data == &mons[PM_MASK_GESTAPO]) (void) mongets(mtmp, find_corona_mask());

		if (ptr == &mons[PM_MAUREEN]) {
			(void) mongets(mtmp, CIGARETTE);
			(void) mongets(mtmp, VICTORIAN_UNDERWEAR);
		}
		if (ptr == &mons[PM_ALABASTER_MUMMY]) {
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}
		if (ptr == &mons[PM_WAKE_ELDER_MUMMY]) {
			(void) mongets(mtmp, REACH_TRIDENT);
			(void) mongets(mtmp, HEAVY_MAIL);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, SMALL_SHIELD);
		}

		if (ptr == &mons[PM_KALWINA]) {
		    otmp = mksobj(KALASHNIKOV, FALSE, FALSE, FALSE);

		    if (otmp) {

			otmp = oname(otmp, artiname(ART_KAL));
			(void) mpickobj(mtmp, otmp, TRUE);

		    }

			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);

		}

		if (monsndx(ptr) == PM_BJARNARHAVEN_FARMER) {
			(void) mongets(mtmp, GRAIN_SCYTHE);
			(void) mongets(mtmp, LOW_BOOTS);
		}
		if (monsndx(ptr) == PM_CUDDLY_BANK_LADY) {
			(void) mongets(mtmp, GENTLEWOMAN_S_DRESS);
			(void) mongets(mtmp, HIGH_STILETTOS);
		}

		if (monsndx(ptr) == PM_LASER_MUMMY) {
			(void) mongets(mtmp, HAND_BLASTER);
			m_initthrow(mtmp, BLASTER_BOLT, 40);
		}
		if (monsndx(ptr) == PM_UNITDEAD_QUEEN) {
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 50);
			m_initthrow(mtmp, ARROW, 50);
		}
		if (monsndx(ptr) == PM_KITCHEN_MUMMY) {
			m_initthrow(mtmp, CERAMIC_KNIFE, 5);
		}
		if (monsndx(ptr) == PM_GREEN_FEMMY) {
			(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		}
		if (monsndx(ptr) == PM_DELTA_SADDLE_SUPPLIER) {
			(void) mongets(mtmp, LEATHER_SADDLE);
		}
		if (monsndx(ptr) == PM_DELTA_HELMET_WEARER) {
			if ((find_orange_visored_helmet()) != -1) (void)mongets(mtmp, find_orange_visored_helmet());
		}
		if (monsndx(ptr) == PM_DELTA_TEN) {
			if ((find_visored_helmet()) != -1) (void)mongets(mtmp, find_visored_helmet());
		}
		if (monsndx(ptr) == PM_DELTA_INFINITE) {
			if ((find_visored_helmet()) != -1) (void)mongets(mtmp, find_visored_helmet());
			(void) mongets(mtmp, FLAIL);
			(void) mongets(mtmp, IRON_CHAIN);
			(void) mongets(mtmp, BASEBALL_BAT);
			(void) mongets(mtmp, LEATHER_JACKET);
			(void) mongets(mtmp, HIGH_BOOTS);
			(void) mongets(mtmp, ROCKET_GAUNTLETS);
			(void) mongets(mtmp, LEATHER_SADDLE);
		}
		if (monsndx(ptr) == PM_VERY_ILLUSORY_MUMMY) {
			(void) mongets(mtmp, SCR_ILLUSION);
		}
		if (monsndx(ptr) == PM_XTRALUSION_MUMMY) {
			(void) mongets(mtmp, SCR_ILLUSION);
			(void) mongets(mtmp, SCR_ILLUSION);
		}

		if (monsndx(ptr) == PM_EMMA_S_SEXY_WEDGE_SANDAL) {
			(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
			(void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
		}

		if (monsndx(ptr) == PM_MUMMIFIED_ROGUE) {
			(void) mongets(mtmp, KNIFE);
			(void) mongets(mtmp, LEATHER_ARMOR);
		}
		if (monsndx(ptr) == PM_MUMMIFIED_ASSASSIN) {
			(void) mongets(mtmp, SHORT_SWORD);
			(void) mongets(mtmp, RING_MAIL);
			(void) mongets(mtmp, SMALL_SHIELD);
		}
		if (monsndx(ptr) == PM_MUMMIFIED_ELITE_ASSASSIN) {
			(void) mongets(mtmp, BELL_CLAWS);
			(void) mongets(mtmp, RING_MAIL);
			(void) mongets(mtmp, SMALL_SHIELD);
		}
		if (monsndx(ptr) == PM_PACKAGED_MUMMY) {
			(void) mongets(mtmp, PISTOL);
			(void) mongets(mtmp, PLATE_MAIL);
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, LOW_BOOTS);
			m_initthrow(mtmp, PISTOL_BULLET, 50);
		}

		break;
	    case S_QUANTMECH:
		if (monsndx(ptr) == PM_QUANTUM_MECHANIC && !rn2(20)) {
			otmp = mksobj(LARGE_BOX, FALSE, FALSE, FALSE);
			if (otmp) {
				otmp->spe = 1; /* flag for special box */
				otmp->owt = weight(otmp);
				(void) mpickobj(mtmp, otmp, TRUE);
			}
		}

		if (monsndx(ptr) == PM_JEWELRY_THIEF) (void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if (monsndx(ptr) == PM_FOOTBALL_BAT) (void) mongets(mtmp, BASEBALL_BAT);
		if (monsndx(ptr) == PM_COMO_MECHANIC) (void) mongets(mtmp, QUARTERSTAFF);
		if (monsndx(ptr) == PM_BALLWIELD_HEATH) (void) mongets(mtmp, HEATH_BALL);

		if (ptr == &mons[PM_TOLKIEN_MECHANIC]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, ELVEN_MITHRIL_COAT);
			 m_initthrow(mtmp, SMALL_PIECE_OF_UNREFINED_MITHR, 25);
		}

		if (ptr == &mons[PM_ARIANE__LADY_OF_THE_ELEMENTS]) {
			(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
			(void) mongets(mtmp, WAN_TELEPORTATION);
			(void) mongets(mtmp, WAN_FULL_HEALING);
			(void) mongets(mtmp, POT_FULL_HEALING);
			(void) mongets(mtmp, POT_FULL_HEALING);
			(void) mongets(mtmp, POT_FULL_HEALING);
		}

		if (ptr == &mons[PM_ARAB_GUARD]) {
			(void) mongets(mtmp, DESERT_SWORD);
			 m_initthrow(mtmp, SAND_DART, 50);
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}
		if (ptr == &mons[PM_HARDCORE_GUARD]) {
			(void) mongets(mtmp, DESERT_SWORD);
			 m_initthrow(mtmp, SAND_DART, 50);
			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());
		}

		if (monsndx(ptr) == PM_MURDERER_BURNER) {
			m_initthrow(mtmp, FRAG_GRENADE, 10);
		}
		if (monsndx(ptr) == PM_BOWWIERDO) {
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 30);
		}
		if (monsndx(ptr) == PM_ARCHER_OF_ELEA) {
			(void) mongets(mtmp, WIND_BOW);
			m_initthrow(mtmp, ARROW, 25);
		}
		if (monsndx(ptr) == PM_ARCHER_OF_ELENA) {
			(void) mongets(mtmp, WIND_BOW);
			m_initthrow(mtmp, ARROW, 25);
		}
		if (monsndx(ptr) == PM_SNIPER_OF_ELEA) {
			(void) mongets(mtmp, WIND_BOW);
			m_initthrow(mtmp, BRONZE_ARROW, 50);
		}
		if (monsndx(ptr) == PM_SNIPER_OF_ELENA) {
			(void) mongets(mtmp, WIND_BOW);
			m_initthrow(mtmp, BRONZE_ARROW, 50);
		}
		if (monsndx(ptr) == PM_CITIZEN_OF_CYBER_DOME) {
			(void) mongets(mtmp, HAND_BLASTER);
			m_initthrow(mtmp, BLASTER_BOLT, 20);
		}
		if (monsndx(ptr) == PM_CROSSBOWWIERDO) {
			(void) mongets(mtmp, CROSSBOW);
			m_initthrow(mtmp, CROSSBOW_BOLT, 45);
		}
		if (monsndx(ptr) == PM_GUNWIERDO) {
			(void) mongets(mtmp, PISTOL);
			m_initthrow(mtmp, PISTOL_BULLET, 30);
		}
		if (monsndx(ptr) == PM_RUNEWIERDO) {
			m_initthrow(mtmp, ELVEN_DAGGER, 5);
		}

		if (monsndx(ptr) == PM_INKA_FIGHTER) {
			(void) mongets(mtmp, INKA_BLADE);
			if (!rn2(10)) (void) mongets(mtmp, INKA_MITHRIL_COAT);
		}
		if (monsndx(ptr) == PM_NEO_INKA) {
			(void) mongets(mtmp, NATURAL_STICK);
		}
		if (monsndx(ptr) == PM_INKA_GIRL) {
			(void) mongets(mtmp, INKA_BOOT);
		}
		if (monsndx(ptr) == PM_INKA_WOMAN) {
			(void) mongets(mtmp, INKA_BOOT);
			(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		}
		if (monsndx(ptr) == PM_INKA_LADY) {
			(void) mongets(mtmp, INKA_BOOT);
			(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		}
		if (monsndx(ptr) == PM_INKA_MILITIA) {
			(void) mongets(mtmp, INKUTLASS);
			if (!rn2(10)) (void) mongets(mtmp, INKA_MITHRIL_COAT);
		}
		if (monsndx(ptr) == PM_INKA_TORTUREMASTER) {
			(void) mongets(mtmp, INKA_SHACKLE);
			if (!rn2(4)) (void) mongets(mtmp, INKA_MITHRIL_COAT);
		}
		if (monsndx(ptr) == PM_INKA_EXTERMINATOR) {
			(void) mongets(mtmp, VERMIN_SWATTER);
			if (!rn2(7)) (void) mongets(mtmp, INKA_MITHRIL_COAT);
		}
		if (monsndx(ptr) == PM_INKA_HUNTER) {
			(void) mongets(mtmp, INKA_SPEAR);
			(void) mongets(mtmp, INKA_SLING);
			if (!rn2(10)) (void) mongets(mtmp, BEAUTIFUL_SHIRT);
			if (!rn2(4)) (void) mongets(mtmp, INKA_MITHRIL_COAT);
			m_initthrow(mtmp, ROCK, 25);
		}
		if (monsndx(ptr) == PM_INKA_BARTENDER) {
			m_initthrow(mtmp, INKA_STINGER, 40);
			if (!rn2(2)) (void) mongets(mtmp, BEAUTIFUL_SHIRT);
		}
		if (monsndx(ptr) == PM_LOTHRIAN_AGENT) {
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 50);
			m_initthrow(mtmp, ARROW, 50);
		}

		if (monsndx(ptr) == PM_INCINERATOR) m_initthrow(mtmp, FRAG_GRENADE, 12);
		if (monsndx(ptr) == PM_STEAM_POWERED_PISTOL_SENTRY) { (void) mongets(mtmp, PISTOL); m_initthrow(mtmp, PISTOL_BULLET, 50); }
		if (monsndx(ptr) == PM_STEAM_POWERED_RIFLE_SENTRY) { (void) mongets(mtmp, RIFLE); m_initthrow(mtmp, RIFLE_BULLET, 50); }
		if (monsndx(ptr) == PM_STEAM_POWERED_SHOTGUN_SENTRY) { (void) mongets(mtmp, SHOTGUN); m_initthrow(mtmp, SHOTGUN_SHELL, 50); }
		if (monsndx(ptr) == PM_STEAM_POWERED_ROCKET_SENTRY) { (void) mongets(mtmp, ROCKET_LAUNCHER); m_initthrow(mtmp, ROCKET, 50); }
		if (monsndx(ptr) == PM_STEAM_POWERED_MISSILE_SENTRY) { (void) mongets(mtmp, ROCKET_LAUNCHER); m_initthrow(mtmp, ROCKET, 50); m_initthrow(mtmp, FRAG_GRENADE, 50); }
		if (monsndx(ptr) == PM_NAZI_PANTHER_TANK) { (void) mongets(mtmp, HEAVY_MACHINE_GUN); (void) mongets(mtmp, ROCKET_LAUNCHER); m_initthrow(mtmp, ROCKET, 50); m_initthrow(mtmp, MG_BULLET, 50); m_initthrow(mtmp, MG_BULLET, 50); m_initthrow(mtmp, MG_BULLET, 50); m_initthrow(mtmp, MG_BULLET, 50); }
		if (monsndx(ptr) == PM_GATLING_AUTOMATA) { (void) mongets(mtmp, HEAVY_MACHINE_GUN); m_initthrow(mtmp, MG_BULLET, 50); m_initthrow(mtmp, MG_BULLET, 50); m_initthrow(mtmp, MG_BULLET, 50); m_initthrow(mtmp, MG_BULLET, 50); }
		if (monsndx(ptr) == PM_MOBILE_REPLICATING_MACHINE_GUN_AUTOMATA_TYPE_IX) { (void) mongets(mtmp, HEAVY_MACHINE_GUN); m_initthrow(mtmp, MG_BULLET, 50); m_initthrow(mtmp, MG_BULLET, 50); m_initthrow(mtmp, MG_BULLET, 50); m_initthrow(mtmp, MG_BULLET, 50); }
		if (monsndx(ptr) == PM_BOMB_CARRYING_ORNITHOPTER_AUTOMATON) m_initthrow(mtmp, FRAG_GRENADE, 20);

	      if (monsndx(ptr) == PM_CLOCKWORK_AUTOMATON) {
	        (void) mongets(mtmp, rn2(2)? BROADSWORD : SCIMITAR);
	        (void) mongets(mtmp, BRONZE_PLATE_MAIL);
	      }
		if (monsndx(ptr) == PM_DOCTOR_FRANKENSTEIN) {
			(void)mongets(mtmp, LAB_COAT);
			(void)mongets(mtmp, WAN_POLYMORPH);
			(void)mongets(mtmp, SPE_POLYMORPH);
		}

		if (ptr == &mons[PM_ACTUAL_MONSTER_GENERATOR]) {
			(void) mongets(mtmp, SCR_SUMMON_BOSS);
			if (!rn2(3)) (void) mongets(mtmp, SCR_SUMMON_BOSS);
			if (!rn2(7)) {
				(void) mongets(mtmp, SCR_SUMMON_BOSS);
				(void) mongets(mtmp, SCR_SUMMON_BOSS);
			}
			if (!rn2(35)) {
				(void) mongets(mtmp, SCR_SUMMON_BOSS);
				(void) mongets(mtmp, SCR_SUMMON_BOSS);
				(void) mongets(mtmp, SCR_SUMMON_BOSS);
			}
			if (!rn2(335)) {
				(void) mongets(mtmp, SCR_SUMMON_BOSS);
				(void) mongets(mtmp, SCR_SUMMON_BOSS);
				(void) mongets(mtmp, SCR_SUMMON_BOSS);
				(void) mongets(mtmp, SCR_SUMMON_BOSS);
				(void) mongets(mtmp, SCR_SUMMON_BOSS);
			}
			(void) mongets(mtmp, WAN_CREATE_HORDE);
			(void) mongets(mtmp, WAN_SUMMON_UNDEAD);
		}

 		break;

		break;
	    case S_LEPRECHAUN:
#ifndef GOLDOBJ

		if (mtmp->m_lev <= 0) 
			mtmp->mgold = (long) rnd(4);
		else if (mtmp->m_lev < level_difficulty()) 
			mtmp->mgold = (long) d(mtmp->m_lev, 4);
		else
			mtmp->mgold = (long) d(level_difficulty(), 4);
#else
		if (mtmp->m_lev <= 0) 
			mkmonmoney(mtmp, (long) rnd(4);
		else if (mtmp->m_lev < level_difficulty()) 
			mkmonmoney(mtmp, (long) d(mtmp->m_lev, 4);
		else
			mkmonmoney(mtmp, (long) d(level_difficulty(), 4));
#endif

		if (monsndx(ptr) == PM_BALLEPPIE) (void) mongets(mtmp, EAGLE_BALL);
		if (monsndx(ptr) == PM_MEANIE_IN_GREEN) (void) mongets(mtmp, SPRAY_BOX);
		if (monsndx(ptr) == PM_ELITE_MEANIE_IN_GREEN) (void) mongets(mtmp, BASEBALL_BAT);
		if (monsndx(ptr) == PM_BULBOUS_LEPRECHAUN) (void) mongets(mtmp, LIGHTBULB);
		if (monsndx(ptr) == PM_AMBUSH_DUMBBUSH) (void) mongets(mtmp, AMBUSH_QATAR);

		if (monsndx(ptr) == PM_LUPIN_THE_THIRD) (void) mongets(mtmp, WAN_TRAP_CREATION);
		if (monsndx(ptr) == PM_GRETA_S_HUGGING_BOOT) { (void) mongets(mtmp, HUGGING_BOOT); (void) mongets(mtmp, SCR_TRAP_CREATION); }
		if (monsndx(ptr) == PM_GRETA_S_LADY_PUMP) { (void) mongets(mtmp, FEMININE_PUMPS); (void) mongets(mtmp, SEXY_LEATHER_PUMP); } /* M4_PUMPS */

		if (ptr == &mons[PM_ELOQUICKLING_ARCHER]) {
			(void) mongets(mtmp, LONG_SWORD);
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, ARROW, 50);
		}
		if (ptr == &mons[PM_GRASS_DANCER]) {
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, ARROW, 50);
		}
		if (ptr == &mons[PM_HC_LEYDE]) {
			(void)mongets(mtmp, rnd_class(WEDGE_SANDALS,ITALIAN_HEELS));
		}
		if (ptr == &mons[PM_HELLSTLING]) {
			 m_initthrow(mtmp, SHURIKEN, 50);
			 m_initthrow(mtmp, SHURIKEN, 50);
		}
		if (ptr == &mons[PM_EXTRA_HELLSTLING]) {
			 m_initthrow(mtmp, SHURIKEN, 50);
			 m_initthrow(mtmp, SHURIKEN, 50);
		}

		if (ptr == &mons[PM_MARCHER]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, HIGH_BOOTS);
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, LEATHER_CLOAK);
			 m_initthrow(mtmp, VOLCANIC_GLASS_FRAGMENT, 30);
		}

		if (ptr == &mons[PM_COORDINATOR]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, PLASTEEL_GLOVES);
			(void) mongets(mtmp, PLASTEEL_HELM);
			(void) mongets(mtmp, PAPER_SHIELD);
			 m_initthrow(mtmp, SLING_AMMO, 30);
		}
		if (ptr == &mons[PM_THIEVING_THIEF]) {
			(void) mongets(mtmp, UNKNOWN_KNIFE);
			(void) mongets(mtmp, BASINET);
			 m_initthrow(mtmp, WONDER_DAGGER, 8);
		}

		if (monsndx(ptr) == PM_CORPSE_SHREDDER) m_initthrow(mtmp, FRAG_GRENADE, 3);
		if (monsndx(ptr) == PM_CORNUCHULA) m_initthrow(mtmp, FRAG_GRENADE, 4);
		if (monsndx(ptr) == PM_ROUGH_TERESA_S_GENTLE_SOFT_SNEAKER) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (monsndx(ptr) == PM_SKI_JIR) m_initthrow(mtmp, FRAG_GRENADE, 5);
		if (monsndx(ptr) == PM_CODE_EDITOR) m_initthrow(mtmp, FRAG_GRENADE, 10);
		if (monsndx(ptr) == PM_MUNCHKIN) { (void) mongets(mtmp, ROCKET_LAUNCHER); m_initthrow(mtmp, ROCKET, 10); }

	      if (ptr == &mons[PM_WEPECHAUN]) (void) mongets(mtmp, DAGGER);
	      if (ptr == &mons[PM_GRAY_FEMMY]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);

	      if (ptr == &mons[PM_LEPRECHAUN_ARM_CHEST_CONTRACTOR]) {
			(void) mongets(mtmp, CROSSBOW);
			m_initthrow(mtmp, CROSSBOW_BOLT, 40);
			(void) mongets(mtmp, ORCISH_HELM);
		}

	      if (ptr == &mons[PM_LASERCHAUN]) {
			(void) mongets(mtmp, HAND_BLASTER);
			m_initthrow(mtmp, BLASTER_BOLT, 50);
		}

	      if (ptr == &mons[PM_KNIFE_ROBBER]) {
			(void) mongets(mtmp, KNIFE);
			m_initthrow(mtmp, KNIFE, 8);
			(void) mongets(mtmp, ORCISH_HELM);
		}

	      if (ptr == &mons[PM_DOUBLE_MEASURER_MEASURER_MAN]) {
			(void) mongets(mtmp, KNIFE);
			(void) mongets(mtmp, MEASURER);
			(void) mongets(mtmp, MEASURER);
			m_initthrow(mtmp, KNIFE, 8);
			(void) mongets(mtmp, ORCISH_HELM);
		}

		break;
       case S_ZRUTY: /* case S_ZOUTHERN: */
	      if (ptr == &mons[PM_BANNIK] && !rn2(5)) (void) mongets(mtmp, TOWEL);
	      if (ptr == &mons[PM_LESHY]) (void) mongets(mtmp, APPLE);
	      if (ptr == &mons[PM_DESERT_KANGAROO]) (void) mongets(mtmp, SCR_QUICKSAND);
	      if (ptr == &mons[PM_TWINE_BITCH]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
	      if (ptr == &mons[PM_POLE_KANGAROO]) (void) mongets(mtmp, BOHEMIAN_EAR_SPOON);
	      if (ptr == &mons[PM_FLAT_SPITTER]) (void) mongets(mtmp, SHARP_POLE);
	      if (ptr == &mons[PM_SQUISH_SPITTER]) (void) mongets(mtmp, LONG_POLE);

		if (ptr == &mons[PM_MACRO_KANGAROO]) {
			 m_initthrow(mtmp, SAND_DART, 50);
			 m_initthrow(mtmp, SAND_DART, 50);
		}
		if (ptr == &mons[PM_MERCENARY_ARCHER]) {
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, ARROW, 25);
		}
		if (ptr == &mons[PM_KARAVIKA]) {
			(void) mongets(mtmp, SHORT_SWORD);
		}

		if (ptr == &mons[PM_FIRECRACKER_KANGAROO]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SLING_AMMO, 30);
		}
		if (ptr == &mons[PM_ZANAN_HEAVILY_ARMED]) {
			(void) mongets(mtmp, BALLISTA);
			 m_initthrow(mtmp, HEAVY_CROSSBOW_BOLT, 50);
			(void) mongets(mtmp, STEEL_SHIELD);
		}
		if (ptr == &mons[PM_VANESSA_HEAVILY_ARMED]) {
			(void) mongets(mtmp, BALLISTA);
			 m_initthrow(mtmp, HEAVY_CROSSBOW_BOLT, 50);
			(void) mongets(mtmp, STEEL_SHIELD);
		}
		if (ptr == &mons[PM_ZANAN_ENHANCED_SOLDIER]) {
			 m_initthrow(mtmp, FRAG_GRENADE, 20);
		}
		if (ptr == &mons[PM_VANESSA_ENHANCED_SOLDIER]) {
			 m_initthrow(mtmp, FRAG_GRENADE, 20);
		}
		if (ptr == &mons[PM_CORONA_PARTY_CELEBRATOR]) {
			(void) mongets(mtmp, T_SHIRT);
			(void) mongets(mtmp, POT_CONFUSION);
			(void) mongets(mtmp, BO_STAFF);
		}
		if (ptr == &mons[PM_COVID_GUEST]) {
			(void) mongets(mtmp, T_SHIRT);
			(void) mongets(mtmp, POT_CONFUSION);
			(void) mongets(mtmp, BO_STAFF);
		}

		if (ptr == &mons[PM_MUTATED_UNDEAD_POTATO]) (void) mongets(mtmp, rn2(10) ? POT_MUTATION : WAN_MUTATION);
	      if (ptr == &mons[PM_FRANZI_S_WEDGE_SANDAL]) { mongets(mtmp, WEDGE_SANDALS); mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); } /* M4_HAMMERSANDAL|M4_SANDALS */
	      if (ptr == &mons[PM_SHUKAT]) m_initthrow(mtmp, SHURIKEN, 60);

	      if (ptr == &mons[PM_BEAR_WITH_A_GUN]) {
			(void) mongets(mtmp, AUTO_SHOTGUN);
			m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 50);
		}

	      break;

          case S_VORTEX:

	      if (ptr == &mons[PM_EVELINE_S_SWEET_WEDGE_SANDAL]) { mongets(mtmp, WEDGE_SANDALS); mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); } /* M4_HAMMERSANDAL|M4_SANDALS */
		if (monsndx(ptr) == PM_NICHOLAS_D__WOLFWOOD) { (void) mongets(mtmp, ROCKET_LAUNCHER); m_initthrow(mtmp, ROCKET, 10); }
	      if (ptr == &mons[PM_EVELINE_S_SNEAKER]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
	      if (ptr == &mons[PM_EVELINE_S_DANCING_SHOE]) (void) mongets(mtmp, DANCING_SHOES);
	      if (ptr == &mons[PM_TRAM_VORTEX]) (void) mongets(mtmp, WAN_TREMBLING);
	      if (ptr == &mons[PM_UNEXPECTED_WHIRLWIND]) (void) mongets(mtmp, NASTYPOLE);
	      if (ptr == &mons[PM_WONDERCLOUD]) (void) mongets(mtmp, WONDER_DAGGER);
	      if (ptr == &mons[PM_UNHOLY_VORTEX]) (void) mongets(mtmp, SCR_OFFLEVEL_ITEM);
	      if (ptr == &mons[PM_ROTATER_CLOUD]) (void) mongets(mtmp, WONDER_DAGGER);
	      if (ptr == &mons[PM_DUNGEON_CLEANER]) (void) mongets(mtmp, POT_SALT_WATER);
	      if (ptr == &mons[PM_FENCER_VORTEX]) (void) mongets(mtmp, ETERNIUM_SABER);
	      if (ptr == &mons[PM_WHIRBLEWHIRBLE_CLOUD]) (void) mongets(mtmp, QATAR);
	      if (ptr == &mons[PM_HC_NUT_MASSEUSE]) (void) mongets(mtmp, COMBAT_STILETTOS);
		if (ptr == &mons[PM_VIOLETTA]) {
			(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
			(void) mongets(mtmp, WAN_DEATH);
		}
		if (ptr == &mons[PM_AMBRA_VORTEX]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, AMBER_FRAGMENT, 25);
		}
		if (ptr == &mons[PM_CHLOE]) {
			(void) mongets(mtmp, CIGARETTE);
			(void) mongets(mtmp, VICTORIAN_UNDERWEAR);
		}

		if (ptr == &mons[PM_CUTE_FEMMY]) {
			(void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
			(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		}
		if (ptr == &mons[PM_SECRETION_CLOUD]) {
			 m_initthrow(mtmp, SECRETION_DAGGER, 5);
		}
		if (ptr == &mons[PM_BLACK_CLOUD]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, ORCISH_HELM);
			 m_initthrow(mtmp, GRAPHITE, 20);
		}
		if (ptr == &mons[PM_POTION_HUMANOID_SINK_MONEY_FOOD_TRAP_DEMON_STONE_PORTAL]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, CONUNDRUM_NUGGET, 40);
		}
		if (ptr == &mons[PM_VOLCANIC_VORTEX]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, CRYSTAL_PLATE_MAIL);
			 m_initthrow(mtmp, VOLCANIC_GLASS_FRAGMENT, 50);
		}
		if (ptr == &mons[PM_SUCKBLOOD_VORTEX]) {
			(void) mongets(mtmp, WAN_BLEEDING);
		}

		if (ptr == &mons[PM_BONE_VORTEX]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, BONE_FRAGMENT, 35);
		}
		if (ptr == &mons[PM_LEAD_VORTEX]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, LEAD_CLUMP, 40);
		}

		if (ptr == &mons[PM_WEAPONIZED_VOMORTEX]) {

			switch (rnd(4)) {

				case 1:
					(void) mongets(mtmp, SHORT_SWORD);
					break;
				case 2:
					(void) mongets(mtmp, BATTLE_AXE);
					break;
				case 3:
					(void) mongets(mtmp, BOW);
					m_initthrow(mtmp, ARROW, 50);
					break;
				case 4:
					m_initthrow(mtmp, SHURIKEN, 50);
					m_initthrow(mtmp, SHURIKEN, 50);
					break;

			}

		}

	    break;

	    case S_ELEMENTAL:

		if (ptr == &mons[PM_HEEL_ELEMENTAL]) (void) mongets(mtmp, COMBAT_STILETTOS);

		if (ptr == &mons[PM_WOODCUT_SYLPH]) {
			(void) mongets(mtmp, SHARP_AXE);
		}
		if (ptr == &mons[PM_TARBALL]) {
			(void) mongets(mtmp, BITUKNIFE);
		}
		if (ptr == &mons[PM_COOLINK]) {
			(void) mongets(mtmp, BEAMSWORD);
		}
		if (ptr == &mons[PM_FACKLING_TORCHBLAZE]) {
			(void) mongets(mtmp, TORCH);
			(void) mongets(mtmp, TORCH);
			(void) mongets(mtmp, TORCH);
		}
		if (ptr == &mons[PM_NOOB_ADVICE_LISTENER]) {
			(void) mongets(mtmp, FISHING_POLE);
		}
		if (ptr == &mons[PM_LANTERN_STALKER]) {
			(void) mongets(mtmp, POLE_LANTERN);
		}
		if (ptr == &mons[PM_BURNING_TARBALL]) {
			(void) mongets(mtmp, BITUKNIFE);
			m_initthrow(mtmp, BITUKNIFE, 5);
		}
		if (ptr == &mons[PM_FLAMING_TARBALL]) {
			(void) mongets(mtmp, BITUKNIFE);
			m_initthrow(mtmp, BITUKNIFE, 12);
		}
		if (ptr == &mons[PM_HIGH_TECH_ELEMENTAL]) {
			(void) mongets(mtmp, NANO_PICK);
			(void) mongets(mtmp, NANO_SUIT);
		}

	      if (ptr == &mons[PM_FIRK]) {
			m_initthrow(mtmp, SHURIKEN, 30);
			m_initthrow(mtmp, SHURIKEN, 30);
		}
		if (ptr == &mons[PM_BYE_FELICIA]) {
			(void) mongets(mtmp, SCR_EVIL_VARIANT);
		}

		if (ptr == &mons[PM_SALT_POEMER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SALT_CHUNK, 25);
		}

	      if (ptr == &mons[PM_MAGIC_ARCHER]) {
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 40);
			m_initthrow(mtmp, ARROW, 40);
		}

		if (ptr == &mons[PM_KNOCKER_OF_DARKNESS]) (void) mongets(mtmp, DARKNESS_CLUB);
		if (ptr == &mons[PM_HEAVY_GIRL]) (void) mongets(mtmp, COMBAT_STILETTOS);
		if (monsndx(ptr) == PM_ICELANDIC_GUN_CHICK) { (void) mongets(mtmp, PISTOL); m_initthrow(mtmp, PISTOL_BULLET, 30); }

		if (ptr == &mons[PM_SUPER_ELEMENTAL]) (void) mongets(mtmp, SCR_ELEMENTALISM);
		if (ptr == &mons[PM_LAURA_S_SOFT_MOCASSIN]) (void) mongets(mtmp, SWEET_MOCASSINS);

		if (ptr == &mons[PM_IMBA_WATER_ELEMENTAL]) (void) mongets(mtmp, WAN_TIDAL_WAVE);
		if (ptr == &mons[PM_NORTHERN_HUSSY_GIRL]) (void) mongets(mtmp, NASTYPOLE);

		if (ptr == &mons[PM_ULTRA_ELEMENTAL]) {
			(void) mongets(mtmp, SCR_ELEMENTALISM);
			(void) mongets(mtmp, SCR_ELEMENTALISM);
		}
		if (ptr == &mons[PM_WEDGE_BEAUTY]) {
			(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
			(void) mongets(mtmp, SCR_NASTY_CURSE);
		}

		/* evil patch idea by jonadab; he wants them to turn the tile a player is on into lava
               I'll just give them an appropriate scroll instead. --Amy */
		if (ptr == &mons[PM_THEMATIC_FIRE_ELEMENTAL]) (void) mongets(mtmp, SCR_LAVA);

		if (ptr == &mons[PM_THEMATIC_ASTRAL_ELEMENTAL]) (void) mongets(mtmp, rn2(10) ? SCR_BAD_EFFECT : WAN_BAD_EFFECT);

		break;
	    case S_VAMPIRE:
		/* [Lethe] Star and fire vampires don't get this stuff */
		if (ptr == &mons[PM_STAR_VAMPIRE] || ptr == &mons[PM_VAMPIROID] || ptr == &mons[PM_FIRE_VAMPIRE]) break;
	    	/* Get opera cloak */

		/* Amy edit: but only if the vampire is at least level 5 */
		if (ptr->mlevel >= 5) {
			for (i = STRANGE_OBJECT; i < NUM_OBJECTS; i++) {

				if (itemnumwithappearance(i, APP_OPERA_CLOAK)) break;

			}
			if (i < NUM_OBJECTS) (void)mongets(mtmp, i);
		}

		if (rn2(2)) {
		    if ((int) mtmp->m_lev > rn2(30))
			(void)mongets(mtmp, POT_VAMPIRE_BLOOD);
		    else
			(void)mongets(mtmp, POT_BLOOD);
		}

		if(ptr == &mons[PM_CLAWHAND_VAMPIRE]) (void) mongets(mtmp, QATAR);
		if(ptr == &mons[PM_VARY_VAMP]) (void) mongets(mtmp, VARIED_GRINDER);
		if(ptr == &mons[PM_CHRISTICAL_MOON_VAMPIRE]) (void) mongets(mtmp, MOON_AXE);
		if(ptr == &mons[PM_STEAK_VAMPIRE]) (void) mongets(mtmp, WOODEN_STAKE);
		if(ptr == &mons[PM_VAMPIRE_CORRODER]) (void) mongets(mtmp, WAN_ACID);
		if(ptr == &mons[PM_DRRDRRDRR_VAMPIRE]) (void) mongets(mtmp, WAN_ACID);
		if(ptr == &mons[PM_VAMPIRIC_FEMMY]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if(ptr == &mons[PM_SITH_WOMAN]) (void) mongets(mtmp, SITH_STAFF);
		if(ptr == &mons[PM_THURINGWETHIL]) (void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		if(ptr == &mons[PM_SHE_WOMBURE]) (void) mongets(mtmp, rnd_class(SPE_FORCE_BOLT,SPE_PSYBEAM));
		if (mtmp->data == &mons[PM_POWERFIST_VAMPIRE]) (void) mongets(mtmp, POWERFIST);
		if (ptr == &mons[PM_VEIL_PSEUDO_LEYDE]) {
			(void)mongets(mtmp, rnd_class(WEDGE_SANDALS,ITALIAN_HEELS));
		}
		if (ptr == &mons[PM_NOSTRO]) {
		     (void)mongets(mtmp, rnd_class(ROBE,ROBE_OF_WEAKNESS));
		     (void)mongets(mtmp, rnd_class(QUARTERSTAFF,PLATINUM_FIRE_HOOK));
		}

		if (ptr == &mons[PM_SUNBARARIAN]) {
			(void) mongets(mtmp, HAND_BLASTER);
			 m_initthrow(mtmp, BLASTER_BOLT, 10);
		}
		if (ptr == &mons[PM_SUNBARBARIAN]) {
			(void) mongets(mtmp, HAND_BLASTER);
			 m_initthrow(mtmp, BLASTER_BOLT, 10);
		}

		if (ptr == &mons[PM_SELF_LOATHING_VAMPIRE]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, SILVER_SPEAR);
			 m_initthrow(mtmp, SILVER_SLINGSTONE, 40);
			 m_initthrow(mtmp, SILVER_DAGGER, 5);
		}

		if(ptr == &mons[PM_SAJIDA]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if(ptr == &mons[PM_SING_S_PLATEAU_BOOT]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if(ptr == &mons[PM_GRASS_VAMPIRE]) (void) mongets(mtmp, SCR_GRASSLAND);

		if (ptr == &mons[PM_ANTI_VAMPIRE]) {
			(void) mongets(mtmp, DEMON_CROSSBOW);
			m_initthrow(mtmp, KOKKEN, 50);
			m_initthrow(mtmp, KOKKEN, 30);
		}
		if (ptr == &mons[PM_CARVE_VAMPIRE]) {
			m_initthrow(mtmp, KNIFE, 10);
		}
		if (ptr == &mons[PM_SECONDED_VAMPIRE]) {
			m_initthrow(mtmp, UNKNOWN_KNIFE, 10);
		}
		if (ptr == &mons[PM_HILDAPIRE]) {
			(void)mongets(mtmp, WILDHILD_BOW);
			m_initthrow(mtmp, ODOR_SHOT, 40);
		}
		if (ptr == &mons[PM_SYRINGE_VAMPIRE]) {
			(void)mongets(mtmp, ASSAULT_RIFLE);
			m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 40);
			m_initthrow(mtmp, LEAD_ASSAULT_RIFLE_BULLET, 40);
		}
		if (ptr == &mons[PM_ASSAULT_VAMPIRE]) {
			(void)mongets(mtmp, ASSAULT_RIFLE);
			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 40);
			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 40);
		}

		if (ptr == &mons[PM_GOD_OF_STARCRAFT_UNIVERSE]) {
		(void)mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if (!rn2(3)) (void)mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if (!rn2(7)) (void)mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if (!rn2(11)) (void)mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if (!rn2(15)) (void)mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		}

		break;
	    case S_DEMON:
		/* moved here from m_initweap() because these don't
		   have AT_WEAP so m_initweap() is not called for them */

		if(ptr == &mons[PM_FINGERNAIL_DEMON]) (void) mongets(mtmp, QATAR);
		if(ptr == &mons[PM_KARATE_FEMMY]) (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		if(ptr == &mons[PM_LASERVENGER]) (void) mongets(mtmp, LASERDENT);
		if(ptr == &mons[PM_LILITU_QUEEN]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if(ptr == &mons[PM_LOSER_DEVIL]) (void) mongets(mtmp, GARBOWHIP);
		if(ptr == &mons[PM_PLATFORMINA]) (void) mongets(mtmp, find_plateau_boots());
		if(ptr == &mons[PM_HC_SEDUCTRESS]) (void) mongets(mtmp, find_filigree_stilettos());
		if(ptr == &mons[PM_HC_TEMPTRESS]) (void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		if(ptr == &mons[PM_LASERCHAIN_DEVIL]) (void) mongets(mtmp, LASER_CHAIN);
		if(ptr == &mons[PM_CHAINSMOKER_DEVIL]) (void) mongets(mtmp, CIGARETTE);
		if(ptr == &mons[PM_IRON_CHAIN_DEVIL]) (void) mongets(mtmp, IRON_CHAIN);
		if(ptr == &mons[PM_KING_DEDEDE]) (void) mongets(mtmp, MALLET);

		if (ptr == &mons[PM_SWORD_DANCER]) {
			(void) mongets(mtmp, SAND_SWORD);
			 m_initthrow(mtmp, SAND_DART, 20);
		}
		if (ptr == &mons[PM_UTE]) {
			(void) mongets(mtmp, LEATHER_PEEP_TOES);
			(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		}
		if (ptr == &mons[PM_HELLWALK_BARBARIAN]) {
			(void) mongets(mtmp, RING_MAIL);
			(void) mongets(mtmp, LOW_BOOTS);
			(void) mongets(mtmp, FLAME_MOUNTAIN);
		}
		if (mtmp->data == &mons[PM_GRUFF_NUT_MOTHER]) (void) mongets(mtmp, FLOGGER);
		if (ptr == &mons[PM_DEPTHWALK_BARBARIAN]) {
			(void) mongets(mtmp, RING_MAIL);
			(void) mongets(mtmp, LOW_BOOTS);
			(void) mongets(mtmp, FLAME_MOUNTAIN);
		}
		if (ptr == &mons[PM_LITTLE_IRIS]) {
			(void) mongets(mtmp, SILVER_SHORT_SWORD);
		}
		if (ptr == &mons[PM_FOAM_DEMON]) {
			(void) mongets(mtmp, SHOOMDENT);
		}
		if (ptr == &mons[PM_MITHRINCUBUS]) {
			(void) mongets(mtmp, MITHRIL_WHIP);
		}
		if (ptr == &mons[PM_MOLOCH_S_OPERATOR]) {
			(void) mongets(mtmp, TELEPHONE);
		}
		if (ptr == &mons[PM_AXE_DAEMON]) {
			(void) mongets(mtmp, INFERNAL_AXE);
		}
		if (ptr == &mons[PM_DAMN_AXE_DAEMON]) {
			(void) mongets(mtmp, INFERNAL_AXE);
		}
		if (ptr == &mons[PM_MOLOCH_S_ANSWERING_SET]) {
			(void) mongets(mtmp, TELEPHONE);
		}
		if (ptr == &mons[PM_SILVER_IRIS]) {
			(void) mongets(mtmp, SILVER_SHORT_SWORD);
			(void) mongets(mtmp, SILVER_GAUNTLETS);
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, SILVER_ARROW, 50);
		}
		if (ptr == &mons[PM_CTHULHIME]) {
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
		}
		if (ptr == &mons[PM_SPAGHETTI_MONSTER]) {
			(void) mongets(mtmp, MYSTERY_LIGHTSABER);
		}
		if (ptr == &mons[PM_WISE_SOPHIA]) {
			(void) mongets(mtmp, QUARTERSTAFF);
		}
		if (ptr == &mons[PM_ELBOW_DEVIL]) {
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, ARROW, 40);
		}
		if (ptr == &mons[PM_ARM_CHEST_DEVIL]) {
			(void) mongets(mtmp, CROSSBOW);
			 m_initthrow(mtmp, CROSSBOW_BOLT, 50);
		}
		if (ptr == &mons[PM_ASSAULT_DEVIL]) {
			(void) mongets(mtmp, ASSAULT_RIFLE);
			 m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
			 m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
		}
		if (ptr == &mons[PM_XEREN_SATELITE_UNIT]) {
			(void) mongets(mtmp, RAYGUN);
			 m_initthrow(mtmp, RAYGUN_BOLT, 50);
			 m_initthrow(mtmp, RAYGUN_BOLT, 50);
		}
		if (ptr == &mons[PM_HORNY_DEVIL]) {
			(void) mongets(mtmp, BULLWHIP);
		}
		if (ptr == &mons[PM_TEACHER_INSIDE_WOMAN]) {
			(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		}
		if (ptr == &mons[PM_LAUGHING_RELIGIOUS_HARLOT]) {
			(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		}
		if (ptr == &mons[PM_CHUNK_DEVIL]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SMALL_PIECE_OF_UNREFINED_MITHR, 30);
		}
		if (ptr == &mons[PM_FIX_DEVIL]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, SILVER_KHAKKHARA);
			 m_initthrow(mtmp, SILVER_SLINGSTONE, 50);
		}
		if (ptr == &mons[PM_CHEATER_LION]) {
			(void) mongets(mtmp, BFG);
			 m_initthrow(mtmp, BFG_AMMO, 40);
			 m_initthrow(mtmp, BFG_AMMO, 40);
			 m_initthrow(mtmp, BFG_AMMO, 40);
			 m_initthrow(mtmp, BFG_AMMO, 40);
			 m_initthrow(mtmp, BFG_AMMO, 40);
			 m_initthrow(mtmp, BFG_AMMO, 40);
			 m_initthrow(mtmp, BFG_AMMO, 40);
			 m_initthrow(mtmp, BFG_AMMO, 40);
			 m_initthrow(mtmp, BFG_AMMO, 40);
			 m_initthrow(mtmp, BFG_AMMO, 40);
		}
		if (ptr == &mons[PM_ASIAN_ENEMY_BOSS]) {
			(void) mongets(mtmp, LEATHER_PEEP_TOES);
			(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		}
		if (ptr == &mons[PM_SCRATCHY_MAFIA_BOSS]) {
			(void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
			(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		}
		if (ptr == &mons[PM_AUNT_ANITA]) {
			(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
			(void) mongets(mtmp, SEXY_LEATHER_PUMP);
			(void) mongets(mtmp, WILDHILD_BOW);
			 m_initthrow(mtmp, ODOR_SHOT, 50);
			 m_initthrow(mtmp, ODOR_SHOT, 50);
		}
		if (ptr == &mons[PM_NEWCOMER_BONUS_GIRL]) (void) mongets(mtmp, WAN_CHROMATIC_BEAM);

		if (ptr == &mons[PM_SEXY_BALROG]) {
			(void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
			(void) mongets(mtmp, ELEGANT_BROADSWORD);
			(void) mongets(mtmp, SEXPLAY_WHIP);
		}
		if (ptr == &mons[PM_DOCK_SECURITY]) {
			(void) mongets(mtmp, PISTOL);
			(void) mongets(mtmp, SCHOOL_UNIFORM);
			(void) mongets(mtmp, PLASTEEL_HELM);
			 m_initthrow(mtmp, LEAD_PISTOL_BULLET, 30);
		}
		if (ptr == &mons[PM_AIRPORT_SECURITY]) {
			(void) mongets(mtmp, HEAVY_MACHINE_GUN);
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, PLASTEEL_HELM);
			 m_initthrow(mtmp, LEAD_MG_BULLET, 50);
			 m_initthrow(mtmp, LEAD_MG_BULLET, 50);
			 m_initthrow(mtmp, LEAD_MG_BULLET, 50);
			 m_initthrow(mtmp, LEAD_MG_BULLET, 50);
		}

		if (ptr == &mons[PM_ICE_DEVIL] && !rn2(4)) {
			(void)mongets(mtmp, SPEAR);
		/* [DS] Cthulhu isn't fully integrated yet, and he won't be
		 *      until Moloch's Sanctum is rearranged */
		} else if (ptr == &mons[PM_CTHULHU]) {
			/*(void)mongets(mtmp, AMULET_OF_YENDOR);*/ /* the high priest already has it, and we're not gonna scrap him --Amy */
			(void)mongets(mtmp, WAN_DEATH);
			(void)mongets(mtmp, POT_FULL_HEALING);
		} else if (ptr == &mons[PM_ASMODEUS]) {
			(void)mongets(mtmp, WAN_COLD);
			(void)mongets(mtmp, WAN_FIRE);
		}

		if (ptr == &mons[PM_LEAD_VROCK]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, ROCKET_GAUNTLETS);
			 m_initthrow(mtmp, LEAD_CLUMP, 30);
		}
		if (ptr == &mons[PM_BONETHROW_DEVIL]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, BARRIER_SHIELD);
			 m_initthrow(mtmp, BONE_FRAGMENT, 30);
		}

		if (ptr == &mons[PM_PURPLE_AMPERSAND]) {
			otmp = mksobj(SCALPEL, FALSE, FALSE, FALSE);
			if (otmp) {
				otmp->spe = 4;
				(void) mpickobj(mtmp, otmp, TRUE);
			}
		}

		if (ptr == &mons[PM_MANCUBUS]) {
			mongets(mtmp, BFG);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);

		}
		if (mtmp->data == &mons[PM_STUPID_FURY]) { (void) mongets(mtmp, UMBRELLA); (void) mongets(mtmp, FEMININE_PUMPS); } /* M4_PUMPS */

		if(ptr == &mons[PM_CHARGING_KINDNESS] || ptr == &mons[PM_ARMORED_BUNDLE_GIRL]) (void) mongets(mtmp, COMBAT_STILETTOS);
		if (mtmp->data == &mons[PM_CONNY_S_COMBAT_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_INA_S_LEATHER_PUMP]) { (void) mongets(mtmp, SEXY_LEATHER_PUMP); (void) mongets(mtmp, FEMININE_PUMPS); } /* M4_PUMPS */
		if (mtmp->data == &mons[PM_BENGE_BARBAROIS]) { (void) mongets(mtmp, SCR_TRAP_CREATION); (void) mongets(mtmp, WAN_TRAP_CREATION); }

		if(ptr == &mons[PM_FRIEDERIKE_S_SOFT_DANCING_SHOE]) (void) mongets(mtmp, DANCING_SHOES);
		if(ptr == &mons[PM_FRIEDERIKE_S_LADY_PUMP]) { (void) mongets(mtmp, SEXY_LEATHER_PUMP); (void) mongets(mtmp, FEMININE_PUMPS); } /* M4_PUMPS */
		if(ptr == &mons[PM_VILE_DEMON]) (void) mongets(mtmp, SCR_VILENESS);
		if(ptr == &mons[PM_PLANE_DEMON]) (void) mongets(mtmp, SCR_ASH);
		if(ptr == &mons[PM_SCIM_CIM_DEVIL]) (void) mongets(mtmp, SCIMITAR);
		if(ptr == &mons[PM_GENIE_IN_A_BOTTLE]) (void) mongets(mtmp, SAND_SWORD);

		if(ptr == &mons[PM_SPINED_REVIL]) (void) mongets(mtmp, IRON_SABER);
		if(ptr == &mons[PM_PIRATE_DEVIL]) (void) mongets(mtmp, IRON_SABER);
		if(ptr == &mons[PM_AIRHACK_DEMON]) (void) mongets(mtmp, IRON_SABER);
		if(ptr == &mons[PM_MARYLITH]) {
			(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
			(void) mongets(mtmp, ORCISH_HELM);
		}
		if(ptr == &mons[PM_FRONG_DEVIL]) {
			(void) mongets(mtmp, IRON_SABER);
			(void) mongets(mtmp, ORCISH_HELM);
		}
		if(ptr == &mons[PM_POLECUBUS]) {
			(void) mongets(mtmp, LEATHER_ARMOR);
			(void) mongets(mtmp, LEATHER_CLOAK);
			(void) mongets(mtmp, rnd_class(PARTISAN,BEC_DE_CORBIN));
		}
		if(ptr == &mons[PM_NALSLASHNEE]) {
			(void) mongets(mtmp, IRON_SABER);
			(void) mongets(mtmp, ORCISH_HELM);
		}
		if(ptr == &mons[PM_WHIPLARGG]) {
			(void) mongets(mtmp, CHAINWHIP);
			(void) mongets(mtmp, ORCISH_HELM);
		}
		if(ptr == &mons[PM_ELEC_DEMON]) {
			(void) mongets(mtmp, ROSE_WHIP);
			(void) mongets(mtmp, BLUE_DRAGON_SCALES);
			(void) mongets(mtmp, ORCISH_HELM);
		}
		if(ptr == &mons[PM_LATCH_DEVIL]) {
			(void) mongets(mtmp, IRON_CHAIN);
			(void) mongets(mtmp, SKULLCAP);
		}
		if(ptr == &mons[PM_HUNGERING_HORSEMAN]) {
			(void) mongets(mtmp, SCYTHE);
			(void) mongets(mtmp, SKULLCAP);
			(void) mongets(mtmp, PARTIAL_PLATE_MAIL);
		}
		if(ptr == &mons[PM_PESTILENT_HORSEMAN]) {
			(void) mongets(mtmp, SCYTHE);
			(void) mongets(mtmp, SKULLCAP);
			(void) mongets(mtmp, PARTIAL_PLATE_MAIL);
		}
		if(ptr == &mons[PM_DEATHLY_HORSEMAN]) {
			(void) mongets(mtmp, SCYTHE);
			(void) mongets(mtmp, SKULLCAP);
			(void) mongets(mtmp, PARTIAL_PLATE_MAIL);
		}
		if(ptr == &mons[PM_SOMALESE]) {
			(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
			(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		}
		if(ptr == &mons[PM_YITH_DEMON]) {
			(void) mongets(mtmp, YITH_TENTACLE);
		}
		if(ptr == &mons[PM_NEOPHYTE_YITH_DEMON]) {
			(void) mongets(mtmp, YITH_TENTACLE);
		}
		if(ptr == &mons[PM_LESSER_YITH_DEMON]) {
			(void) mongets(mtmp, YITH_TENTACLE);
		}
		if(ptr == &mons[PM_HEEL_DEMON]) {
			(void) mongets(mtmp, LEATHER_PEEP_TOES);
			(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		}
		if(ptr == &mons[PM_RE_ON_PURCHASED_DEMON]) {
			(void) mongets(mtmp, DANCING_SHOES);
			(void) mongets(mtmp, LEATHER_GLOVES);
		}
		if(ptr == &mons[PM_CHOICE_DEVIL]) {
			switch (rnd(3)) {

				case 1:
					(void) mongets(mtmp, BOW);
					m_initthrow(mtmp, ARROW, 50);
					break;
				case 2:
					(void) mongets(mtmp, CROSSBOW);
					m_initthrow(mtmp, CROSSBOW_BOLT, 50);
					break;
				case 3:
					(void) mongets(mtmp, RAYGUN);
					m_initthrow(mtmp, RAYGUN_BOLT, 50);
					break;
			}
		}
		if(ptr == &mons[PM_BROWN_DEVIL]) {
			(void) mongets(mtmp, QUARTERSTAFF);
			(void) mongets(mtmp, SKULLCAP);
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 50);
			(void) mongets(mtmp, BAMBOO_MAIL);
		}
		if(ptr == &mons[PM_KALDEVIL]) {
			(void) mongets(mtmp, KALASHNIKOV);
			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
			(void) mongets(mtmp, BANDED_MAIL);
		}
		if(ptr == &mons[PM_DENTOPACKER]) {
			(void) mongets(mtmp, TRIDENT);
			(void) mongets(mtmp, ANTENNA);
			(void) mongets(mtmp, CRYSTAL_BOOTS);
			(void) mongets(mtmp, LEATHER_CLOAK);
			(void) mongets(mtmp, BOW);
			m_initthrow(mtmp, ARROW, 30);
			(void) mongets(mtmp, STUDDED_LEATHER_ARMOR);
		}
		if(ptr == &mons[PM_ORANGE_DEVIL]) {
			(void) mongets(mtmp, COLLUSION_KNIFE);
			(void) mongets(mtmp, SKULLCAP);
			(void) mongets(mtmp, RAPIRAPI);
			m_initthrow(mtmp, COLLUSION_KNIFE, 15);
			(void) mongets(mtmp, RIBBED_PLATE_MAIL);
		}
		if(ptr == &mons[PM_BRIGHT_GREEN_DEVIL]) {
			(void) mongets(mtmp, ARCANE_RAPIER);
			(void) mongets(mtmp, HELM_OF_STEEL);
			(void) mongets(mtmp, YELLOW_DRAGON_SCALE_SHIELD);
			(void) mongets(mtmp, YELLOW_DRAGON_SCALE_MAIL);
			(void) mongets(mtmp, BFG);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
			m_initthrow(mtmp, BFG_AMMO, 50);
		}
		if(ptr == &mons[PM_CYAN_DEVIL]) {
			(void) mongets(mtmp, AKLYS);
			(void) mongets(mtmp, SKULLCAP);
			(void) mongets(mtmp, IRON_SHOES);
			(void) mongets(mtmp, BILL_GUISARME);
			(void) mongets(mtmp, PLATE_MAIL);
		}
		if(ptr == &mons[PM_DIGGER_DEVIL]) {
			(void) mongets(mtmp, DWARVISH_MATTOCK);
			(void) mongets(mtmp, SKULLCAP);
			(void) mongets(mtmp, SPLINT_MAIL);
		}
		if(ptr == &mons[PM_NEEDLE_DEVIL]) {
			(void) mongets(mtmp, SHORT_SWORD);
			(void) mongets(mtmp, SKULLCAP);
			(void) mongets(mtmp, SPEAR);
			m_initthrow(mtmp, SHURIKEN, 50);
			m_initthrow(mtmp, DART, 30);
			m_initthrow(mtmp, DAGGER, 10);
		}
		if(ptr == &mons[PM_FROCK]) {
			(void) mongets(mtmp, IRON_SABER);
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, ORCISH_HELM);
			m_initthrow(mtmp, ROCK, 50);
		}
		if(ptr == &mons[PM_VACUUM_DEVIL]) {
			(void) mongets(mtmp, ARM_BLASTER);
			(void) mongets(mtmp, SHIELD);
			(void) mongets(mtmp, ORCISH_HELM);
			m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
			m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		}
		if(ptr == &mons[PM_ABYSS_PWNZ_R]) {
			(void) mongets(mtmp, LONG_SWORD);
			(void) mongets(mtmp, SHOTGUN);
			(void) mongets(mtmp, PAPER_SHIELD);
			(void) mongets(mtmp, ORCISH_HELM);
			m_initthrow(mtmp, SHOTGUN_SHELL, 50);
		}
		if(ptr == &mons[PM_IRATE_DEMON]) {
			(void) mongets(mtmp, IRON_SABER);
			(void) mongets(mtmp, PISTOL);
			(void) mongets(mtmp, ORCISH_HELM);
			m_initthrow(mtmp, PISTOL_BULLET, 40);
		}
		if(ptr == &mons[PM_RILED_DEMON]) {
			(void) mongets(mtmp, CRYPTIC_SABER);
			(void) mongets(mtmp, PISTOL);
			(void) mongets(mtmp, ORCISH_HELM);
			m_initthrow(mtmp, LEAD_PISTOL_BULLET, 40);
		}
		if(ptr == &mons[PM_STONE_BOMBARD_DEVIL]) {
			(void) mongets(mtmp, GRANITE_IMPALER);
			(void) mongets(mtmp, CATAPULT);
			(void) mongets(mtmp, LEATHER_ARMOR);
			(void) mongets(mtmp, ORCISH_CLOAK);
			(void) mongets(mtmp, ORCISH_HELM);
			m_initthrow(mtmp, FLINT, 50);
			m_initthrow(mtmp, FLINT, 50);
		}

		if(ptr == &mons[PM_GREATER_NALFESHNEE]) (void) mongets(mtmp, WAN_CREATE_MONSTER);
		if(ptr == &mons[PM_MASTER_NALFESHNEE]) (void) mongets(mtmp, WAN_CREATE_HORDE);

		if(ptr == &mons[PM_SUPER_DEMON]) (void) mongets(mtmp, SCR_DEMONOLOGY);
		if(ptr == &mons[PM_SLOPPY_SLOTH]) (void) mongets(mtmp, WAN_INERTIA);

		if(ptr == &mons[PM_HYBRID_BASTARD]) (void) mongets(mtmp, SCR_HYBRIDIZATION);
		if(ptr == &mons[PM_DEADLY_SIN]) (void) mongets(mtmp, SCR_SIN);
		if(ptr == &mons[PM_ICON_OF_SIN]) (void) mongets(mtmp, WAN_SIN);

		if (ptr == &mons[PM_INA_S_HUGGING_BOOT]) (void)mongets(mtmp, HUGGING_BOOT);

		if(ptr == &mons[PM_ULTRA_DEMON]) {
		 (void) mongets(mtmp, SCR_DEMONOLOGY);
		 (void) mongets(mtmp, SCR_DEMONOLOGY);
		}

		/* Major demon lords and princes always start with a scroll of root password detection as a means to escape
		 * from the player character if they feel they're losing. THIS IS DONE ON PURPOSE. Soviet the Type Of Ice Block
		 * would remove this and give a weird comment, but I won't, even in soviet mode.
		 * That continuous "REMOVE! REMOVE! REMOVE!" policy of Soviet5lo is really terrible. I wonder why he didn't
		 * decide to take up DCSS, because that game has an official design philosophy of putting stuff in just to
		 * make the player think "oh this is fun! I'm happy with this new feature!" and then in the next version they
		 * remove it again, often for absolutely petty reasons.
		 * Anyway, this is SLEX, where I and I alone decide what is put in and that nothing is removed. --Amy */

		/* edit: instead of having 200 lines, we'll just give the scroll to the entire range of demon lords */

		if (mtmp->data >= &mons[PM_JUIBLEX] && mtmp->data <= &mons[PM_CTHULHU]) (void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);

	if (ishaxor) {
		if (mtmp->data >= &mons[PM_JUIBLEX] && mtmp->data <= &mons[PM_CTHULHU]) (void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
	}

		break;
	    case S_ANGEL:

		if(ptr == &mons[PM_STARTBADDIE]) (void) mongets(mtmp, EAGLE_BALL);
		if(ptr == &mons[PM_ALEAX_ORBER]) (void) mongets(mtmp, EAGLE_BALL);
		if(ptr == &mons[PM_GOOD_JARED]) (void) mongets(mtmp, JARED_STONE);
		if(ptr == &mons[PM_YOUR_UPLIGHTER]) (void) mongets(mtmp, LIGHTBULB);
		if(ptr == &mons[PM_LASARCHON]) (void) mongets(mtmp, LASER_SWORD);
		if(ptr == &mons[PM_BEALADRIN]) (void) mongets(mtmp, BEAMSWORD);
		if (mtmp->data == &mons[PM_HIGHHEEL_ANGEL]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if(ptr == &mons[PM_ALGONQUIN_BUSINESSLADY]) (void) mongets(mtmp, LEATHER_PEEP_TOES);
		if(ptr == &mons[PM_STAIR_GUARDING_QUEEN]) (void) mongets(mtmp, LEATHER_PEEP_TOES);
		if(ptr == &mons[PM_FIREFOX_ANGEL]) (void) mongets(mtmp, FIRE_STICK);
		if(ptr == &mons[PM_ALINA]) (void) mongets(mtmp, SCALPEL);

		if (monsndx(ptr) == PM_DOUGLAS_ADAMS) {
			(void) mongets(mtmp,HITCHHIKER_S_GUIDE_TO_THE_GALA);
		}
		if (monsndx(ptr) == PM_SCHORSCH) {
			(void) mongets(mtmp, SNEAKERS);
			(void) mongets(mtmp, CIGARETTE);
		}
		if (monsndx(ptr) == PM_LILAC_FEMMY) {
			(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		}
		if (monsndx(ptr) == PM_LASHASSU) {
			(void) mongets(mtmp, HEAVENLY_WHIP);
		}
		if (monsndx(ptr) == PM_ORBALL_ANGEL) {
			(void) mongets(mtmp, EAGLE_BALL);
		}
		if (monsndx(ptr) == PM_BIMMER) {
			(void) mongets(mtmp, RAIN_PIPE);
		}
		if (monsndx(ptr) == PM_CHROMIUM_ANGEL) {
			(void) mongets(mtmp, CHROME_STAFF);
		}

		if (ptr == &mons[PM_SALTATL]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, BAMBOO_MAIL);
			 m_initthrow(mtmp, SALT_CHUNK, 25);
		}
		if (ptr == &mons[PM_DAYDREAMER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, ROCK, 20);
		}
		if (ptr == &mons[PM_DIVINE_PLANETAR]) {
			 m_initthrow(mtmp, DIVINE_DART, 40);
		}
		if (ptr == &mons[PM_ARASIEL]) {
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, ARROW, 50);
			 m_initthrow(mtmp, ARROW, 50);
		}
		if (ptr == &mons[PM_SKIES_GEL]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, METAL_LAMELLAR_ARMOR);
			(void) mongets(mtmp, CROWN);
			 m_initthrow(mtmp, VOLCANIC_GLASS_FRAGMENT, 40);
		}

		if (monsndx(ptr) == PM_MARTIAN_MISSILE_WALKER) {
			(void) mongets(mtmp,ROCKET_LAUNCHER);
			 m_initthrow(mtmp, ROCKET, 10);
		}

		if (monsndx(ptr) == PM_GREEN_COUATL) {
			otmp = mksobj(DAGGER, FALSE, FALSE, FALSE);
			if (otmp) {
				otmp->opoisoned = TRUE;
				(void) mpickobj(mtmp, otmp, TRUE);
			}
			(void) mongets(mtmp,ORCISH_BOW);
			 m_initthrow(mtmp, ORCISH_ARROW, 30);
		}
		if (monsndx(ptr) == PM_CUPID_OF_LOVE) {
			(void) mongets(mtmp,BOW);
			 m_initthrow(mtmp, ARROW, 20);
		}
		if (monsndx(ptr) == PM_ARKHAI) {
			(void) mongets(mtmp,BOW);
			 m_initthrow(mtmp, ARROW, 50);
		}
		if (monsndx(ptr) == PM_DOMINION) {
			(void) mongets(mtmp,BOW);
			 m_initthrow(mtmp, ARROW, 50);
			 m_initthrow(mtmp, ARROW, 50);
		}
		if (monsndx(ptr) == PM_PESKY_ALEAX) {
			 m_initthrow(mtmp, DART, 35);
		}

		if (monsndx(ptr) == PM_CUPID_OF_DEATH) {
			(void) mongets(mtmp,BOW);
			 m_initthrow(mtmp, ARROW, 50);
			 m_initthrow(mtmp, ARROW, 50);
		}
		if (monsndx(ptr) == PM_SHINY_ANGEL) {
			(void) mongets(mtmp,CROSSBOW);
			(void) mongets(mtmp,PLATE_MAIL);
			 m_initthrow(mtmp, CROSSBOW_BOLT, 50);
		}

		if (monsndx(ptr) == PM_MISS_GENTLE_BUNDLE) {
			(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
			(void) mongets(mtmp, SWEET_MOCASSINS);
		}
		if (monsndx(ptr) == PM_SCHRACKARCHON) {
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, ORCISH_CLOAK);
			(void) mongets(mtmp, rnd_class(PARTISAN,BEC_DE_CORBIN));
		}
		if (monsndx(ptr) == PM_SERAPH_OF_THE_ARMOR) {
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
			(void) mongets(mtmp, rnd_class(HAWAIIAN_SHIRT,LEVITATION_BOOTS));
		}

		if (mtmp->data == &mons[PM_ELOSERAPH]) (void) mongets(mtmp, WAN_PUNISHMENT);
		if (mtmp->data == &mons[PM_HC_SEX_PRINCESS]) (void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

		if (mtmp->data == &mons[PM_BATTIE]) (void) mongets(mtmp, IRON_SABER);
		if (mtmp->data == &mons[PM_TERRARCHON]) (void) mongets(mtmp, WAN_CONTAMINATION);

		if (mtmp->data == &mons[PM_SWINGATL]) {
			(void) mongets(mtmp, SHORT_SWORD);
			(void) mongets(mtmp, ORCISH_CLOAK);
		}
		if (mtmp->data == &mons[PM_SLAYATL]) {
			(void) mongets(mtmp, SHORT_BLADE);
			(void) mongets(mtmp, DENTED_POT);
		}

		if (mtmp->data == &mons[PM_SERAPH_OF_THE_WEAPONS]) {
			(void) mongets(mtmp, BATTLE_AXE);
			(void) mongets(mtmp, MORNING_STAR);
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, ARROW, 50);
			 m_initthrow(mtmp, DAGGER, 10);
		}

		if (mtmp->data == &mons[PM_HAMMER_DEVA]) {
			(void) mongets(mtmp, WAR_HAMMER);
			(void) mongets(mtmp, ORCISH_HELM);
		}

		if (mtmp->data == &mons[PM_MULTIPLAR_GRIGORI]) {
			(void) mongets(mtmp, FLAIL);
			(void) mongets(mtmp, PENIS_POLE);
		}

		if (mtmp->data == &mons[PM_HANETAR]) {
			(void) mongets(mtmp, INKA_BOOT);
			(void) mongets(mtmp, TARRIER);
			(void) mongets(mtmp, ELVEN_LEATHER_HELM);
			 m_initthrow(mtmp, INKA_STINGER, 50);
		}

		if (mtmp->data == &mons[PM_BRIGHTAR]) {
			(void) mongets(mtmp, COURSE_LANCE);
			(void) mongets(mtmp, RAPIRAPI);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, POT_EXTRA_HEALING);
			(void) mongets(mtmp, ARM_BLASTER);
			 m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		}

		if (mtmp->data == &mons[PM_NUT_MOTHER]) {
			(void) mongets(mtmp, BULLWHIP);
			(void) mongets(mtmp, GENTLEWOMAN_S_DRESS);
		}

		if (mtmp->data == &mons[PM_ULTRARCHON]) {
			(void) mongets(mtmp, TWO_HANDED_SWORD);
			(void) mongets(mtmp, PLATE_MAIL);
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, LEATHER_GLOVES);
			(void) mongets(mtmp, HIGH_BOOTS);
			 m_initthrow(mtmp, SHURIKEN, 50);
			 m_initthrow(mtmp, SHURIKEN, 50);
		}

		if (mtmp->data == &mons[PM_GHISELE]) {
			(void) mongets(mtmp, GUISARME);
			(void) mongets(mtmp, POT_HEALING);
			(void) mongets(mtmp, ORCISH_HELM);
			 m_initthrow(mtmp, JAVELIN, 3);
		}

		if (mtmp->data == &mons[PM_WEAPONIZED_ANGEL]) {
			(void) mongets(mtmp, DAGGER);
			(void) mongets(mtmp, SPEAR);
			 m_initthrow(mtmp, DAGGER, 5);
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, CHAIN_MAIL);
		}

		if (mtmp->data == &mons[PM_STUPID_NAME_ANGEL]) (void) mongets(mtmp, UNICORN_HORN);

		if (mtmp->data == &mons[PM_ROSAE]) {
			(void) mongets(mtmp, ROSE_WHIP);
			(void) mongets(mtmp, SCALE_MAIL);
			(void) mongets(mtmp, HELMET);
			 m_initthrow(mtmp, DART, 40);
		}

		if (monsndx(ptr) == PM_SELENITE) {
			(void) mongets(mtmp, FLINTLOCK);
			 m_initthrow(mtmp, PISTOL_BULLET, 20);
		}

		if (mtmp->data == &mons[PM_VICTORIA_S_LADY_PUMP]) { (void) mongets(mtmp, SEXY_LEATHER_PUMP); (void) mongets(mtmp, FEMININE_PUMPS); } /* M4_PUMPS */
		if (mtmp->data == &mons[PM_VICTORIA_S_FLEECY_COMBAT_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_VICTORIA_S_HIGH_HEELED_SANDAL]) { (void) mongets(mtmp, HIGH_HEELED_SANDAL); (void) mongets(mtmp, WEDGE_SANDALS); } /* M4_HAMMERSANDAL|M4_SANDALS */
		break;

	    case S_XORN:
		if (monsndx(ptr) == PM_MARVIN) {
			int i;
			int t[3] = {DIODE, TRANSISTOR, IC};
			for (i=0;i<3;i++) {
				otmp = mksobj(t[i],FALSE,FALSE, FALSE);
				if (otmp) {
					otmp->quan = rn2(7) + 1;
					otmp->owt = weight(otmp);
					mpickobj(mtmp,otmp, TRUE);
				}
			}
		}
		if (ptr == &mons[PM_BONEWHEEL_XORN]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, BONE_FRAGMENT, 40);
		}
		if (ptr == &mons[PM_HC_MEAT_GRINDER]) {
			(void) mongets(mtmp, MEATSWORD);
		}

		if (ptr == &mons[PM_CARBON_XORN]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, GRAPHITE, 25);
		}

		if (ptr == &mons[PM_BRICKBREAK_FEMMY]) (void) mongets(mtmp, POWERFIST);
		if (ptr == &mons[PM_CLAWXORN]) (void) mongets(mtmp, QATAR);
		if (ptr == &mons[PM_MANDARINA_S_LADY_SHOE]) (void) mongets(mtmp, SWEET_MOCASSINS);
		if (ptr == &mons[PM_MARLEEN_S_BLOCK_HEELED_COMBAT_BOOT]) (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		break;
 
	    case S_XAN:
		if (ptr == &mons[PM_RANDOM_MONSTER_GENERATOR]) (void) mongets(mtmp, SCR_GROUP_SUMMONING);
		if (ptr == &mons[PM_AKLYS_BUG]) (void) mongets(mtmp, AKLYS);
		if (ptr == &mons[PM_SPACEBUG]) (void) mongets(mtmp, LASER_POLE);
		if (ptr == &mons[PM_BLOWKLYS_BUG]) (void) mongets(mtmp, BLOW_AKLYS);
		if (ptr == &mons[PM_GREATER_AKLYS_BUG]) (void) mongets(mtmp, AKLYS);
		if (ptr == &mons[PM_EXTREMELY_CONTAMINATED_BUG]) (void) mongets(mtmp, SCR_STYX);
		if (ptr == &mons[PM_KATIA_S_LEATHER_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */
		if (ptr == &mons[PM_BLADE_BUG]) (void) mongets(mtmp, LOWER_ARM_BLADE);

		if (ptr == &mons[PM_MISRIL_BUG]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, SPLINT_MAIL);
			 m_initthrow(mtmp, SMALL_PIECE_OF_UNREFINED_MITHR, 20);
		}

		if (ptr == &mons[PM_BESH_XAN]) (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );

		if (ptr == &mons[PM_INSECT_HIVEMIND]) {

			int eggcount = 200;
			while (eggcount > 0) {
				struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
				if (otmpX) {

					struct permonst *antpm = 0;
					int anttempts = 0;

					do {
						antpm = rndmonst();
						anttempts++;
					if (!rn2(2000)) reset_rndmonst(NON_PM);

					} while ( (!antpm || (antpm && !(antpm->mlet == S_ANT) )) && anttempts < 50000);

					otmpX->spe = 0;
					otmpX->quan = 1;
					otmpX->owt = weight(otmpX);
					if (antpm) otmpX->corpsenm = egg_type_from_parent(monsndx(antpm), FALSE);
					else otmpX->corpsenm = egg_type_from_parent(PM_ANT, FALSE); /* fail safe */
					attach_egg_hatch_timeout(otmpX);
					kill_egg(otmpX); /* make sure they're stale --Amy */
					(void) mpickobj(mtmp,otmpX, TRUE);
				}
				eggcount--;
			}

		}

		if (monsndx(ptr) == PM_DEEP_THOUGHT) {
			otmp = mksobj(IC,FALSE,FALSE, FALSE);
			if (otmp) {
				otmp->quan = 42;
	 			otmp->owt = weight(otmp);
				mpickobj(mtmp,otmp, TRUE);
			}
 		}
 		break;

	    case S_WALLMONST:
		if (mtmp->data == &mons[PM_UNEXPECTED_LIGHT]) (void) mongets(mtmp, LASER_SWATTER);
		if (mtmp->data == &mons[PM_DAMGE_INSTEAD_OF_DUNGEON]) (void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);

		if (ptr == &mons[PM_MOAI]) {
			(void) mongets(mtmp, HAND_BLASTER);
			m_initthrow(mtmp, BLASTER_BOLT, 30);
		}
		if (ptr == &mons[PM_DESKTOP_NAVY]) {
			(void) mongets(mtmp, ROCKET_LAUNCHER);
			 m_initthrow(mtmp, ROCKET, 10);
		}
		if (ptr == &mons[PM_DESKTOP_NAVY_SWARM]) {
			(void) mongets(mtmp, ROCKET_LAUNCHER);
			 m_initthrow(mtmp, ROCKET, 10);
		}

		if (ptr == &mons[PM_LARUS]) {
			(void) mongets(mtmp, BULLWHIP);
			(void) mongets(mtmp, HIGH_BOOTS);
			(void) mongets(mtmp, LEATHER_JACKET);
		}

		if (ptr == &mons[PM_LIGHTWHOOSH_WALL]) {
			(void) mongets(mtmp, MYSTERY_LIGHTSABER);
		}
		if (ptr == &mons[PM_PLASTIC_WALL]) {
			(void) mongets(mtmp, PLASTIC_MACE);
		}
		if (ptr == &mons[PM_VENTILATOR]) {
			(void) mongets(mtmp, CARDBOARD_FAN);
		}
		if (ptr == &mons[PM_BLADE_ALPHA]) {
			(void) mongets(mtmp, HELMET);
			(void) mongets(mtmp, SCALE_MAIL);
		}
		if (ptr == &mons[PM_TALC_SHOOTER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, TALC, 30);
		}
		if (ptr == &mons[PM_YERLESWOOD_SAVAGE_MACHINE]) {
			 m_initthrow(mtmp, DART, 50);
			 m_initthrow(mtmp, DART, 50);
		}
		if (ptr == &mons[PM_TANJAWOOD_SAVAGE_MACHINE]) {
			 m_initthrow(mtmp, DART, 50);
			 m_initthrow(mtmp, DART, 50);
		}
		if (ptr == &mons[PM_SECURITY_SYSTEM]) {
			(void) mongets(mtmp, ASSAULT_RIFLE);
			 m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
			 m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
		}
		if (ptr == &mons[PM_YERLESWOOD_NEO]) {
			(void) mongets(mtmp, KATANA);
		}
		if (ptr == &mons[PM_TANJAWOOD_NEO]) {
			(void) mongets(mtmp, KATANA);
		}
		if (ptr == &mons[PM_G_CUBE]) {
			(void) mongets(mtmp, MACE);
			(void) mongets(mtmp, BULLWHIP);
			 m_initthrow(mtmp, DART, 30);
		}
		if (ptr == &mons[PM_G_GLOBUS]) {
			(void) mongets(mtmp, MACE);
			(void) mongets(mtmp, BULLWHIP);
			 m_initthrow(mtmp, DART, 30);
		}
		if (ptr == &mons[PM_GRAVITY_CANNON]) {
			(void) mongets(mtmp, HEAVY_MACHINE_GUN);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
		}
		if (ptr == &mons[PM_YERLESWOOD_TYPE_M]) {
			(void) mongets(mtmp, GREEN_LIGHTSABER);
			(void) mongets(mtmp, HEAVY_MACHINE_GUN);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
		}
		if (ptr == &mons[PM_TANJAWOOD_TYPE_M]) {
			(void) mongets(mtmp, GREEN_LIGHTSABER);
			(void) mongets(mtmp, HEAVY_MACHINE_GUN);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
			 m_initthrow(mtmp, MG_BULLET, 50);
		}
		if (ptr == &mons[PM_YERLES_MORTAR]) {
			 m_initthrow(mtmp, FRAG_GRENADE, 20);
		}
		if (ptr == &mons[PM_TANJA_MORTAR]) {
			 m_initthrow(mtmp, FRAG_GRENADE, 20);
		}

		if (ptr == &mons[PM_DILATIONAL_BLACK_HOLE]) (void) mongets(mtmp, SCR_ANTIMATTER);
		if (ptr == &mons[PM_STARLIT_WALL]) (void) mongets(mtmp, WAN_FLEECY_TERRAIN);
		if (ptr == &mons[PM_EXTRA_STARLIT_WALL]) (void) mongets(mtmp, WAN_FLEECY_TERRAIN);
		if (ptr == &mons[PM_SYL_STARLIT_WALL]) (void) mongets(mtmp, WAN_FLEECY_TERRAIN);
		if (ptr == &mons[PM_CARTRIDGE_OF_HAVING_A_HORROR]) (void) mongets(mtmp, WAN_BAD_EFFECT);
		if (ptr == &mons[PM_BEGINNING_OF_WAR]) {
			(void) mongets(mtmp, POT_FIRE);
			(void) mongets(mtmp, POT_FIRE);
		}
		if (ptr == &mons[PM_MEGA_BLERTA]) {
			(void) mongets(mtmp, POT_HALLUCINATION);
			(void) mongets(mtmp, POT_HALLUCINATION);
		}
		if (ptr == &mons[PM_GULP_RECORDER]) {
			(void) mongets(mtmp, POT_CONFUSION);
			(void) mongets(mtmp, POT_CONFUSION);
		}

		if (ptr == &mons[PM_LASERCUT_WALL]) {
			(void) mongets(mtmp, CUTTING_LASER);
			 m_initthrow(mtmp, LASER_BEAM, 40);
			 m_initthrow(mtmp, LASER_BEAM, 40);
		}

 		break;

	    case S_YETI:

		if (ptr == &mons[PM_KATI_S_WEDGE_HEELED_PUMP]) { (void) mongets(mtmp, FEMININE_PUMPS); (void) mongets(mtmp, SEXY_LEATHER_PUMP); } /* M4_PUMPS */
		if (ptr == &mons[PM_KATI_S_THICK_GIRL_BOOT]) { (void) mongets(mtmp, HIPPIE_HEELS); (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS); } /* M4_BLOCKHEELBOOTS */
		if (ptr == &mons[PM_KATI_S_STRIPED_SNEAKER]) { (void) mongets(mtmp, SOFT_SNEAKERS); (void) mongets(mtmp, SOFT_GIRL_SNEAKER); } /* M4_SNEAKERS */
		if (ptr == &mons[PM_KATI_S_HIGH_HEELED_BOOT]) { (void) mongets(mtmp, INKA_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */
		if (ptr == &mons[PM_KATI_S_PLATEAU_BOOT]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if (ptr == &mons[PM_KATI_S_BALLERINA]) (void) mongets(mtmp, SWEET_MOCASSINS);

		if (ptr == &mons[PM_YNGVAR]) (void) mongets(mtmp, GENTLEMAN_S_SUIT);
		if (ptr == &mons[PM_TOWELBEAR]) (void) mongets(mtmp, TOWEL);
		if (ptr == &mons[PM_HIBERNAL_YETI]) (void) mongets(mtmp, SCR_SNOW);
		if (ptr == &mons[PM_CHARLENE]) (void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		if (ptr == &mons[PM_SLAVE_ZRUTY]) (void) mongets(mtmp, IRON_CHAIN);
		if (ptr == &mons[PM_FASHION_MODEL_ZRUTY]) (void) mongets(mtmp, LEATHER_PEEP_TOES);
		if (ptr == &mons[PM_SOKOZRUTY]) (void) mongets(mtmp, BOULDER);
		if (ptr == &mons[PM_NORDIC_STALKING_BEAR]) (void)mongets(mtmp, CLIMBING_STICK);

		if (ptr == &mons[PM_OOGABOOGAGOBILITGOOK_SEEKER_AREHETYPE_FUCKING_RETARD_ASS_SHIT_FLINGING_MONKEY_MONSTER]) {
			(void) mongets(mtmp, WILDHILD_BOW);
			 m_initthrow(mtmp, ODOR_SHOT, 50);
		}
		if (ptr == &mons[PM_PUNISHED_ZRUTY]) {
			(void) mongets(mtmp, SCR_PUNISHMENT);
			(void) mongets(mtmp, HEAVY_IRON_BALL);
		}
		if (ptr == &mons[PM_HELFRIEKA]) {
			(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			  if ((find_iceblock_heels()) != -1) (void)mongets(mtmp, find_iceblock_heels());
		}

		if (ptr == &mons[PM_PRISON_ZRUTY]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, STRIPED_SHIRT);
			 m_initthrow(mtmp, !rn2(3) ? TALC : !rn2(2) ? GRAPHITE : SMALL_PIECE_OF_UNREFINED_MITHR, 50);
		}

		if (ptr == &mons[PM_CROSSZRUTY]) {
			(void) mongets(mtmp, CROSSBOW);
			 m_initthrow(mtmp, CROSSBOW_BOLT, 50);
		}
		if (ptr == &mons[PM_SLINRUTY]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SLING_AMMO, 50);
		}
		if (ptr == &mons[PM_FLINZRUTY]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, FLINT, 50);
		}

		if (monsndx(ptr) == PM_ZAPHOD_BREEBLEBROX) {
			otmp = mksobj(POT_PAN_GALACTIC_GARGLE_BLASTE,FALSE,FALSE, FALSE);
			if (otmp) {
				otmp->quan = d(2,4);
				otmp->owt = weight(otmp);
				mpickobj(mtmp,otmp, TRUE);
			}
		}

		if (ptr == &mons[PM_CHAOS_MONKEY]) { /* idea by deepy */

			(void) mongets(mtmp, POT_POLYMORPH);
			(void) mongets(mtmp, RIN_TIMELY_BACKUP);
			(void) mongets(mtmp, AMULET_OF_DATA_STORAGE);
			(void) mongets(mtmp, POT_STUNNING);
			(void) mongets(mtmp, POT_FULL_HEALING);
			(void) mongets(mtmp, SCR_CREATE_MONSTER);
			(void) mongets(mtmp, SCR_FLOOD);
			(void) mongets(mtmp, SCR_EARTH);
			(void) mongets(mtmp, SCR_WARPING);
			(void) mongets(mtmp, SCR_BAD_EFFECT);
			(void) mongets(mtmp, SCR_LAVA);
			(void) mongets(mtmp, SCR_BARRHING);
			(void) mongets(mtmp, SCR_LOCKOUT);
			(void) mongets(mtmp, SCR_TRAP_CREATION);
			(void) mongets(mtmp, WAN_SUMMON_UNDEAD);
			(void) mongets(mtmp, WAN_CREATE_HORDE);
			(void) mongets(mtmp, WAN_DIGGING);

		}

 		break;

	    case S_HUMANOID:

		if (ptr == &mons[PM_KNIVER]) (void) mongets(mtmp, UNKNOWN_KNIFE);
		if (ptr == &mons[PM_SOFTWARF]) (void) mongets(mtmp, SOFT_MATTOCK);
		if (ptr == &mons[PM_RC_ZERO]) (void) mongets(mtmp, STRAW_HAT);
		if (ptr == &mons[PM_DWARVEN_ETERNAL_GUARDIAN]) (void) mongets(mtmp, ETERNIUM_MATTOCK);
		if (ptr == &mons[PM_CONTAMINATED_KNIVER]) (void) mongets(mtmp, RADIOACTIVE_DAGGER);
		if (ptr == &mons[PM_ORPHE_CHAOS_CHILD]) (void) mongets(mtmp, LONG_SWORD);
		if (ptr == &mons[PM_FASHIONABLE_KUNOICHI]) (void) mongets(mtmp, SCYTHE);
		if (ptr == &mons[PM_RELIGIOUS_DIRT_BIRTH]) (void) mongets(mtmp, KNIFE);
		if (ptr == &mons[PM_GENUINE_ASTERISKER]) (void) mongets(mtmp, ASTERISK);
		if (ptr == &mons[PM_DWARF_SPEARFIGHTER]) (void) mongets(mtmp, DWARVISH_SPEAR);
		if (ptr == &mons[PM_DWARF_SPEARLORD]) (void) mongets(mtmp, DWARVISH_SPEAR);
		if (ptr == &mons[PM_MYSTERY_DWARF]) (void) mongets(mtmp, MYSTERY_PICK);
		if (ptr == &mons[PM_ITALIAN_PASTAMANCER]) (void) mongets(mtmp, PASTA);
		if (ptr == &mons[PM_ARMORSMITH_DWARF]) (void) mongets(mtmp, OSFA_CHAIN_MAIL);
		if (ptr == &mons[PM_DWARVEN_MASTER_DIGGER]) (void) mongets(mtmp, CONUNDRUM_PICK);
		if (ptr == &mons[PM_BAD_CIGARETTE_DWARF]) (void) mongets(mtmp, CIGARETTE);
		if (ptr == &mons[PM_HANDED_BAOBHAN_SITH]) (void) mongets(mtmp, SITH_STAFF);
		if (ptr == &mons[PM_KLOCK_HOBBIT]) (void) mongets(mtmp, SEXY_LEATHER_PUMP);
		if (ptr == &mons[PM_STARWARS_FAN]) (void) mongets(mtmp, ORANGE_LIGHTSABER);
		if (ptr == &mons[PM_RANDOM_DIG_DWARF]) (void) mongets(mtmp, PICK_AXE);
		if (ptr == &mons[PM_SLOW_DIG_DWARF]) (void) mongets(mtmp, PICK_AXE);
		if (ptr == &mons[PM_STANDING_PREACHER]) (void) mongets(mtmp, PICK_AXE);
		if (ptr == &mons[PM_BAEMMER]) (void) mongets(mtmp, DWARVISH_MATTOCK);
		if (ptr == &mons[PM_DEPRESSED_HOBBIT]) (void) mongets(mtmp, MAID_DRESS);

		if (ptr == &mons[PM_FIGHTER_SAMURAI]) {
			(void) mongets(mtmp, KATANA);
			(void) mongets(mtmp, SPLINT_MAIL);
		}
		if (ptr == &mons[PM_SAMURAI_TRAINEE]) {
			(void) mongets(mtmp, SHORT_SWORD);
			(void) mongets(mtmp, SPLINT_MAIL);
		}

		if (ptr == &mons[PM_CONTAGION_LASHER]) {
			otmp = mksobj(BULLWHIP, FALSE, FALSE, FALSE);
			if (otmp) {
				otmp->opoisoned = TRUE;
				(void) mpickobj(mtmp, otmp, TRUE);
			}
		}
		if (ptr == &mons[PM_TSAR_CULTIST]) (void) mongets(mtmp, ROBE);
		if (mtmp->data == &mons[PM_WEAPGAFF]) m_initweap_normal(mtmp);
		if (ptr == &mons[PM_SCHWILL_TWERP]) {
			(void) mongets(mtmp, BEAMSWORD);
			(void) mongets(mtmp, LARGE_SHIELD);
		}
		if (ptr == &mons[PM_CRIMINAL_PREACHER]) {
			(void) mongets(mtmp, WOODEN_STAKE);
			(void)mongets(mtmp, rnd_class(ROBE,ROBE_OF_WEAKNESS));
			  otmp = mksobj(POT_WATER, FALSE, FALSE, FALSE);
			  if (otmp) {
				  bless(otmp);
				  mpickobj(mtmp, otmp, TRUE);
			  }
			  otmp = mksobj(POT_WATER, FALSE, FALSE, FALSE);
			  if (otmp) {
				  bless(otmp);
				  mpickobj(mtmp, otmp, TRUE);
			  }
		}
		if (ptr == &mons[PM_SUPER_CRAZY_CRIMINAL_ASSFACE_KID]) {
			(void) mongets(mtmp, HIGH_BOOTS);
			(void) mongets(mtmp, HELMET);
			switch (rnd(4)) {
				case 1:
					(void) mongets(mtmp, BULLWHIP);
					(void) mongets(mtmp, CROSSBOW);
					 m_initthrow(mtmp, CROSSBOW_BOLT, 30);
					break;
				case 2:
					(void) mongets(mtmp, PISTOL);
					 m_initthrow(mtmp, SILVER_PISTOL_BULLET, 50);
					(void) mongets(mtmp, SILVER_SPEAR);
					break;
				case 3:
					(void) mongets(mtmp, SILVER_SHORT_SWORD);
					(void) mongets(mtmp, META_BOW);
					 m_initthrow(mtmp, SILVER_ARROW, 50);
					break;
				case 4:
					(void) mongets(mtmp, WOODEN_STAKE);
					 m_initthrow(mtmp, SILVER_DAGGER, 5);
					break;
			}
		}
		if (ptr == &mons[PM_CALLED_UNDERTAKER]) {
			(void) mongets(mtmp, ROBE);
			 m_initthrow(mtmp, BONE_DAGGER, 5);
		}
		if (ptr == &mons[PM_OOMPA_LOOMPA]) {
			(void) mongets(mtmp, MEASURER);
			 m_initthrow(mtmp, DART, 30);
		}
		if (ptr == &mons[PM_GERMAN_STORMTROOPER]) {
			(void) mongets(mtmp, SUBMACHINE_GUN);
			(void) mongets(mtmp, CHAIN_MAIL);
			(void) mongets(mtmp, CHAIN_COIF);
			 m_initthrow(mtmp, SMG_BULLET, 50);
		}
		if (ptr == &mons[PM_AMBER_HOBBIT]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, AMBER_FRAGMENT, 30);
		}

		if (ptr == &mons[PM_TRICK_OR_TREAT_CHILDREN]) (void) mongets(mtmp, rnd_offensive_potion(mtmp));
		if (ptr == &mons[PM_BOO_CHILDREN]) (void) mongets(mtmp, rnd_offensive_potion(mtmp));
		if (ptr == &mons[PM_HOBBIT_SHERRIF]) {
			(void) mongets(mtmp, FLINTLOCK);
			 m_initthrow(mtmp, PISTOL_BULLET, 20);
		}
		if (ptr == &mons[PM_DWARVEN_PIKEMAN]) {
			(void) mongets(mtmp, PIKE);
			 m_initthrow(mtmp, DWARVISH_SPEAR, 8);
		}
		if (ptr == &mons[PM_ARMORED_DOOD]) {
			(void) mongets(mtmp, FIELD_PLATE);
			(void) mongets(mtmp, QUALITY_AXE);
		}
		if (ptr == &mons[PM_TEASER]) {
			(void) mongets(mtmp, PAPER_SWORD);
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, PAPER_ARROW, 30);
		}
		if (ptr == &mons[PM_DWARF_URETO]) {
			(void) mongets(mtmp, ETERNIUM_MATTOCK);
			(void) mongets(mtmp, DWARVISH_ROUNDSHIELD);
			(void) mongets(mtmp, DWARVISH_IRON_HELM);
		}
		if (ptr == &mons[PM_HOBBIT_ROCK_STAR]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SLING_AMMO, 30);
		}
		if (ptr == &mons[PM_HOBBIT_CHEF]) {
			(void) mongets(mtmp, KNIFE);
		}

		if (ptr == &mons[PM_KLINGON_TROOPER]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, BATLETH);
			 m_initthrow(mtmp, SLING_AMMO, 50);
		}
		if (ptr == &mons[PM_REAL_FIGHT_OVERSEER]) {
			(void) mongets(mtmp, BULLWHIP);
			(void) mongets(mtmp, CHAIN_MAIL);
		}
		if (ptr == &mons[PM_HARLOT_WOMAN]) {
			(void) mongets(mtmp, PROSTITUTE_SHOE);
			(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		}
		if (ptr == &mons[PM_JASON_SEEKER]) {
			if (rn2(2)) {
				(void) mongets(mtmp, SAWED_OFF_SHOTGUN);
				 m_initthrow(mtmp, SHOTGUN_SHELL, 25);
			} else {
				(void) mongets(mtmp, HAND_BLASTER);
				 m_initthrow(mtmp, BLASTER_BOLT, 40);
			}
		}

		if (ptr == &mons[PM_TALC_HOBBIT]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, LARGE_SHIELD);
			 m_initthrow(mtmp, TALC, 25);
		}
		if (ptr == &mons[PM_GRAPHEME_HOBBIT]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, ELVEN_CLOAK);
			 m_initthrow(mtmp, GRAPHITE, 30);
		}
		if (ptr == &mons[PM_SILVER_YEEK]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SILVER_SLINGSTONE, 40);
		}
		if (ptr == &mons[PM_HALFLING_SILVERSLINGER]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, PLATE_MAIL);
			 m_initthrow(mtmp, SILVER_SLINGSTONE, 40);
		}
		if (ptr == &mons[PM_DWARF_WOODFALLER]) {
			(void) mongets(mtmp, SHARP_AXE);
			(void) mongets(mtmp, ORCISH_HELM);
			(void) mongets(mtmp, LEATHER_CLOAK);
		}

		if (ptr == &mons[PM_CURRENT_SERGEANT]) {
			(void) mongets(mtmp, SAWED_OFF_SHOTGUN);
			 m_initthrow(mtmp, LEAD_SHOT, 25);
		}
		if (ptr == &mons[PM_ELECTRICAL_CURRENT_SERGEANT]) {
			(void) mongets(mtmp, SAWED_OFF_SHOTGUN);
			 m_initthrow(mtmp, LEAD_SHOT, 25);
		}
		if (ptr == &mons[PM_BONE_HOBBIT]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, BONE_FRAGMENT, 25);
		}
		if (ptr == &mons[PM_HALFLING_POWERSLINGER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SLING_AMMO, 40);
		}
		if (ptr == &mons[PM_LEAD_YEEK]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, LEAD_CLUMP, 30);
		}
		if (ptr == &mons[PM_HOBBIT_LEADMASTER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, LEAD_CLUMP, 30);
		}
		if (ptr == &mons[PM_HOBBIT_SLINGSHOTTER]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, BASINET);
			 m_initthrow(mtmp, SLING_AMMO, 30);
		}
		if (ptr == &mons[PM_DWARVEN_MESSENGER]) (void) mongets(mtmp, SCR_SUMMON_BOSS);
		if (ptr == &mons[PM_DWARF_MACER]) (void) mongets(mtmp, MACE);
		if (ptr == &mons[PM_HORN_DWARF]) (void) mongets(mtmp, UNICORN_HORN);
		if (ptr == &mons[PM_LEGENDARY_HOBBIT_ROGUE]) (void) mongets(mtmp, SCR_TRAP_CREATION);
		if (ptr == &mons[PM_CZECH_GIRL]) (void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		if (ptr == &mons[PM_YITHIAN_MIND_FLAYER]) (void) mongets(mtmp, YITH_TENTACLE);
		if (ptr == &mons[PM_VIETNAMESE_BEAUTY]) (void) mongets(mtmp, HIGH_STILETTOS);
		if (ptr == &mons[PM_SWEET_SISTER]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (ptr == &mons[PM_PSEUDO_MERMAID]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if (ptr == &mons[PM_DIZZY_BLONDE]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if (ptr == &mons[PM_FARTING_ASIAN_GIRL]) (void) mongets(mtmp, HUGGING_BOOT);
		if (ptr == &mons[PM_PICK_DWARF]) (void) mongets(mtmp, PICK_AXE);
		if (ptr == &mons[PM_LOVELY_GIRL]) {
			(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
			(void) mongets(mtmp, HIGH_STILETTOS);
		}
		if (ptr == &mons[PM_RUSSIAN_FURY]) {
			(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
			(void) mongets(mtmp, SWEET_MOCASSINS);
		}
		if (ptr == &mons[PM_MOONWALKER_KNIGHT]) {
			(void) mongets(mtmp, HEAVY_LONG_SWORD);
			(void) mongets(mtmp, BASINET);
			(void) mongets(mtmp, LARGE_SHIELD);
			(void) mongets(mtmp, SCALE_MAIL);
			(void) mongets(mtmp, LORICATED_CLOAK);
		}
		if (ptr == &mons[PM_ELAN_CHIEF]) {
			(void) mongets(mtmp, HEAVY_HAMMER);
		}
		if (ptr == &mons[PM_ELAN_WARRIOR]) {
			(void) mongets(mtmp, WAR_HAMMER);
			(void) mongets(mtmp, LARGE_SHIELD);
		}
		if (ptr == &mons[PM_FOULSPAWN]) {
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		}
		if (ptr == &mons[PM_HOBBIT_WOARER]) {
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		}
		if (ptr == &mons[PM_DWARVEN_WOARER]) {
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		}
		if (ptr == &mons[PM_WARPED_FOULSPAWN]) {
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		}
		if (ptr == &mons[PM_BIG_FOULSPAWN]) {
			 (void) mongets(mtmp, rnd_class(ORCISH_DAGGER,HAWAIIAN_SHIRT-1) );
		}

		if (ptr == &mons[PM_BLOODCAP_AIMING_GIRL]) {
			(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
			(void) mongets(mtmp, SWEET_MOCASSINS);
		}
		if (ptr == &mons[PM_FORMER_SERGEANT]) {
			(void) mongets(mtmp, SAWED_OFF_SHOTGUN);
			 m_initthrow(mtmp, SHOTGUN_SHELL, 20);
		}
		if (ptr == &mons[PM_ELAN_ARCHER]) {
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, ARROW, 50);
		}
		if (ptr == &mons[PM_FLINTOBBIT]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, FLINT, 30);
		}
		if (ptr == &mons[PM_LANCE_THRUSTER]) {
			(void) mongets(mtmp, LANCE);
		}
		if (ptr == &mons[PM_MEASURE_SERVANT]) {
			 m_initthrow(mtmp, KNIFE, 3);
		}
		if (ptr == &mons[PM_KNIFE_SERVANT]) {
			 m_initthrow(mtmp, UNKNOWN_KNIFE, 3);
			(void) mongets(mtmp, ANTENNA);
		}
		if (ptr == &mons[PM_SPEARBEAR]) {
			 m_initthrow(mtmp, SPEAR, 4);
		}
		if (ptr == &mons[PM_JAM_BAN]) {
			 m_initthrow(mtmp, JAVELIN, 5);
		}
		if (ptr == &mons[PM_AR_ME]) {
			(void) mongets(mtmp, VOULGE);
			(void) mongets(mtmp, DAGGER);
			(void) mongets(mtmp, DENTED_POT);
			(void) mongets(mtmp, STUDDED_LEATHER_ARMOR);
			(void) mongets(mtmp, LEATHER_CLOAK);
			(void) mongets(mtmp, LEATHER_GLOVES);
			(void) mongets(mtmp, LOW_BOOTS);
		}
		if (ptr == &mons[PM_BARTEEK]) {
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, ARROW, 30);
			 m_initthrow(mtmp, DART, 25);
		}

		if (ptr == &mons[PM_HOBBIT_SLINGERER]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, ROCK, 30);
		}

		if (ptr == &mons[PM_DEEP_STINGER]) {
			(void) mongets(mtmp, JAVELIN);
			 m_initthrow(mtmp, SPEAR, 5);
		}

		if (ptr == &mons[PM_WONNEN]) {
			(void) mongets(mtmp, PISTOL);
			 m_initthrow(mtmp, PISTOL_BULLET, 50);
		}
		if (ptr == &mons[PM_GROOOOO_OM]) {
			(void) mongets(mtmp, PISTOL);
			 m_initthrow(mtmp, LEAD_PISTOL_BULLET, 50);
		}

		if (ptr == &mons[PM_PEW_PEW_MIND_FLAYER]) {
			(void) mongets(mtmp, BOW);
			 m_initthrow(mtmp, ARROW, 50);
		}

		if (ptr == &mons[PM_DWARVEN_IMPACTER]) {
			(void) mongets(mtmp, FLY_SWATTER);
			(void) mongets(mtmp, RING_MAIL);
		}

		if (ptr == &mons[PM_HOBBIT_LIGHTMASTER]) (void) mongets(mtmp, GREEN_LIGHTSABER);
		if (ptr == &mons[PM_SABERMAN]) (void) mongets(mtmp, IRON_SABER);
		if (ptr == &mons[PM_HALBERDIER]) (void) mongets(mtmp, HALBERD);
		if (ptr == &mons[PM_ASTERISKER]) (void) mongets(mtmp, MORNING_STAR);
		if (ptr == &mons[PM_DWARF_WHIPLADY]) (void) mongets(mtmp, BULLWHIP);

		if (ptr == &mons[PM_HOE]) (void) mongets(mtmp, AXE);

 		break;

	    case S_JELLY:

		if (ptr == &mons[PM_ENEMY_CUBE_JELLY]) (void) mongets(mtmp, SCR_SUMMON_BOSS);
		if (ptr == &mons[PM_REACH_JELLY]) (void) mongets(mtmp, REACH_TRIDENT);
		if (ptr == &mons[PM_BUMMY]) (void) mongets(mtmp, NOOB_POLLAX);
		if (ptr == &mons[PM_PURPLE_FEMMY]) (void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		if (ptr == &mons[PM_ANCOGEL]) (void) mongets(mtmp, INFERNAL_ANCUS);
		if (ptr == &mons[PM_LESSER_ANCOGEL]) (void) mongets(mtmp, ANCUS);
		if (ptr == &mons[PM_GLEAM_OOZE]) (void) mongets(mtmp, CRYSTAL_SWORD);
		if (ptr == &mons[PM_GREATER_ENEMY_CUBE_JELLY]) (void) mongets(mtmp, SCR_SUMMON_BOSS);
		if (mtmp->data == &mons[PM_NORA_S_BEAUTIFUL_COMBAT_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */
		if (ptr == &mons[PM_FISHING_ALIEN]) (void) mongets(mtmp, FISHING_POLE);

		if (mtmp->data == &mons[PM_BLAKE_STONE_JELLY]) {
			 (void) mongets(mtmp, ARM_BLASTER);
			m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 50);
		}
		if (mtmp->data == &mons[PM_FORPRO_JELLY]) {
			 (void) mongets(mtmp, PLATE_MAIL);
			 (void) mongets(mtmp, LARGE_SHIELD);
			 (void) mongets(mtmp, LORICATED_CLOAK);
		}
		if (mtmp->data == &mons[PM_ROYAL_JELLY]) {
			(void) mongets(mtmp, LUMP_OF_ROYAL_JELLY);
			if (rn2(3)) {
				(void) mongets(mtmp, LUMP_OF_ROYAL_JELLY);
				if (!rn2(2)) (void) mongets(mtmp, LUMP_OF_ROYAL_JELLY);
			}
		}

		if (mtmp->data == &mons[PM_POTION_JEL]) {
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
			(void) mongets(mtmp, rnd_offensive_potion(mtmp));
		}

 		break;

	    case S_EYE:
		if (ptr == &mons[PM_OAK_SAGE]) (void) mongets(mtmp, POT_FULL_HEALING);
		if (ptr == &mons[PM_VISOR]) (void) mongets(mtmp, WAN_MAKE_VISIBLE);
		if (ptr == &mons[PM_NASTY_HC_GIRL]) (void) mongets(mtmp, NASTYPOLE);
		if (ptr == &mons[PM_CARBON_BLACK_SPHERE]) (void) mongets(mtmp, BITUKNIFE);
		if (ptr == &mons[PM_MANADRAINER]) (void) mongets(mtmp, EAGLE_BALL);
		if (ptr == &mons[PM_INNOCUOUS_FEMMY]) (void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

		if (ptr == &mons[PM_BANG_BAG]) m_initthrow(mtmp, FRAG_GRENADE, 7);
		if (ptr == &mons[PM_GUANO]) m_initthrow(mtmp, BOOMERANG, 3);
		if (ptr == &mons[PM_BOOMR]) m_initthrow(mtmp, BOOMERANG, 3);

		if (ptr == &mons[PM_RIFLEYE]) {
			(void) mongets(mtmp, RIFLE);
			m_initthrow(mtmp, RIFLE_BULLET, 40);
		}
		if (ptr == &mons[PM_CONTEYE]) {
			(void) mongets(mtmp, RIFLE);
			m_initthrow(mtmp, LEAD_RIFLE_BULLET, 40);
		}

		if (ptr == &mons[PM_ROCT_ORB]) {
			(void) mongets(mtmp, ROCKET_LAUNCHER);
			m_initthrow(mtmp, ROCKET, 6);
		}

		if (ptr == &mons[PM_K__BEHOLDER]) {
			(void) mongets(mtmp, BOULDER);
			(void) mongets(mtmp, BOULDER);
			(void) mongets(mtmp, BOULDER);
			(void) mongets(mtmp, BOULDER);
			(void) mongets(mtmp, BOULDER);
		}

		if (ptr == &mons[PM_WOLFENSTEINER]) {
			(void) mongets(mtmp, CUTTING_LASER);
			m_initthrow(mtmp, LASER_BEAM, 30);

		}

 		break;
	    case S_GRUE:
		if (ptr == &mons[PM_ROCKET_MINE] || ptr == &mons[PM_BOUNCING_MINE]) {
			(void) mongets(mtmp, ROCKET_LAUNCHER);
			m_initthrow(mtmp, ROCKET, 10);
		}
		if (ptr == &mons[PM_SALTWATER_GRUE]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, SNEAKERS);
			(void) mongets(mtmp, ORCISH_CLOAK);
			 m_initthrow(mtmp, SALT_CHUNK, 30);
		}
		if (ptr == &mons[PM_GENDER_STAR_IST]) (void) mongets(mtmp, ASTERISK);
		if (ptr == &mons[PM_POLE_GRUE]) (void) mongets(mtmp, DARK_BAR);
		if (ptr == &mons[PM_PURE_VENOM_GRUE]) (void) mongets(mtmp, CHROME_HORN);
		if (ptr == &mons[PM_COMMA_LADY]) (void) mongets(mtmp, BLOCK_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		if (ptr == &mons[PM_NASTY_FEMMY]) (void) mongets(mtmp, HUGGING_BOOT);
		if (ptr == &mons[PM_MOST_USELESS_GRUE]) (void) mongets(mtmp, QATAR);
		if (ptr == &mons[PM_VY_GRUE]) (void) mongets(mtmp, KHOPESH);
		if (ptr == &mons[PM_OIL_IDOL]) (void) mongets(mtmp, POT_OIL);

		if (ptr == &mons[PM_ROXANNE]) {
			(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
			(void) mongets(mtmp, CROSSBOW);
			m_initthrow(mtmp, CROSSBOW_BOLT, 50);
		}
		if (ptr == &mons[PM_TOTAL_BULLSHOT]) {
			(void) mongets(mtmp, RIFLE);
			m_initthrow(mtmp, RIFLE_BULLET, 40);
		}

		if (mtmp->data == &mons[PM_ANNEMARIE_S_GIRL_SHOE]) { (void) mongets(mtmp, LACQUERED_DANCING_SHOE); (void) mongets(mtmp, WEDGE_SANDALS); } /* M4_SANDALS */
		if (ptr == &mons[PM_DANIELLE_S_CUDDLY_SNEAKER]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (ptr == &mons[PM_HYPOTONIC_SALINE_INFUSION]) (void) mongets(mtmp, POT_FULL_HEALING);

 		break;
	    case S_SPIDER:

		if (ptr == &mons[PM_DIM_GIRL]) (void) mongets(mtmp, QATAR);
		if (ptr == &mons[PM_LASSY_GIRL]) (void) mongets(mtmp, QATAR);
		if (ptr == &mons[PM_MEGAWHIPPET]) (void) mongets(mtmp, SECRET_SOUND_WHIP);
		if (ptr == &mons[PM_PUMPS_FEMMY]) (void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		if (ptr == &mons[PM_CAMPER_ASSHOLE]) {
			(void)mongets(mtmp, SNIPER_RIFLE);
			m_initthrow(mtmp, SNIPER_BULLET, 10);
		}
		if (ptr == &mons[PM_LASER_EQUIPPED_SECRET_CAR]) {
			(void)mongets(mtmp, PROCESS_CARD);
			m_initthrow(mtmp, RADIO, 50);
		}
		if (ptr == &mons[PM_TORCHY_ALIEN]) {
			(void)mongets(mtmp, TORCH);
			(void)mongets(mtmp, TORCH);
		}

		if (ptr == &mons[PM_LANCE_INFECTOR]) {
			otmp = mksobj(GLAIVE, FALSE, FALSE, FALSE);
			if (otmp) {
				otmp->opoisoned = TRUE;
				(void) mpickobj(mtmp, otmp, TRUE);
			}
		}
		if (ptr == &mons[PM_DISABLED_SAND_FISHER]) {
			(void) mongets(mtmp, FISHING_POLE);
		}
		if (ptr == &mons[PM_GIRL_CLICKER]) {
			(void) mongets(mtmp, JAGGED_TOOTH_CLUB);
		}
		if (ptr == &mons[PM_WHIPPET_SCOPION]) {
			(void) mongets(mtmp, VIPERWHIP);
		}
		if (ptr == &mons[PM_DEEP_CAVE_FISHER]) {
			(void) mongets(mtmp, FISHING_POLE);
		}

		if (ptr == &mons[PM_EASY_OPPONENT]) {
			(void) mongets(mtmp, SHORT_BLADE);
		}
		if (ptr == &mons[PM_DOGSHIT_SEARCHER]) {
			(void)mongets(mtmp, QUARTERSTAFF);
			(void)mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
			(void)mongets(mtmp, SCR_BULLSHIT);

		}
		if (ptr == &mons[PM_EK_CHUAH]) {
			(void)mongets(mtmp, CROSSBOW);
			m_initthrow(mtmp, CROSSBOW_BOLT, 50);

		}
		if (ptr == &mons[PM_AIRTIGHT_FEMMY]) {
			(void)mongets(mtmp, HUGGING_BOOT);

		}
		if (ptr == &mons[PM_THE_SPIDER_MASTERMIND]) {
			(void)mongets(mtmp, HEAVY_MACHINE_GUN);
			m_initthrow(mtmp, MG_BULLET, 50);
			m_initthrow(mtmp, MG_BULLET, 50);
			m_initthrow(mtmp, MG_BULLET, 50);
			m_initthrow(mtmp, MG_BULLET, 50);
			m_initthrow(mtmp, MG_BULLET, 50);
			m_initthrow(mtmp, MG_BULLET, 50);
			m_initthrow(mtmp, MG_BULLET, 50);
			m_initthrow(mtmp, MG_BULLET, 50);
			m_initthrow(mtmp, MG_BULLET, 50);
			m_initthrow(mtmp, MG_BULLET, 50);

		}

		if (ptr == &mons[PM_PRINCESS_CATHLETTE]) {
			(void)mongets(mtmp, SEXY_LEATHER_PUMP);
			(void)mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

		}

		if (ptr == &mons[PM_KALACHNOTRON]) {
			(void)mongets(mtmp, KALASHNIKOV);
			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
			m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);

		}

		if (ptr == &mons[PM_ARACHNOTRON]) {

			if (rn2(2)) {
				(void) mongets(mtmp, RAYGUN);
				m_initthrow(mtmp, RAYGUN_BOLT, 30);
			}
			else {
				(void) mongets(mtmp, ARM_BLASTER);
				m_initthrow(mtmp, HEAVY_BLASTER_BOLT, 30);
			}

		}

		if (ptr == &mons[PM_NONEXISTANT_COP]) {
			(void)mongets(mtmp, RUBBER_HOSE);
			m_initthrow(mtmp, CREAM_PIE, 2);
		}

		if (mtmp->data == &mons[PM_SARAH_S_HUGGING_BOOT]) { (void) mongets(mtmp, HUGGING_BOOT); (void) mongets(mtmp, DANCING_SHOES); }

 		break;

	    case S_DRAGON:
		if (ptr == &mons[PM_DRAGON_LORD]) {
			struct obj *otmp;
			otmp = mksobj(GRAY_DRAGON_SCALE_MAIL,TRUE,FALSE, FALSE);
			if (otmp) {
				otmp = oname(otmp,artiname(ART_SCALES_OF_THE_DRAGON_LORD));
				if (otmp) mpickobj(mtmp,otmp, TRUE);
			}
		}

		if (ptr == &mons[PM_CONTRO_MON]) (void) mongets(mtmp, CONTRO_STAFF);
		if (ptr == &mons[PM_RIVAL]) (void) mongets(mtmp, CONTRO_STAFF);
		if (ptr == &mons[PM_ABSOLUTE_JERK]) (void) mongets(mtmp, CONTRO_STAFF);
		if (ptr == &mons[PM_GRINDRAGON]) (void) mongets(mtmp, GRINDER);
		if (ptr == &mons[PM_STEAM_SMOKER]) (void) mongets(mtmp, ELECTRIC_CIGARETTE);
		if (ptr == &mons[PM_EDDOMINA]) (void) mongets(mtmp, LEATHER_PEEP_TOES);
		if (ptr == &mons[PM_LANE_MUGGER]) (void) mongets(mtmp, KNIFE);

		if (ptr == &mons[PM_BANDANA_ROCKZ]) {
			  if ((find_strip_bandana()) != -1) (void)mongets(mtmp, find_strip_bandana());
		}

		if (ptr == &mons[PM_NUKE_TREB]) {
			(void) mongets(mtmp, BOW);
	  		m_initthrow(mtmp, METEOR_ARROW, 40);
	  		m_initthrow(mtmp, METEOR_ARROW, 40);
		}
		if (ptr == &mons[PM_ARMED_COP_CAR]) {
			(void) mongets(mtmp, PISTOL);
	  		m_initthrow(mtmp, PISTOL_BULLET, 50);
		}
		if (ptr == &mons[PM_WOOZIE]) {
			(void) mongets(mtmp, PISTOL);
	  		m_initthrow(mtmp, LEAD_PISTOL_BULLET, 50);
	  		m_initthrow(mtmp, LEAD_PISTOL_BULLET, 50);
		}
		if (ptr == &mons[PM_METAL_MAFIA_SOLDIER]) {
			(void) mongets(mtmp, PISTOL);
	  		m_initthrow(mtmp, PISTOL_BULLET, 20);
		}
		if (ptr == &mons[PM_METAL_MAFIA_LIEUTENANT]) {
			(void) mongets(mtmp, SUBMACHINE_GUN);
	  		m_initthrow(mtmp, SMG_BULLET, 30);
		}
		if (ptr == &mons[PM_METAL_MAFIA_CAPTAIN]) {
			(void) mongets(mtmp, ASSAULT_RIFLE);
	  		m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 40);
		}
		if (ptr == &mons[PM_ROCKZ_ARMY]) {
			(void) mongets(mtmp, SUBMACHINE_GUN);
	  		m_initthrow(mtmp, SMG_BULLET, 50);
		}
		if (ptr == &mons[PM_HEADER_RA____AUTO]) {
			(void) mongets(mtmp, ASSAULT_RIFLE);
	  		m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
	  		m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
	  		m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
	  		m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
		}
		if (ptr == &mons[PM_ARMED_PICKUP]) {
			(void) mongets(mtmp, PISTOL);
	  		m_initthrow(mtmp, PISTOL_BULLET, 20);
		}
		if (ptr == &mons[PM_WOODEN_AUTO]) {
			(void) mongets(mtmp, QUARTERSTAFF);
			(void) mongets(mtmp, BAMBOO_MAIL);
		}
		if (ptr == &mons[PM_DIABLO_GANGSTER]) {
			(void) mongets(mtmp, MUMMY_WRAPPING);
			if (!rn2(2)) (void) mongets(mtmp, BASEBALL_BAT);
			else {
				(void) mongets(mtmp, PISTOL);
		  		m_initthrow(mtmp, LEAD_PISTOL_BULLET, 20);

			}
		}
		if (mtmp->data == &mons[PM_SUPERFLUOUS_GREEN_DRAGON]) (void) mongets(mtmp, POISON_REPELLANT_ARMOR);
		if (ptr == &mons[PM_LOCKDOWN_DENIER]) {
			(void) mongets(mtmp, CONGLOMERATE_PICK);
			(void) mongets(mtmp, WAN_DIGGING);
		}
		if (ptr == &mons[PM_BLONDE_FEMMY]) {
			(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
			(void) mongets(mtmp, STILETTO_SANDALS); /* M4_SANDALS */
		}
		if (ptr == &mons[PM_ELEMENT_DRAGON]) {
			(void) mongets(mtmp, QUARTERSTAFF);
		}
		if (ptr == &mons[PM_APPRENTICE_MASON]) {
			(void) mongets(mtmp, BRICK_PICK);
		}
		if (ptr == &mons[PM_OF_FLOW]) {
			(void) mongets(mtmp, RAIN_PIPE);
		}
		if (ptr == &mons[PM_YOUNG_SPEAR_DRAGON]) (void) mongets(mtmp, DRAGON_SPEAR);
		if (ptr == &mons[PM_YOUNG_ADULT_SPEAR_DRAGON]) (void) mongets(mtmp, DRAGON_SPEAR);
		if (ptr == &mons[PM_ADULT_SPEAR_DRAGON]) (void) mongets(mtmp, DRAGON_SPEAR);
		if (ptr == &mons[PM_OLD_SPEAR_DRAGON]) (void) mongets(mtmp, DRAGON_SPEAR);
		if (ptr == &mons[PM_VERY_OLD_SPEAR_DRAGON]) (void) mongets(mtmp, DRAGON_SPEAR);
		if (ptr == &mons[PM_ANCIENT_SPEAR_DRAGON]) (void) mongets(mtmp, DRAGON_SPEAR);
		if (ptr == &mons[PM_GLUELUELUELUELUE_DRAGON]) {
			(void) mongets(mtmp, TELEPHONE);
		}
		if (ptr == &mons[PM_TENNIS_WORLD_CHAMPION]) {
			(void) mongets(mtmp, TENNIS_RACKET);
		}
		if (ptr == &mons[PM_ETERNAL_STAR]) {
			(void) mongets(mtmp, ETERNIUM_BLADE);
		}
		if (ptr == &mons[PM_DIMETHYLMERCURY_ADULTERATOR]) {
			(void) mongets(mtmp, MERCURIAL_ATHAME);
		}
		if (ptr == &mons[PM_BURGUNDY_DRAGON]) {
			(void) mongets(mtmp, AXE);
		}
		if (ptr == &mons[PM_SARS_FINDER]) {
			(void) mongets(mtmp, POT_FULL_HEALING);
			(void) mongets(mtmp, POT_FULL_HEALING);
		}
		if (ptr == &mons[PM_CRISIS_POLITICIAN]) {
			(void) mongets(mtmp, SCR_LOCKOUT);
			(void) mongets(mtmp, SCR_LOCKOUT);
			(void) mongets(mtmp, SCR_LOCKOUT);
			(void) mongets(mtmp, SCR_LOCKOUT);
			(void) mongets(mtmp, SCR_LOCKOUT);
		}

		if (ptr == &mons[PM_AS_A_MOMMY]) {
			(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		}
		if (mtmp->data == &mons[PM_BIRTHDAY_PRESENTER]) {
			 (void) mongets(mtmp, CHOCOLATE);
			 (void) mongets(mtmp, CHOCOEGG);
		}
		if (ptr == &mons[PM_CROATIAN_SCRATCHER]) {
			(void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		}
		if (ptr == &mons[PM_DYNAMO_TRAINEE]) {
			(void) mongets(mtmp, FLAME_WHIP);
			(void) mongets(mtmp, SILVER_SHIELD);
		}
		if (ptr == &mons[PM_SLEEPING_ASIAN_GIRL]) {
			(void) mongets(mtmp, HUGGING_BOOT);
			(void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		}
		if (ptr == &mons[PM_SALT_DOCTOR]) {
			(void) mongets(mtmp, SLING);
			 m_initthrow(mtmp, SALT_CHUNK, 40);
		}
		if (ptr == &mons[PM_DYKE_EARL]) {
			(void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		}
		if (ptr == &mons[PM_PACIFIC_COAST_SCRATCHER]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, LEATHER_PEEP_TOES);
			 m_initthrow(mtmp, VOLCANIC_GLASS_FRAGMENT, 50);
		}
		if (ptr == &mons[PM_BAD]) {
			(void) mongets(mtmp, LEATHER_JACKET);
			(void) mongets(mtmp, HELMET);
		}

		if (mtmp->data == &mons[PM_SEX_ADDICT]) (void) mongets(mtmp, SEXPLAY_WHIP);
		if (mtmp->data == &mons[PM_KLINGON_WORSHIPPER]) (void) mongets(mtmp, BATLETH);
		if (mtmp->data == &mons[PM_FIRST_NIGHT_PROSTITUTE]) {
			(void) mongets(mtmp, PROSTITUTE_SHOE);
			(void) mongets(mtmp, LADY_BOOTS); /* M4_BLOCKHEELBOOTS */
		}
		if (mtmp->data == &mons[PM_KRYPTAK]) (void) mongets(mtmp, CRYPTIC_SABER);
		if (mtmp->data == &mons[PM_AMMO_STASH_STACKER]) m_initthrow(mtmp, STACK_JAVELIN, 25);
		if (mtmp->data == &mons[PM_TRUE_JEDI]) {
			(void) mongets(mtmp, MYSTERY_LIGHTSABER);
			 m_initthrow(mtmp, DART_OF_DISINTEGRATION, 50);
		}

		if (mtmp->data == &mons[PM_BRIANNA]) (void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		if (mtmp->data == &mons[PM_OLD_MAN_FROM_LEGEND_OF_ZELDA]) (void) mongets(mtmp, SHORT_SWORD);
		if (mtmp->data == &mons[PM_DOUBLE_ACID_DRAGON]) (void) mongets(mtmp, WAN_ACID);
		if (mtmp->data == &mons[PM_DRUG_DISTRIBUTOR]) (void) mongets(mtmp, POT_ACID);
		if (mtmp->data == &mons[PM_CLOUDY_FEMMY]) (void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		if (mtmp->data == &mons[PM_UNFAIR_FEMMY]) (void) mongets(mtmp, COMBAT_STILETTOS);
		if (mtmp->data == &mons[PM_STROKING_WHIP_LADY]) (void) mongets(mtmp, BULLWHIP);
		if (mtmp->data == &mons[PM_INTERESTING_EVIL_LADY]) {
			(void) mongets(mtmp, SWEET_MOCASSINS);
			(void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
		}
		if (ptr == &mons[PM_AMMO_PREPPER]) {
			(void) mongets(mtmp, SLING);
			(void) mongets(mtmp, HEAVY_LONG_SWORD);
			 m_initthrow(mtmp, SLING_AMMO, 50);
			 m_initthrow(mtmp, SLING_AMMO, 50);
			 m_initthrow(mtmp, SLING_AMMO, 50);
			 m_initthrow(mtmp, SLING_AMMO, 50);
		}

		if (mtmp->data == &mons[PM_SARACEN_NEMESIS]) {
			(void) mongets(mtmp, SCIMITAR);
			(void) mongets(mtmp, SMALL_SHIELD);
		}
		if (mtmp->data == &mons[PM_SPA_OPERATOR]) {
			(void) mongets(mtmp, SCR_URINE);
			(void) mongets(mtmp, SCR_URINE);
			(void) mongets(mtmp, SCR_URINE);
			(void) mongets(mtmp, POT_URINE);
			(void) mongets(mtmp, POT_URINE);
			(void) mongets(mtmp, POT_URINE);
		}

		if (mtmp->data == &mons[PM_SILVERSHIRT_LADY]) (void) mongets(mtmp, SILVER_DRAGON_SCALES);
		if (mtmp->data == &mons[PM_HC_MODEL]) (void) mongets(mtmp, DANCING_SHOES);
		if (mtmp->data == &mons[PM_FEMMY_IN_PLATFORM_BOOTS]) (void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

		if (ptr == &mons[PM_RICHEST_MAN_OF_THE_WORLD]) {
		    mtmp->mgold += (long)rn1(20, 200);
		}
		if (ptr == &mons[PM_PIG_SOCCER_FAN]) (void) mongets(mtmp, POT_CONFUSION);
		if (ptr == &mons[PM_UNFORTUNATE_FOREST]) (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		if (ptr == &mons[PM_HUGGER_DRAGON]) (void) mongets(mtmp, HUGGING_BOOT);

		if (ptr == &mons[PM_DANGEROUS_GOOD_LOOKING_CRIMINAL]) (void) mongets(mtmp, GENTLEMAN_S_SUIT);
		if (ptr == &mons[PM_DETENTION_PHYSICS_TEACHER]) (void) mongets(mtmp, SCR_LOCKOUT);
		if (ptr == &mons[PM_NICE_DUTCH_GIRL]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (ptr == &mons[PM_DUTCH_GIRL]) (void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		if (ptr == &mons[PM_BEAUTIFUL_DUTCH_GIRL]) { (void) mongets(mtmp, SOFT_SNEAKERS); (void) mongets(mtmp, SOFT_GIRL_SNEAKER); } /* M4_SNEAKERS */
		if (ptr == &mons[PM_POCAHONTAS_COSPLAYER]) { (void) mongets(mtmp, HIPPIE_HEELS); (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); } /* M4_BLOCKHEELBOOTS */
		if (ptr == &mons[PM_CZECH_WENCH]) (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		if (ptr == &mons[PM_BOTTLE_DRAGON]) (void) mongets(mtmp, BOTTLE);
		if (ptr == &mons[PM_IMPOSSIBLE_CHALLENGER]) (void) mongets(mtmp, SCR_LOCKOUT);
		if (ptr == &mons[PM_FOREST_VINDICATOR]) (void) mongets(mtmp, INKA_SHACKLE);

		if (ptr == &mons[PM_SHOEMAKER]) (void) mongets(mtmp, rnd_class(PLASTEEL_BOOTS,LEVITATION_BOOTS));
		if (ptr == &mons[PM_DANCRESS]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if (ptr == &mons[PM_FULL_SKINNY_BEAUTY]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if (ptr == &mons[PM_POWERFUL_BLONDE_GIRL]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		if (ptr == &mons[PM_SUPER_SWEET_GIRL_IN_PLATEAU_BOOTS]) (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);

		if (ptr == &mons[PM_VIOLENT_BEAUTY]) { (void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS); (void) mongets(mtmp, COMBAT_STILETTOS); }
		if (ptr == &mons[PM_TEENIE_SWARM]) { (void) mongets(mtmp, HIGH_HEELED_SANDAL); (void) mongets(mtmp, HIGH_STILETTOS); } /* M4_HAMMERSANDAL */
		if (mtmp->data == &mons[PM_SWEET_THICK_GIRL]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */

		if (ptr == &mons[PM_WICKED_WOODS]) (void) mongets(mtmp, SCR_GROWTH);
		if (ptr == &mons[PM_ARCTIS_INHABITANT]) (void) mongets(mtmp, SCR_ICE);
		if (ptr == &mons[PM_FALLING_BALL_DRAGON]) (void) mongets(mtmp, HEAVY_IRON_BALL);
		if (ptr == &mons[PM_TELEPHONING_BALL_DRAGON]) (void) mongets(mtmp, HEAVY_IRON_BALL);
		if (ptr == &mons[PM_RAIN_CLOUD_DRAGON]) (void) mongets(mtmp, SCR_FLOOD);
		if (ptr == &mons[PM_WATER_USING_DRAGON]) (void) mongets(mtmp, SCR_FLOOD);
		if (ptr == &mons[PM_RAIN_GUESSING_DRAGON]) (void) mongets(mtmp, SCR_FLOOD);
		if (ptr == &mons[PM_GREEN_ANIMATION_DRAGON]) (void) mongets(mtmp, SCR_CREATE_MONSTER);
		if (ptr == &mons[PM_ANIMAL_ANTICS]) (void) mongets(mtmp, WAN_CREATE_MONSTER);
		if (ptr == &mons[PM_TRAP_INSTALLING_DRAGON]) (void) mongets(mtmp, SCR_TRAP_CREATION);
		if (ptr == &mons[PM_ARBITRATOR]) (void) mongets(mtmp, TIN_WHISTLE);

		if (ptr == &mons[PM_VANESSA_S_THICK_LADY_SHOE]) (void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		if (ptr == &mons[PM_KSENIA_S_PLATEAU_SANDAL]) { (void) mongets(mtmp, HIGH_HEELED_SANDAL); (void) mongets(mtmp, WEDGE_SANDALS); } /* M4_HAMMERSANDAL|M4_SANDALS */
		if (ptr == &mons[PM_MAURAH_S_HUGGING_BOOT]) { (void) mongets(mtmp, HUGGING_BOOT); (void) mongets(mtmp, COMBAT_STILETTOS); }
		if (mtmp->data == &mons[PM_ARIANE_S_FLEECY_COMBAT_BOOT]) { (void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT); (void) mongets(mtmp, HIPPIE_HEELS); } /* M4_BLOCKHEELBOOTS */
		if (ptr == &mons[PM_NELLY_S_ELEGANT_PUMP]) { (void) mongets(mtmp, SEXY_LEATHER_PUMP); (void) mongets(mtmp, FEMININE_PUMPS); } /* M4_PUMPS */
		if (ptr == &mons[PM_MAURAH_S_SWEETHEART_PUMP]) { (void) mongets(mtmp, SEXY_LEATHER_PUMP); (void) mongets(mtmp, FEMININE_PUMPS); } /* M4_PUMPS */

		if (ptr == &mons[PM_LAVA_DRAGON]) { (void) mongets(mtmp, SCR_LAVA); (void) mongets(mtmp, SCR_LAVA); (void) mongets(mtmp, SCR_LAVA);
		}
		/* according to jonadab the lava dragon should turn floor tiles into lava with its breath, but
		   since adding new breath types is difficult, let's just give them a few scrolls of lava. --Amy */

		if (ptr == &mons[PM_CHINESE_WOMAN]) {(void) mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		}

		if (ptr == &mons[PM_DARTER]) m_initthrow(mtmp, DART, 30);
		if (ptr == &mons[PM_SPEARTOSSER]) m_initthrow(mtmp, SPEAR, 6);
		if (ptr == &mons[PM_QUICK_DAGGERMASTER]) m_initthrow(mtmp, DAGGER, 8);
		if (ptr == &mons[PM_JAV_STABBER]) m_initthrow(mtmp, JAVELIN, 5);
		if (ptr == &mons[PM_KNIFESTABBER]) m_initthrow(mtmp, KNIFE, 9);
		if (ptr == &mons[PM_PACKING_CITIZEN]) {
			m_initthrow(mtmp, SHURIKEN, 50);
			m_initthrow(mtmp, SHURIKEN, 50);
			m_initthrow(mtmp, BOOMERANG, 4);
			m_initthrow(mtmp, ARROW, 50);
			m_initthrow(mtmp, SMG_BULLET, 50);
			m_initthrow(mtmp, SMG_BULLET, 50);
			(void)mongets(mtmp, SUBMACHINE_GUN);
			(void)mongets(mtmp, BOW);
		}

		if (ptr == &mons[PM_BARROWGRIM_SOLDIER]) { (void)mongets(mtmp, BOW); (void)mongets(mtmp, DAGGER);  (void)mongets(mtmp, GRIM_SHIELD);
			 m_initthrow(mtmp, ARROW, 30);

		}
		if (ptr == &mons[PM_FINISHED_ROCKER]) {
			(void)mongets(mtmp, SLING);
			m_initthrow(mtmp, FLINT, 40);
		}

		if (ptr == &mons[PM_FLASH_WYVERN]) {
			(void)mongets(mtmp, SNIPER_RIFLE);
			m_initthrow(mtmp, SNIPER_BULLET, 50);

		}

		if (ptr == &mons[PM_DEMONIC_BLADEWITCH]) { (void)mongets(mtmp, BOW); (void)mongets(mtmp, WEDGE_SANDALS); (void)mongets(mtmp, SHORT_SWORD); m_initthrow(mtmp, ARROW, 50); /* M4_SANDALS */
		}

		if (ptr == &mons[PM_MARTIAN_INHABITANT]) { (void)mongets(mtmp, SLING); (void)mongets(mtmp, LOADSTONE);

		}

		if (ptr == &mons[PM_ROMULANIAN_SOLDIER]) {

			  (void) mongets(mtmp, SUBMACHINE_GUN);
		  	  m_initthrow(mtmp, SMG_BULLET, 25);
		  	  m_initthrow(mtmp, SMG_BULLET, 25);
			  (void) mongets(mtmp, DAGGER);
			  (void) mongets(mtmp, FRAG_GRENADE);

		}

		if (ptr == &mons[PM_BUFFALO_SOLDIER]) {

			  (void) mongets(mtmp, ASSAULT_RIFLE);
		  	  m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 25);
		  	  m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 25);
			  (void) mongets(mtmp, DAGGER);
			  (void) mongets(mtmp, FRAG_GRENADE);

		}

		break;

	    default:
		break;
	}

	if ((int) mtmp->m_lev > rn2(400))
		(void) mongets(mtmp, rnd_defensive_item(mtmp));
	if ((int) mtmp->m_lev > rn2(400))
		(void) mongets(mtmp, rnd_misc_item(mtmp));
	if ((int) mtmp->m_lev > rn2(1000))
		(void) mongets(mtmp, rnd_offensive_item(mtmp));
	if (!rn2(1200)) (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
	if (!rn2(1200)) (void) mongets(mtmp, rnd_misc_item_new(mtmp));
	if (!rn2(3000)) (void) mongets(mtmp, rnd_offensive_item_new(mtmp));

	/* inventory initialization for bosses --Amy */

	if (ptr == &mons[PM_CHRIS_CHENG]) {

		int artilistentry = find_wildtalentartifact(); /*&artilist[ART_ELLI_S_PSEUDOBAND_OF_POS];*/

		otmp = mksobj(artilistentry, FALSE, FALSE, FALSE);

		if (otmp) {

			otmp = oname(otmp, artiname(ART_ELLI_S_PSEUDOBAND_OF_POS));

		}

		if (otmp) (void) mpickobj(mtmp, otmp, TRUE);

	}
	
	if (ptr == &mons[PM_FOAMING_WHITE_KNIGHT]) {

		int artilistentry = find_prostituteartifact(); /*&artilist[ART_HIGHEST_FEELING];*/

		otmp = mksobj(artilistentry, FALSE, FALSE, FALSE);

		if (otmp) {

			otmp = oname(otmp, artiname(ART_HIGHEST_FEELING));

		}

		if (otmp) (void) mpickobj(mtmp, otmp, TRUE);

	}

	if (ptr == &mons[PM_CASH_GREEDY_FINANCE_MINISTER]) {

		int artilistentry = find_kurwaartifact(); /*&artilist[ART_LORSKEL_S_INTEGRITY];*/

		otmp = mksobj(artilistentry, FALSE, FALSE, FALSE);

		if (otmp) {

			otmp = oname(otmp, artiname(ART_LORSKEL_S_INTEGRITY));

		}

		if (otmp) (void) mpickobj(mtmp, otmp, TRUE);

	}

	if (ptr == &mons[PM_CRISTI]) {
		(void) mongets(mtmp, QUARTERSTAFF);
		(void) mongets(mtmp, WAN_GAIN_LEVEL);
	}

	if (ptr == &mons[PM_ROBAT]) {
		(void) mongets(mtmp, ASSAULT_RIFLE);
		(void) mongets(mtmp, KNIFE);
		m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
		m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);

	}

	if (ptr == &mons[PM_TOBI]) {
		(void) mongets(mtmp, SILVER_MACE);
		(void) mongets(mtmp, ROBE);
		(void) mongets(mtmp, SCR_SUMMON_ELM);

	}

	if (ptr == &mons[PM_FLO_OOO]) {
		(void) mongets(mtmp, ELECTRIC_SWORD);
		m_initthrow(mtmp, DART, 50);
		(void) mongets(mtmp, GAUNTLETS_OF_TYPING);
		(void) mongets(mtmp, AMULET_OF_DATA_STORAGE);
		(void) mongets(mtmp, RIN_TIMELY_BACKUP);
		(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		(void) mongets(mtmp, WAN_BUGGING);

	}

	if (ptr == &mons[PM_CONSE]) {
		(void) mongets(mtmp, PISTOL);
		(void) mongets(mtmp, IRON_SHOES);
		m_initthrow(mtmp, PISTOL_BULLET, 50);

	}

	if (ptr == &mons[PM_PETE]) {
		(void) mongets(mtmp, PISTOL);
		m_initthrow(mtmp, PISTOL_BULLET, 50);
		(void) mongets(mtmp, AMULET_OF_LIFE_SAVING);
		(void) mongets(mtmp, STRIPED_SHIRT);

	}

	if (ptr == &mons[PM_ALEX]) {
		(void) mongets(mtmp, WAN_FEAR);
		(void) mongets(mtmp, WAN_TELEPORTATION);
		(void) mongets(mtmp, SCR_GROUP_SUMMONING);

	}

	if (ptr == &mons[PM_YVONNE]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_MAGDALENA]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, POT_FIRE);
		(void) mongets(mtmp, RING_MAIL);
		(void) mongets(mtmp, COMBAT_STILETTOS);

	}

	if (ptr == &mons[PM_EVELINE]) {
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, VICTORIAN_UNDERWEAR);
		(void) mongets(mtmp, WAN_TIME);
		(void) mongets(mtmp, WAN_INERTIA);

	}

	if (ptr == &mons[PM_BEA]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, POT_URINE);

	}

	if (ptr == &mons[PM_MAILIE]) {
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SCR_RELOCATION);

	}

	if (ptr == &mons[PM_JULCHEN]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, POT_HEALING);

	}

	if (ptr == &mons[PM_SABRINA]) {
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		(void) mongets(mtmp, MACE);
		m_initthrow(mtmp, CREAM_PIE, 5);

	}

	if (ptr == &mons[PM_SABINE]) {
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		(void) mongets(mtmp, CLOAK_OF_MAGIC_RESISTANCE);
		(void) mongets(mtmp, SCR_IMMOBILITY);

	}

	if (ptr == &mons[PM_EGAS]) {
		(void) mongets(mtmp, SUBMACHINE_GUN);
		(void) mongets(mtmp, SCR_MESSAGE);
		m_initthrow(mtmp, SMG_BULLET, 25);

	}

	if (ptr == &mons[PM_HANNES]) {
		(void) mongets(mtmp, PISTOL);
		(void) mongets(mtmp, LEATHER_ARMOR);
		(void) mongets(mtmp, HELMET);
		(void) mongets(mtmp, WAN_STUN_MONSTER);
		(void) mongets(mtmp, IRON_SHOES);
		m_initthrow(mtmp, PISTOL_BULLET, 50);

	}

	if (ptr == &mons[PM_KATZOU]) {
		(void) mongets(mtmp, POT_AMNESIA);
		(void) mongets(mtmp, POT_CANCELLATION);
		(void) mongets(mtmp, POT_CYANIDE);
		(void) mongets(mtmp, POT_RADIUM);
		(void) mongets(mtmp, POT_SLIME);
		(void) mongets(mtmp, POT_FULL_HEALING);
		(void) mongets(mtmp, POT_INVISIBILITY);
		(void) mongets(mtmp, WAN_POISON);

	}

	if (ptr == &mons[PM_BASCHDI_DEATHSTRIKE]) {
		(void) mongets(mtmp, POT_INVISIBILITY);
		(void) mongets(mtmp, ROCKET_LAUNCHER);
		(void) mongets(mtmp, POT_RADIUM);
		(void) mongets(mtmp, PLATE_MAIL);
		m_initthrow(mtmp, ROCKET, 5);

	}

	if (ptr == &mons[PM_MARKUS]) {
		(void) mongets(mtmp, CLUB);
		(void) mongets(mtmp, T_SHIRT);

	}

	if (ptr == &mons[PM_MARTIN]) {
		(void) mongets(mtmp, GAS_GRENADE);
		(void) mongets(mtmp, RIFLE);
		(void) mongets(mtmp, LOADSTONE);
		(void) mongets(mtmp, SCR_BAD_EFFECT);
		(void) mongets(mtmp, HELM_OF_OPPOSITE_ALIGNMENT);
		(void) mongets(mtmp, VULNERABILITY_CLOAK);
		(void) mongets(mtmp, CLAY_CHAIN);
		(void) mongets(mtmp, SCR_RUMOR);
		(void) mongets(mtmp, SCR_RUMOR);
		m_initthrow(mtmp, CROSSBOW_BOLT, 25);

	}

	if (ptr == &mons[PM_CORINA]) {
		(void) mongets(mtmp, SPIKED_BATTLE_BOOT);
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, STUDDED_LEATHER_ARMOR);
		(void) mongets(mtmp, SCR_CREATE_VICTIM);
		(void) mongets(mtmp, WAN_FINGER_BENDING);

	}

	if (ptr == &mons[PM_ELIF]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, VICTORIAN_UNDERWEAR);

	}

	if (ptr == &mons[PM_SUNALI]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SCR_SIN);
		(void) mongets(mtmp, LEATHER_PEEP_TOES);
		m_initthrow(mtmp, GAS_GRENADE, 5);

	}

	if (ptr == &mons[PM_RHEA]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, WAN_FINGER_BENDING);
		(void) mongets(mtmp, SCR_CREATE_TRAP);
		m_initthrow(mtmp, DART, 50);
		m_initthrow(mtmp, DART, 50);

	}

	if (ptr == &mons[PM_JESSICA]) {
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, SCR_FLOODING);
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, BAG_OF_TRICKS);
		(void) mongets(mtmp, LEATHER_CLOAK);

	}

	if (ptr == &mons[PM_SOLVEJG]) {
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, WAN_EGOISM);
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);

	}

	if (ptr == &mons[PM_THAI]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, SCR_DESTROY_WEAPON);
		(void) mongets(mtmp, SCR_SIN);

	}

	if (ptr == &mons[PM_NADJA]) {
		(void) mongets(mtmp, SCR_TRAP_CREATION);
		(void) mongets(mtmp, SCR_TELE_LEVEL);
		(void) mongets(mtmp, LACQUERED_DANCING_SHOE);
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, SCR_ENRAGE);
		(void) mongets(mtmp, WAN_FINGER_BENDING);

	}

	if (ptr == &mons[PM_JANNIK]) {
		(void) mongets(mtmp, SUBMACHINE_GUN);
		(void) mongets(mtmp, BULLWHIP);
		(void) mongets(mtmp, SCR_RELOCATION);
		(void) mongets(mtmp, SCR_RELOCATION);
		m_initthrow(mtmp, SMG_BULLET, 25);

	}

	if (ptr == &mons[PM_URBALDI]) {
		(void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		(void) mongets(mtmp, SNIPER_RIFLE);
		m_initthrow(mtmp, SNIPER_BULLET, 10);

	}

	if (ptr == &mons[PM_H_]) {
		(void) mongets(mtmp, ATHAME);
		(void) mongets(mtmp, WAN_DRAIN_MANA);
		(void) mongets(mtmp, RIFLE);
		(void) mongets(mtmp, SCR_DESTROY_ARMOR);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		m_initthrow(mtmp, RIFLE_BULLET, 50);

	}

	if (ptr == &mons[PM_PAUL]) {
		(void) mongets(mtmp, KNIFE);
		(void) mongets(mtmp, BULLWHIP);
		(void) mongets(mtmp, LEATHER_JACKET);

	}

	if (ptr == &mons[PM_DAVID]) {
		(void) mongets(mtmp, ASSAULT_RIFLE);
		(void) mongets(mtmp, VOULGE);
		(void) mongets(mtmp, LEATHER_JACKET);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_BARRHING);
		(void) mongets(mtmp, SCR_GROUP_SUMMONING);
		(void) mongets(mtmp, SCR_POWER_HEALING);
		m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);

	}

	if (ptr == &mons[PM_RITA]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, WAN_TRAP_CREATION);
		(void) mongets(mtmp, WAN_CREATE_HORDE);
		(void) mongets(mtmp, SCR_ANTIMATTER);
		(void) mongets(mtmp, SCR_VILENESS);
	}

	if (ptr == &mons[PM_KATI]) {
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

	}

	if (ptr == &mons[PM_JOHANETTA]) {
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, SILVER_DRAGON_SCALES);
		(void) mongets(mtmp, DANCING_SHOES);

	}

	if (ptr == &mons[PM_KLARA]) {
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, WAN_BAD_LUCK);
		(void) mongets(mtmp, WAN_TIDAL_WAVE);

	}

	if (ptr == &mons[PM_SANDRA]) {
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, SPIKED_BATTLE_BOOT);
		(void) mongets(mtmp, SCALE_MAIL);
		(void) mongets(mtmp, LEATHER_CLOAK);
		(void) mongets(mtmp, WAN_DISINTEGRATION_BEAM);
		(void) mongets(mtmp, SCR_VILENESS);

	}

	if (ptr == &mons[PM_MELTEM]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

	}

	if (ptr == &mons[PM_LARISSA]) {
		(void) mongets(mtmp, SCR_TELEPORTATION);
		(void) mongets(mtmp, SCR_TELEPORTATION);
		(void) mongets(mtmp, SCR_CREATE_TRAP);
		(void) mongets(mtmp, WAN_ACID);
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);

	}

	if (ptr == &mons[PM_SUESCHEN]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, SHOTGUN);
		(void) mongets(mtmp, SCR_SUMMON_ELM);
		m_initthrow(mtmp, SHOTGUN_SHELL, 10);

	}

	if (ptr == &mons[PM_DOCTOR_MAEX]) {
		(void) mongets(mtmp, POT_CYANIDE);
		(void) mongets(mtmp, POT_CYANIDE);
		(void) mongets(mtmp, POT_CYANIDE);
		(void) mongets(mtmp, POT_RADIUM);
		(void) mongets(mtmp, POT_RADIUM);
		(void) mongets(mtmp, POT_RADIUM);
		(void) mongets(mtmp, ORCISH_BOW);
		(void) mongets(mtmp, WAN_POISON);
		m_initthrow(mtmp, ORCISH_ARROW, 50);
		m_initthrow(mtmp, ORCISH_ARROW, 50);
		m_initthrow(mtmp, ORCISH_ARROW, 50);
		m_initthrow(mtmp, ORCISH_ARROW, 50);

	}

	if (ptr == &mons[PM_MARC_THE_SPACEWARS_FIGHTER]) {
		(void) mongets(mtmp, DAGGER);
		(void) mongets(mtmp, LEATHER_ARMOR);
		(void) mongets(mtmp, WAN_FIREBALL);
		(void) mongets(mtmp, WAN_SLEEP);

	}

	if (ptr == &mons[PM_ARNE]) {
		(void) mongets(mtmp, POT_SPEED);
		(void) mongets(mtmp, IRON_CHAIN);
		(void) mongets(mtmp, LOW_BOOTS);
		(void) mongets(mtmp, LEATHER_JACKET);
		(void) mongets(mtmp, SCR_DESTROY_WEAPON);

	}

	if (ptr == &mons[PM_HAILBUSH]) {
		(void) mongets(mtmp, SCR_GROWTH);
		(void) mongets(mtmp, SCR_GROWTH);
		(void) mongets(mtmp, SCR_GROWTH);
		(void) mongets(mtmp, SCR_GROWTH);
		(void) mongets(mtmp, SCR_GROWTH);
		(void) mongets(mtmp, CLOAK_OF_REFLECTION);

	}

	if (ptr == &mons[PM_ROMANN]) {
		(void) mongets(mtmp, MALLET);
		(void) mongets(mtmp, SCR_CREATE_VICTIM);

	}

	if (ptr == &mons[PM_SIEGFRIED]) {
		(void) mongets(mtmp, STEEL_WHIP);
		(void) mongets(mtmp, HEAVY_MACHINE_GUN);
		m_initthrow(mtmp, MG_BULLET, 50);

	}

	if (ptr == &mons[PM_ROY]) {
		(void) mongets(mtmp, STEEL_WHIP);
		(void) mongets(mtmp, HEAVY_MACHINE_GUN);
		m_initthrow(mtmp, MG_BULLET, 50);

	}

	if (ptr == &mons[PM_ANTONIA]) {
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, FLY_SWATTER);
		(void) mongets(mtmp, LAB_COAT);

	}

	if (ptr == &mons[PM_DONALD_TRUMP]) {
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		mtmp->mgold += rn1(5000,5000);
	}

	if (ptr == &mons[PM_CHASKA]) {
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, LEATHER_JACKET);
		(void) mongets(mtmp, POT_SPEED);

	}

	if (ptr == &mons[PM_LUDGERA]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, DANCING_SHOES);
		(void) mongets(mtmp, SCR_MEGALOAD);

	}

	if (ptr == &mons[PM_LAURA]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SCR_FLOOD);
		(void) mongets(mtmp, SCR_FLOODING);
		(void) mongets(mtmp, SCR_ICE);
		(void) mongets(mtmp, POT_NUMBNESS);
		(void) mongets(mtmp, POT_STUNNING);
		(void) mongets(mtmp, WAN_CORROSION);
		(void) mongets(mtmp, SILVER_DRAGON_SCALE_MAIL);
		(void) mongets(mtmp, TEMPEST_HORN);

	}

	if (ptr == &mons[PM_EVA]) {
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, SILVER_SPEAR);
		(void) mongets(mtmp, JAVELIN);
		(void) mongets(mtmp, SCR_TRAP_CREATION);
		m_initthrow(mtmp, SPEAR, 10);

	}

	if (ptr == &mons[PM_MAURAH]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, DANCING_SHOES);
		(void) mongets(mtmp, WAN_POISON);
		(void) mongets(mtmp, SCR_BAD_EFFECT);
		(void) mongets(mtmp, SCR_SUMMON_GHOST);
		m_initthrow(mtmp, GAS_GRENADE, 5);

	}

	if (ptr == &mons[PM_SOPHIE]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

	}

	if (ptr == &mons[PM_MARIAN]) {
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, WAN_POISON);

	}

	if (ptr == &mons[PM_ARABELLA_THE_TUFTED_ASIAN_GIRL]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, WAN_BANISHMENT);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, SCR_WARPING);

	}

	if (ptr == &mons[PM_ANASTASIA_THE_SWEET_BLONDE]) {
		(void) mongets(mtmp, DANCING_SHOES);
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, SCR_VILENESS);

	}

	if (ptr == &mons[PM_HENRIETTA_THE_BURLY_WOMAN]) {
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, SCR_TRAP_CREATION);
		(void) mongets(mtmp, SCR_TRAP_CREATION);

	}

	if (ptr == &mons[PM_KATRIN_THE_VIOLET_BEAUTY]) {
		(void) mongets(mtmp, POT_PARALYSIS);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, SCR_CREATE_TRAP);
		(void) mongets(mtmp, SCR_MEGALOAD);
		(void) mongets(mtmp, WAN_IMMOBILITY);

	}

	if (ptr == &mons[PM_JANA_THE_SOFT_WENCH]) {
		(void) mongets(mtmp, POT_URINE);
		(void) mongets(mtmp, SCR_BARRHING);
		(void) mongets(mtmp, SCR_RELOCATION);
		(void) mongets(mtmp, SCR_RELOCATION);
		(void) mongets(mtmp, SCR_RELOCATION);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, WAN_SIN);
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_JIL]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

	}

	if (ptr == &mons[PM_PATRICIA]) {
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

	}

	if (ptr == &mons[PM_KERSTIN]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, BLUE_DRAGON_SCALE_MAIL);
		(void) mongets(mtmp, SCR_POWER_HEALING);

	}

	if (ptr == &mons[PM_SALLY]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, DAGGER);

	}

	if (ptr == &mons[PM_HANH]) {
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		(void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, POT_FULL_HEALING);

	}

	if (ptr == &mons[PM_ANTJE]) {
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, SCR_BULLSHIT);
		(void) mongets(mtmp, SCR_CREATE_VICTIM);

	}

	if (ptr == &mons[PM_JENNIFER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

	}

	if (ptr == &mons[PM_ELKE]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, POT_HEALING);
		(void) mongets(mtmp, POT_HEALING);

	}

	if (ptr == &mons[PM_KARIN]) {
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, WAN_DRAINING);
		(void) mongets(mtmp, WAN_STUN_MONSTER);
		(void) mongets(mtmp, SCR_TRAP_CREATION);

	}

	if (ptr == &mons[PM_NICOLE]) {
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, ELVEN_BOW);
		(void) mongets(mtmp, TEMPEST_HORN);
		m_initthrow(mtmp, ELVEN_ARROW, 50);

	}

	if (ptr == &mons[PM_BETTINA]) {
		(void) mongets(mtmp, SPEED_BOOTS);
		(void) mongets(mtmp, ATHAME);
		(void) mongets(mtmp, T_SHIRT);

	}

	if (ptr == &mons[PM_INA]) {
		(void) mongets(mtmp, WAN_STARVATION);
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, WAN_EXTRA_HEALING);

	}

	if (ptr == &mons[PM_HEIKE]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SPEED_BOOTS);
		(void) mongets(mtmp, PISTOL);
		(void) mongets(mtmp, SCR_SIN);
		(void) mongets(mtmp, SCR_DESTROY_WEAPON);
		m_initthrow(mtmp, PISTOL_BULLET, 20);

	}

	if (ptr == &mons[PM_DORA]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, BULLWHIP);
		(void) mongets(mtmp, POT_GAIN_LEVEL);
		(void) mongets(mtmp, POT_GAIN_LEVEL);
		(void) mongets(mtmp, POT_HEALING);
		(void) mongets(mtmp, SCR_CREATE_TRAP);

	}

	if (ptr == &mons[PM_MAITE]) {
		(void) mongets(mtmp, POT_CYANIDE);
		(void) mongets(mtmp, WAN_INERTIA);
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

	}

	if (ptr == &mons[PM_RUTH]) {
		(void) mongets(mtmp, POT_RADIUM);
		(void) mongets(mtmp, POT_RADIUM);
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SCR_CREATE_MONSTER);

	}

	if (ptr == &mons[PM_VERENA]) {
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, SCR_TELEPORTATION);
		(void) mongets(mtmp, SCR_POWER_HEALING);
		(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);

	}

	if (ptr == &mons[PM_LOU]) {
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, WAN_POISON);
		(void) mongets(mtmp, POT_EXTRA_HEALING);
		(void) mongets(mtmp, POT_EXTRA_HEALING);
		(void) mongets(mtmp, POT_EXTRA_HEALING);

	}

	if (ptr == &mons[PM_DANIELLE]) {
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, WAN_CANCELLATION);
		(void) mongets(mtmp, WAN_TIME);
		(void) mongets(mtmp, RIFLE);
		m_initthrow(mtmp, RIFLE_BULLET, 50);

	}

	if (ptr == &mons[PM_AMANDINE]) {
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, SCR_MESSAGE);
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_LILY]) {
		(void) mongets(mtmp, ORCISH_DAGGER);

	}

	if (ptr == &mons[PM_LEONIE]) {
		(void) mongets(mtmp, SHORT_SWORD);

	}

	if (ptr == &mons[PM_MIRA]) {
		(void) mongets(mtmp, POT_HEALING);
		(void) mongets(mtmp, POT_HEALING);
		(void) mongets(mtmp, POT_HEALING);
		(void) mongets(mtmp, POT_HEALING);
		(void) mongets(mtmp, POT_HEALING);
		(void) mongets(mtmp, POT_EXTRA_HEALING);
		(void) mongets(mtmp, POT_EXTRA_HEALING);
		(void) mongets(mtmp, POT_EXTRA_HEALING);
		(void) mongets(mtmp, POT_FULL_HEALING);
		(void) mongets(mtmp, WAN_INCREASE_MAX_HITPOINTS);
	}

	if (ptr == &mons[PM_SOFIA]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, SCR_EGOISM);

	}

	if (ptr == &mons[PM_CHRISTIANE]) {
		(void) mongets(mtmp, SCR_BAD_EFFECT);
		(void) mongets(mtmp, WAN_BAD_EFFECT);
		(void) mongets(mtmp, SCR_TELEPORTATION);

	}

	if (ptr == &mons[PM_ANN_KATHRIN]) {
		(void) mongets(mtmp, DANCING_SHOES);
		(void) mongets(mtmp, LACQUERED_DANCING_SHOE);
		(void) mongets(mtmp, SCR_TELEPORTATION);

	}

	if (ptr == &mons[PM_NJUSHA]) {
		(void) mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, WAN_CONFUSION);

	}

	if (ptr == &mons[PM_DESIREE]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, KNIFE);
		(void) mongets(mtmp, POT_HEALING);
		(void) mongets(mtmp, WAN_CREATE_MONSTER);

	}

	if (ptr == &mons[PM_CELIA]) {
		(void) mongets(mtmp, SCR_BULLSHIT);
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, WAN_POISON);

	}

	if (ptr == &mons[PM_ELIANE]) {
		(void) mongets(mtmp, WAN_PARALYSIS);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, POT_PARALYSIS);
		(void) mongets(mtmp, POT_PARALYSIS);
		(void) mongets(mtmp, POT_PARALYSIS);
		(void) mongets(mtmp, SCR_POWER_HEALING);
		(void) mongets(mtmp, SCR_RELOCATION);
	}

	if (ptr == &mons[PM_FENJA]) {
		(void) mongets(mtmp, WAN_DISINTEGRATION);
		(void) mongets(mtmp, WAN_STONING);
		(void) mongets(mtmp, WAN_STUN_MONSTER);
		(void) mongets(mtmp, WAN_FULL_HEALING);
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, HEAVY_MACHINE_GUN);
		(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		m_initthrow(mtmp, MG_BULLET, 50);
		m_initthrow(mtmp, MG_BULLET, 50);
		m_initthrow(mtmp, MG_BULLET, 50);
		m_initthrow(mtmp, MG_BULLET, 50);
	}

	if (ptr == &mons[PM_SILVANA]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SCALPEL);
		(void) mongets(mtmp, SCR_EARTH);
		(void) mongets(mtmp, SCR_FIRE);
	}

	if (ptr == &mons[PM_MANDARINA]) {
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, CRYSKNIFE);
		(void) mongets(mtmp, STUDDED_LEATHER_ARMOR);
		(void) mongets(mtmp, SCR_HEALING);
		(void) mongets(mtmp, SCR_HEALING);
		(void) mongets(mtmp, SCR_HEALING);
		(void) mongets(mtmp, SCR_HEALING);
		(void) mongets(mtmp, SCR_HEALING);

	}

	if (ptr == &mons[PM_ARIANE]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, WAN_REDUCE_MAX_HITPOINTS);
		(void) mongets(mtmp, WAN_STRIKING);
		(void) mongets(mtmp, WAN_CHROMATIC_BEAM);

	}

	if (ptr == &mons[PM_CARINA]) {
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, POT_PARALYSIS);
		(void) mongets(mtmp, LEATHER_JACKET);

	}

	if (ptr == &mons[PM_DENISE]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);

	}

	if (ptr == &mons[PM_KIRA]) {
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, WAN_HEALING);

	}

	if (ptr == &mons[PM_NADINE]) {
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		(void) mongets(mtmp, SILVER_DRAGON_SCALES);
		(void) mongets(mtmp, WAN_ACID);
		(void) mongets(mtmp, WAN_SUMMON_ELM);
		(void) mongets(mtmp, SCR_TELEPORTATION);

	}

	if (ptr == &mons[PM_RONJA]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, WAN_STUN_MONSTER);
		(void) mongets(mtmp, POT_EXTRA_HEALING);
		(void) mongets(mtmp, LEATHER_JACKET);
		(void) mongets(mtmp, CLOAK_OF_MAGIC_RESISTANCE);

	}

	if (ptr == &mons[PM_ELISABETH]) {
		(void) mongets(mtmp, SCR_FLOOD);
		(void) mongets(mtmp, SCR_FLOODING);

	}

	if (ptr == &mons[PM_CONNY]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, SCR_BAD_EFFECT);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		(void) mongets(mtmp, SCR_CREATE_TRAP);
		m_initthrow(mtmp, DART, 50);

	}

	if (ptr == &mons[PM_LISA]) {
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, WAN_LIGHTNING);
		(void) mongets(mtmp, SCR_ENRAGE);
		(void) mongets(mtmp, POT_BLINDNESS);

	}

	if (ptr == &mons[PM_ANJA]) {
		(void) mongets(mtmp, SWEET_MOCASSINS);

	}

	if (ptr == &mons[PM_YASAMAN]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, LEATHER_CLOAK);
		(void) mongets(mtmp, SCR_SUMMON_GHOST);

	}

	if (ptr == &mons[PM_ALMUTH]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, WAN_CORROSION);

	}

	if (ptr == &mons[PM_KSENIA]) {
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, SCR_HEALING);
		(void) mongets(mtmp, RIN_TIMELY_BACKUP);
		(void) mongets(mtmp, POT_FEAR);
		(void) mongets(mtmp, POT_SPEED);
		(void) mongets(mtmp, WAN_TELE_LEVEL);
		(void) mongets(mtmp, WAN_CHROMATIC_BEAM);

	}

	if (ptr == &mons[PM_MIRIAM]) {
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, POT_SLEEPING);
		(void) mongets(mtmp, POT_STUNNING);

	}

	if (ptr == &mons[PM_ELENA]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		(void) mongets(mtmp, POT_CONFUSION);
		(void) mongets(mtmp, POT_HALLUCINATION);
		(void) mongets(mtmp, SCR_CHAOS_TERRAIN);
		(void) mongets(mtmp, WAN_FULL_HEALING);
		(void) mongets(mtmp, AMULET_OF_DATA_STORAGE);
	}

	if (ptr == &mons[PM_KATHARINA]) {
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, POT_CANCELLATION);
		(void) mongets(mtmp, POT_AMNESIA);
		(void) mongets(mtmp, SCR_SUMMON_UNDEAD);
		(void) mongets(mtmp, WAN_FULL_HEALING);
		(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
	}

	if (ptr == &mons[PM_HELEN]) {
		(void) mongets(mtmp, WAN_BAD_EFFECT);
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, SCR_RELOCATION);
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		m_initthrow(mtmp, DART, 30);
		m_initthrow(mtmp, SHURIKEN, 5);

	}

	if (ptr == &mons[PM_LUCIA]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, WAR_HAMMER);

	}

	if (ptr == &mons[PM_VICTORIA]) {
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, SCR_PUNISHMENT);
		(void) mongets(mtmp, SCR_SIN);
		(void) mongets(mtmp, WAN_REMOVE_RESISTANCE);

	}

	if (ptr == &mons[PM_SIMONE]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, WAN_LYCANTHROPY);
		(void) mongets(mtmp, POT_FIRE);
		(void) mongets(mtmp, POT_ICE);
		(void) mongets(mtmp, POT_FEAR);
		(void) mongets(mtmp, SCR_DESTROY_WEAPON);
		(void) mongets(mtmp, DANCING_SHOES);

	}

	if (ptr == &mons[PM_NATALIYA]) {
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, POT_BLINDNESS);
		(void) mongets(mtmp, SCR_CLOUDS);
	}

	if (ptr == &mons[PM_KRISTIN]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SCR_GROUP_SUMMONING);
		(void) mongets(mtmp, RIN_TIMELY_BACKUP);
		(void) mongets(mtmp, RIN_TIMELY_BACKUP);
		(void) mongets(mtmp, RIN_TIMELY_BACKUP);
		(void) mongets(mtmp, RIN_TIMELY_BACKUP);
		(void) mongets(mtmp, RIN_TIMELY_BACKUP);
		(void) mongets(mtmp, WAN_REMOVE_RESISTANCE);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SCR_CREATE_VICTIM);
		(void) mongets(mtmp, SCR_CREATE_VICTIM);
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */

	}

	if (ptr == &mons[PM_NELLY]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, WAN_GAIN_LEVEL);

	}

	if (ptr == &mons[PM_REJDA]) {
		(void) mongets(mtmp, ASSAULT_RIFLE);
		(void) mongets(mtmp, POT_SPEED);
		(void) mongets(mtmp, WAN_DRAIN_MANA);
		(void) mongets(mtmp, POT_INVISIBILITY);
		m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);
		m_initthrow(mtmp, ASSAULT_RIFLE_BULLET, 50);

	}

	if (ptr == &mons[PM_VERA]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, WAN_COLD);
		(void) mongets(mtmp, POT_ICE);
		(void) mongets(mtmp, SCR_ICE);
		(void) mongets(mtmp, POT_ICE);
		(void) mongets(mtmp, SCR_ICE);
		(void) mongets(mtmp, POT_ICE);
		(void) mongets(mtmp, SCR_ICE);
		(void) mongets(mtmp, WHITE_DRAGON_SCALES);
		(void) mongets(mtmp, CLOAK_OF_WARMTH);
		(void) mongets(mtmp, ICE_SHIELD);
		(void) mongets(mtmp, WAN_INCREASE_MAX_HITPOINTS);
	}

	if (ptr == &mons[PM_NORA]) {
		(void) mongets(mtmp, POT_SPEED);
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, POT_GAIN_LEVEL);
		(void) mongets(mtmp, POT_MUTATION);
		(void) mongets(mtmp, WAN_CREATE_HORDE);
	}

	if (ptr == &mons[PM_JASIEEN]) {
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, RIN_TIMELY_BACKUP);
		(void) mongets(mtmp, AMULET_OF_LIFE_SAVING);
		(void) mongets(mtmp, CLOAK_OF_REFLECTION);
		(void) mongets(mtmp, BLACK_DRAGON_SCALE_MAIL);
		(void) mongets(mtmp, HELM_OF_STEEL);
		(void) mongets(mtmp, GAUNTLETS_OF_STEEL);
		(void) mongets(mtmp, T_SHIRT);
		(void) mongets(mtmp, VENOM_SHIELD);
	}

	if (ptr == &mons[PM_MARIKE]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, POT_URINE);
		(void) mongets(mtmp, WAN_SLIMING);
	}

	if (ptr == &mons[PM_MERLE]) {
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

	}

	if (ptr == &mons[PM_MARIANNE]) {
		(void) mongets(mtmp, SCR_WOUNDS);

	}

	if (ptr == &mons[PM_SINA]) {
		(void) mongets(mtmp, DANCING_SHOES);
		(void) mongets(mtmp, CLUB);
		(void) mongets(mtmp, POT_ACID);

	}

	if (ptr == &mons[PM_DOROTHEA]) {
		(void) mongets(mtmp, RUBBER_HOSE);

	}

	if (ptr == &mons[PM_TINANYA]) {
		(void) mongets(mtmp, AMULET_OF_LIFE_SAVING);
		(void) mongets(mtmp, LEATHER_PEEP_TOES);
		(void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, SPEAR);
	}

	if (ptr == &mons[PM_ALINE]) {
		(void) mongets(mtmp, T_SHIRT);
		(void) mongets(mtmp, RING_MAIL);
		(void) mongets(mtmp, MACE);

	}

	if (ptr == &mons[PM_MICHAELA]) {
		(void) mongets(mtmp, LARGE_SHIELD);
		(void) mongets(mtmp, SCIMITAR);
		(void) mongets(mtmp, UNICORN_HORN);

	}

	if (ptr == &mons[PM_MARE]) {
		(void) mongets(mtmp, TORPEDO);
		(void) mongets(mtmp, DANCING_SHOES);
		(void) mongets(mtmp, WAN_SPEED_MONSTER);
		(void) mongets(mtmp, LEATHER_ARMOR);
		(void) mongets(mtmp, POT_STUNNING);
		(void) mongets(mtmp, SCR_SUMMON_GHOST);
		m_initthrow(mtmp, SPIRIT_THROWER, 5);
	}

	if (ptr == &mons[PM_NOEMI]) {
		(void) mongets(mtmp, POT_URINE);
		(void) mongets(mtmp, SCR_ICE);
		(void) mongets(mtmp, WAN_AMNESIA);
		(void) mongets(mtmp, VICTORIAN_UNDERWEAR);

	}

	if (ptr == &mons[PM_GIULIA]) {
		(void) mongets(mtmp, DANCING_SHOES);
		(void) mongets(mtmp, LACQUERED_DANCING_SHOE);
		(void) mongets(mtmp, POT_FIRE);
		(void) mongets(mtmp, WAN_CREATE_HORDE);
	}

	if (ptr == &mons[PM_LEA]) {
		(void) mongets(mtmp, SCR_TELEPORTATION);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		(void) mongets(mtmp, KNIFE);

	}

	if (ptr == &mons[PM_SARAH]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, DANCING_SHOES);
		(void) mongets(mtmp, SCR_BAD_EFFECT);

	}

	if (ptr == &mons[PM_SARINA]) {
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SCR_ICE);
		(void) mongets(mtmp, POT_HEALING);
	}

	if (ptr == &mons[PM_ALEXIA]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);	
		(void) mongets(mtmp, WAN_BAD_EFFECT);	
		(void) mongets(mtmp, WAN_FINGER_BENDING);	

	}

	if (ptr == &mons[PM_ISIS]) {
		(void) mongets(mtmp, DANCING_SHOES);
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		(void) mongets(mtmp, POT_FULL_HEALING);
		(void) mongets(mtmp, SCR_WARPING);
		(void) mongets(mtmp, WAN_DIGGING);
	}

	if (ptr == &mons[PM_ILSE]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, CLOAK_OF_PROTECTION);
		(void) mongets(mtmp, SCR_HEALING);
	}

	if (ptr == &mons[PM_MELANIE]) {
		(void) mongets(mtmp, DANCING_SHOES);
		(void) mongets(mtmp, SCR_WOUNDS);
		(void) mongets(mtmp, SPIKED_BATTLE_BOOT);
	}

	if (ptr == &mons[PM_LARA]) {
		(void) mongets(mtmp, SCR_BAD_EFFECT);
		(void) mongets(mtmp, POT_SPEED);

	}

	if (ptr == &mons[PM_JANINA]) {
		(void) mongets(mtmp, SPIKED_BATTLE_BOOT);
		(void) mongets(mtmp, COMBAT_STILETTOS);

	}

	if (ptr == &mons[PM_MICHA]) {
		(void) mongets(mtmp, RUBBER_HOSE);
		m_initthrow(mtmp, CREAM_PIE, 4);

	}

	if (ptr == &mons[PM_FRANZI]) {
		(void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		(void) mongets(mtmp, SCR_FLOOD);
		(void) mongets(mtmp, SCR_RUMOR);
	}

	if (ptr == &mons[PM_AMELIE]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		(void) mongets(mtmp, SCR_CREATE_TRAP);

	}

	if (ptr == &mons[PM_ANNIKA]) {
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, POT_URINE);
		(void) mongets(mtmp, SCR_GROWTH);
	}

	if (ptr == &mons[PM_BARBARA]) {
		(void) mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		(void) mongets(mtmp, WAN_LIGHTNING);
		(void) mongets(mtmp, POT_NUMBNESS);
		(void) mongets(mtmp, SCR_TELEPORTATION);
	}

	if (ptr == &mons[PM_ELSA]) {
		(void) mongets(mtmp, POT_CANCELLATION);

	}

	if (ptr == &mons[PM_ISABEL]) {
		(void) mongets(mtmp, POT_URINE);

	}

	if (ptr == &mons[PM_THUY_HAN]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SCR_BAD_EFFECT);

	}

	if (ptr == &mons[PM_CHARLOTTE]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, RIFLE);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		m_initthrow(mtmp, RIFLE_BULLET, 20);
	}

	if (ptr == &mons[PM_FRIEDERIKE]) {
		(void) mongets(mtmp, POT_ICE);
		(void) mongets(mtmp, DANCING_SHOES);
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SCR_SUMMON_BOSS);
		(void) mongets(mtmp, SCR_SUMMON_ELM);
		(void) mongets(mtmp, POT_AMNESIA);
	}

	if (ptr == &mons[PM_SOPHIA]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, SCR_DESTROY_ARMOR);
		(void) mongets(mtmp, SCR_IMMOBILITY);
		(void) mongets(mtmp, SCR_DESTROY_ARMOR);
		(void) mongets(mtmp, POT_FEAR);
	}

	if (ptr == &mons[PM_SUE_LYN]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, DANCING_SHOES);
		(void) mongets(mtmp, WAN_BAD_EFFECT);
		(void) mongets(mtmp, AMULET_OF_DATA_STORAGE);
		(void) mongets(mtmp, WAN_GAIN_LEVEL);
		(void) mongets(mtmp, WAN_TIDAL_WAVE);
	}

	if (ptr == &mons[PM_JUEN]) {
		(void) mongets(mtmp, LEATHER_PEEP_TOES);
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, CLOAK_OF_DEATH);
		(void) mongets(mtmp, POT_VAMPIRE_BLOOD);
		(void) mongets(mtmp, SCR_PUNISHMENT);
	}

	if (ptr == &mons[PM_RUEA]) {
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		(void) mongets(mtmp, SCR_BULLSHIT);
		(void) mongets(mtmp, WAN_REMOVE_RESISTANCE);
	}

	if (ptr == &mons[PM_MARIYA]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, SCR_BAD_EFFECT);
		(void) mongets(mtmp, WAN_AMNESIA);
		(void) mongets(mtmp, WAN_SIN);
		(void) mongets(mtmp, POT_CONFUSION);
	}

	if (ptr == &mons[PM_WENDY_O__KOOPA]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, POT_NUMBNESS);
		(void) mongets(mtmp, SCR_TRAP_CREATION);
	}

	if (ptr == &mons[PM_KATIA]) {
		(void) mongets(mtmp, POT_GAIN_LEVEL);
		(void) mongets(mtmp, WAN_GAIN_LEVEL);
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, SCR_BULLSHIT);
		(void) mongets(mtmp, SCR_MEGALOAD);
		(void) mongets(mtmp, POT_URINE);
	}

	if (ptr == &mons[PM_TANJA]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, POT_STUNNING);
		(void) mongets(mtmp, POT_CONFUSION);
	}

	if (ptr == &mons[PM_VANESSA]) {
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, FLAIL);
		(void) mongets(mtmp, SCR_BARRHING);
		(void) mongets(mtmp, SCR_EGOISM);
		(void) mongets(mtmp, WAN_POISON);

	}

	if (ptr == &mons[PM_ANNE]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, WAN_SLIMING);
		(void) mongets(mtmp, SCR_GROUP_SUMMONING);
		(void) mongets(mtmp, SCR_DESTROY_WEAPON);

	}

	if (ptr == &mons[PM_LENA]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, WAN_STRIKING);
		(void) mongets(mtmp, T_SHIRT);

	}

	if (ptr == &mons[PM_JEANETTA]) {
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		(void) mongets(mtmp, WAN_SLOW_MONSTER);
		(void) mongets(mtmp, WAN_STUN_MONSTER);
		(void) mongets(mtmp, DANCING_SHOES);
		(void) mongets(mtmp, SCR_CREATE_TRAP);
	}

	if (ptr == &mons[PM_GUDRUN]) {
		(void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, RIFLE);
		(void) mongets(mtmp, POT_ICE);
		(void) mongets(mtmp, SCR_TELEPORTATION);
		(void) mongets(mtmp, SCR_SUMMON_GHOST);
		(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		m_initthrow(mtmp, RIFLE_BULLET, 50);
	}

	if (ptr == &mons[PM_MELISSA]) {
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		(void) mongets(mtmp, SCR_SUMMON_ELM);
		(void) mongets(mtmp, LEATHER_ARMOR);
		(void) mongets(mtmp, LEATHER_CLOAK);
		(void) mongets(mtmp, WAN_STRIKING);
		(void) mongets(mtmp, TEMPEST_HORN);
	}

	if (ptr == &mons[PM_ELLA]) {
		(void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		(void) mongets(mtmp, WAN_BAD_EFFECT);
		(void) mongets(mtmp, PLASTEEL_HELM);
		(void) mongets(mtmp, RIN_TIMELY_BACKUP);
		(void) mongets(mtmp, RIN_TIMELY_BACKUP);
		(void) mongets(mtmp, RIN_TIMELY_BACKUP);
		(void) mongets(mtmp, RIN_TIMELY_BACKUP);
		(void) mongets(mtmp, WAN_SUMMON_UNDEAD);
		(void) mongets(mtmp, WAN_TIME);
		(void) mongets(mtmp, SCR_PUNISHMENT);
		(void) mongets(mtmp, SCR_POWER_HEALING);
		(void) mongets(mtmp, POT_AMNESIA);
		(void) mongets(mtmp, SCR_VILENESS);
	}

	if (ptr == &mons[PM_MADELEINE]) {
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		(void) mongets(mtmp, WAN_FINGER_BENDING);
		(void) mongets(mtmp, SCR_BULLSHIT);
	}

	if (ptr == &mons[PM_ANITA]) {
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, SCR_WOUNDS);
		(void) mongets(mtmp, SCR_WOUNDS);
		(void) mongets(mtmp, SCR_WOUNDS);
		(void) mongets(mtmp, SCR_WOUNDS);
		(void) mongets(mtmp, SCR_WOUNDS);
		(void) mongets(mtmp, SCR_ENRAGE);
		(void) mongets(mtmp, SCR_GROUP_SUMMONING);
	}

	if (ptr == &mons[PM_NINA]) {
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, STILETTO);
		(void) mongets(mtmp, WAN_STUN_MONSTER);
		(void) mongets(mtmp, SCR_SUMMON_BOSS);
		(void) mongets(mtmp, SCR_CREATE_VICTIM);

	}

	if (ptr == &mons[PM_NATASCHA]) {
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		(void) mongets(mtmp, LEATHER_GLOVES);
		(void) mongets(mtmp, SHIELD_OF_REFLECTION);
	}

	if (ptr == &mons[PM_MANUELA]) {
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, SPIKED_BATTLE_BOOT);
		(void) mongets(mtmp, WAN_CREATE_HORDE);
		(void) mongets(mtmp, DEEP_DRAGON_SCALE_MAIL);
		(void) mongets(mtmp, LAB_COAT);
		(void) mongets(mtmp, PLASTEEL_GLOVES);
		(void) mongets(mtmp, BUGLE);
		(void) mongets(mtmp, POT_POLYMORPH);
		(void) mongets(mtmp, WAN_PUNISHMENT);
		(void) mongets(mtmp, SCR_LAVA);
		(void) mongets(mtmp, SCR_STONING);
		(void) mongets(mtmp, SCR_ANTIMATTER);
		(void) mongets(mtmp, WAN_DISINTEGRATION);
		(void) mongets(mtmp, WAN_POISON);
		(void) mongets(mtmp, SCR_VILENESS);
	}

	if (ptr == &mons[PM_TILLA]) {
		(void) mongets(mtmp, GLAIVE);
		(void) mongets(mtmp, POT_BLINDNESS);
		(void) mongets(mtmp, POT_BLINDNESS);
		(void) mongets(mtmp, POT_BLINDNESS);
		m_initthrow(mtmp, CREAM_PIE, 5);
	}

	if (ptr == &mons[PM_GRETA]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, WAN_MAKE_VISIBLE);
		(void) mongets(mtmp, SCR_DESTROY_ARMOR);
		(void) mongets(mtmp, SCR_DESTROY_WEAPON);
		(void) mongets(mtmp, POT_RADIUM);
		(void) mongets(mtmp, SCR_SUMMON_GHOST);
	}

	if (ptr == &mons[PM_JANE]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, DANCING_SHOES);
		(void) mongets(mtmp, POT_FIRE);
		(void) mongets(mtmp, WAN_EGOISM);
		(void) mongets(mtmp, SCR_TRAP_CREATION);
		(void) mongets(mtmp, SCR_CREATE_TRAP);
		(void) mongets(mtmp, WAN_CREATE_MONSTER);
	}

	if (ptr == &mons[PM_NATALJE]) {
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, BAG_OF_TRICKS);
		(void) mongets(mtmp, POT_GAIN_LEVEL);
		(void) mongets(mtmp, POT_CYANIDE);
		(void) mongets(mtmp, WAN_CURSE_ITEMS);
		(void) mongets(mtmp, WAN_POLYMORPH);
		(void) mongets(mtmp, SCR_POWER_HEALING);
		(void) mongets(mtmp, SCR_ENRAGE);
		(void) mongets(mtmp, SCR_RELOCATION);
	}

	if (ptr == &mons[PM_LITTLE_MARIE]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SPEED_BOOTS);
		(void) mongets(mtmp, WAN_CREATE_HORDE);
		(void) mongets(mtmp, WAN_SUMMON_UNDEAD);
		(void) mongets(mtmp, SCR_WARPING);
		(void) mongets(mtmp, SCR_IMMOBILITY);
		(void) mongets(mtmp, SCR_SIN);
		(void) mongets(mtmp, SCR_GROUP_SUMMONING);
		(void) mongets(mtmp, POT_HALLUCINATION);
		(void) mongets(mtmp, SUBMACHINE_GUN);
		(void) mongets(mtmp, AMULET_OF_DATA_STORAGE);
		(void) mongets(mtmp, SCR_VILENESS);
		m_initthrow(mtmp, SMG_BULLET, 50);
		m_initthrow(mtmp, SMG_BULLET, 50);
	}

	if (ptr == &mons[PM_TONJA]) {
		(void) mongets(mtmp, SPIKED_BATTLE_BOOT);
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, WAN_DEATH);

	}

	if (ptr == &mons[PM_ANNEMARIE]) {
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, LEATHER_PEEP_TOES);
		(void) mongets(mtmp, ROCKET_LAUNCHER);
		(void) mongets(mtmp, POT_FEAR);
		(void) mongets(mtmp, SCR_HEALING);
		(void) mongets(mtmp, SCR_CHAOS_TERRAIN);
		(void) mongets(mtmp, WAN_FIREBALL);
		(void) mongets(mtmp, WAN_SUMMON_ELM);
		m_initthrow(mtmp, ROCKET, 5);
	}

	if (ptr == &mons[PM_CARO]) {
		(void) mongets(mtmp, WAN_FIRE);
		(void) mongets(mtmp, LEATHER_JACKET);

	}

	if (ptr == &mons[PM_BIANCA]) {
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, LEATHER_PEEP_TOES);
		(void) mongets(mtmp, SCR_EGOISM);
		(void) mongets(mtmp, WAN_EGOISM);
		(void) mongets(mtmp, WAN_SOLAR_BEAM);
		(void) mongets(mtmp, AMULET_OF_DATA_STORAGE);
		(void) mongets(mtmp, ORANGE_DRAGON_SCALES);
	}

	if (ptr == &mons[PM_CARMEN]) {
		(void) mongets(mtmp, SPEED_BOOTS);
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, WAN_EXTRA_HEALING);
	}

	if (ptr == &mons[PM_HILDA]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, WAN_INERTIA);
		(void) mongets(mtmp, SCR_SUMMON_BOSS);

	}

	if (ptr == &mons[PM_JOHANNA]) {
		(void) mongets(mtmp, POT_CONFUSION);

	}

	if (ptr == &mons[PM_JULIETTA]) {
		(void) mongets(mtmp, LACQUERED_DANCING_SHOE);
		(void) mongets(mtmp, POT_AMNESIA);
		(void) mongets(mtmp, WAN_AMNESIA);
		(void) mongets(mtmp, WAN_DISINTEGRATION_BEAM);
		(void) mongets(mtmp, SCR_AMNESIA);
		(void) mongets(mtmp, SCR_WARPING);
		(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
	}

	if (ptr == &mons[PM_LINDA]) {
		(void) mongets(mtmp, WAN_CREATE_HORDE);

	}

	if (ptr == &mons[PM_PETRA]) {
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, DANCING_SHOES);
		(void) mongets(mtmp, WAN_PARALYSIS);
		(void) mongets(mtmp, WAN_STUN_MONSTER);

	}

	if (ptr == &mons[PM_SONJA]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, SCR_SUMMON_BOSS);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		(void) mongets(mtmp, SCR_SUMMON_UNDEAD);
		(void) mongets(mtmp, LEATHER_JACKET);
		(void) mongets(mtmp, POT_POLYMORPH);
		(void) mongets(mtmp, SCR_MESSAGE);
	}

	if (ptr == &mons[PM_STELLA]) {
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		(void) mongets(mtmp, WAN_CREATE_MONSTER);
		(void) mongets(mtmp, POT_BLINDNESS);

	}

	if (ptr == &mons[PM_TERESA]) {
		(void) mongets(mtmp, POT_NUMBNESS);
		(void) mongets(mtmp, POT_NUMBNESS);
		(void) mongets(mtmp, POT_NUMBNESS);
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, LANCE);

	}

	if (ptr == &mons[PM_ROSY]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, POT_SPEED);
		(void) mongets(mtmp, SCR_CLOUDS);
		(void) mongets(mtmp, CREAM_PIE);
		(void) mongets(mtmp, POT_BLINDNESS);
	}

	if (ptr == &mons[PM_SING]) {
		(void) mongets(mtmp, POT_VAMPIRE_BLOOD);
		(void) mongets(mtmp, POT_VAMPIRE_BLOOD);
		(void) mongets(mtmp, POT_VAMPIRE_BLOOD);
		(void) mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		(void) mongets(mtmp, POT_PARALYSIS);
		(void) mongets(mtmp, POT_CONFUSION);
		(void) mongets(mtmp, ROBE);
		(void) mongets(mtmp, SCR_ENRAGE);
	}
	if (ptr == &mons[PM_VAMPIRE_SING]) {
		(void) mongets(mtmp, POT_VAMPIRE_BLOOD);
		(void) mongets(mtmp, POT_VAMPIRE_BLOOD);
		(void) mongets(mtmp, POT_VAMPIRE_BLOOD);
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);
		(void) mongets(mtmp, find_buffalo_boots());
	}

	if (ptr == &mons[PM_EROGENOUS_KATIA]) {

		mtmp->crapbonus += 50;

	}

	if (ptr == &mons[PM_ANAL_SAMURAI]) {

		mtmp->crapbonus += 10;

	}

	if (ptr == &mons[PM_CRAP_FEMMY]) {

		mtmp->crapbonus += 50;

	}

	if (ptr == &mons[PM_CRAP_TITAN]) {

		mtmp->crapbonus += 10;

	}

	if (ptr == &mons[PM_HOLLANDIC_FEMMY]) {

		mtmp->crapbonus += 10;

	}

	if (ptr == &mons[PM_TOILET_FEMMY]) {

		mtmp->crapbonus += 20;

	}

	if (ptr == &mons[PM_VIET_BOSS]) {

		mtmp->crapbonus += 10;

	}

	if (ptr == &mons[PM_PRINCESS_CATHLETTE]) {

		mtmp->fartbonus += 9;

	}

	if (ptr == &mons[PM_VENERABLE_FEMMY]) {

		mtmp->fartbonus += 9;

	}

	if (ptr == &mons[PM_MASTER_PO]) {

		mtmp->fartbonus += 5;

	}

	if (ptr == &mons[PM_MASTER_BUTT]) {

		mtmp->fartbonus += 6;

	}

	if (ptr == &mons[PM_SUSTAINED_FART_FEMMY]) {

		mtmp->fartbonus += 9;

	}

	if (ptr == &mons[PM_DUDE_WHO_CAN_FART_REALLY_WELL]) {

		mtmp->fartbonus += 9;

	}

	if (ptr == &mons[PM_ABSENCE_OF_NOISE_FEMMY]) {

		mtmp->fartbonus += 7;
		mtmp->crapbonus += 10;

	}

	if (ptr == &mons[PM_POPO_CHAMBO]) {

		mtmp->fartbonus += 5;

	}

	if (ptr == &mons[PM_SARAH_AIR_EMITTER]) {

		mtmp->fartbonus += 5;

	}

	if (ptr == &mons[PM_KATI_NOISE_TRAP]) {

		mtmp->fartbonus += 7;

	}

	if (ptr == &mons[PM_THAI_NOISE_EVENT]) {

		mtmp->crapbonus += 10;

	}

	if (ptr == &mons[PM_KATIA_NOISE_CHARM]) {

		mtmp->crapbonus += 20;

	}

	if (ptr == &mons[PM_ANTJE_SEX_AREA]) {

		mtmp->crapbonus += 10;

	}

	if (ptr == &mons[PM_LUDGERA_NOISE_COURSE]) {

		mtmp->crapbonus += 10;

	}

	if (ptr == &mons[PM_ELIF_AIR_CANAL]) {

		mtmp->fartbonus += 7;

	}

	if (ptr == &mons[PM_SANDRA_NOISE_EXPERIENCE]) {

		mtmp->fartbonus += 7;

	}

	if (ptr == &mons[PM_MARIKE_BUTT]) {

		mtmp->fartbonus += 9;
		mtmp->crapbonus += 10;

	}

	if (ptr == &mons[PM_WENDY_NOISE_ABORT]) {

		mtmp->fartbonus += 7;
		mtmp->crapbonus += 10;

	}

	if (ptr == &mons[PM_ELENA_NOISE_REWARD]) {

		mtmp->fartbonus += 9;
		mtmp->crapbonus += 5;

	}

	if (ptr == &mons[PM_KATHARINA_NOISE_CHALLENGE]) {

		mtmp->fartbonus += 9;
		mtmp->crapbonus += 10;

	}

	if (ptr == &mons[PM_INA_NOISE_OCCURRENCE]) {

		mtmp->fartbonus += 6;

	}

	if (ptr == &mons[PM_MAURAH_NOISE_EMITTER]) {

		mtmp->fartbonus += 4;

	}

	if (ptr == &mons[PM_NICE_EVIL_GIRL]) {

		mtmp->fartbonus += 9;

	}

	if (ptr == &mons[PM_INDIAN_QUEEN]) {

		mtmp->fartbonus += 9;
		mtmp->crapbonus += 20;

	}

	if (ptr == &mons[PM_AUNTIE_WENDY]) {

		mtmp->fartbonus += 9;

	}

	if (ptr == &mons[PM_BLOND_SWOON_BUNDLE_HARE]) {

		mtmp->fartbonus += 9;

	}

	if (ptr == &mons[PM_SIMONE]) {

		mtmp->fartbonus += 2;

	}

	if (ptr == &mons[PM_TURKISH_BANDIT]) {

		mtmp->crapbonus += 7;

	}

	if (ptr == &mons[PM_PJONGJANG_AFFILIATE]) {

		mtmp->crapbonus += 10;

	}

	if (ptr == &mons[PM_SADISTIC_ASIAN_GIRL]) {

		mtmp->fartbonus += 7;

	}

	if (ptr == &mons[PM_FARTING_ASIAN_GIRL]) {

		mtmp->fartbonus += 7;

	}

	if (ptr == &mons[PM_THICK_FARTING_GIRL]) {

		mtmp->fartbonus += 9;
		mtmp->crapbonus += 10;

	}

	if (ptr == &mons[PM_BRATFISH]) {

		mtmp->fartbonus += 3;
		mtmp->crapbonus += 20;

	}

	if (ptr == &mons[PM_FAT_FARTING_GIRL]) {

		mtmp->fartbonus += 9;
		mtmp->crapbonus += 10;

	}

	if (ptr == &mons[PM_EVEN_FATTER_FARTING_GIRL]) {

		mtmp->fartbonus += 9;
		mtmp->crapbonus += 10;

	}

	if (ptr == &mons[PM_LOVING_ASIAN_GIRL]) {

		mtmp->fartbonus += 7;

	}

	if (ptr == &mons[PM_RUEA]) {

		mtmp->crapbonus += 5;

	}

	if (ptr == &mons[PM_SARAH]) {

		mtmp->fartbonus += 4;

	}

	if (ptr == &mons[PM_SUNALI]) {

		mtmp->crapbonus += 5;

	}

	if (ptr == &mons[PM_KATI]) {

		mtmp->crapbonus += 2;
		mtmp->fartbonus += 9;

	}

	if (ptr == &mons[PM_THAI]) {

		mtmp->crapbonus += 3;

	}

	if (ptr == &mons[PM_ELIF]) {

		mtmp->fartbonus += 7;

	}

	if (ptr == &mons[PM_SOLVEJG]) {

		mtmp->fartbonus += 1;

	}

	if (ptr == &mons[PM_ANTJE]) {

		mtmp->crapbonus += 1;

	}

	if (ptr == &mons[PM_MAURAH]) {

		mtmp->crapbonus += 6;
		mtmp->fartbonus += 3;

	}

	if (ptr == &mons[PM_KLARA]) {

		mtmp->crapbonus += 10;

	}

	if (ptr == &mons[PM_KERSTIN]) {

		mtmp->crapbonus += 2;
		mtmp->fartbonus += 3;

	}

	if (ptr == &mons[PM_EVELINE]) {

		mtmp->crapbonus += 2;

	}

	if (ptr == &mons[PM_INA]) {

		mtmp->crapbonus += 3;
		mtmp->fartbonus += 6;

	}

	if (ptr == &mons[PM_KARIN]) {

		mtmp->crapbonus += 8;

	}

	if (ptr == &mons[PM_SUE_LYN]) {

		mtmp->crapbonus += 4;
		mtmp->fartbonus += 9;

	}

	if (ptr == &mons[PM_MARIKE]) {

		mtmp->fartbonus += 9;

	}

	if (ptr == &mons[PM_KATIA]) {

		mtmp->crapbonus += 20;

	}

	if (ptr == &mons[PM_LUDGERA]) {

		mtmp->crapbonus += 1;

	}

	if (ptr == &mons[PM_MARIYA]) {

		mtmp->fartbonus += 8;

	}

	if (ptr == &mons[PM_SANDRA]) {

		mtmp->fartbonus += 5;

	}

	if (ptr == &mons[PM_MELTEM]) {

		mtmp->fartbonus += 4;

	}

	if (ptr == &mons[PM_TENDER_ASIAN_GIRL]) {

		mtmp->fartbonus += 7;

	}

	if (ptr == &mons[PM_CHINESE_GIRL]) {

		mtmp->fartbonus += 7;

	}

	if (ptr == &mons[PM_KOREAN_GIRL]) {

		mtmp->fartbonus += 8;

	}

	if (ptr == &mons[PM_TURKISH_GIRL]) {

		mtmp->crapbonus += 4;

	}

	if (ptr == &mons[PM_YOGA_GIRL]) {

		mtmp->fartbonus += 3;

	}

	if (ptr == &mons[PM_BEAUTIFUL_GIRL]) {

		mtmp->fartbonus += 5;

	}

	if (ptr == &mons[PM_PRETTY_ASIAN_WOMAN]) {

		mtmp->fartbonus += 7;

	}

	if (ptr == &mons[PM_SEXY_CHINESE_WOMAN]) {

		mtmp->fartbonus += 7;

	}

	if (ptr == &mons[PM_KOREAN_WOMAN]) {

		mtmp->fartbonus += 6;

	}

	if (ptr == &mons[PM_TURKISH_WOMAN]) {

		mtmp->crapbonus += 3;

	}

	if (ptr == &mons[PM_WONDERFUL_LADY]) {

		mtmp->fartbonus += 6;

	}

	if (ptr == &mons[PM_SEXY_ASIAN_LADY]) {

		mtmp->fartbonus += 5;

	}

	if (ptr == &mons[PM_CHINESE_LADY]) {

		mtmp->fartbonus += 5;

	}

	if (ptr == &mons[PM_KOREAN_LADY]) {

		mtmp->fartbonus += 5;

	}

	if (ptr == &mons[PM_TURKISH_LADY]) {

		mtmp->crapbonus += 2;

	}

	if (ptr == &mons[PM_WATER_GIRL]) {

		mtmp->fartbonus += 6;

	}

	if (ptr == &mons[PM_NATURE_GIRL]) {

		mtmp->fartbonus += 7;

	}

	if (ptr == &mons[PM_DEFORMED_GIRL]) {

		mtmp->crapbonus += 10;

	}

	if (ptr == &mons[PM_MAGICAL_GIRL]) {

		mtmp->fartbonus += 5;

	}

	if (ptr == &mons[PM_WATER_LADY]) {

		mtmp->fartbonus += 6;

	}

	if (ptr == &mons[PM_NATURE_LADY]) {

		mtmp->fartbonus += 8;

	}

	if (ptr == &mons[PM_ICE_LADY]) {

		mtmp->fartbonus += 2;

	}

	if (ptr == &mons[PM_FEMALE_HULL]) {

		mtmp->crapbonus += 15;

	}

	if (ptr == &mons[PM_SADISTIC_LADY]) {

		mtmp->fartbonus += 5;

	}

	if (ptr == &mons[PM_BDSM_LADY]) {

		mtmp->fartbonus += 3;

	}

	if (ptr == &mons[PM_MAGICAL_LADY]) {

		mtmp->fartbonus += 7;

	}

	if (ptr == &mons[PM_FREAKY_GIRL]) {

		mtmp->fartbonus += 5;

	}

	if (ptr == &mons[PM_SLUT]) {

		mtmp->fartbonus += 4;
		mtmp->crapbonus += 6;

	}

	if (ptr == &mons[PM_WENCH]) {

		mtmp->fartbonus += 8;
		mtmp->crapbonus += 9;

	}

	if (ptr == &mons[PM_WILD_WOMAN]) {

		mtmp->fartbonus += 5;
		mtmp->crapbonus += 2;

	}

	if (ptr == &mons[PM_WENDY_O__KOOPA]) {

		mtmp->crapbonus += 5;
		mtmp->fartbonus += 7;

	}

	if (ptr == &mons[PM_ELENA]) {

		mtmp->crapbonus += 5;
		mtmp->fartbonus += 9;

	}

	if (ptr == &mons[PM_KATHARINA]) {

		mtmp->crapbonus += 6;
		mtmp->fartbonus += 9;

	}

	if (ptr == &mons[PM_JESSICA]) {

		mtmp->fartbonus += 9;

	}

	if (ptr == &mons[PM_JENNIFER]) {

		mtmp->crapbonus += 1;

	}

	if (ptr == &mons[PM_YVONNE]) {

		mtmp->crapbonus += 2;

	}

	if (ptr == &mons[PM_MIRIAM]) {

		mtmp->fartbonus += 2;

	}

	if (ptr == &mons[PM_LISA]) {

		mtmp->crapbonus += 2;

	}

	if (ptr == &mons[PM_BIRGIT]) {

		mtmp->fartbonus += 5;

	}

	if (ptr == &mons[PM_INGE]) {

		mtmp->fartbonus += 8;

	}

	if (ptr == &mons[PM_MISS_SCHRACK]) {

		mtmp->fartbonus += 7;

	}

	if (ptr == &mons[PM_EXTRA_FLEECY_BUNDLE]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
	}

	if (ptr == &mons[PM_EMMELIE]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, T_SHIRT);
	}

	if (ptr == &mons[PM_LUISA]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, BULLWHIP);
	}

	if (ptr == &mons[PM_SHY_LAURA]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, LEATHER_CLOAK);
		(void) mongets(mtmp, LEATHER_JACKET);
	}

	if (ptr == &mons[PM_ANNA]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, POT_NUMBNESS);
	}

	if (ptr == &mons[PM_LEXI]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		m_initthrow(mtmp, CREAM_PIE, 4);
	}

	if (ptr == &mons[PM_SOFT_SARAH]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
	}

	if (ptr == &mons[PM_MAREIKE]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, SCR_FIRE);
	}

	if (ptr == &mons[PM_REBECCA]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, WAN_FEAR);
	}

	if (ptr == &mons[PM_ROUGH_TERESA]) {
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, POT_HALLUCINATION);
	}

	if (ptr == &mons[PM_JANINE]) {
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, POT_BLINDNESS);
		(void) mongets(mtmp, SCR_SUMMON_ELM);
	}

	if (ptr == &mons[PM_BITCHY_LARA]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, POT_STUNNING);
		(void) mongets(mtmp, SCR_MEGALOAD);
	}

	if (ptr == &mons[PM_MARLEEN]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, POT_PARALYSIS);
		(void) mongets(mtmp, WAN_STUN_MONSTER);
	}

	if (ptr == &mons[PM_NONEROTIC_IRINA]) {
		(void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		(void) mongets(mtmp, WAN_BANISHMENT);
		(void) mongets(mtmp, SCR_RELOCATION);
	}

	if (ptr == &mons[PM_BUNDLY_ANN]) {
		(void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, WAN_STRIKING);
		(void) mongets(mtmp, STEEL_WHIP);
	}

	if (ptr == &mons[PM_LISELOTTE]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, POT_CONFUSION);
	}

	if (ptr == &mons[PM_MAY_BRITT]) {
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, SCR_WOUNDS);
		(void) mongets(mtmp, SCR_EGOISM);
		if (!rn2(20)) mongets(mtmp, WAN_EGOISM);
		(void) mongets(mtmp, POT_CONFUSION);
	}

	if (ptr == &mons[PM_LILLY]) {
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, SCR_WARPING);
		(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
	}

	if (ptr == &mons[PM_MIRIAM_THE_SPIRIT_GIRL]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, POT_NUMBNESS);
		(void) mongets(mtmp, SCR_GROUP_SUMMONING);
	}

	if (ptr == &mons[PM_THE_SWEET_HIGH_HEEL_LOVING_ASIAN_GIRL]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, WAN_FINGER_BENDING);
		(void) mongets(mtmp, WAN_STUN_MONSTER);
		if (!rn2(10)) (void) mongets(mtmp, WAN_SIN);
	}

	if (ptr == &mons[PM_EMMA]) {
		(void) mongets(mtmp, PLATE_MAIL);
	}

	if (ptr == &mons[PM_ALIDA]) {
		(void) mongets(mtmp, CLOAK_OF_MAGIC_RESISTANCE);
	}

	if (ptr == &mons[PM_JOSEFINE]) {
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, DANCING_SHOES);
		if (!rn2(10)) (void) mongets(mtmp, WAN_EGOISM);
		if (!rn2(3)) (void) mongets(mtmp, SCR_EGOISM);
		if (!rn2(5)) (void) mongets(mtmp, SCR_VILENESS);
	}

	if (ptr == &mons[PM_VILEA]) {
		(void) mongets(mtmp, HUGGING_BOOT);
	}

	if (ptr == &mons[PM_VILEA_S_SISTER]) {
		(void) mongets(mtmp, HUGGING_BOOT);
	}

	if (ptr == &mons[PM_HANNAH]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, POT_BLINDNESS);
	}

	if (ptr == &mons[PM_AMELJE]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
	}

	if (ptr == &mons[PM_NON_PRETTY_MELANIE]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SWEET_MOCASSINS);
	}

	if (ptr == &mons[PM_THE_SWEET_REDGUARD_GIRL]) {
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, DANCING_SHOES);
		(void) mongets(mtmp, POT_STUNNING);
		(void) mongets(mtmp, POT_RADIUM);
	}

	if (ptr == &mons[PM_THE_HEELED_TOPMODEL]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, SCR_RUMOR);
	}

	if (ptr == &mons[PM_THE_HUGGING_TOPMODEL]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, DANCING_SHOES);
		(void) mongets(mtmp, SCR_MESSAGE);
	}

	if (ptr == &mons[PM_MARIE]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
	}

	if (ptr == &mons[PM_THE_FAIRY]) {
		(void) mongets(mtmp, RING_MAIL);
		(void) mongets(mtmp, LEATHER_CLOAK);
	}

	if (ptr == &mons[PM_FANNY]) {
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */
		(void) mongets(mtmp, WAN_STUN_MONSTER);
	}

	if (ptr == &mons[PM_THE_BASTARD_BROTHER_OF_SHY_LAURA]) {
		(void) mongets(mtmp, STYGIAN_PIKE);
	}

	if (ptr == &mons[PM_APE_HEAD]) {
		(void) mongets(mtmp, POT_CYANIDE);
		(void) mongets(mtmp, POT_URINE);
		(void) mongets(mtmp, SCR_BULLSHIT);
	}

	if (ptr == &mons[PM_MALADJUSTED_LEON]) {
		(void) mongets(mtmp, WAN_MAGIC_MISSILE);
	}

	if (ptr == &mons[PM_MAX_THE_BADASS]) {
		(void) mongets(mtmp, BASEBALL_BAT);
	}

	if (ptr == &mons[PM_ANTON]) {
		(void) mongets(mtmp, METAL_CLUB);
		(void) mongets(mtmp, SLING);
		m_initthrow(mtmp, CAPTCHA_STONE, 1);
	}

	if (ptr == &mons[PM_JONAS_THE_SCHIZO_AUTIST]) {
		m_initthrow(mtmp, DART, 20);
	}

	if (ptr == &mons[PM_LARS_THE_SCHIZOPHRENIC]) {
		m_initthrow(mtmp, SHURIKEN, 1);
	}

	if (ptr == &mons[PM_MELVIN]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SCR_BULLSHIT);
	}

	if (ptr == &mons[PM_THE_BASTARD_BROTHER_OF_LILLY]) {
		(void) mongets(mtmp, SCR_CHAOS_TERRAIN);
	}

	if (ptr == &mons[PM_THE_DISGUSTING_FRIEND_OF_LILLY_S_BROTHER]) {
		(void) mongets(mtmp, POT_RADIUM);
	}

	if (ptr == &mons[PM_THE_DISGUSTING_SMOKER_FRIEND_OF_MARIE]) {
		(void) mongets(mtmp, POT_CYANIDE);
		(void) mongets(mtmp, WAN_DISINTEGRATION);
		(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		(void) mongets(mtmp, SHIELD_OF_REFLECTION);
		(void) mongets(mtmp, RUBBER_HOSE);
	}

	if (ptr == &mons[PM_SCHALOTTE]) {
		(void) mongets(mtmp, WAN_CONFUSION);
	}

	if (ptr == &mons[PM_ROXY_GRETA]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);
		(void) mongets(mtmp, POT_CONFUSION);
		(void) mongets(mtmp, POT_STUNNING);
	}

	if (ptr == &mons[PM_BUNDLE_NADJA]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, POT_PARALYSIS);
		(void) mongets(mtmp, VICTORIAN_UNDERWEAR);
	}

	if (ptr == &mons[PM_STRU_BES]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, CLOAK_OF_REFLECTION);
		(void) mongets(mtmp, BAG_OF_TRICKS);
		(void) mongets(mtmp, FIRE_HELMET);
		(void) mongets(mtmp, OILSKIN_GLOVES);
		(void) mongets(mtmp, ICE_SHIELD);
		(void) mongets(mtmp, SCR_ANTIMATTER);
		(void) mongets(mtmp, WAN_INERTIA);
		(void) mongets(mtmp, BOOTS_OF_ACID_RESISTANCE);
		(void) mongets(mtmp, RIN_TIMELY_BACKUP);
		(void) mongets(mtmp, AMULET_OF_LIFE_SAVING);
		(void) mongets(mtmp, WAN_BAD_EFFECT);
		(void) mongets(mtmp, WAN_GAIN_LEVEL);
		(void) mongets(mtmp, WAN_INCREASE_MAX_HITPOINTS);
		(void) mongets(mtmp, WAN_REDUCE_MAX_HITPOINTS);
		(void) mongets(mtmp, WAN_CURSE_ITEMS);
	}

	if (ptr == &mons[PM_YANNICK]) {
		(void) mongets(mtmp, HEAVY_HAMMER);
		(void) mongets(mtmp, SCR_CLOUDS);
	}

	if (ptr == &mons[PM_FELIX]) {
		(void) mongets(mtmp, CATAPULT);
		m_initthrow(mtmp, FLINT, 50);
	}

	if (ptr == &mons[PM_STEFAN]) {
		(void) mongets(mtmp, POT_HEALING);
		(void) mongets(mtmp, STRIPED_SHIRT);
	}

	if (ptr == &mons[PM_FREDDIE]) {
		(void) mongets(mtmp, POT_STUNNING);
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
	}

	if (ptr == &mons[PM_MICHAEL]) {
		(void) mongets(mtmp, BROADSWORD);
		(void) mongets(mtmp, PLATE_MAIL);
		(void) mongets(mtmp, POT_SLEEPING);
	}

	if (ptr == &mons[PM_HANNO]) {
		(void) mongets(mtmp, KATANA);
		(void) mongets(mtmp, SPLINT_MAIL);
	}

	if (ptr == &mons[PM_ROBIN]) {
		(void) mongets(mtmp, ELVEN_CLOAK);
		(void) mongets(mtmp, POT_INVISIBILITY);
		(void) mongets(mtmp, ELVEN_BOW);
		m_initthrow(mtmp, ELVEN_ARROW, 50);
		m_initthrow(mtmp, ELVEN_ARROW, 50);
	}

	if (ptr == &mons[PM_JNR]) {
		(void) mongets(mtmp, STYGIAN_PIKE);
		(void) mongets(mtmp, BRONZE_PLATE_MAIL);
		(void) mongets(mtmp, SCR_HEALING);
		(void) mongets(mtmp, POT_EXTRA_HEALING);
	}

	if (ptr == &mons[PM_LARS]) {
		(void) mongets(mtmp, BULLWHIP);
		(void) mongets(mtmp, WAN_MAGIC_MISSILE);
	}

	if (ptr == &mons[PM_TOMMY]) {
		(void) mongets(mtmp, FLY_SWATTER);
		(void) mongets(mtmp, ROBE_OF_WEAKNESS);
		(void) mongets(mtmp, GNOMISH_BOOTS);
		(void) mongets(mtmp, POT_MUTATION);
	}

	if (ptr == &mons[PM_LUKAS]) {
		(void) mongets(mtmp, WAN_GAIN_LEVEL);
		(void) mongets(mtmp, OBSID);
		(void) mongets(mtmp, PLASTEEL_ARMOR);
		(void) mongets(mtmp, GREEN_LIGHTSABER);
		(void) mongets(mtmp, AMULET_OF_LIFE_SAVING);
		(void) mongets(mtmp, WAN_FULL_HEALING);
		(void) mongets(mtmp, WAN_BAD_EFFECT);
	}

	if (ptr == &mons[PM_LUKAS_S_BODYGUARD]) {
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SNIPER_RIFLE);
		(void) mongets(mtmp, POT_FEAR);
		(void) mongets(mtmp, AMULET_OF_DATA_STORAGE);
		(void) mongets(mtmp, CLOAK_OF_MAGIC_RESISTANCE);
		m_initthrow(mtmp, SNIPER_BULLET, 50);
		m_initthrow(mtmp, SNIPER_BULLET, 50);
	}

	if (ptr == &mons[PM_SELINGER]) {
		(void) mongets(mtmp, HUGGING_BOOT);
		(void) mongets(mtmp, SPEED_BOOTS);
		(void) mongets(mtmp, POT_SPEED);
		(void) mongets(mtmp, SCR_TELEPORTATION);
		(void) mongets(mtmp, SCR_RELOCATION);
		(void) mongets(mtmp, SCR_TELEPORTATION);
		(void) mongets(mtmp, SCR_TELEPORTATION);
		(void) mongets(mtmp, WAN_TELEPORTATION);
		(void) mongets(mtmp, WAN_DIGGING);
	}

	if (ptr == &mons[PM_BAENNI]) {
		(void) mongets(mtmp, SCR_BULLSHIT);
		(void) mongets(mtmp, POT_URINE);
		(void) mongets(mtmp, STRIPED_SHIRT);
		(void) mongets(mtmp, POT_SLIME);
	}

	if (ptr == &mons[PM_WALTER]) {
		(void) mongets(mtmp, RUBBER_HOSE);
		(void) mongets(mtmp, PISTOL);
		(void) mongets(mtmp, WAN_STUN_MONSTER);
		(void) mongets(mtmp, CHAIN_MAIL);
		m_initthrow(mtmp, PISTOL_BULLET, 20);
		m_initthrow(mtmp, CREAM_PIE, 4);
	}

	if (ptr == &mons[PM_KLAUS]) {
		(void) mongets(mtmp, RUBBER_HOSE);
		(void) mongets(mtmp, PISTOL);
		(void) mongets(mtmp, WAN_STUN_MONSTER);
		(void) mongets(mtmp, CHAIN_MAIL);
		m_initthrow(mtmp, PISTOL_BULLET, 20);
		m_initthrow(mtmp, CREAM_PIE, 4);
	}

	if (ptr == &mons[PM_LAURENS]) {
		(void) mongets(mtmp, SCR_TELEPORTATION);
		(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		m_initthrow(mtmp, DART, 20);
	}

	if (ptr == &mons[PM_JORIN]) {
		(void) mongets(mtmp, CROSSBOW);
		(void) mongets(mtmp, BANDED_MAIL);
		(void) mongets(mtmp, WAN_TELEPORTATION);
		(void) mongets(mtmp, SCR_FIRE);
		m_initthrow(mtmp, CROSSBOW_BOLT, 50);
		m_initthrow(mtmp, CROSSBOW_BOLT, 20);
	}

	if (ptr == &mons[PM_ANDREJ]) {
		(void) mongets(mtmp, DAGGER);
		(void) mongets(mtmp, SLING);
		m_initthrow(mtmp, ROCK, 10);
	}

	if (ptr == &mons[PM_ANSELM]) {
		(void) mongets(mtmp, SCR_GROWTH);
		(void) mongets(mtmp, POT_HEALING);
		(void) mongets(mtmp, POT_EXTRA_HEALING);
		(void) mongets(mtmp, BOW);
		(void) mongets(mtmp, CLUB);
		(void) mongets(mtmp, LEATHER_ARMOR);
		m_initthrow(mtmp, ORCISH_ARROW, 5);
	}

	if (ptr == &mons[PM_ARAM]) {
		(void) mongets(mtmp, WAN_SLEEP);
		(void) mongets(mtmp, LONG_SWORD);
		(void) mongets(mtmp, ORCISH_CLOAK);
	}

	if (ptr == &mons[PM_BORIS]) {
		(void) mongets(mtmp, AMULET_OF_DATA_STORAGE);
		(void) mongets(mtmp, RUNESWORD);
		(void) mongets(mtmp, WAN_COLD);
		(void) mongets(mtmp, WAN_ACID);
	}

	if (ptr == &mons[PM_BURKHARD]) {
		(void) mongets(mtmp, DROVEN_GREATSWORD);
		(void) mongets(mtmp, DWARVISH_MITHRIL_COAT);
		(void) mongets(mtmp, WAN_HEALING);
		m_initthrow(mtmp, FRAG_GRENADE, 10);
	}

	if (ptr == &mons[PM_NILS]) {
		(void) mongets(mtmp, DWARVISH_SPEAR);
		(void) mongets(mtmp, HELMET);
		m_initthrow(mtmp, ORCISH_SPEAR, 5);
	}

	if (ptr == &mons[PM_OZAN]) {
		(void) mongets(mtmp, SILVER_SABER);
		(void) mongets(mtmp, SLING);
		m_initthrow(mtmp, OPAL, 5);
	}

	if (ptr == &mons[PM_THORWALD]) {
		(void) mongets(mtmp, SHORT_SWORD);
		(void) mongets(mtmp, LEATHER_ARMOR);
		(void) mongets(mtmp, BOW);
		(void) mongets(mtmp, SCR_WOUNDS);
		m_initthrow(mtmp, ARROW, 1);
	}

	if (ptr == &mons[PM_HENDRIC]) {
		(void) mongets(mtmp, POT_SPEED);
		(void) mongets(mtmp, AXE);
		(void) mongets(mtmp, SHOTGUN);
		m_initthrow(mtmp, SHOTGUN_SHELL, 8);
	}

	if (ptr == &mons[PM_NINO]) {
		(void) mongets(mtmp, WAN_TELEPORTATION);
		(void) mongets(mtmp, BILL_GUISARME);
		(void) mongets(mtmp, POT_CONFUSION);
		(void) mongets(mtmp, SCR_LAVA);
		(void) mongets(mtmp, SCR_GROUP_SUMMONING);
	}

	if (ptr == &mons[PM_KASTORTRANSPORT]) {
		(void) mongets(mtmp, SCR_CHAOS_TERRAIN);
		(void) mongets(mtmp, SCR_CHAOS_TERRAIN);
		(void) mongets(mtmp, SCR_CHAOS_TERRAIN);
		(void) mongets(mtmp, SCR_TELEPORTATION);
		(void) mongets(mtmp, SCR_FLOODING);
		(void) mongets(mtmp, WAN_STRIKING);
		(void) mongets(mtmp, RING_MAIL);
	}

	if (ptr == &mons[PM_LARRY]) {
		(void) mongets(mtmp, WAN_MAGIC_MISSILE);
	}

	if (ptr == &mons[PM_MORTON]) {
		(void) mongets(mtmp, POT_STUNNING);
		(void) mongets(mtmp, BROADSWORD);
		(void) mongets(mtmp, WAN_MAGIC_MISSILE);
	}

	if (ptr == &mons[PM_IGGY]) {
		(void) mongets(mtmp, WAN_MAGIC_MISSILE);
		(void) mongets(mtmp, WAN_TELEPORTATION);
	}

	if (ptr == &mons[PM_LEMMY]) {
		(void) mongets(mtmp, SLING);
		(void) mongets(mtmp, SCR_ICE);
		m_initthrow(mtmp, EPIDOTE, 3);
		m_initthrow(mtmp, CYAN_STONE, 3);
	}

	if (ptr == &mons[PM_LUDWIG]) {
		(void) mongets(mtmp, WAN_MAGIC_MISSILE);
		(void) mongets(mtmp, POT_STUNNING);
		(void) mongets(mtmp, POT_CONFUSION);
		(void) mongets(mtmp, AMULET_OF_DATA_STORAGE);
		(void) mongets(mtmp, SCR_WARPING);
	}

	if (ptr == &mons[PM_DANIEL]) {
		(void) mongets(mtmp, MALLET);
		(void) mongets(mtmp, AUTO_SHOTGUN);
		(void) mongets(mtmp, GRAY_DRAGON_SCALE_MAIL);
		(void) mongets(mtmp, WAN_DISINTEGRATION);
		m_initthrow(mtmp, AUTO_SHOTGUN_SHELL, 25);
	}

	if (ptr == &mons[PM_LEN_KIND]) {
		(void) mongets(mtmp, WAN_HASTE_MONSTER);
		(void) mongets(mtmp, POT_FULL_HEALING);
		(void) mongets(mtmp, BULLWHIP);
		(void) mongets(mtmp, ORCISH_CHAIN_MAIL);
	}

	if (ptr == &mons[PM_ILJA]) {
		(void) mongets(mtmp, POT_SLIME);
		(void) mongets(mtmp, SCR_EARTH);
		(void) mongets(mtmp, WAN_TELE_LEVEL);
		(void) mongets(mtmp, WAN_DRAINING);
		(void) mongets(mtmp, WAN_TIDAL_WAVE);
		(void) mongets(mtmp, BENT_SABLE);
		(void) mongets(mtmp, GNOMISH_SUIT);
		(void) mongets(mtmp, ORCISH_HELM);
	}

	if (ptr == &mons[PM_TILL]) {
		(void) mongets(mtmp, BEC_DE_CORBIN);
		(void) mongets(mtmp, BRONZE_PLATE_MAIL);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
	}

	if (ptr == &mons[PM_TOMAS]) {
		(void) mongets(mtmp, POT_GAIN_LEVEL);
		(void) mongets(mtmp, ORCISH_CHAIN_MAIL);
		(void) mongets(mtmp, CATAPULT);
		m_initthrow(mtmp, FLINT, 40);
	}

	if (ptr == &mons[PM_NICO]) {
		(void) mongets(mtmp, GREAT_DAGGER);
		(void) mongets(mtmp, BAG_OF_TRICKS);
		(void) mongets(mtmp, SCR_DESTROY_ARMOR);
		(void) mongets(mtmp, SCR_DESTROY_ARMOR);
		(void) mongets(mtmp, WAN_BAD_EFFECT);
		(void) mongets(mtmp, WAN_CURSE_ITEMS);
		(void) mongets(mtmp, WAN_REMOVE_RESISTANCE);
		m_initthrow(mtmp, KNIFE, 20);
	}

	if (ptr == &mons[PM_TILLMANN]) {
		(void) mongets(mtmp, TSURUGI);
		(void) mongets(mtmp, FORCE_PIKE);
		(void) mongets(mtmp, YELLOW_DRAGON_SCALES);
		(void) mongets(mtmp, VENOM_SHIELD);
		(void) mongets(mtmp, AMULET_OF_LIFE_SAVING);
		(void) mongets(mtmp, POT_ICE);
		(void) mongets(mtmp, SCR_EGOISM);
		(void) mongets(mtmp, SCR_BAD_EFFECT);
		(void) mongets(mtmp, WAN_GAIN_LEVEL);
		(void) mongets(mtmp, WAN_CREATE_HORDE);
	}

	if (ptr == &mons[PM_WALKER]) {
		(void) mongets(mtmp, WAN_BAD_LUCK);
		(void) mongets(mtmp, WAN_CORROSION);
		(void) mongets(mtmp, WAN_LYCANTHROPY);
		(void) mongets(mtmp, SCR_SUMMON_BOSS);
		(void) mongets(mtmp, DARK_ELVEN_SHORT_SWORD);
		(void) mongets(mtmp, PLASTEEL_BOOTS);
	}

	if (ptr == &mons[PM_NIKOLEI]) {
		(void) mongets(mtmp, POT_SPEED);
		(void) mongets(mtmp, WAN_HASTE_MONSTER);
		(void) mongets(mtmp, TRIDENT);
		(void) mongets(mtmp, SLING);
		m_initthrow(mtmp, SALT_CHUNK, 10);
	}

	if (ptr == &mons[PM_JONAS]) {
		(void) mongets(mtmp, WAN_SLIMING);
	}

	if (ptr == &mons[PM_IWAN]) {
		(void) mongets(mtmp, KNIFE);
		(void) mongets(mtmp, CRYSKNIFE);
		(void) mongets(mtmp, RIFLE);
		(void) mongets(mtmp, SCR_SUMMON_BOSS);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		m_initthrow(mtmp, RIFLE_BULLET, 10);
	}

	if (ptr == &mons[PM_RUBINHO]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, RIFLE);
		(void) mongets(mtmp, CHAIN_MAIL);
		(void) mongets(mtmp, WAN_FIRE);
		(void) mongets(mtmp, POT_FIRE);
		(void) mongets(mtmp, SCR_HEALING);
		(void) mongets(mtmp, POT_EXTRA_HEALING);
		m_initthrow(mtmp, RIFLE_BULLET, 50);
		m_initthrow(mtmp, RIFLE_BULLET, 50);
		m_initthrow(mtmp, SHURIKEN, 50);
	}

	if (ptr == &mons[PM_THE_COFFIN_NAIL]) {
		(void) mongets(mtmp, WAN_SUMMON_UNDEAD);
		(void) mongets(mtmp, WAN_SUMMON_UNDEAD);
		(void) mongets(mtmp, WAN_SUMMON_UNDEAD);
		(void) mongets(mtmp, PICK_AXE);
		(void) mongets(mtmp, SCR_SUMMON_GHOST);
		(void) mongets(mtmp, SCR_SUMMON_GHOST);
		(void) mongets(mtmp, SMALL_SHIELD);
	}

	if (ptr == &mons[PM_EVILLAN]) {
		(void) mongets(mtmp, WAN_CREATE_MONSTER);
		(void) mongets(mtmp, SILVER_LONG_SWORD);
		(void) mongets(mtmp, CATAPULT);
		(void) mongets(mtmp, SILVER_DRAGON_SCALE_MAIL);
		m_initthrow(mtmp, CIRMOCLINE, 7);
		m_initthrow(mtmp, SILVER_SPEAR, 5);
		(void) mongets(mtmp, SCR_VILENESS);
	}

	if (ptr == &mons[PM_THILO]) {
		(void) mongets(mtmp, KNIFE);
		(void) mongets(mtmp, KNIFE);
	}

	if (ptr == &mons[PM_MAURUS]) {
		(void) mongets(mtmp, SCR_BAD_EFFECT);
		(void) mongets(mtmp, SCR_SUMMON_UNDEAD);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
	}

	if (ptr == &mons[PM_DOMINIK]) {
		(void) mongets(mtmp, POT_STUNNING);
		(void) mongets(mtmp, WAN_REDUCE_MAX_HITPOINTS);
		(void) mongets(mtmp, BATTLE_STAFF);
		(void) mongets(mtmp, ELVEN_CLOAK);
		(void) mongets(mtmp, WAN_LYCANTHROPY);
		(void) mongets(mtmp, WAN_STUN_MONSTER);
	}

	if (ptr == &mons[PM_ALBERT]) {
		(void) mongets(mtmp, PISTOL);
		(void) mongets(mtmp, KNIFE);
		(void) mongets(mtmp, SCR_HEALING);
		(void) mongets(mtmp, PLASTEEL_ARMOR);
		m_initthrow(mtmp, PISTOL_BULLET, 50);
	}

	if (ptr == &mons[PM_DON_FINWE]) {
		(void) mongets(mtmp, ELVEN_BOW);
		(void) mongets(mtmp, ELVEN_MITHRIL_COAT);
		(void) mongets(mtmp, ELVEN_BROADSWORD);
		(void) mongets(mtmp, ELVEN_LEATHER_HELM);
		(void) mongets(mtmp, ELVEN_BOOTS);
		(void) mongets(mtmp, WAN_EXTRA_HEALING);
		m_initthrow(mtmp, ELVEN_DAGGER, 5);
		m_initthrow(mtmp, ELVEN_SPEAR, 5);
		m_initthrow(mtmp, ELVEN_ARROW, 50);
	}

	if (ptr == &mons[PM_GERRIT]) {
		(void) mongets(mtmp, SPEAR);
	}

	if (ptr == &mons[PM_JENS]) {
		(void) mongets(mtmp, PISTOL);
		(void) mongets(mtmp, SCR_WARPING);
		m_initthrow(mtmp, SILVER_PISTOL_BULLET, 50);
	}

	if (ptr == &mons[PM_LEON]) {
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		(void) mongets(mtmp, LEATHER_ARMOR);
		(void) mongets(mtmp, BATTLE_AXE);
		(void) mongets(mtmp, SCR_GROWTH);
		(void) mongets(mtmp, SCR_GROWTH);
	}

	if (ptr == &mons[PM_MARIUS]) {
		(void) mongets(mtmp, SLING);
		m_initthrow(mtmp, ROCK, 5);
	}

	if (ptr == &mons[PM_SIGURD]) {
		(void) mongets(mtmp, WAN_CORROSION);
		(void) mongets(mtmp, POT_AMNESIA);
		(void) mongets(mtmp, CLOAK_OF_REFLECTION);
		(void) mongets(mtmp, LONG_SWORD);
	}

	if (ptr == &mons[PM_WILHELM]) {
		(void) mongets(mtmp, KATANA);
		(void) mongets(mtmp, YUMI);
		m_initthrow(mtmp, YA, 50);
	}

	if (ptr == &mons[PM_ANDREAS]) {
		(void) mongets(mtmp, WAR_HAMMER);
		(void) mongets(mtmp, PLATE_MAIL);
		(void) mongets(mtmp, SCR_TELEPORTATION);
	}

	if (ptr == &mons[PM_TYPE_OF_ICE_BLOCK]) {
		(void) mongets(mtmp, POT_ICE);
		(void) mongets(mtmp, POT_ICE);
		(void) mongets(mtmp, POT_ICE);
		(void) mongets(mtmp, POT_ICE);
		(void) mongets(mtmp, POT_ICE);
		(void) mongets(mtmp, SCR_ICE);
		(void) mongets(mtmp, SCR_ICE);
		(void) mongets(mtmp, SCR_ICE);
		(void) mongets(mtmp, SCR_FLOOD);
		(void) mongets(mtmp, WAN_COLD);
		(void) mongets(mtmp, WHITE_DRAGON_SCALE_MAIL);
		(void) mongets(mtmp, HELM_OF_STEEL);
		(void) mongets(mtmp, SCR_BAD_EFFECT);
		(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
	}

	if (ptr == &mons[PM_SVEN]) {
		(void) mongets(mtmp, WAN_SOLAR_BEAM);
		(void) mongets(mtmp, SCR_DESTROY_ARMOR);
		(void) mongets(mtmp, AMULET_OF_DATA_STORAGE);
		(void) mongets(mtmp, HEAVY_MACHINE_GUN);
		(void) mongets(mtmp, PISTOL);
		(void) mongets(mtmp, TSURUGI);
		(void) mongets(mtmp, GRAY_DRAGON_SCALE_MAIL);
		(void) mongets(mtmp, POT_FULL_HEALING);
		(void) mongets(mtmp, WAN_FULL_HEALING);
		(void) mongets(mtmp, SCR_SUMMON_BOSS);
		(void) mongets(mtmp, SCR_SUMMON_BOSS);
		(void) mongets(mtmp, SCR_SUMMON_BOSS);
		(void) mongets(mtmp, WAN_CREATE_HORDE);
		(void) mongets(mtmp, WAN_CREATE_HORDE);
		m_initthrow(mtmp, SILVER_PISTOL_BULLET, 50);
		m_initthrow(mtmp, MG_BULLET, 50);
		m_initthrow(mtmp, MG_BULLET, 50);
		m_initthrow(mtmp, MG_BULLET, 50);
	}

	if (ptr == &mons[PM_DR__DELILAH]) {
		(void) mongets(mtmp, POT_ACID);
		(void) mongets(mtmp, POT_ACID);
		(void) mongets(mtmp, WAN_ACID);
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, QUARTERSTAFF);
	}

	if (ptr == &mons[PM_STUTTERING_TEACHER]) {
		if (!rn2(5)) (void) mongets(mtmp, POT_ACID);
		if (!rn2(5)) (void) mongets(mtmp, POT_ACID);
		if (!rn2(5)) (void) mongets(mtmp, WAN_ACID);
		if (!rn2(5)) (void) mongets(mtmp, SWEET_MOCASSINS);
		if (!rn2(5)) (void) mongets(mtmp, QUARTERSTAFF);
	}

	if (ptr == &mons[PM_WOMAN_WHO_IS_DISLIKED_BY_EVERYONE]) {
		if (!rn2(5)) mongets(mtmp, WAN_REMOVE_RESISTANCE);
		if (!rn2(5)) mongets(mtmp, BULLWHIP);
		if (!rn2(5)) mongets(mtmp, RIN_TIMELY_BACKUP);
	}

	if (ptr == &mons[PM_SWARM_SOFT_LADY]) {
		if (!rn2(5)) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		if (!rn2(5)) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		if (!rn2(5)) mongets(mtmp, WAN_STRIKING);
		if (!rn2(5)) mongets(mtmp, LEATHER_ARMOR);
		if (!rn2(5)) mongets(mtmp, LEATHER_CLOAK);
		if (!rn2(5)) mongets(mtmp, BUGLE);
		if (!rn2(5)) mongets(mtmp, SCR_RELOCATION);
	}

	if (ptr == &mons[PM_MASTER_FARTING_LADY]) {
		if (!rn2(5)) mongets(mtmp, SCR_LAVA);
		if (!rn2(5)) mongets(mtmp, SCR_BARRHING);
		if (!rn2(5)) mongets(mtmp, SCR_CHAOS_TERRAIN);
		if (!rn2(5)) mongets(mtmp, SCR_CREATE_MONSTER);
		if (!rn2(5)) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		if (!rn2(5)) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
	}

	if (ptr == &mons[PM_FALSE_BITCH]) {
		if (!rn2(5)) mongets(mtmp, SWEET_MOCASSINS);
		if (!rn2(5)) mongets(mtmp, BULLWHIP);
		if (!rn2(5)) mongets(mtmp, RING_MAIL);
		if (!rn2(5)) mongets(mtmp, HELMET);
		if (!rn2(5)) mongets(mtmp, WAN_DRAIN_MANA);
		if (!rn2(5)) mongets(mtmp, POT_EXTRA_HEALING);
		if (!rn2(5)) mongets(mtmp, SILVER_SPEAR);
	}

	if (ptr == &mons[PM_BIOLOGICAL_CRONE]) {
		if (!rn2(5)) mongets(mtmp, POT_ACID);
		if (!rn2(5)) mongets(mtmp, FLY_SWATTER);
		if (!rn2(5)) mongets(mtmp, POISONOUS_CLOAK);
		if (!rn2(5)) mongets(mtmp, GREEN_DRAGON_SCALES);
		if (!rn2(5)) mongets(mtmp, BOOTS_OF_ACID_RESISTANCE);
		if (!rn2(5)) mongets(mtmp, POT_RADIUM);
	}

	if (ptr == &mons[PM_UNKNOWN_WOMAN]) {
		if (!rn2(5)) mongets(mtmp, WAN_FEAR);
	}

	if (ptr == &mons[PM_DEAR_DEER_LADY]) {
		if (!rn2(5)) mongets(mtmp, SWEET_MOCASSINS);
		if (!rn2(5)) mongets(mtmp, STEEL_WHIP);
		if (!rn2(5)) mongets(mtmp, SHIELD_OF_REFLECTION);
		if (!rn2(5)) mongets(mtmp, WAN_CREATE_MONSTER);
		if (!rn2(5)) mongets(mtmp, WAN_STONING);
		if (!rn2(5)) m_initthrow(mtmp, SILVER_SPEAR, 3);
	}

	if (ptr == &mons[PM_FLAX_WOMAN]) {
		if (!rn2(5)) mongets(mtmp, WAN_REDUCE_MAX_HITPOINTS);
		if (!rn2(5)) mongets(mtmp, POT_STUNNING);
		if (!rn2(5)) mongets(mtmp, RUBBER_HOSE);
	}

	if (ptr == &mons[PM_US_PRESIDENTIAL_ELECTION_LOSER]) {
		if (!rn2(5)) mongets(mtmp, SCR_SUMMON_BOSS);
	}

	if (ptr == &mons[PM_AMY_S_BROTHER_HIS_SECRET_LOVE]) {
		if (!rn2(5)) mongets(mtmp, SCR_CREATE_MONSTER);
		if (!rn2(5)) mongets(mtmp, SCR_CREATE_MONSTER);
		if (!rn2(5)) mongets(mtmp, SCR_CREATE_MONSTER);
		if (!rn2(5)) mongets(mtmp, SWEET_MOCASSINS);
	}

	if (ptr == &mons[PM_HISTORY_DRAGON]) {
		if (!rn2(5)) mongets(mtmp, WAN_CURSE_ITEMS);
		if (!rn2(5)) mongets(mtmp, STUDDED_LEATHER_ARMOR);
	}

	if (ptr == &mons[PM_SILVER_HEELED_BITCH]) {
		if (!rn2(5)) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (!rn2(5)) mongets(mtmp, SEXY_LEATHER_PUMP);
		if (!rn2(5)) mongets(mtmp, PISTOL);
		if (!rn2(5)) mongets(mtmp, BOW);
		if (!rn2(5)) mongets(mtmp, SILVER_DRAGON_SCALES);
		if (!rn2(5)) mongets(mtmp, SCR_BAD_EFFECT);
		if (!rn2(5)) m_initthrow(mtmp, SILVER_SPEAR, 10);
		if (!rn2(5)) m_initthrow(mtmp, SILVER_PISTOL_BULLET, 50);
		if (!rn2(5)) m_initthrow(mtmp, SILVER_DAGGER, 10);
		if (!rn2(5)) m_initthrow(mtmp, SILVER_ARROW, 50);
	}

	if (ptr == &mons[PM_COMBAT_BOOT_WEARING_AMAZON]) {
		if (!rn2(5)) mongets(mtmp, COMBAT_STILETTOS);
		if (!rn2(5)) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
	}

	if (ptr == &mons[PM_STRICT_OLD_WOMAN]) {
		if (!rn2(5)) mongets(mtmp, WAN_MAGIC_MISSILE);
	}

	if (ptr == &mons[PM_SEXY_SPORTS_LADY]) {
		if (!rn2(5)) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (!rn2(5)) mongets(mtmp, SPIKED_BATTLE_BOOT);
		if (!rn2(5)) mongets(mtmp, LANCE);
		if (!rn2(5)) mongets(mtmp, POT_FIRE);
		if (!rn2(5)) mongets(mtmp, POT_PARALYSIS);
		if (!rn2(5)) mongets(mtmp, SCR_ICE);
		if (!rn2(5)) mongets(mtmp, WAN_HEALING);
		if (!rn2(5)) m_initthrow(mtmp, GAS_GRENADE, 5);
	}

	if (ptr == &mons[PM_SECRETARY_IN_CHARGE]) {
		if (!rn2(5)) mongets(mtmp, WAN_PARALYSIS);
	}

	if (ptr == &mons[PM_BITCH_OF_YOUNG]) {
		if (!rn2(5)) mongets(mtmp, WAN_CURSE_ITEMS);
		if (!rn2(5)) mongets(mtmp, WAN_BAD_EFFECT);
		if (!rn2(5)) mongets(mtmp, GRAY_DRAGON_SCALE_MAIL);
		if (!rn2(5)) mongets(mtmp, ORCISH_BOW);
		if (!rn2(5)) m_initthrow(mtmp, DARK_ELVEN_ARROW, 50);
		if (!rn2(5)) mongets(mtmp, SCR_VILENESS);
	}

	if (ptr == &mons[PM_SNAPPY_WOMAN]) {
		if (!rn2(5)) mongets(mtmp, SCR_TELEPORTATION);
	}

	if (ptr == &mons[PM_OIL_VILLAGE]) {
		if (!rn2(5)) mongets(mtmp, SEXY_LEATHER_PUMP);
		if (!rn2(5)) mongets(mtmp, COMBAT_STILETTOS);
		if (!rn2(5)) mongets(mtmp, POT_ACID);
		if (!rn2(5)) mongets(mtmp, WAN_ACID);
	}

	if (ptr == &mons[PM_WORK_HOUSES]) {
		if (!rn2(5)) mongets(mtmp, SCR_BAD_EFFECT);
	}

	if (ptr == &mons[PM_DUALITY_NAME_TEACHER]) {
		if (!rn2(5)) mongets(mtmp, UNICORN_HORN);
		if (!rn2(5)) m_initthrow(mtmp, DART, 20);
	}

	if (ptr == &mons[PM_ICE_HEEL_LADY]) {
		if (!rn2(5)) mongets(mtmp, SEXY_LEATHER_PUMP);
		if (!rn2(5)) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		if (!rn2(5)) mongets(mtmp, WAN_HEALING);
		if (!rn2(5)) mongets(mtmp, WAN_EXTRA_HEALING);
		if (!rn2(5)) mongets(mtmp, WAN_FULL_HEALING);
		if (!rn2(5)) mongets(mtmp, WAN_CONFUSION);
		if (!rn2(5)) mongets(mtmp, SCR_SUMMON_ELM);
		if (!rn2(5)) mongets(mtmp, POT_CONFUSION);
	}

	if (ptr == &mons[PM_WORST_JUNIOR_LAWYER]) {
		if (!rn2(5)) mongets(mtmp, WAN_CREATE_MONSTER);
		if (!rn2(5)) mongets(mtmp, T_SHIRT);
	}

	if (ptr == &mons[PM_WOMAN_WHO_CAN_T_SPELL_HER_OWN_NAME]) {
		if (!rn2(5)) mongets(mtmp, POT_BLINDNESS);
		if (!rn2(5)) mongets(mtmp, POT_ICE);
		if (!rn2(5)) mongets(mtmp, POT_FEAR);
	}

	if (ptr == &mons[PM_CANCER_RESEARCH_LADY]) {
		if (!rn2(5)) mongets(mtmp, WAN_COLD);
		if (!rn2(5)) mongets(mtmp, WAN_LIGHTNING);
		if (!rn2(5)) mongets(mtmp, AMULET_OF_DATA_STORAGE);
		if (!rn2(5)) mongets(mtmp, RIN_TIMELY_BACKUP);
		if (!rn2(5)) mongets(mtmp, SWEET_MOCASSINS);
	}

	if (ptr == &mons[PM_CHEEKY_PUPIL_BITER]) {
		if (!rn2(5)) mongets(mtmp, POT_RADIUM);
		if (!rn2(5)) mongets(mtmp, POT_RADIUM);
		if (!rn2(5)) mongets(mtmp, POT_RADIUM);
	}

	if (ptr == &mons[PM_BRIGHT_STAR]) {
		if (!rn2(5)) mongets(mtmp, SWEET_MOCASSINS);
		if (!rn2(5)) mongets(mtmp, SCR_FLOOD);
		if (!rn2(5)) mongets(mtmp, ELVEN_CLOAK);
		if (!rn2(5)) mongets(mtmp, LEATHER_JACKET);
	}

	if (ptr == &mons[PM_TOMORROW]) {
		if (!rn2(5)) mongets(mtmp, SWEET_MOCASSINS);
	}

	if (ptr == &mons[PM_MUDDY_TEACHER]) {
		if (!rn2(5)) mongets(mtmp, SCR_CHAOS_TERRAIN);
	}

	if (ptr == &mons[PM_CONFUSED_BITCH]) {
		if (!rn2(5)) mongets(mtmp, POT_FIRE);
		if (!rn2(5)) mongets(mtmp, SCR_LAVA);
		if (!rn2(5)) mongets(mtmp, SWEET_MOCASSINS);
	}

	if (ptr == &mons[PM_ALL_ROCKING_WOMAN]) {
		if (!rn2(5)) mongets(mtmp, SCR_GROWTH);
		if (!rn2(5)) mongets(mtmp, SCR_GROWTH);
		if (!rn2(5)) mongets(mtmp, SCR_GROWTH);
		if (!rn2(5)) mongets(mtmp, SCR_CREATE_MONSTER);
	}

	if (ptr == &mons[PM_BIOLOGY_BITCH]) {
		if (!rn2(5)) mongets(mtmp, POT_POLYMORPH);
		if (!rn2(5)) mongets(mtmp, WAN_STRIKING);
		if (!rn2(5)) mongets(mtmp, STEEL_WHIP);
	}

	if (ptr == &mons[PM_COOL_DIRIGENT]) {
		if (!rn2(5)) mongets(mtmp, BUGLE);
		if (!rn2(5)) mongets(mtmp, BLACK_DRAGON_SCALE_MAIL);
		if (!rn2(5)) mongets(mtmp, ORCISH_SHORT_SWORD);
		if (!rn2(5)) mongets(mtmp, ORCISH_HELM);
		if (!rn2(5)) mongets(mtmp, ORCISH_CHAIN_MAIL);
	}

	if (ptr == &mons[PM_BEARDED_MATH_TEACHER]) {
		if (!rn2(5)) mongets(mtmp, RUBBER_HOSE);
	}

	if (ptr == &mons[PM_DRIVER]) {
		if (!rn2(5)) mongets(mtmp, POT_SPEED);
		if (!rn2(5)) mongets(mtmp, SCR_BAD_EFFECT);
	}

	if (ptr == &mons[PM_TWITCHER]) {
		if (!rn2(5)) mongets(mtmp, MALLET);
		if (!rn2(5)) mongets(mtmp, LEATHER_JACKET);
		if (!rn2(5)) mongets(mtmp, POT_EXTRA_HEALING);
	}

	if (ptr == &mons[PM_INCOMPETENT_PSEUDO_PRINCIPAL]) {
		if (!rn2(5)) mongets(mtmp, POT_BLINDNESS);
		if (!rn2(5)) mongets(mtmp, KNOUT);
		if (!rn2(5)) mongets(mtmp, SCR_IMMOBILITY);
		if (!rn2(5)) mongets(mtmp, POT_CYANIDE);
		if (!rn2(5)) mongets(mtmp, WAN_SUMMON_UNDEAD);
		if (!rn2(5)) mongets(mtmp, AMULET_OF_DATA_STORAGE);
		if (!rn2(5)) m_initthrow(mtmp, CREAM_PIE, 4);
	}

	if (ptr == &mons[PM_TEACHER_WITH_YELLOW_TEETH]) {
		if (!rn2(5)) mongets(mtmp, POT_SLIME);
		if (!rn2(5)) mongets(mtmp, POISONOUS_CLOAK);
	}

	if (ptr == &mons[PM_MONEY_STEALER]) {
		if (!rn2(5)) mongets(mtmp, LACQUERED_DANCING_SHOE);
		if (!rn2(5)) mongets(mtmp, LEATHER_JACKET);
		if (!rn2(5)) mongets(mtmp, SLING);
		if (!rn2(5)) mongets(mtmp, SCR_GROUP_SUMMONING);
		if (!rn2(5)) m_initthrow(mtmp, INVENTORY_LOSS_STONE, 1);
		if (!rn2(5)) m_initthrow(mtmp, DROPBUG_STONE, 1);
		if (!rn2(5)) m_initthrow(mtmp, BAD_EFFECT_STONE, 1);
	}

	if (ptr == &mons[PM_BRAIN_RUPTURED_TEACHER]) {
		if (!rn2(5)) mongets(mtmp, BUGLE);
		if (!rn2(5)) mongets(mtmp, POT_AMNESIA);
	}

	if (ptr == &mons[PM_ADMONISHER_TYPE]) {
		if (!rn2(5)) mongets(mtmp, WAN_CANCELLATION);
	}

	if (ptr == &mons[PM_DISTURBANCE_HEAD]) {
		if (!rn2(5)) mongets(mtmp, POT_SPEED);
		if (!rn2(5)) mongets(mtmp, BASEBALL_BAT);
	}

	if (ptr == &mons[PM_EVIL_TEACHER]) {
		if (!rn2(5)) mongets(mtmp, TWO_HANDED_SWORD);
		if (!rn2(5)) mongets(mtmp, PLATE_MAIL);
		if (!rn2(5)) mongets(mtmp, SCR_PUNISHMENT);
		if (!rn2(5)) mongets(mtmp, POT_STUNNING);
		if (!rn2(5)) mongets(mtmp, WAN_FINGER_BENDING);
	}

	if (ptr == &mons[PM_ASSLEFT_DOG]) {
		if (!rn2(5)) mongets(mtmp, WAN_DRAINING);
		if (!rn2(5)) mongets(mtmp, SCR_MEGALOAD);
		if (!rn2(5)) mongets(mtmp, WAN_STARVATION);
		if (!rn2(5)) mongets(mtmp, WAN_REDUCE_MAX_HITPOINTS);
		if (!rn2(5)) mongets(mtmp, GOLD_CHAIN);
	}

	if (ptr == &mons[PM_STRIP_MINE_HAWK]) {
		if (!rn2(5)) mongets(mtmp, WAN_DIGGING);
		if (!rn2(5)) mongets(mtmp, DWARVISH_MATTOCK);
		if (!rn2(5)) mongets(mtmp, CLOAK_OF_MAGIC_RESISTANCE);
	}

	if (ptr == &mons[PM_GEOLOGY_TORTURER]) {
		if (!rn2(5)) mongets(mtmp, SCR_EARTH);
		if (!rn2(5)) mongets(mtmp, SCR_EARTH);
		if (!rn2(5)) mongets(mtmp, SCR_EARTH);
		if (!rn2(5)) mongets(mtmp, WAN_STRIKING);
	}

	if (ptr == &mons[PM_UNCLE_OF_CARLO_SANTANA]) {
		if (!rn2(5)) mongets(mtmp, BUGLE);
		if (!rn2(5)) mongets(mtmp, POT_PARALYSIS);
	}

	if (ptr == &mons[PM_PIOUS_DAD]) {
		if (!rn2(5)) mongets(mtmp, MACE);
		if (!rn2(5)) mongets(mtmp, WAN_HEALING);
	}

	if (ptr == &mons[PM_DESERT_MOUNTAIN]) {
		if (!rn2(5)) mongets(mtmp, FLAIL);
		if (!rn2(5)) mongets(mtmp, WAN_STRIKING);
		if (!rn2(5)) mongets(mtmp, LEATHER_JACKET);
	}

	if (ptr == &mons[PM_HACKER_TEACHER]) {
		if (!rn2(5)) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if (!rn2(5)) mongets(mtmp, AMULET_OF_DATA_STORAGE);
		if (!rn2(5)) mongets(mtmp, RIN_TIMELY_BACKUP);
		if (!rn2(5)) mongets(mtmp, ELECTRIC_SWORD);
	}

	if (ptr == &mons[PM_CANNON_SADIST]) {
		if (!rn2(5)) mongets(mtmp, PISTOL);
		if (!rn2(5)) mongets(mtmp, LEATHER_JACKET);
		if (!rn2(5)) mongets(mtmp, ELVEN_CLOAK);
		if (!rn2(5)) mongets(mtmp, WAN_TELEPORTATION);
		if (!rn2(5)) m_initthrow(mtmp, PISTOL_BULLET, 50);
	}

	if (ptr == &mons[PM_OLD_RUNNER]) {
		if (!rn2(5)) mongets(mtmp, SCR_CHAOS_TERRAIN);
	}

	if (ptr == &mons[PM_CHEMISTRY_NERD]) {
		if (!rn2(5)) mongets(mtmp, POT_ACID);
		if (!rn2(5)) mongets(mtmp, POT_RADIUM);
		if (!rn2(5)) mongets(mtmp, POT_CYANIDE);
		if (!rn2(5)) mongets(mtmp, POT_HALLUCINATION);
		if (!rn2(5)) mongets(mtmp, POT_HALLUCINATION);
		if (!rn2(5)) mongets(mtmp, LEATHER_GLOVES);
	}

	if (ptr == &mons[PM_CHEMISTRY_WATCHER]) {
		if (!rn2(5)) mongets(mtmp, WAN_FIREBALL);
		if (!rn2(5)) mongets(mtmp, LAB_COAT);
	}

	if (ptr == &mons[PM_TERRIBLE_GARBAGE_HOUSES]) {
		if (!rn2(5)) mongets(mtmp, SLING);
		if (!rn2(5)) mongets(mtmp, AMULET_OF_DATA_STORAGE);
		if (!rn2(5)) m_initthrow(mtmp, CAPTCHA_STONE, 1);
		if (!rn2(5)) m_initthrow(mtmp, QUIZ_STONE, 1);
	}

	if (ptr == &mons[PM_ASSHOLE_TEACHER_WITHOUT_OWN_HOUSE]) {
		if (!rn2(5)) mongets(mtmp, SCR_BULLSHIT);
		if (!rn2(5)) mongets(mtmp, MUMMY_WRAPPING);
		if (!rn2(5)) mongets(mtmp, IRON_CHAIN);
		if (!rn2(5)) mongets(mtmp, WAN_SIN);
		if (!rn2(5)) mongets(mtmp, HEAVY_IRON_BALL);
	}

	if (ptr == &mons[PM_CORRECT_BULL]) {
		if (!rn2(5)) mongets(mtmp, RUBBER_HOSE);
		if (!rn2(5)) mongets(mtmp, PISTOL);
		if (!rn2(5)) mongets(mtmp, WAN_STUN_MONSTER);
		if (!rn2(5)) mongets(mtmp, SCR_CREATE_MONSTER);
		if (!rn2(5)) m_initthrow(mtmp, CREAM_PIE, 4);
		if (!rn2(5)) m_initthrow(mtmp, PISTOL_BULLET, 20);
	}

	if (ptr == &mons[PM_LONG_DICK]) {
		if (!rn2(5)) mongets(mtmp, POT_PARALYSIS);
	}

	if (ptr == &mons[PM_BIGOTED_MATH_TEACHER]) {
		if (!rn2(5)) mongets(mtmp, WAR_HAMMER);
		if (!rn2(5)) mongets(mtmp, CHAIN_MAIL);
		if (!rn2(5)) mongets(mtmp, POT_ICE);
		if (!rn2(5)) mongets(mtmp, POT_FIRE);
	}

	if (ptr == &mons[PM_DEPUTY_PRINCIPAL]) {
		if (!rn2(5)) mongets(mtmp, WAN_CREATE_MONSTER);
		if (!rn2(5)) mongets(mtmp, SCR_LOCKOUT);
		if (!rn2(5)) mongets(mtmp, SCR_LOCKOUT);
		if (!rn2(5)) mongets(mtmp, WAN_SUMMON_ELM);
		if (!rn2(5)) mongets(mtmp, SCR_SUMMON_ELM);
		if (!rn2(5)) mongets(mtmp, POT_GAIN_LEVEL);
		if (!rn2(5)) mongets(mtmp, RIN_TIMELY_BACKUP);
		if (!rn2(5)) mongets(mtmp, CLOAK_OF_INVISIBILITY);
		if (!rn2(5)) mongets(mtmp, ELVEN_MITHRIL_COAT);
		if (!rn2(5)) mongets(mtmp, ELYSIUM_SCOURGE);
	}

	if (ptr == &mons[PM_POLITE_TEACHER]) {
		if (!rn2(5)) mongets(mtmp, POT_SLEEPING);
	}

	if (ptr == &mons[PM_ART_AND_CRAFT_ANNOYER]) {
		if (!rn2(5)) mongets(mtmp, BUGLE);
		if (!rn2(5)) mongets(mtmp, MACE);
		if (!rn2(5)) m_initthrow(mtmp, DART, 50);
		if (!rn2(5)) m_initthrow(mtmp, DART, 50);
	}

	if (ptr == &mons[PM_WIZENED_OLD_BAG]) {
		if (!rn2(5)) mongets(mtmp, WAN_CLONE_MONSTER);
	}

	if (ptr == &mons[PM_BEST_HIGH_SCHOOL_TEACHER]) {
		if (!rn2(5)) mongets(mtmp, WAN_FIRE);
		if (!rn2(5)) mongets(mtmp, WAN_COLD);
		if (!rn2(5)) mongets(mtmp, CLOAK_OF_REFLECTION);
		if (!rn2(5)) mongets(mtmp, SCR_HEALING);
		if (!rn2(5)) mongets(mtmp, POT_POLYMORPH);
	}

	if (ptr == &mons[PM_SUPER_OLD_ASSHOLE_TEACHER]) {
		if (!rn2(5)) mongets(mtmp, KNOUT);
		if (!rn2(5)) mongets(mtmp, POT_SPEED);
	}

	if (ptr == &mons[PM_IN_THE_NET]) {
		if (!rn2(5)) mongets(mtmp, SCR_TELEPORTATION);
		if (!rn2(5)) mongets(mtmp, SCR_WARPING);
		if (!rn2(5)) mongets(mtmp, SCR_CREATE_MONSTER);
		if (!rn2(5)) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
	}

	if (ptr == &mons[PM_HOUSE_MASTER]) {
		if (!rn2(5)) mongets(mtmp, CONCRETE_NUNCHIAKU);
		if (!rn2(5)) mongets(mtmp, HEAVY_CONCRETE_BALL);
		if (!rn2(5)) mongets(mtmp, CLOAK_OF_MAGIC_RESISTANCE);
		if (!rn2(5)) mongets(mtmp, AMULET_OF_DATA_STORAGE);
	}

	if (ptr == &mons[PM_CARTHAGINIAN_TEACHER]) {
		if (!rn2(5)) mongets(mtmp, WAN_POLYMORPH);
	}

	if (ptr == &mons[PM_SIR]) {
		if (!rn2(5)) mongets(mtmp, PISTOL);
		if (!rn2(5)) mongets(mtmp, SCR_ENRAGE);
		if (!rn2(5)) mongets(mtmp, PLASTEEL_CLOAK);
		if (!rn2(5)) mongets(mtmp, WAN_SLOW_MONSTER);
		if (!rn2(5)) mongets(mtmp, POT_EXTRA_HEALING);
		if (!rn2(5)) m_initthrow(mtmp, PISTOL_BULLET, 20);
	}

	if (ptr == &mons[PM_BANISHER_TEACHER]) {
		if (!rn2(5)) mongets(mtmp, WAN_BANISHMENT);
	}

	if (ptr == &mons[PM_OLD_REGIMENT_TEACHER]) {
		if (!rn2(5)) mongets(mtmp, POT_MUTATION);
	}

	if (ptr == &mons[PM_PEACE_MINDED_TEACHER]) {
		if (!rn2(5)) mongets(mtmp, BULLWHIP);
	}

	if (ptr == &mons[PM_MOTORCYCLE_CHAIN_SWINGER]) {
		if (!rn2(5)) mongets(mtmp, POT_SPEED);
		if (!rn2(5)) mongets(mtmp, WAN_FEAR);
		if (!rn2(5)) mongets(mtmp, IRON_CHAIN);
	}

	if (ptr == &mons[PM_HAIR_BEARD]) {
		if (!rn2(5)) mongets(mtmp, SCR_BAD_EFFECT);
		if (!rn2(5)) mongets(mtmp, WAN_FIRE);
	}

	if (ptr == &mons[PM_WHEATER]) {
		if (!rn2(5)) mongets(mtmp, SCR_GROWTH);
	}

	if (ptr == &mons[PM_BAD_TEACHER_GRANDPA]) {
		if (!rn2(5)) mongets(mtmp, POT_SLEEPING);
		if (!rn2(5)) mongets(mtmp, WAN_SLEEP);
		if (!rn2(5)) mongets(mtmp, CLAY_CHAIN);
	}

	if (ptr == &mons[PM_IT_TEACHER]) {
		if (!rn2(5)) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if (!rn2(5)) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if (!rn2(5)) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if (!rn2(5)) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if (!rn2(5)) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		if (!rn2(5)) mongets(mtmp, GAUNTLETS_OF_TYPING);
	}

	if (ptr == &mons[PM_WHO]) {
		if (!rn2(5)) mongets(mtmp, POT_CONFUSION);
	}

	if (ptr == &mons[PM_THREE_ATE_GUY]) {
		if (!rn2(5)) mongets(mtmp, KATANA);
		if (!rn2(5)) mongets(mtmp, SCR_SUMMON_BOSS);
	}

	if (ptr == &mons[PM_REAL_AND_TRUE_PRINCIPAL]) {
		if (!rn2(5)) mongets(mtmp, DROVEN_BOW);
		if (!rn2(5)) mongets(mtmp, MALLET);
		if (!rn2(5)) mongets(mtmp, FULL_PLATE_MAIL);
		if (!rn2(5)) mongets(mtmp, AMULET_OF_DATA_STORAGE);
		if (!rn2(5)) mongets(mtmp, CLOAK_OF_MAGIC_RESISTANCE);
		if (!rn2(5)) mongets(mtmp, HELM_OF_STEEL);
		if (!rn2(5)) mongets(mtmp, PLASTEEL_GLOVES);
		if (!rn2(5)) mongets(mtmp, STEEL_SHIELD);
		if (!rn2(5)) mongets(mtmp, SCR_SUMMON_GHOST);
		if (!rn2(5)) mongets(mtmp, SCR_RELOCATION);
		if (!rn2(5)) mongets(mtmp, SCR_EGOISM);
		if (!rn2(5)) mongets(mtmp, SPEED_BOOTS);
		if (!rn2(5)) mongets(mtmp, WAN_DISINTEGRATION);
		if (!rn2(5)) mongets(mtmp, WAN_TIME);
		if (!rn2(5)) mongets(mtmp, WAN_CREATE_HORDE);
		if (!rn2(5)) m_initthrow(mtmp, DROVEN_ARROW, 50);
		if (!rn2(5)) m_initthrow(mtmp, DROVEN_ARROW, 50);
		if (!rn2(5)) m_initthrow(mtmp, DROVEN_ARROW, 50);
		if (!rn2(5)) m_initthrow(mtmp, DROVEN_ARROW, 50);
	}


	if (ptr == &mons[PM_JUTTA_FLAX]) {
		(void) mongets(mtmp, SCR_BAD_EFFECT);
		(void) mongets(mtmp, SCR_SIN);
		(void) mongets(mtmp, SCR_TRAP_CREATION);
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, LACQUERED_DANCING_SHOE);
		(void) mongets(mtmp, POT_CONFUSION);
		(void) mongets(mtmp, POT_STUNNING);
	}

	if (ptr == &mons[PM_IRRESISTIBLE_THICK_LADY]) {
		if (!rn2(5)) (void) mongets(mtmp, SCR_BAD_EFFECT);
		if (!rn2(5)) (void) mongets(mtmp, SCR_SIN);
		if (!rn2(5)) (void) mongets(mtmp, SCR_TRAP_CREATION);
		if (!rn2(5)) (void) mongets(mtmp, SWEET_MOCASSINS);
		if (!rn2(5)) (void) mongets(mtmp, LACQUERED_DANCING_SHOE);
		if (!rn2(5)) (void) mongets(mtmp, POT_CONFUSION);
		if (!rn2(5)) (void) mongets(mtmp, POT_STUNNING);
	}

	if (ptr == &mons[PM_ANNIE]) {
		(void) mongets(mtmp, WAN_REMOVE_RESISTANCE);
		(void) mongets(mtmp, BULLWHIP);
		(void) mongets(mtmp, RIN_TIMELY_BACKUP);
	}

	if (ptr == &mons[PM_BIRGIT]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
		(void) mongets(mtmp, WAN_STRIKING);
		(void) mongets(mtmp, LEATHER_ARMOR);
		(void) mongets(mtmp, LEATHER_CLOAK);
		(void) mongets(mtmp, BUGLE);
		(void) mongets(mtmp, SCR_RELOCATION);
	}

	if (ptr == &mons[PM_INGE]) {
		(void) mongets(mtmp, SCR_LAVA);
		(void) mongets(mtmp, SCR_BARRHING);
		(void) mongets(mtmp, SCR_CHAOS_TERRAIN);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
		(void) mongets(mtmp, HIPPIE_HEELS); /* M4_BLOCKHEELBOOTS */
	}

	if (ptr == &mons[PM_ALICE]) {
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, BULLWHIP);
		(void) mongets(mtmp, RING_MAIL);
		(void) mongets(mtmp, HELMET);
		(void) mongets(mtmp, WAN_DRAIN_MANA);
		(void) mongets(mtmp, POT_EXTRA_HEALING);
		(void) mongets(mtmp, SILVER_SPEAR);
	}

	if (ptr == &mons[PM_KELK]) {
		(void) mongets(mtmp, POT_ACID);
		(void) mongets(mtmp, FLY_SWATTER);
		(void) mongets(mtmp, POISONOUS_CLOAK);
		(void) mongets(mtmp, GREEN_DRAGON_SCALES);
		(void) mongets(mtmp, BOOTS_OF_ACID_RESISTANCE);
		(void) mongets(mtmp, POT_RADIUM);
	}

	if (ptr == &mons[PM_KUN_KWEI]) {
		(void) mongets(mtmp, WAN_FEAR);
	}

	if (ptr == &mons[PM_MARENKA]) {
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, STEEL_WHIP);
		(void) mongets(mtmp, SHIELD_OF_REFLECTION);
		(void) mongets(mtmp, WAN_CREATE_MONSTER);
		(void) mongets(mtmp, WAN_STONING);
		m_initthrow(mtmp, SILVER_SPEAR, 3);
	}

	if (ptr == &mons[PM_GRIDIN]) {
		(void) mongets(mtmp, WAN_REDUCE_MAX_HITPOINTS);
		(void) mongets(mtmp, POT_STUNNING);
		(void) mongets(mtmp, RUBBER_HOSE);
	}

	if (ptr == &mons[PM_WURIE]) {
		(void) mongets(mtmp, SCR_SUMMON_BOSS);
	}

	if (ptr == &mons[PM_MISS_BEING_MOOSE]) {
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		(void) mongets(mtmp, SWEET_MOCASSINS);
	}

	if (ptr == &mons[PM_JENNI]) {
		(void) mongets(mtmp, WAN_CURSE_ITEMS);
		(void) mongets(mtmp, STUDDED_LEATHER_ARMOR);
	}

	if (ptr == &mons[PM_IRIS_FLAX]) {
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, PISTOL);
		(void) mongets(mtmp, BOW);
		(void) mongets(mtmp, SILVER_DRAGON_SCALES);
		(void) mongets(mtmp, SCR_BAD_EFFECT);
		m_initthrow(mtmp, SILVER_SPEAR, 10);
		m_initthrow(mtmp, SILVER_PISTOL_BULLET, 50);
		m_initthrow(mtmp, SILVER_DAGGER, 10);
		m_initthrow(mtmp, SILVER_ARROW, 50);
	}

	if (ptr == &mons[PM_DR__PAPPE]) {
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);
	}

	if (ptr == &mons[PM_MERRY_LUIS]) {
		(void) mongets(mtmp, WAN_MAGIC_MISSILE);
	}

	if (ptr == &mons[PM_MISS_SCHRACK]) {
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, SPIKED_BATTLE_BOOT);
		(void) mongets(mtmp, LANCE);
		(void) mongets(mtmp, POT_FIRE);
		(void) mongets(mtmp, POT_PARALYSIS);
		(void) mongets(mtmp, SCR_ICE);
		(void) mongets(mtmp, WAN_HEALING);
		m_initthrow(mtmp, GAS_GRENADE, 5);
	}

	if (ptr == &mons[PM_CAROLA]) {
		(void) mongets(mtmp, WAN_PARALYSIS);
	}

	if (ptr == &mons[PM_MISS_YOUNGDRAGON]) {
		(void) mongets(mtmp, WAN_CURSE_ITEMS);
		(void) mongets(mtmp, WAN_BAD_EFFECT);
		(void) mongets(mtmp, GRAY_DRAGON_SCALE_MAIL);
		(void) mongets(mtmp, ORCISH_BOW);
		m_initthrow(mtmp, DARK_ELVEN_ARROW, 50);
		(void) mongets(mtmp, SCR_VILENESS);
	}

	if (ptr == &mons[PM_KLAF]) {
		(void) mongets(mtmp, SCR_TELEPORTATION);
	}

	if (ptr == &mons[PM_MARIA]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, COMBAT_STILETTOS);
		(void) mongets(mtmp, POT_ACID);
		(void) mongets(mtmp, WAN_ACID);
	}

	if (ptr == &mons[PM_MISS_HOUSE_WORKER]) {
		(void) mongets(mtmp, SCR_BAD_EFFECT);
	}

	if (ptr == &mons[PM_GRAHW]) {
		(void) mongets(mtmp, UNICORN_HORN);
		m_initthrow(mtmp, DART, 20);
	}

	if (ptr == &mons[PM_ROSWITHA]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, WAN_HEALING);
		(void) mongets(mtmp, WAN_EXTRA_HEALING);
		(void) mongets(mtmp, WAN_FULL_HEALING);
		(void) mongets(mtmp, WAN_CONFUSION);
		(void) mongets(mtmp, SCR_SUMMON_ELM);
		(void) mongets(mtmp, POT_CONFUSION);
	}

	if (ptr == &mons[PM_RAFSCHAR]) {
		(void) mongets(mtmp, WAN_CREATE_MONSTER);
		(void) mongets(mtmp, T_SHIRT);
	}

	if (ptr == &mons[PM_MISS_NICOLAS]) {
		(void) mongets(mtmp, POT_BLINDNESS);
		(void) mongets(mtmp, POT_ICE);
		(void) mongets(mtmp, POT_FEAR);
	}

	if (ptr == &mons[PM_LILJANA]) {
		(void) mongets(mtmp, WAN_COLD);
		(void) mongets(mtmp, WAN_LIGHTNING);
		(void) mongets(mtmp, AMULET_OF_DATA_STORAGE);
		(void) mongets(mtmp, RIN_TIMELY_BACKUP);
		(void) mongets(mtmp, SWEET_MOCASSINS);
	}

	if (ptr == &mons[PM_RENDTBAR]) {
		(void) mongets(mtmp, POT_RADIUM);
		(void) mongets(mtmp, POT_RADIUM);
		(void) mongets(mtmp, POT_RADIUM);
	}

	if (ptr == &mons[PM_MISS_DARKMOON]) {
		(void) mongets(mtmp, SWEET_MOCASSINS);
		(void) mongets(mtmp, SCR_FLOOD);
		(void) mongets(mtmp, ELVEN_CLOAK);
		(void) mongets(mtmp, LEATHER_JACKET);
	}

	if (ptr == &mons[PM_MISS_TODAY]) {
		(void) mongets(mtmp, SWEET_MOCASSINS);
	}

	if (ptr == &mons[PM_MISS_MUD_DIRT]) {
		(void) mongets(mtmp, SCR_CHAOS_TERRAIN);
	}

	if (ptr == &mons[PM_SCHMIDTS]) {
		(void) mongets(mtmp, POT_FIRE);
		(void) mongets(mtmp, SCR_LAVA);
		(void) mongets(mtmp, SWEET_MOCASSINS);
	}

	if (ptr == &mons[PM_BUNDLE_TREE]) {
		(void) mongets(mtmp, SCR_GROWTH);
		(void) mongets(mtmp, SCR_GROWTH);
		(void) mongets(mtmp, SCR_GROWTH);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
	}

	if (ptr == &mons[PM_MISS_LOCKING_STABLE]) {
		(void) mongets(mtmp, POT_POLYMORPH);
		(void) mongets(mtmp, WAN_STRIKING);
		(void) mongets(mtmp, STEEL_WHIP);
	}

	if (ptr == &mons[PM_MISTER_BLACKMAN]) {
		(void) mongets(mtmp, BUGLE);
		(void) mongets(mtmp, BLACK_DRAGON_SCALE_MAIL);
		(void) mongets(mtmp, ORCISH_SHORT_SWORD);
		(void) mongets(mtmp, ORCISH_HELM);
		(void) mongets(mtmp, ORCISH_CHAIN_MAIL);
	}

	if (ptr == &mons[PM_MISTER_GREENLY]) {
		(void) mongets(mtmp, RUBBER_HOSE);
	}

	if (ptr == &mons[PM_DRIVING_IMPULSE]) {
		(void) mongets(mtmp, POT_SPEED);
		(void) mongets(mtmp, SCR_BAD_EFFECT);
	}

	if (ptr == &mons[PM_MOVING_TWITCH]) {
		(void) mongets(mtmp, MALLET);
		(void) mongets(mtmp, LEATHER_JACKET);
		(void) mongets(mtmp, POT_EXTRA_HEALING);
	}

	if (ptr == &mons[PM_MARIHUANA]) {
		(void) mongets(mtmp, POT_BLINDNESS);
		(void) mongets(mtmp, KNOUT);
		(void) mongets(mtmp, SCR_IMMOBILITY);
		(void) mongets(mtmp, POT_CYANIDE);
		(void) mongets(mtmp, WAN_SUMMON_UNDEAD);
		(void) mongets(mtmp, AMULET_OF_DATA_STORAGE);
		m_initthrow(mtmp, CREAM_PIE, 4);
	}

	if (ptr == &mons[PM_LEUTKAK]) {
		(void) mongets(mtmp, POT_SLIME);
		(void) mongets(mtmp, POISONOUS_CLOAK);
	}

	if (ptr == &mons[PM_HANS]) {
		(void) mongets(mtmp, LACQUERED_DANCING_SHOE);
		(void) mongets(mtmp, LEATHER_JACKET);
		(void) mongets(mtmp, SLING);
		(void) mongets(mtmp, SCR_GROUP_SUMMONING);
		m_initthrow(mtmp, INVENTORY_LOSS_STONE, 1);
		m_initthrow(mtmp, DROPBUG_STONE, 1);
		m_initthrow(mtmp, BAD_EFFECT_STONE, 1);
	}

	if (ptr == &mons[PM_GLOECKLE]) {
		(void) mongets(mtmp, BUGLE);
		(void) mongets(mtmp, POT_AMNESIA);
	}

	if (ptr == &mons[PM_MISTER_ADMONISHER]) {
		(void) mongets(mtmp, WAN_CANCELLATION);
	}

	if (ptr == &mons[PM_MISTER_HEAD]) {
		(void) mongets(mtmp, POT_SPEED);
		(void) mongets(mtmp, BASEBALL_BAT);
	}

	if (ptr == &mons[PM_DR__RAMOV]) {
		(void) mongets(mtmp, TWO_HANDED_SWORD);
		(void) mongets(mtmp, PLATE_MAIL);
		(void) mongets(mtmp, SCR_PUNISHMENT);
		(void) mongets(mtmp, POT_STUNNING);
		(void) mongets(mtmp, WAN_FINGER_BENDING);
	}

	if (ptr == &mons[PM_LEFT_ASS]) {
		(void) mongets(mtmp, WAN_DRAINING);
		(void) mongets(mtmp, SCR_MEGALOAD);
		(void) mongets(mtmp, WAN_STARVATION);
		(void) mongets(mtmp, WAN_REDUCE_MAX_HITPOINTS);
		(void) mongets(mtmp, GOLD_CHAIN);
	}

	if (ptr == &mons[PM_GREAT_CORNER_HARD]) {
		(void) mongets(mtmp, WAN_DRAINING);
		(void) mongets(mtmp, SCR_MEGALOAD);
		(void) mongets(mtmp, WAN_STARVATION);
		(void) mongets(mtmp, WAN_REDUCE_MAX_HITPOINTS);
		(void) mongets(mtmp, GOLD_CHAIN);
	}

	if (ptr == &mons[PM_MISTER_STRIP_MINE]) {
		(void) mongets(mtmp, WAN_DIGGING);
		(void) mongets(mtmp, DWARVISH_MATTOCK);
		(void) mongets(mtmp, CLOAK_OF_MAGIC_RESISTANCE);
	}

	if (ptr == &mons[PM_PEDALAS]) {
		(void) mongets(mtmp, SCR_EARTH);
		(void) mongets(mtmp, SCR_EARTH);
		(void) mongets(mtmp, SCR_EARTH);
		(void) mongets(mtmp, WAN_STRIKING);
	}

	if (ptr == &mons[PM_GROSS_SANTANA]) {
		(void) mongets(mtmp, BUGLE);
		(void) mongets(mtmp, POT_PARALYSIS);
	}

	if (ptr == &mons[PM_DAD_MANGER]) {
		(void) mongets(mtmp, MACE);
		(void) mongets(mtmp, WAN_HEALING);
	}

	if (ptr == &mons[PM_DESERT_DWARF]) {
		(void) mongets(mtmp, FLAIL);
		(void) mongets(mtmp, WAN_STRIKING);
		(void) mongets(mtmp, LEATHER_JACKET);
	}

	if (ptr == &mons[PM_HAXXOR]) {
		(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		(void) mongets(mtmp, AMULET_OF_DATA_STORAGE);
		(void) mongets(mtmp, RIN_TIMELY_BACKUP);
		(void) mongets(mtmp, ELECTRIC_SWORD);
	}

	if (ptr == &mons[PM_AL_CAPONE]) {
		(void) mongets(mtmp, PISTOL);
		(void) mongets(mtmp, LEATHER_JACKET);
		(void) mongets(mtmp, ELVEN_CLOAK);
		(void) mongets(mtmp, WAN_TELEPORTATION);
		m_initthrow(mtmp, PISTOL_BULLET, 50);
	}

	if (ptr == &mons[PM_RUNNER]) {
		(void) mongets(mtmp, SCR_CHAOS_TERRAIN);
	}

	if (ptr == &mons[PM_GUNTER]) {
		(void) mongets(mtmp, POT_ACID);
		(void) mongets(mtmp, POT_RADIUM);
		(void) mongets(mtmp, POT_CYANIDE);
		(void) mongets(mtmp, POT_HALLUCINATION);
		(void) mongets(mtmp, POT_HALLUCINATION);
		(void) mongets(mtmp, LEATHER_GLOVES);
	}

	if (ptr == &mons[PM_MISTER_ALSO_MATTE]) {
		(void) mongets(mtmp, WAN_FIREBALL);
		(void) mongets(mtmp, LAB_COAT);
	}

	if (ptr == &mons[PM_MISTER_GARBAGE_HOUSES]) {
		(void) mongets(mtmp, SLING);
		(void) mongets(mtmp, AMULET_OF_DATA_STORAGE);
		m_initthrow(mtmp, CAPTCHA_STONE, 1);
		m_initthrow(mtmp, QUIZ_STONE, 1);
	}

	if (ptr == &mons[PM_HARRO]) {
		(void) mongets(mtmp, SCR_BULLSHIT);
		(void) mongets(mtmp, MUMMY_WRAPPING);
		(void) mongets(mtmp, IRON_CHAIN);
		(void) mongets(mtmp, WAN_SIN);
		(void) mongets(mtmp, HEAVY_IRON_BALL);
	}

	if (ptr == &mons[PM_BAERAN]) {
		(void) mongets(mtmp, RUBBER_HOSE);
		(void) mongets(mtmp, PISTOL);
		(void) mongets(mtmp, WAN_STUN_MONSTER);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		m_initthrow(mtmp, CREAM_PIE, 4);
		m_initthrow(mtmp, PISTOL_BULLET, 20);
	}

	if (ptr == &mons[PM_DICKMOUTH]) {
		(void) mongets(mtmp, POT_PARALYSIS);
	}

	if (ptr == &mons[PM_RAINI]) {
		(void) mongets(mtmp, WAR_HAMMER);
		(void) mongets(mtmp, CHAIN_MAIL);
		(void) mongets(mtmp, POT_ICE);
		(void) mongets(mtmp, POT_FIRE);
	}

	if (ptr == &mons[PM_MISTER_BE_SILENT_KERT]) {
		(void) mongets(mtmp, WAN_CREATE_MONSTER);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, SCR_LOCKOUT);
		(void) mongets(mtmp, WAN_SUMMON_ELM);
		(void) mongets(mtmp, SCR_SUMMON_ELM);
		(void) mongets(mtmp, POT_GAIN_LEVEL);
		(void) mongets(mtmp, RIN_TIMELY_BACKUP);
		(void) mongets(mtmp, CLOAK_OF_INVISIBILITY);
		(void) mongets(mtmp, ELVEN_MITHRIL_COAT);
		(void) mongets(mtmp, ELYSIUM_SCOURGE);
	}

	if (ptr == &mons[PM_CONSTI]) {
		(void) mongets(mtmp, POT_SLEEPING);
	}

	if (ptr == &mons[PM_SOUND_IMPACTS]) {
		(void) mongets(mtmp, BUGLE);
		(void) mongets(mtmp, MACE);
		m_initthrow(mtmp, DART, 50);
		m_initthrow(mtmp, DART, 50);
	}

	if (ptr == &mons[PM_SCHRUMPEL]) {
		(void) mongets(mtmp, WAN_CLONE_MONSTER);
	}

	if (ptr == &mons[PM_FAHRTUM]) {
		(void) mongets(mtmp, WAN_FIRE);
		(void) mongets(mtmp, WAN_COLD);
		(void) mongets(mtmp, CLOAK_OF_REFLECTION);
		(void) mongets(mtmp, SCR_HEALING);
		(void) mongets(mtmp, POT_POLYMORPH);
	}

	if (ptr == &mons[PM_RIVERMAN]) {
		(void) mongets(mtmp, KNOUT);
		(void) mongets(mtmp, POT_SPEED);
	}

	if (ptr == &mons[PM_MISTER_INTERNET]) {
		(void) mongets(mtmp, SCR_TELEPORTATION);
		(void) mongets(mtmp, SCR_WARPING);
		(void) mongets(mtmp, SCR_CREATE_MONSTER);
		(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
	}

	if (ptr == &mons[PM_KOVVELKOV]) {
		(void) mongets(mtmp, CONCRETE_NUNCHIAKU);
		(void) mongets(mtmp, HEAVY_CONCRETE_BALL);
		(void) mongets(mtmp, CLOAK_OF_MAGIC_RESISTANCE);
		(void) mongets(mtmp, AMULET_OF_DATA_STORAGE);
	}

	if (ptr == &mons[PM_BAENDRE]) {
		(void) mongets(mtmp, WAN_POLYMORPH);
	}

	if (ptr == &mons[PM_MISTER_SIR]) {
		(void) mongets(mtmp, PISTOL);
		(void) mongets(mtmp, SCR_ENRAGE);
		(void) mongets(mtmp, PLASTEEL_CLOAK);
		(void) mongets(mtmp, WAN_SLOW_MONSTER);
		(void) mongets(mtmp, POT_EXTRA_HEALING);
		m_initthrow(mtmp, PISTOL_BULLET, 20);
	}

	if (ptr == &mons[PM_TELPAN]) {
		(void) mongets(mtmp, WAN_BANISHMENT);
	}

	if (ptr == &mons[PM_MISTER_ANCIENT_REGIME]) {
		(void) mongets(mtmp, POT_MUTATION);
	}

	if (ptr == &mons[PM_HIRSCHAH]) {
		(void) mongets(mtmp, BULLWHIP);
	}

	if (ptr == &mons[PM_OTTO]) {
		(void) mongets(mtmp, POT_SPEED);
		(void) mongets(mtmp, WAN_FEAR);
		(void) mongets(mtmp, IRON_CHAIN);
	}

	if (ptr == &mons[PM_HAIRBEARD]) {
		(void) mongets(mtmp, SCR_BAD_EFFECT);
		(void) mongets(mtmp, WAN_FIRE);
	}

	if (ptr == &mons[PM_WEITZER]) {
		(void) mongets(mtmp, SCR_GROWTH);
	}

	if (ptr == &mons[PM_SUPER_OLD_FRITZ]) {
		(void) mongets(mtmp, POT_SLEEPING);
		(void) mongets(mtmp, WAN_SLEEP);
		(void) mongets(mtmp, CLAY_CHAIN);
	}

	if (ptr == &mons[PM_FIVE_MAN]) {
		(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		(void) mongets(mtmp, SCR_ROOT_PASSWORD_DETECTION);
		(void) mongets(mtmp, GAUNTLETS_OF_TYPING);
	}

	if (ptr == &mons[PM_MISTER_WHO]) {
		(void) mongets(mtmp, POT_CONFUSION);
	}

	if (ptr == &mons[PM_FLAT_MAN]) {
		(void) mongets(mtmp, KATANA);
		(void) mongets(mtmp, SCR_SUMMON_BOSS);
	}

	if (ptr == &mons[PM_PRINCIPAL_NATURAL_GAS]) {
		(void) mongets(mtmp, DROVEN_BOW);
		(void) mongets(mtmp, MALLET);
		(void) mongets(mtmp, FULL_PLATE_MAIL);
		(void) mongets(mtmp, AMULET_OF_DATA_STORAGE);
		(void) mongets(mtmp, CLOAK_OF_MAGIC_RESISTANCE);
		(void) mongets(mtmp, HELM_OF_STEEL);
		(void) mongets(mtmp, PLASTEEL_GLOVES);
		(void) mongets(mtmp, STEEL_SHIELD);
		(void) mongets(mtmp, SCR_SUMMON_GHOST);
		(void) mongets(mtmp, SCR_RELOCATION);
		(void) mongets(mtmp, SCR_EGOISM);
		(void) mongets(mtmp, SPEED_BOOTS);
		(void) mongets(mtmp, WAN_DISINTEGRATION);
		(void) mongets(mtmp, WAN_TIME);
		(void) mongets(mtmp, WAN_CREATE_HORDE);
		m_initthrow(mtmp, DROVEN_ARROW, 50);
		m_initthrow(mtmp, DROVEN_ARROW, 50);
		m_initthrow(mtmp, DROVEN_ARROW, 50);
		m_initthrow(mtmp, DROVEN_ARROW, 50);
	}

	if (ptr == &mons[PM_THE_EXTRA_FLEECY_BUNDLE_HER_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_EMMELIE_S_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

	}

	if (ptr == &mons[PM_LUISA_S_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_LEXI_S_WONDERFULLY_SOFT_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_REBECCA_S_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_ROUGH_TERESA_S_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_JANINE_S_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_BITCHY_LARA_S_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_MARLEEN_S_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_MARLEEN_S_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_NONEROTIC_IRINA_S_WEDGE_SANDAL]) {
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

	}

	if (ptr == &mons[PM_BUNDLY_ANN_S_SOFT_SANDAL]) {
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

	}

	if (ptr == &mons[PM_LISELOTTE_S_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_LISELOTTE_S_SOFT_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_MAY_BRITT_S_FLUFFY_SANDAL]) {
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

	}

	if (ptr == &mons[PM_ROXY_GRETA_S_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_THE_HIGH_HEEL_LOVING_ASIAN_GIRL_HER_HEELS]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);

	}

	if (ptr == &mons[PM_ALIDA_S_COLORFUL_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

	}

	if (ptr == &mons[PM_JOSEFINE_S_SUPER_SWEET_VELCRO_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_VILEA_S_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_AMELJE_S_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_AMELJE_S_SANDAL]) {
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

	}

	if (ptr == &mons[PM_MELANIE_S_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_THE_HUGGING_TOPMODEL_HER_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_FANNY_S_VELCRO_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_FANNY_S_BRAND_NEW_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_FANNY_S_BUCKLED_SANDAL]) {
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

	}

	if (ptr == &mons[PM_BUNDLE_NADJA_S_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_MAGDALENA_S_DANCING_SHOE]) {
		(void) mongets(mtmp, DANCING_SHOES);

	}

	if (ptr == &mons[PM_MAILIE_S_STILETTO]) {
		(void) mongets(mtmp, HIGH_STILETTOS);
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);

	}

	if (ptr == &mons[PM_MAILIE_S_BEGUILING_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_JULCHEN_S_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_SABRINA_S_PLATEAU_BOOT]) {
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);

	}

	if (ptr == &mons[PM_SOLVEJG_S_OTHER_MOCASSIN]) {
		(void) mongets(mtmp, SWEET_MOCASSINS);

	}

	if (ptr == &mons[PM_THAI_S_HIGH_HEELED_LADY_SHOE]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);

	}

	if (ptr == &mons[PM_NADJA_S_THICK_BOOT]) {
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);

	}

	if (ptr == &mons[PM_RITA_S_SEXY_SANDAL]) {
		(void) mongets(mtmp, HIGH_STILETTOS);
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */

	}

	if (ptr == &mons[PM_KATI_S_HIGH_HEELED_SANDAL]) {
		(void) mongets(mtmp, HIGH_STILETTOS);
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */

	}

	if (ptr == &mons[PM_JOHANETTA_S_ROUGH_SOLE_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_JOHANETTA_S_DANCING_SHOE]) {
		(void) mongets(mtmp, DANCING_SHOES);

	}

	if (ptr == &mons[PM_KLARA_S_POINTY_COMBAT_BOOT]) {
		(void) mongets(mtmp, SPIKED_BATTLE_BOOT);
		(void) mongets(mtmp, COMBAT_STILETTOS);

	}

	if (ptr == &mons[PM_SANDRA_S_PLATEAU_BOOT]) {
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);

	}

	if (ptr == &mons[PM_LARISSA_S_SOFT_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_LARISSA_S_BLOCK_HEELED_BOOT]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

	}

	if (ptr == &mons[PM_SUESCHEN_S_FEMININE_SANDAL]) {
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

	}

	if (ptr == &mons[PM_ANTONIA_S_LEATHER_PUMP]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

	}

	if (ptr == &mons[PM_CHASKA_S_LEATHER_PUMP]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

	}

	if (ptr == &mons[PM_LUDGERA_S_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

	}

	if (ptr == &mons[PM_LAURA_S_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_LAURA_S_CUDDLY_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_MARIAN_S_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_MARIAN_S_PERSIAN_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_JIL_S_VELCRO_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

	}

	if (ptr == &mons[PM_PATRICIA_S_COMBAT_BOOT]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

	}

	if (ptr == &mons[PM_PATRICIA_S_WORN_OUT_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

	}

	if (ptr == &mons[PM_HANH_S_LITTLE_GIRL_SANDAL]) {
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

	}

	if (ptr == &mons[PM_HANH_S_BLOCK_HEELED_SANDAL]) {
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */

	}

	if (ptr == &mons[PM_HANH_S_SEXY_PUMP]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

	}

	if (ptr == &mons[PM_HANH_S_TRANSLUCENT_SANDAL]) {
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

	}

	if (ptr == &mons[PM_HANH_S_BALLERINA]) {
		(void) mongets(mtmp, SWEET_MOCASSINS);

	}

	if (ptr == &mons[PM_ANTJE_S_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

	}

	if (ptr == &mons[PM_ANTJE_S_BLOCK_HEELED_BOOT]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

	}

	if (ptr == &mons[PM_ELKE_S_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

	}

	if (ptr == &mons[PM_NICOLE_S_BLOCK_HEELED_COMBAT_BOOT]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

	}

	if (ptr == &mons[PM_NICOLE_S_LOVELY_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_BETTINA_S_COMBAT_BOOT]) {
		(void) mongets(mtmp, SPIKED_BATTLE_BOOT);

	}

	if (ptr == &mons[PM_HEIKE_S_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_DORA_S_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_DORA_S_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_RUTH_S_BLOCK_HEELED_LADY_BOOT]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

	}

	if (ptr == &mons[PM_RUTH_S_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_LOU_S_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

	}

	if (ptr == &mons[PM_DANIELLE_S_HIGH_HEELED_SANDAL]) {
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, HIGH_STILETTOS);

	}

	if (ptr == &mons[PM_DANIELLE_S_EROTIC_LADY_SHOE]) {
		(void) mongets(mtmp, SWEET_MOCASSINS);

	}

	if (ptr == &mons[PM_SOFIA_S_LEATHER_PUMP]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

	}

	if (ptr == &mons[PM_ANN_KATHRIN_S_GIRL_SHOE]) {
		(void) mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */

	}

	if (ptr == &mons[PM_NJUSHA_S_SWEET_SANDAL]) {
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

	}

	if (ptr == &mons[PM_ELIANE_S_SHIN_SMASHING_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

	}

	if (ptr == &mons[PM_LISA_S_YELLOW_STILETTO]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, HIGH_STILETTOS);

	}

	if (ptr == &mons[PM_LISA_S_PURPLE_STILETTO]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, HIGH_STILETTOS);

	}

	if (ptr == &mons[PM_LISA_S_HIGH_HEELED_SANDAL]) {
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, HIGH_STILETTOS);

	}

	if (ptr == &mons[PM_LISA_S_GIRL_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_LISA_S_BLOCK_HEELED_COMBAT_BOOT]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

	}

	if (ptr == &mons[PM_ARABELLA_S_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_ARABELLA_S_SOFT_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_ARABELLA_S_HIGH_HEELED_LADY_SHOE]) {
		(void) mongets(mtmp, LACQUERED_DANCING_SHOE);

	}

	if (ptr == &mons[PM_HENRIETTA_S_THICK_BLOCK_HEELED_BOOT]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

	}

	if (ptr == &mons[PM_KATRIN_S_COMBAT_BOOT]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

	}

	if (ptr == &mons[PM_JANA_S_SOFT_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_YASAMAN_S_LADY_PUMP]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

	}

	if (ptr == &mons[PM_ALMUTH_S_BLOCK_HEELED_BOOT]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

	}

	if (ptr == &mons[PM_KSENIA_S_STILETTO_BOOT]) {
		(void) mongets(mtmp, SPIKED_BATTLE_BOOT);
		(void) mongets(mtmp, COMBAT_STILETTOS);

	}

	if (ptr == &mons[PM_ELENA_S_PLATEAU_BOOT]) {
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);

	}

	if (ptr == &mons[PM_ELENA_S_PLATFORM_SANDAL]) {
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

	}

	if (ptr == &mons[PM_INGE_S_COMBAT_BOOT]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

	}

	if (ptr == &mons[PM_HELEN_S_LADY_PUMP]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

	}

	if (ptr == &mons[PM_KRISTIN_S_BLOCK_HEELED_COMBAT_BOOT]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

	}

	if (ptr == &mons[PM_KRISTIN_S_SUPER_HIGH_LADY_SHOE]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);

	}

	if (ptr == &mons[PM_KRISTIN_S_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_KRISTIN_S_SOFT_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_KRISTIN_S_BLOCK_HEELED_SANDAL]) {
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */

	}

	if (ptr == &mons[PM_KRISTIN_S_LACQUERED_NOBLE_SANDAL]) {
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

	}

	if (ptr == &mons[PM_KRISTIN_S_PLATEAU_BOOT]) {
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);

	}

	if (ptr == &mons[PM_VERA_S_ICE_COLD_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

	}

	if (ptr == &mons[PM_NORA_S_LOVELY_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

	}

	if (ptr == &mons[PM_GIULIA_S_DANCING_SHOE]) {
		(void) mongets(mtmp, DANCING_SHOES);

	}

	if (ptr == &mons[PM_SARAH_S_SOFT_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

	}

	if (ptr == &mons[PM_SARAH_S_MOCASSIN]) {
		(void) mongets(mtmp, SWEET_MOCASSINS);

	}

	if (ptr == &mons[PM_IRIS_S_SILVER_PUMP]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

	}

	if (ptr == &mons[PM_ALEXIA_S_SOFT_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_BARBARA_S_LOVELY_SANDAL]) {
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

	}

	if (ptr == &mons[PM_ROSWITHA_S_LACQUERED_PUMP]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

	}

	if (ptr == &mons[PM_CHARLOTTE_S_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_FRIEDERIKE_S_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_SOPHIA_S_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_SUE_LYN_S_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

	}

	if (ptr == &mons[PM_JUEN_S_BLOCK_HEELED_COMBAT_BOOT]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

	}

	if (ptr == &mons[PM_JUEN_S_PLATEAU_BOOT]) {
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);

	}

	if (ptr == &mons[PM_JUEN_S_FRIGHTENING_BATHING_SANDAL]) {
		(void) mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

	}

	if (ptr == &mons[PM_JUEN_S_WEDGE_SANDAL]) {
		(void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

	}

	if (ptr == &mons[PM_JUEN_S_WOODEN_SANDAL]) {
		(void) mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, HIGH_STILETTOS);

	}

	if (ptr == &mons[PM_JUEN_S_SEXY_LEATHER_PUMP]) {
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);

	}

	if (ptr == &mons[PM_RUEA_S_PLATEAU_BOOT]) {
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);

	}

	if (ptr == &mons[PM_RUEA_S_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */
		(void) mongets(mtmp, SOFT_GIRL_SNEAKER);

	}

	if (ptr == &mons[PM_RUEA_S_BLOCK_HEELED_COMBAT_BOOT]) {
		(void) mongets(mtmp, BLOCK_HEELED_COMBAT_BOOT);

	}

	if (ptr == &mons[PM_RUEA_S_NOBLE_SANDAL]) {
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, HIGH_STILETTOS);

	}

	if (ptr == &mons[PM_KATIA_S_LOVELY_SNEAKER]) {
		(void) mongets(mtmp, SOFT_SNEAKERS); /* M4_SNEAKERS */

	}

	if (ptr == &mons[PM_GUDRUN_S_WEDGE_SANDAL]) {
		(void) mongets(mtmp, WEDGED_LITTLE_GIRL_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

	}

	if (ptr == &mons[PM_NATASCHA_S_PLATEAU_BOOT]) {
		(void) mongets(mtmp, STURDY_PLATEAU_BOOT_FOR_GIRLS);

	}

	if (ptr == &mons[PM_JANE_S_DANCING_SHOE]) {
		(void) mongets(mtmp, DANCING_SHOES);

	}

	if (ptr == &mons[PM_LITTLE_MARIE_S_HUGGING_BOOT]) {
		(void) mongets(mtmp, HUGGING_BOOT);

	}

	if (ptr == &mons[PM_BIANCA_S_HIGH_HEELED_SANDAL]) {
		(void) mongets(mtmp, HIGH_HEELED_SANDAL); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, HIGH_STILETTOS);

	}

	if (ptr == &mons[PM_HILDA_S_LADY_PUMP]) {
		(void) mongets(mtmp, SEXY_LEATHER_PUMP);
		(void) mongets(mtmp, FEMININE_PUMPS); /* M4_PUMPS */

	}

	if (ptr == &mons[PM_SING_S_JAPANESE_GETA]) {
		(void) mongets(mtmp, WOODEN_GETA); /* M4_HAMMERSANDAL */
		(void) mongets(mtmp, WEDGE_SANDALS); /* M4_SANDALS */

	}

	/* "evil" patch idea: 50% of the time, quest leader gets a kyrt shirt that can be enchanted like elven armor.
	 * I guess the evil part about it is that you'll have to kill your leader if you want it. --Amy */
	if (!rn2(2) && ptr->msound == MS_LEADER) (void) mongets(mtmp, KYRT_SHIRT);

	if (ptr->msound == MS_METALMAFIA && !rn2(10)) {
		struct obj *otmpX = mksobj(rn2(5) ? SCR_ROOT_PASSWORD_DETECTION : SCR_COURSE_TRAVELING, TRUE, FALSE, FALSE);
		if (otmpX) {
			otmpX->finalcancel = TRUE;
			otmpX->quan = 1;
			otmpX->owt = weight(otmpX);
			mpickobj(mtmp, otmpX, TRUE);
		}

	}

	/* ordinary soldiers rarely have access to magic (or gold :-) */
	if (ptr == &mons[PM_SOLDIER] && rn2(15)) return;
	if (ptr == &mons[PM_TEUTON_SOLDIER] && rn2(15)) return;
	if (ptr == &mons[PM_FRANKISH_SOLDIER] && rn2(15)) return;
	if (ptr == &mons[PM_BRITISH_SOLDIER] && rn2(15)) return;
	if (ptr == &mons[PM_AMERICAN_SOLDIER] && rn2(15)) return;
	if (ptr == &mons[PM_COPPER_SOLDIER] && rn2(15)) return;
	if (ptr == &mons[PM_ARAB_SOLDIER] && rn2(15)) return;
	if (ptr == &mons[PM_ASIAN_SOLDIER] && rn2(15)) return;
	if (ptr == &mons[PM_PAD_SOLDIER] && rn2(15)) return;
	if (ptr == &mons[PM_GAUCHE_SOLDIER] && rn2(15)) return;
	if (ptr == &mons[PM_SEAFARING_SOLDIER] && rn2(15)) return;
	if (ptr == &mons[PM_BYZANTINE_SOLDIER] && rn2(15)) return;
	if (ptr == &mons[PM_CELTIC_SOLDIER] && rn2(15)) return;
	if (ptr == &mons[PM_VANILLA_SOLDIER] && rn2(15)) return;
	if (ptr == &mons[PM_VIKING_SOLDIER] && rn2(15)) return;
	if (ptr == &mons[PM_SWAMP_SOLDIER] && rn2(15)) return;
	if (ptr == &mons[PM_JAVA_SOLDIER] && rn2(15)) return;
	if (ptr == &mons[PM_IBERIAN_SOLDIER] && rn2(15)) return;
	if (ptr == &mons[PM_ROHIRRIM_SOLDIER] && rn2(15)) return;


#ifndef GOLDOBJ
	if (likes_gold(ptr) && !mtmp->mgold && !rn2(5))
		mtmp->mgold =
		      (long) d(level_difficulty(), mtmp->minvent ? 5 : 10);
#else
	if (likes_gold(ptr) && !findgold(mtmp->minvent) && !rn2(5))
		mkmonmoney(mtmp, (long) d(level_difficulty(), mtmp->minvent ? 5 : 10));
#endif
}

/* Note: for long worms, always call cutworm (cutworm calls clone_mon) */
struct monst *
clone_mon(mon, x, y)
struct monst *mon;
xchar x, y;	/* clone's preferred location or 0 (near mon) */
{
	coord mm;
	struct monst *m2;

	if (mon->data->mlet == S_TROVE) /* way too much potential for abuse --Amy */
	    return (struct monst *)0;

	/* may be too weak or have been extinguished for population control */
	if (mon->mhp <= 1 || ((mvitals[monsndx(mon->data)].mvflags & G_EXTINCT) && !(mon->data == &mons[PM_JUBILEX]) && !(mon->data == &mons[PM_BIRTH]) && !(mon->data == &mons[PM_SCHRUMPEL]) ) )
	    return (struct monst *)0;

	if (x == 0) {
	    mm.x = mon->mx;
	    mm.y = mon->my;
	    if (!enexto(&mm, mm.x, mm.y, mon->data) || MON_AT(mm.x, mm.y))
		return (struct monst *)0;
	} else if (!isok(x, y)) {
	    return (struct monst *)0;	/* paranoia */
	} else {
	    mm.x = x;
	    mm.y = y;
	    if (MON_AT(mm.x, mm.y)) {
		if (!enexto(&mm, mm.x, mm.y, mon->data) || MON_AT(mm.x, mm.y))
		    return (struct monst *)0;
	    }
	}
	m2 = newmonst(0);
	*m2 = *mon;			/* copy condition of old monster */
	m2->nmon = fmon;
	fmon = m2;
	m2->m_id = flags.ident++;
	if (!m2->m_id) m2->m_id = flags.ident++;	/* ident overflowed */
	m2->mx = mm.x;
	m2->my = mm.y;

	m2->minvent = (struct obj *) 0; /* objects don't clone */
	MON_NOWEP(m2); /* stupid monster weapon pointer was causing phantom crash bugs on hdf-us! --Amy */
	m2->mleashed = FALSE;
#ifndef GOLDOBJ
	m2->mgold = 0L;
#endif
	/* Max HP the same, but current HP halved for both.  The caller
	 * might want to override this by halving the max HP also.
	 * When current HP is odd, the original keeps the extra point.
	 */
	m2->mhpmax = mon->mhpmax;
	m2->mhp = mon->mhp / 2;
	mon->mhp -= m2->mhp;

	/* Same for the power */
	m2->m_enmax = mon->m_enmax;
	m2->m_en = mon->m_en /= 2;

	/* since shopkeepers and guards will only be cloned if they've been
	 * polymorphed away from their original forms, the clone doesn't have
	 * room for the extra information.  we also don't want two shopkeepers
	 * around for the same shop.
	 */
	if (mon->isshk) m2->isshk = FALSE;
	if (mon->isgd) m2->isgd = FALSE;
	if (mon->ispriest) m2->ispriest = FALSE;
	if (mon->isgyp) m2->isgyp = FALSE;
	m2->mxlth = 0;
	place_monster(m2, m2->mx, m2->my);
	if (emits_light(m2->data))
	    new_light_source(m2->mx, m2->my, emits_light(m2->data),
			     LS_MONSTER, (void *)m2);
	if (m2->mnamelth) {
	    m2->mnamelth = 0; /* or it won't get allocated */
	    m2 = christen_monst(m2, NAME(mon));
	} else if (mon->isshk) {
	    m2 = christen_monst(m2, shkname(mon));
	}

	/* not all clones caused by player are tame or peaceful */
	if (!flags.mon_moving) {
	    if (mon->mtame)
		m2->mtame = rn2(max(2 + u.uluck, 2)) ? mon->mtame : 0;
	    else if (mon->mpeaceful)
		m2->mpeaceful = rn2(max(2 + u.uluck, 2)) ? 1 : 0;
	}

	newsym(m2->mx,m2->my);	/* display the new monster */
	if (m2->mtame) {
	    struct monst *m3;

	    if (mon->isminion) {
		m3 = newmonst(sizeof(struct epri) + mon->mnamelth);
		*m3 = *m2;
		m3->mxlth = sizeof(struct epri);
		if (m2->mnamelth) strcpy(NAME(m3), NAME(m2));
		*(EPRI(m3)) = *(EPRI(mon));
		replmon(m2, m3);
		m2 = m3;
	    } else {
		/* because m2 is a copy of mon it is tame but not init'ed.
		 * however, tamedog will not re-tame a tame dog, so m2
		 * must be made non-tame to get initialized properly.
		 */
		m2->mtame = 0;
		if ((m3 = tamedog(m2, (struct obj *)0, FALSE)) != 0) {
		    m2 = m3;
		    *(EDOG(m2)) = *(EDOG(mon));
		}
	    }
	}
	set_malign(m2);

	/* found by Antichthon: the new monster says it's saddled when it really isn't? --Amy */
	m2->misc_worn_check &= ~W_SADDLE;

	return m2;
}

/*
 * Propagate a species
 *
 * Once a certain number of monsters are created, don't create any more
 * at random (i.e. make them extinct).  The previous (3.2) behavior was
 * to do this when a certain number had _died_, which didn't make
 * much sense.
 *
 * Returns FALSE propagation unsuccessful
 *         TRUE  propagation successful
 */
boolean
propagate(mndx, tally, ghostly)
int mndx;
boolean tally;
boolean ghostly;
{
	boolean result;
	uchar lim = mbirth_limit(mndx);
	boolean gone = (mvitals[mndx].mvflags & G_GONE); /* genocided or extinct */

	result = (((int) mvitals[mndx].born < lim) && !gone) ? TRUE : FALSE;

	/* if it's unique, don't ever make it again */
	if (mons[mndx].geno & G_UNIQ) mvitals[mndx].mvflags |= G_EXTINCT;

	if (mvitals[mndx].born < 9999999 && tally && (!ghostly || (ghostly && result)))
		 mvitals[mndx].born++;
	if ((int) mvitals[mndx].born >= lim && !(mons[mndx].geno & G_NOGEN) &&
		!(mvitals[mndx].mvflags & G_EXTINCT)) {
#if defined(DEBUG) && defined(WIZARD)
		if (wizard) pline("Automatically extinguished %s.",
					makeplural(mons[mndx].mname));
#endif
		mvitals[mndx].mvflags |= G_EXTINCT;
		reset_rndmonst(mndx);
	}
	return result;
}

/*
 * called with [x,y] = coordinates;
 *	[0,0] means anyplace
 *	[u.ux,u.uy] means: near player (if !in_mklev)
 *
 *	In case we make a monster group, only return the one at [x,y].
 */
struct monst *
makemon(ptr, x, y, mmflags)
register struct permonst *ptr;
register int	x, y;
register int	mmflags;
{
	register struct monst *mtmp;
	int mndx, mcham, ct, mitem, xlth, senserchance;
	boolean anymon = (!ptr);
	boolean byyou = (x == u.ux && y == u.uy);
	boolean allow_minvent = ((((mmflags & NO_MINVENT) == 0) || ptr == &mons[PM_HUGE_OGRE_THIEF]) && ptr != &mons[PM_HOLE_MASTER] && ptr != &mons[PM_TRAP_MASTER] && ptr != &mons[PM_BOULDER_MASTER] && ptr != &mons[PM_ITEM_MASTER] && ptr != &mons[PM_GOOD_ITEM_MASTER] && ptr != &mons[PM_BAD_ITEM_MASTER]);
	boolean allow_special = ((mmflags & MM_NOSPECIALS) == 0);
	boolean countbirth = ((mmflags & MM_NOCOUNTBIRTH) == 0);
	boolean monster_is_revived = ((mmflags & MM_REVIVED) != 0);
	unsigned gpflags = (mmflags & MM_IGNOREWATER) ? MM_IGNOREWATER : 0;
	int randsp;
	int i;
	coord cc;
	int leveladjustment, leveladjusttemp;

	/* ATTENTION: ptr might not be defined at this point!!! */

	/* weak monsters have less HP on average: all those that have neither M2_STRONG nor M2_NASTY and aren't bosses --Amy */
	boolean weakmon = (ptr && !strongmonst(ptr) && !extra_nasty(ptr) && !(ptr->geno & G_UNIQ));

	if (!rn2(5)) {
		reset_rndmonst(NON_PM);
	}

	/* if caller wants random location, do it here */
	if(x == 0 && y == 0) {
		int tryct = 0;	/* careful with bigrooms */
		int tryct2 = 0;
		struct monst fakemon;

		fakemon.data = ptr;	/* set up for goodpos */
		do {
			x = rn1(COLNO-3,2);
			y = rn2(ROWNO);
		} while((!goodpos(x, y, ptr ? &fakemon : (struct monst *)0, gpflags) ||
			(!in_mklev && tryct++ < 50 && rn2(20) && cansee(x, y))) && tryct2++ < 100000);
		/* Amy edit: did a few changes. First, have a low chance of monsters spawning in your LOS because I'm evil :P
		 * second, prevent game freeze if there really is no valid location, by limiting the # of tries */

		if (tryct2 >= 100000) {
			impossible("makemon(): cannot find location to place monster after 100000 tries.");
			return((struct monst *)0);
		}

	} else if (byyou && !in_mklev) {
		coord bypos;

		if(enexto_core(&bypos, u.ux, u.uy, ptr, gpflags)) {
			x = bypos.x;
			y = bypos.y;
		} else
			return((struct monst *)0);
	}

	/* Does monster already exist at the position? */
	if(MON_AT(x, y)) {
		if ((mmflags & MM_ADJACENTOK) != 0) {
			coord bypos;
			if(enexto_core(&bypos, x, y, ptr, gpflags)) {
				x = bypos.x;
				y = bypos.y;
			} else
				return((struct monst *) 0);
		} else 
			return((struct monst *) 0);
	}

	if(ptr){
		mndx = monsndx(ptr);
		/* if you are to make a specific monster and it has
		   already been genocided, return */
		if (mvitals[mndx].mvflags & G_GENOD) return((struct monst *) 0);
#if defined(WIZARD) && defined(DEBUG)
		if (wizard && (mvitals[mndx].mvflags & G_EXTINCT))
		    pline("Explicitly creating extinct monster %s.",
			mons[mndx].mname);
#endif
	} else {
		/* make a random (common) monster that can survive here.
		 * (the special levels ask for random monsters at specific
		 * positions, causing mass drowning on the medusa level,
		 * for instance.)
		 */
		int tryct = 0;	/* maybe there are no good choices */
		struct monst fakemon;
		do {
			if(!(ptr = rndmonst())) {
#ifdef DEBUG
			    pline("Warning: no monster.");
#endif
			    return((struct monst *) 0);	/* no more monsters! */
			}
			fakemon.data = ptr;	/* set up for goodpos */
		} while(!goodpos(x, y, &fakemon, gpflags) && tryct++ < 50);
		mndx = monsndx(ptr);
	}

	(void) propagate(mndx, countbirth, FALSE);
	xlth = ptr->pxlth;
	if (mmflags & MM_EDOG) xlth += sizeof(struct edog);
	else if (mmflags & MM_EMIN) xlth += sizeof(struct emin);
	mtmp = newmonst(xlth);
	*mtmp = zeromonst;		/* clear all entries in structure */
	(void)memset((void *)mtmp->mextra, 0, xlth);
	mtmp->nmon = fmon;
	fmon = mtmp;
	mtmp->m_id = flags.ident++;
	if (!mtmp->m_id) mtmp->m_id = flags.ident++;	/* ident overflowed */
	set_mon_data(mtmp, ptr, 0);
	if (mtmp->data->msound == MS_LEADER)
	    quest_status.leader_m_id = mtmp->m_id;
	mtmp->mxlth = xlth;
	mtmp->mnum = mndx;

	mtmp->m_lev = adj_lev(ptr);
	
	/* WAC set oldmonnm */
	mtmp->oldmonnm = monsndx(ptr);

	if (ptr >= &mons[PM_ARCHEOLOGIST] && ptr <= &mons[PM_WIZARD]) {
	   /* enemy characters are of varying level */
	   int base_you, base_lev;
	   base_you = (u.ulevel / 2)+1;
	   base_lev = level_difficulty()+1;
	   if (base_you < 1) base_you = 1;
	   if (base_lev < 1) base_lev = 1;
	   mtmp->m_lev = (1 + rn2(base_you) + rn2(base_lev) / 2)+1;
	}

	if (ptr == &mons[PM_BLACKY] || ptr == &mons[PM_BLUEY] || ptr == &mons[PM_LAMER_TYPE] || ptr == &mons[PM_EROTICLOUDY] || ptr == &mons[PM_WOODICLOUDY] || ptr == &mons[PM_SCENTICLOUDY] || ptr == &mons[PM_WHITLEVEL_KOP] || ptr == &mons[PM_BLAKLEVEL_KOP] || ptr == &mons[PM_GREYLEVEL_KOP] || ptr == &mons[PM_RNGED_KOP] || ptr == &mons[PM_EXMINATOR_KOP]) {
	   /* blacky too --Amy */
	   /* and specific kop types */
	   /* and the claudia trap monsters */
	   int base_you, base_lev;
	   base_you = (u.ulevel / 2)+1;
	   base_lev = level_difficulty()+1;
	   if (base_you < 1) base_you = 1;
	   if (base_lev < 1) base_lev = 1;
	   mtmp->m_lev = (1 + rn2(base_you) + rn2(base_lev) / 2)+1;
	}

	/* randomly make higher-level monsters for doppelgangers since the game is easy enough for them already --Amy */
	if (mtmp->m_lev && (mtmp->m_lev < 50) && !rn2(10) && Race_if(PM_DOPPELGANGER)) {

		mtmp->m_lev += rnd(u.ulevel);
		if (mtmp->m_lev > 49) mtmp->m_lev = 49;
	}

	if (mtmp->m_lev && (mtmp->m_lev < 50) && !rn2(10) && Role_if(PM_SHAPESHIFTER)) {

		mtmp->m_lev += rnd(u.ulevel);
		if (mtmp->m_lev > 49) mtmp->m_lev = 49;
	}

	if (LevelTrapEffect || u.uprops[LEVELBUG].extrinsic || have_levelstone() || (uwep && uwep->oartifact == ART_MANUELA_S_PRACTICANT_TERRO) || (ptr == &mons[PM_GUDRUN_THE_FEMINIST]) || (ptr == &mons[PM_ELLA_THE_FEMINIST]) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_MANUELA_S_PRACTICANT_TERRO) || (uwep && uwep->oartifact == ART_GENOCIDE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_GENOCIDE) ) {

		int leveltrapbonus = mvitals[mtmp->mnum].born + 1;
		if (leveltrapbonus < 1) leveltrapbonus = 1;
		if (leveltrapbonus > 120) leveltrapbonus = 120; /* for sanity reasons --Amy */

		mtmp->m_lev += rnd(leveltrapbonus);
		if (mtmp->m_lev > 49) mtmp->m_lev = 49;

	}

	/* Set HP, HPmax */	
	if (is_golem(ptr)) {
	    mtmp->mhpmax = mtmp->mhp = golemhp(mndx);

	    if (uarmh && itemhasappearance(uarmh, APP_CELTIC_HELMET) ) {
		    mtmp->mhpmax *= 3;
		    mtmp->mhpmax /= 2;
		    mtmp->mhp *= 3;
		    mtmp->mhp /= 2;

	    }

	} else if (mndx == PM_CRITICALLY_INJURED_THIEF || mndx == PM_CRITICALLY_INJURED_JEDI) { 
		/* can be killed in a single hit --Amy */
	    mtmp->mhpmax = mtmp->mhp = 1;
	} else if (is_rider(ptr)) {

	    /* We want low HP, but a high mlevel so they can attack well */
		mtmp->mhpmax = mtmp->mhp = d(10,8) + 20 + ptr->mlevel;

	} else if (is_deadlysin(ptr)) {

		mtmp->mhpmax = mtmp->mhp = d(10,9) + rnd(ptr->mlevel);

	} /*else if (ptr->mlevel > 49) {*/	/* from now on we'll just let their hp be calculated normally --Amy */
	    /* "special" fixed hp monster
	     * the hit points are encoded in the mlevel in a somewhat strange
	     * way to fit in the 50..127 positive range of a signed character
	     * above the 1..49 that indicate "normal" monster levels */
	    /*mtmp->mhpmax = mtmp->mhp = 5*(ptr->mlevel - 6);*/ /*hp increase --Amy */
	    /*mtmp->m_lev = mtmp->mhp / 4;*/	/* approximation */
	/*}*/ else if (ptr->mlet == S_DRAGON && mndx >= PM_GRAY_DRAGON) {
	    /* adult dragons */
		leveladjustment = mtmp->m_lev;
		if (leveladjustment > 20) {
			leveladjusttemp = (leveladjustment - 19);
			leveladjustment -= rn2(leveladjusttemp);
		}

	    mtmp->mhpmax = mtmp->mhp = (int) (In_endgame(&u.uz) ?
		(8 * leveladjustment) : (4 * leveladjustment + d((int)leveladjustment, 4)));
	} else if (!mtmp->m_lev) {
	    mtmp->mhpmax = mtmp->mhp = rnd(4);
	} else {

		/* very high-level monsters shouldn't get excessive amounts of HP every single time --Amy */
		leveladjustment = mtmp->m_lev;
		if (leveladjustment > 50) {
			leveladjusttemp = (leveladjustment - 49);
			leveladjustment -= rn2(leveladjusttemp);
		}
		if (leveladjustment > 20) {
			leveladjusttemp = (leveladjustment - 19);
			leveladjustment -= rn2(leveladjusttemp);
		}

	    mtmp->mhpmax = mtmp->mhp = d((int)leveladjustment, weakmon ? (6 + rn2(3)) : 8);
		/* small things like ants and stuff shouldn't have the same amount of health as big monsters --Amy */
	    if (verysmall(mtmp->data) && mtmp->mhpmax > 3) {
		mtmp->mhpmax *= 3;
		mtmp->mhpmax /= 4;
		mtmp->mhp *= 3;
		mtmp->mhp /= 4;
		if (!rn2(2)) {
			mtmp->mhpmax *= 3;
			mtmp->mhpmax /= 4;
			mtmp->mhp *= 3;
			mtmp->mhp /= 4;
		}
	    }
	    if (rathersmall(mtmp->data) && !verysmall(mtmp->data) && mtmp->mhpmax > 3) {
		mtmp->mhpmax *= 7;
		mtmp->mhpmax /= 8;
		mtmp->mhp *= 7;
		mtmp->mhp /= 8;
		if (!rn2(3)) {
			mtmp->mhpmax *= 7;
			mtmp->mhpmax /= 8;
			mtmp->mhp *= 7;
			mtmp->mhp /= 8;
		}
	    }

	    if (rn2(2)) {
		mtmp->mhpmax += (leveladjustment * rnd(2));
		mtmp->mhp = mtmp->mhpmax;
	    }
	    
	    if (is_home_elemental(ptr))
		mtmp->mhpmax = (mtmp->mhp *= 3);
	}

	if (humanoid(ptr) && is_female(ptr) && FemtrapActiveWendy && (mtmp->mhpmax < 2000) ) mtmp->mhpmax += rnd(mtmp->mhpmax);

	if (ptr->mlevel > 49) { /* so they still get extra HP --Amy */

		mtmp->mhpmax += ( (ptr->mlevel - 49) * 5);
		mtmp->mhp = mtmp->mhpmax;

	}

	if (ptr == &mons[PM_PERCENTS_SECRET_CAR] || ptr == &mons[PM_OAK_SAGE] || ptr == &mons[PM_PERCENTS_____NIX] || ptr == &mons[PM_TANK_WARRIOR] || ptr == &mons[PM_PERCENTS_RAT_MAN] || ptr == &mons[PM_PERCENTS_UFO] ) { /* supposed to be extra annoying --Amy */
		mtmp->mhpmax *= 5;
		mtmp->mhp *= 5;

	}

	if (ptr == &mons[PM_LONG_LIVE_THE_GOLDEN]) {
		mtmp->mhpmax *= 2;
		mtmp->mhp *= 2;
	}
	if (ptr == &mons[PM_CUDDLY_BANK_LADY]) {
		mtmp->mhpmax *= 2;
		mtmp->mhp *= 2;
	}

	if ((ptr->geno & G_UNIQ) ) {
		if (rn2(5)) mtmp->mhpmax += rnd(mtmp->mhpmax);
		else if (rn2(5)) mtmp->mhpmax += rnd(mtmp->mhpmax * 2);
		else if (rn2(5)) mtmp->mhpmax += rnd(mtmp->mhpmax * 3);
		else mtmp->mhpmax += rnd(mtmp->mhpmax * 4);
		if (!rn2(10)) {
			mtmp->mhpmax /= 2;
			if (mtmp->mhpmax < 2) mtmp->mhpmax = 2;
		}
		mtmp->mhp = mtmp->mhpmax;
	}

	if (Role_if(PM_CAMPERSTRIKER) && (ptr->geno & G_UNIQ) ) {
		if (rn2(5)) mtmp->mhpmax += rnd(mtmp->mhpmax);
		else if (rn2(5)) mtmp->mhpmax += rnd(mtmp->mhpmax * 2);
		else if (rn2(5)) mtmp->mhpmax += rnd(mtmp->mhpmax * 3);
		else mtmp->mhpmax += rnd(mtmp->mhpmax * 4);
		if (!rn2(10)) {
			mtmp->mhpmax /= 2;
			if (mtmp->mhpmax < 2) mtmp->mhpmax = 2;
		}
		mtmp->mhp = mtmp->mhpmax;
	}

	if ((ptr == &mons[PM_DARK_GOKU] || ptr == &mons[PM_FRIEZA]) ) { /* credits go to Bug Sniper for this idea --Amy */
		mtmp->mhpmax += 9000;
		mtmp->mhp += 9000;
	}

	/* monsters just have too much HP later on, so I'm installing a nerf here. --Amy */
	if (weakmon && mtmp->mhpmax > 1 && !rn2(2)) {
		mtmp->mhpmax -= rnd(mtmp->mhpmax / 2);
		if (mtmp->mhp > mtmp->mhpmax) mtmp->mhp = mtmp->mhpmax;
	}

	/* Assign power */
	/*if (mindless(ptr)) {
	    mtmp->m_enmax = mtmp->m_en = 0;
	} else {*/
	    /* This is actually quite similar to hit dice,  
	     * but with more randomness 
	     * Mindless monsters may do some spellcasting now, mainly for sephirahs --Amy
	     */
	    mtmp->m_enmax = mtmp->m_en =
		d((int)mtmp->m_lev * 2, 4) + (mtmp->m_lev*rnd(2));
		if (mindless(ptr)) {mtmp->m_enmax = mtmp->m_enmax / 2; mtmp->m_en = mtmp->m_en / 2; }
	/*}*/
	if (is_female(ptr)) mtmp->female = TRUE;
	else if (is_male(ptr)) mtmp->female = FALSE;
	else mtmp->female = rn2(2);	/* ignored for neuters */

	/*if (In_sokoban(&u.uz) && !mindless(ptr))*/  /* know about traps here */
	    /*mtmp->mtrapseen = (1L << (PIT - 1)) | (1L << (HOLE - 1));*/
	/*if (ptr->msound == MS_LEADER)*/		/* leader knows about portal */
	    /*mtmp->mtrapseen |= (1L << (MAGIC_PORTAL-1));*/

	place_monster(mtmp, x, y);
	mtmp->mcansee = mtmp->mcanmove = TRUE;
	mtmp->mpeaceful = (mmflags & MM_ANGRY) ? FALSE : peace_minded(ptr);
	if (!mtmp->mpeaceful && (mmflags & MM_FRENZIED) && !rn2(3)) mtmp->mfrenzied = TRUE;
	if (mmflags & MM_XFRENZIED) {
		mtmp->mpeaceful = FALSE;
		mtmp->mfrenzied = TRUE;
	}
	if (ptr == &mons[PM_ROTATING_THROUGH_UNICORN]) {
		mtmp->mpeaceful = FALSE;
		mtmp->mfrenzied = TRUE;
	}
	if (ptr == &mons[PM_TAPIA]) {
		mtmp->mpeaceful = FALSE;
		mtmp->mfrenzied = TRUE;
	}
	if (ptr == &mons[PM_PRION]) {
		mtmp->mpeaceful = FALSE;
		mtmp->mfrenzied = TRUE;
	}
	mtmp->mtraitor  = FALSE;
	mtmp->masleep = 0;

	if (!rn2(30)) {
		mtmp->fartbonus += rnd(9);
		if (mtmp->fartbonus > 9) mtmp->fartbonus = 9;
	}
	if (!rn2(30)) mtmp->crapbonus += rnd(50);

	if (FemtrapActiveJennifer && mtmp->data->msound == MS_FART_QUIET) {
		mtmp->fartbonus += rnd(9);
		if (mtmp->fartbonus > 9) mtmp->fartbonus = 9;
	}
	if (FemtrapActiveInge && mtmp->data->msound == MS_FART_QUIET) mtmp->fartbonus = 9;

	/* initialize nurse services... yes it's not a bug that we set this for every monster, because monsters are capable
	 * of polymorphing into MS_NURSE monsters, you noob :P --Amy */
	mtmp->nurse_extrahealth = !rn2(5);
	mtmp->nurse_decontaminate = !rn2(20);
	mtmp->nurse_healing = !rn2(3);
	mtmp->nurse_curesickness = !rn2(10);
	mtmp->nurse_curesliming = !rn2(15);
	mtmp->nurse_curesanity = !rn2(10);
	mtmp->nurse_medicalsupplies = !rn2(5);
	mtmp->nurse_purchasedrugs = !rn2(10);
	mtmp->nurse_obtainsymbiote = !rn2(10);
	mtmp->nurse_fixsymbiote = !rn2(15);
	mtmp->nurse_shutdownsymbiote = !rn2(8);
	mtmp->nurse_restoration = !rn2(5);
	mtmp->nurse_vaccine = !rn2(10);
	mtmp->nurse_alla = !rn2(20);

	mtmp->sagesvisible = !rn2(10);
	mtmp->internetvisible = !rn2(9);
	mtmp->stunnovisible = rn2(4);
	mtmp->selfhybridvisible = !rn2(2);
	mtmp->warningvisible = 0;
	mtmp->scentvisible = rn2(3);
	mtmp->echolocatevisible = rn2(5);
	mtmp->terraintrans = rnd(29); /* keyword: RAINCLOUD */
	mtmp->handytime = 0;
	mtmp->handyfirst = 0;
	mtmp->phototaken = 0;
	mtmp->repaircredit = 0;
	mtmp->singability = 0;
	mtmp->hominglazer = 0;
	mtmp->ogrethief = 0;
	mtmp->bleedout = 0;
	mtmp->healblock = 0;
	mtmp->inertia = 0;
	mtmp->singannoyance = FALSE;
	mtmp->singdirty = FALSE;
	mtmp->canceltimeout = FALSE;
	mtmp->slowtimeout = FALSE;
	if (!rn2(2)) mtmp->warningvisible = (rn2(2) ? 2 : 1);
	mtmp->telepatvisible = 0;
	if (!rn2(3)) mtmp->telepatvisible = (rn2(2) ? 2 : 1);
	mtmp->seeinvisble = rn2(3);
	mtmp->infravisble = rn2(3);
	mtmp->lisapantscolor = rnd(19);
	mtmp->lisapantstype = rnd(18);
	mtmp->lisaseen = FALSE;
	mtmp->codeguessed = FALSE;

	if (Movemork || u.uprops[MOVEMORKING].extrinsic || have_movemorkstone()) mtmp->movement += 12;
	if (uarmf && uarmf->oartifact == ART_SATAN_S_HYPERCHARGE) mtmp->movement += rnd(24);
	if (FemtrapActiveKsenia && spawnswithsandals(mtmp->data)) mtmp->movement += 12;

	/* Everything that can hide under an object will now do so. --Amy */
      if(x && y && isok(x, y) && !issoviet && allow_special && (hides_under(ptr) || !rn2(100) ) ) { /* low chance of getting an object even if nonhiding, too */

	  if (rn2(3) && timebasedlowerchance() && (rn2(100) > u.concealitemchance))
		(void) mkobj_at(0, x, y, TRUE, FALSE);
	  else
		(void) mkobj_at(COIN_CLASS, x, y, TRUE, FALSE);
	}

	if (x && y && isok(x, y) && ptr == &mons[PM_BEST_TREASURE_RUSSIAN]) {
		(void) mkobj_at(0, x, y, TRUE, FALSE);
		(void) mkobj_at(0, x, y, TRUE, FALSE);
		(void) mkobj_at(0, x, y, TRUE, FALSE);
	}

		/* and even lower chance to get extra objects */
	if (x && y && isok(x, y) && timebasedlowerchance() && !rn2(200) && allow_special) {
	  (void) mkobj_at(0, x, y, TRUE, FALSE);
	  if (!rn2(3)) (void) mkobj_at(0, x, y, TRUE, FALSE);
	}
	if (x && y && isok(x, y) && timebasedlowerchance() && !rn2(400) && allow_special) {
	  (void) mkobj_at(0, x, y, TRUE, FALSE);
	  if (!rn2(3)) (void) mkobj_at(0, x, y, TRUE, FALSE);
	  if (!rn2(9)) (void) mkobj_at(0, x, y, TRUE, FALSE);
	}
	if (x && y && isok(x, y) && timebasedlowerchance() && !rn2(800) && allow_special) {
	  (void) mkobj_at(0, x, y, TRUE, FALSE);
	  if (!rn2(3)) (void) mkobj_at(0, x, y, TRUE, FALSE);
	  if (!rn2(9)) (void) mkobj_at(0, x, y, TRUE, FALSE);
	  if (!rn2(27)) (void) mkobj_at(0, x, y, TRUE, FALSE);
	}
	if (x && y && isok(x, y) && timebasedlowerchance() && !rn2(1600) && allow_special) {
	  (void) mkobj_at(0, x, y, TRUE, FALSE);
	  if (!rn2(3)) (void) mkobj_at(0, x, y, TRUE, FALSE);
	  if (!rn2(9)) (void) mkobj_at(0, x, y, TRUE, FALSE);
	  if (!rn2(27)) (void) mkobj_at(0, x, y, TRUE, FALSE);
	  if (!rn2(81)) (void) mkobj_at(0, x, y, TRUE, FALSE);
	}

	/* maybe generate a sleeping monster */

	if (!rn2(Aggravate_monster ? 500 : 100) && (!u.uhave.amulet || u.freeplaymode || (!u.amuletcompletelyimbued && rn2(3)))) mtmp->msleeping = 1;

	if ((mmflags & MM_MAYSLEEP) && !rn2(5)) {
		if ((!(u.uhave.amulet && !u.freeplaymode && u.amuletcompletelyimbued)) || !rn2(5)) mtmp->msleeping = 1;
	}

	if (ptr == &mons[PM_CAKE_MONSTER]) mtmp->msleeping = 1;
	if (ptr == &mons[PM_SLEEPING_GIANT]) mtmp->msleeping = 1;
	if (ptr == &mons[PM_SLEEPY_GIRL]) mtmp->msleeping = 1;
	if (ptr == &mons[PM_SLEEPY_WOMAN]) mtmp->msleeping = 1;
	if (ptr == &mons[PM_SLEEPY_LADY]) mtmp->msleeping = 1;
	if (ptr == &mons[PM_SLEEPING_ASIAN_GIRL]) mtmp->msleeping = 1;
	if (ptr == &mons[PM_DEEP_SLEEPER]) mtmp->msleeping = 1;
	if (ptr == &mons[PM_SLEEPING_HULK]) mtmp->msleeping = 1;

	if (mtmp->data->msound == MS_SNORE) mtmp->msleeping = 1;

	/* or an invisible one, based on an evil patch idea by jonadab */

	if (!rn2(250)) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}

	if (ptr == &mons[PM_SCROLLER_MASTER] && x && y && isok(x, y) && !(t_at(x, y)) )
		(void) maketrap(x, y, ACTIVE_SUPERSCROLLER_TRAP, 0, FALSE);

	if (ptr == &mons[PM_BOULDER_MASTER] && x && y && isok(x, y) && !(t_at(x, y)) )
		(void) mksobj_at(BOULDER, x, y, TRUE, FALSE, FALSE);

	if (ptr == &mons[PM_GOOD_ITEM_MASTER] && x && y && isok(x, y) )
		(void) mksobj_at(usefulitem(), x, y, TRUE, FALSE, FALSE);

	if (ptr == &mons[PM_BAD_ITEM_MASTER] && x && y && isok(x, y) )
		(void) mksobj_at(nastymusableitem(), x, y, TRUE, FALSE, FALSE);

	if (ptr == &mons[PM_HOLE_MASTER] && x && y && isok(x, y) && !(t_at(x, y)) )
		(void) maketrap(x, y, HOLE, 10, TRUE);

	if (ptr == &mons[PM_TRAP_MASTER] && x && y && isok(x, y) && !(t_at(x, y)) )
		(void) maketrap(x, y, randomtrap(), 100, TRUE);

	if (ptr == &mons[PM_ELONIC_MINE_DOG] && x && y && isok(x, y) && !(t_at(x, y)) )
		(void) maketrap(x, y, LANDMINE, 10, TRUE);

	/* maybe make a random trap underneath the monster, higher chance for drow to make it harder for them --Amy */

	if (!rn2( ( (uarmg && uarmg->oartifact == ART_EXPERTENGAME_THE_ENTIRE_LE) ? 10 : (uarmg && uarmg->oartifact == ART_DIFFICULTY__) ? 10 : Race_if(PM_DEVELOPER) ? 25 : Race_if(PM_DROW) ? 100 : 500) ) && allow_special && isok(x, y) && !(depth(&u.uz) == 1 && In_dod(&u.uz) && rn2(3)) && !(depth(&u.uz) == 2 && In_dod(&u.uz) && rn2(2)) && !(t_at(x, y))  ) {
		int rtrap;

		rtrap = randomtrap();

		(void) maketrap(x, y, rtrap, 100, TRUE);

	}

	if (level_difficulty() > 10 && isok(x, y) && !(t_at(x, y)) && allow_special) {

		int reduceramount = (level_difficulty() / 10);
		if (reduceramount < 1) reduceramount = 1;

		if (!rn2(200 / reduceramount)) {
			int rtrap;
			rtrap = randomtrap();
			(void) maketrap(x, y, rtrap, 100, TRUE);
		}

	}

	if (isok(x, y) && !(t_at(x, y)) && allow_special && (HomicideEffect || u.uprops[HOMICIDE_EFFECT].extrinsic || have_homicidestone()) ) {

		int rtrap;

		rtrap = randomtrap();

		(void) maketrap(x, y, rtrap, 100, FALSE);

	}

	if (!rn2(8192)) mtmp->shinymonst = 1;

	if (!rn2(100) && (uarmc && itemhasappearance(uarmc, APP_ELDRITCH_CLOAK))) {
		mtmp->isegotype = 1;
		mtmp->egotype_abomination = 1;
	}

	if (!rn2(100) && uwep && uwep->oartifact == ART_AMY_S_SEX_TOY) {
		mtmp->isegotype = 1;
		mtmp->egotype_seducer = 1;
	}

	if (!rn2(100) && uswapwep && uswapwep->oartifact == ART_AMY_S_SEX_TOY) {
		mtmp->isegotype = 1;
		mtmp->egotype_seducer = 1;
	}

	if (!rn2(50) && uwep && uwep->oartifact == ART_ARABSTREET_SOUND) {
		mtmp->isegotype = 1;
		mtmp->egotype_sounder = 1;
	}

	if (!rn2(50) && mtmp->data->msound == MS_SHOE) {
		mtmp->isegotype = 1;
		mtmp->egotype_steed = 1;
	}

	if (!rn2(15) && mtmp->data->msound == MS_STENCH) {
		mtmp->isegotype = 1;
		mtmp->egotype_farter = 1;
	}

	if (!rn2(40) && mtmp->data->msound == MS_CONVERT && is_female(mtmp->data)) {
		mtmp->isegotype = 1;
		mtmp->egotype_perfumespreader = 1;
	}

	if (!rn2(200) && mtmp->data->msound == MS_STENCH) {
		mtmp->isegotype = 1;
		mtmp->egotype_steed = 1;
	}

	if (!rn2(200) && mtmp->data->msound == MS_FART_NORMAL) {
		mtmp->isegotype = 1;
		mtmp->egotype_steed = 1;
	}

	if (!rn2(100) && mtmp->data->msound == MS_FART_QUIET) {
		mtmp->isegotype = 1;
		mtmp->egotype_steed = 1;
	}

	if (!rn2(1000) && mtmp->data->msound == MS_FART_LOUD) {
		mtmp->isegotype = 1;
		mtmp->egotype_steed = 1;
	}

	if (!rn2(100) && RngeAbominations) {
		mtmp->isegotype = 1;
		mtmp->egotype_abomination = 1;
	}

	if (uarmh && uarmh->oartifact == ART_NUCLEAR_BOMB && ptr->mlet == S_GOLEM) {
		mtmp->isegotype = 1;
		mtmp->egotype_bomber = 1;
		mtmp->egotype_exploder = 1;
	}

	if (!rn2(100) && uarmc && uarmc->oartifact == ART_MORE_HIGHER) {
		mtmp->isegotype = 1;
		mtmp->egotype_incrementor = 1;
	}

	if (!rn2(isxrace ? 30 : 100) || always_egotype(mtmp->data) ) {

		add_monster_egotype(mtmp);

		while (!rn2(iswarper ? 4 : 10)) {
			add_monster_egotype(mtmp);
		}

	}

	if (ptr->mlet == S_FUNGUS && (!rn2(isxrace ? 20 : 66)) ) {

		add_monster_egotype(mtmp);

		while (!rn2(iswarper ? 4 : 10)) {
			add_monster_egotype(mtmp);
		}

	}

	if (ptr == &mons[PM_PERFUMED_HC_BITCH]) {
		mtmp->noegodesc = mtmp->noegodisplay = TRUE;
		mtmp->isegotype = 1;
		mtmp->egotype_perfumespreader = 1;
	}
	if (ptr == &mons[PM_FLUIDATOR_MAFFER]) {
		mtmp->noegodesc = mtmp->noegodisplay = TRUE;
		mtmp->isegotype = 1;
		mtmp->egotype_metalmafioso = 1;
	}
	if (ptr == &mons[PM_FLUIDATOR_SINGER]) {
		mtmp->noegodesc = mtmp->noegodisplay = TRUE;
		mtmp->isegotype = 1;
		mtmp->egotype_singagent = 1;
	}
	if (ptr == &mons[PM_FLUIDATOR_GRAPHIC]) {
		mtmp->noegodesc = mtmp->noegodisplay = TRUE;
		mtmp->isegotype = 1;
		mtmp->egotype_alladrainer = 1;
	}
	if (ptr == &mons[PM_FLUIDATOR_KRONA]) {
		mtmp->noegodesc = mtmp->noegodisplay = TRUE;
		mtmp->isegotype = 1;
		mtmp->egotype_converter = 1;
	}
	if (ptr == &mons[PM_FLUIDATOR_WOAWOA]) {
		mtmp->noegodesc = mtmp->noegodisplay = TRUE;
		mtmp->isegotype = 1;
		mtmp->egotype_wouwouer = 1;
	}
	if (ptr == &mons[PM_FLUIDATOR_TONE]) {
		mtmp->noegodesc = mtmp->noegodisplay = TRUE;
		mtmp->isegotype = 1;
		mtmp->egotype_farter = 1;
	}
	if (ptr == &mons[PM_FLUIDATOR_PRUMA]) {
		mtmp->noegodesc = mtmp->noegodisplay = TRUE;
		mtmp->isegotype = 1;
		mtmp->egotype_perfumespreader = 1;
	}
	if (ptr == &mons[PM_FLUIDATOR_WEND]) {
		mtmp->noegodesc = mtmp->noegodisplay = TRUE;
		mtmp->isegotype = 1;
		mtmp->egotype_deepstatemember = 1;
	}
	if (ptr == &mons[PM_DEEPSTATE_DISALLAER]) {
		mtmp->noegodesc = mtmp->noegodisplay = TRUE;
		mtmp->isegotype = 1;
		mtmp->egotype_alladrainer = 1;
	}
	if (ptr == &mons[PM_DEEPSTATE_FARTER]) {
		mtmp->noegodesc = mtmp->noegodisplay = TRUE;
		mtmp->isegotype = 1;
		mtmp->egotype_farter = 1;
	}
	if (ptr == &mons[PM_DEEPSTATE_RUMBLER]) {
		mtmp->noegodesc = mtmp->noegodisplay = TRUE;
		mtmp->isegotype = 1;
		mtmp->egotype_farter = 1;
	}
	if (ptr == &mons[PM_ALIEN_IN_BRIDAL_DRESS]) {
		mtmp->noegodesc = mtmp->noegodisplay = TRUE;
		mtmp->isegotype = 1;
		mtmp->egotype_farter = 1;
	}
	if (ptr == &mons[PM_HADRON_SAVE_COLLIDER_BUG]) {
		mtmp->noegodesc = mtmp->noegodisplay = TRUE;
		mtmp->isegotype = 1;
		mtmp->egotype_allivore = 1;
	}
	if (ptr == &mons[PM_SING_S_DEEPSTATE_AGENT]) {
		mtmp->noegodesc = mtmp->noegodisplay = TRUE;
		mtmp->isegotype = 1;
		mtmp->egotype_singagent = 1;
	}
	if (ptr == &mons[PM_BEN_ARGIMUNT]) {
		mtmp->noegodesc = mtmp->noegodisplay = TRUE;
		mtmp->isegotype = 1;
		mtmp->egotype_farter = 1;
	}

	/* slex shopkeepers don't fuck around - if you engage them, they may hit you with a variety of nasty stuff --Amy */
	if (ptr == &mons[PM_SHOPKEEPER] || ptr == &mons[PM_MASTER_SHOPKEEPER] || ptr == &mons[PM_ELITE_SHOPKEEPER] || ptr == &mons[PM_BLACK_MARKETEER] || ptr == &mons[PM_GUARD] || ptr == &mons[PM_MASTER_GUARD] || ptr == &mons[PM_ELITE_GUARD] || ptr == &mons[PM_CROUPIER] || ptr == &mons[PM_MASTER_CROUPIER] || ptr == &mons[PM_ELITE_CROUPIER]) {

		if (ptr == &mons[PM_GUARD] || ptr == &mons[PM_MASTER_GUARD] || ptr == &mons[PM_ELITE_GUARD] || ptr == &mons[PM_CROUPIER] || ptr == &mons[PM_MASTER_CROUPIER] || ptr == &mons[PM_ELITE_CROUPIER]) mtmp->noegodesc = TRUE;
		if (rn2(2)) {
			mtmp->noegodesc = mtmp->noegodisplay = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_wallwalk = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_disenchant = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_rust = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_corrosion = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_decay = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_flamer = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_blasphemer = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_dropper = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_wither = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_grab = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_slows = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_vampire = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_wrap = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_disease = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_slime = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_engrave = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_dark = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_luck = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_arcane = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_clerical = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_armorer = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_tank = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_speedster = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_racer = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_blaster = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_gator = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_reflecting = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_farter = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_watersplasher = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_cancellator = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_shredder = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_incrementor = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_mirrorimage = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_curser = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_cullen = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_webber = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_itemporter = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_abomination = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_flickerer = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_hitter = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_piercer = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_lifesaver = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_shader = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_amnesiac = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_trapmaster = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_mastercaster = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_sinner = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_weeper = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_destructor = TRUE;
		}
		if (!rn2(1000)) {
			mtmp->isegotype = 1;
			mtmp->egotype_datadeleter = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_trembler = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_worldender = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_damager = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_antitype = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_statdamager = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_sanitizer = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_nastycurser = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_rogue = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_champion = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_boss = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_atomizer = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_perfumespreader = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_converter = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_alladrainer = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_stabilizer = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_spoilerproofer = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_metalmafioso = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_deepstatemember = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_wouwouer = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_laserpwnzor = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_badowner = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_bleeder = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_shanker = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_terrorizer = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_feminizer = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_levitator = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_illusionator = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_stealer = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_stoner = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_maecke = TRUE;
		}
		if (!rn2(100)) {
			mtmp->isegotype = 1;
			mtmp->egotype_amberite = TRUE;
		}

	}

	if (AlwaysEgotypeMonsters || u.uprops[ALWAYS_EGOTYPES].extrinsic || have_egostone()) {

		mtmp->isegotype = 1;
		add_monster_egotype(mtmp);

		while (!rn2(iswarper ? 4 : 10)) {
			add_monster_egotype(mtmp);
		}

	}

	/* monster that got created with the steed egotype now has 1% chance of receiving a saddle --Amy */
	if (mtmp && mtmp->egotype_steed && !rn2(100)) {
		struct obj *osaddle;
		if (!!(osaddle = mksobj(!rn2(20) ? INKA_SADDLE : LEATHER_SADDLE, TRUE, FALSE, FALSE))) {
			if (mpickobj(mtmp, osaddle, TRUE)) { /* it became a gold piece (e.g. minimalist) --Amy */
				if (wizard) impossible("merged saddle?");
			} else {
				mtmp->misc_worn_check |= W_SADDLE;
				osaddle->dknown = osaddle->bknown = osaddle->rknown = 1;
				osaddle->owornmask = W_SADDLE;
				osaddle->leashmon = mtmp->m_id;
				update_mon_intrinsics(mtmp, osaddle, TRUE, TRUE);
			}
		}
	}

	if(/*in_mklev && */hides_under(ptr) && OBJ_AT(x, y))
	  mtmp->mundetected = TRUE;

	switch(ptr->mlet) {
		case S_MIMIC:
			set_mimic_sym(mtmp);
			break;
		case S_TROLL:
			if (mndx == PM_OLOG_HAI_MIMIC) set_mimic_sym(mtmp);
			if (mndx == PM_OLOG_HAI_PERMAMIMIC) set_mimic_sym(mtmp);
			if (mndx == PM_TROLL_PERMAMIMIC_MUMMY) set_mimic_sym(mtmp);
			if (mndx == PM_NETHERWORLD_TROLL) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_DEEPSTATE_CLOBBERER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_ATOMIC_ROFLCOPTER_WATER_TROLL) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}

			break;

		case S_JELLY:
			if (mndx == PM_EVIL_JELLY) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_HAHAHAHAHAHAHA) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_HAHAHAHAHAHAHA_A_A_A_A_DIIIIU) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			break;

		case S_QUANTMECH:
			if (mndx == PM_JEWELRY_THIEF) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_DEEPSTATE_SECRET_WEAPON) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			break;

		case S_ANGEL:
			if (mndx == PM_SOMETHING_INVISIBLE_IS_KILLING_YOU) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_DEEPSTATE_MURDER_SQUAD) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_THATS_IT_PLAYTIMES_OVER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_MOVANIC_HAHA) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_ITS_COOL_WHEN_YOU_CANNOT_SEE_A_DEADLY_MONSTER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mtmp->data == &mons[PM_ANIMEBAND_PLAYER]) {
				int spawnnumber = rn1(10, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(325), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			break;

		case S_OGRE:
			if (mndx == PM_HELP_HEEEEELP) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_U_R_GOING_DOWN) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			break;

		case S_CENTAUR:
			if (mndx == PM_UNSEEN_CRUSHER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_U_DIED_IN_AN_ACCIDENT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_MYRMIDON_DIATRYPON) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_HAHA_YOU_CANNOT_SEE_ME) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			break;

		case S_GREMLIN:
			if (mndx == PM_DEFORMED_GALLTRIT) set_mimic_sym(mtmp);
			if (mndx == PM_STATE_SEIZE_AGENT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}

			break;
		case S_WORM_TAIL:
			if (mtmp->data == &mons[PM_PERFUMEHUGGER]) {
				int spawnnumber = rn1(10, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(333), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}

			break;
		case S_GIANT:
			if (mndx == PM_EVIL_PATCH_MINOTAUR) set_mimic_sym(mtmp);
			if (mndx == PM_MINOTAUR_MIMIC) set_mimic_sym(mtmp);
			if (mtmp->data == &mons[PM_COURT_LORD]) {
				int spawnnumber = rn1(12, 5);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(courtmon(), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_TES_PLAYER]) {
				int spawnnumber = rn1(10, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(427), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}

			break;
		case S_WALLMONST:
			if (mndx == PM_DARK_NUMBER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_FUNK_HOLE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_BELT_MOUNTAIN) set_mimic_sym(mtmp);
			if (mtmp->data == &mons[PM_HAHAHA_ER]) {
				int spawnnumber = rn1(8, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(323), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_TWISTED_JOKER]) {
				int spawnnumber = rn1(10, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(323), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			break;
		case S_LICH:
			if (mndx == PM_MIMIC_LICH) set_mimic_sym(mtmp);
			if (mndx == PM_DEMILICH_PERMAMIMIC) set_mimic_sym(mtmp);
			if (mndx == PM_SUPER_STEALTH_LICH) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_OUR_KING_HAS_TAKEN_YOU_OUT_) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}

			break;
		case S_IMP:
			if (mndx == PM_COCOON_IMP) set_mimic_sym(mtmp);
			if (mndx == PM_HIDDEN_RUTTERKIN) set_mimic_sym(mtmp);
			if (mndx == PM_BERBALANG_GHOST) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_HOHO_UR_STATS_GO_TO_HECK) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_ALL_UR_STATS_ARE_TRASHED) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}

			break;
		case S_LIZARD:
			if (mndx == PM_MIMIC_LIZARD) set_mimic_sym(mtmp);
			if (mndx == PM_DEFORMED_LIZARD) set_mimic_sym(mtmp);
			if (mndx == PM_ASSASSIN_LIZARD) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_DANGEROUS_ASSASSIN_LIZARD) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mtmp->data == &mons[PM_DUNGEON_LORDS_PLAYER]) {
				int spawnnumber = rn1(10, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(328), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}

			break;

		case S_UMBER:

			if (mndx == PM_MAIDENHACK_HORROR) set_mimic_sym(mtmp);
			if (mndx == PM_YASD_HORROR) set_mimic_sym(mtmp);
			if (mndx == PM_NETHACKFOUR_HORROR) set_mimic_sym(mtmp);
			if (mndx == PM_DEVTEAM_HORROR) set_mimic_sym(mtmp);
			if (mndx == PM_UMBER_MIMIC) set_mimic_sym(mtmp);
			if (mndx == PM_HAEHAEHAE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_WOAHAAHAA) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_YEAH_YOU_HAD_NO_CHANCE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_HARHARHAR) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_RATZEPUEH_HULK) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_SUMTHINS_KILLIN_YA_AGAIN) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}

			if (mtmp->data == &mons[PM____ER]) {
				int spawnnumber = rn1(5, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(douglas_adams_mon(), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_SPECCOR_HORROR]) {
				int spawnnumber = rn1(12, 4);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(331), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}

			break;

		case S_BLOB:

			if (mndx == PM_ONANOCTER__G) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}

			break;

		case S_TRAPPER:

			if (mndx == PM_DECEPTIVE_SPRINGY) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_LITTLE_VORER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_VORER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_LARGE_VORER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_GREAT_VORER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_MEGA_VORER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_GIGA_VORER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mtmp->data == &mons[PM_EVIL_VARIANT_MAINTAINER]) {
				int spawnnumber = rn1(12, 6);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(evilroommon(), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}

			break;

		case S_RUSTMONST:

			if (mndx == PM_SECRET_DISENCHANTER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_KLATSCH__HOEHOE_) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_CAMO_RUST_MONSTER) set_mimic_sym(mtmp);

			break;

		case S_RODENT:

			if (mndx == PM_SOCK_MOLE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}

			break;

		case S_DOG:

			if (mndx == PM_SOSCHUUVA) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_CLEAR_HOUND) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_ETHEREAL_HOUND) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_REAL_CLEAR_HOUND) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_REAL_ETHEREAL_HOUND) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_STAIRWOLF) set_mimic_sym(mtmp);
			if (mndx == PM_FAKE_STAIRWOLF) set_mimic_sym(mtmp);
			if (mndx == PM_HOUND_OF_SUCK_YOU_DRY) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}

			break;

		case S_BAD_FOOD:

			if (mndx == PM_CLEAR_MUSHROOM_PATCH) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_PUMPKIN) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_GREATER_PUMPKIN) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_HALLOWEEN_NIGHTMARE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_VAMPKIN) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_CORPSER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mtmp->data == &mons[PM_ROTTEN_FOOD_RATION]) set_mimic_sym(mtmp);
			if (mtmp->data == &mons[PM_TREEENT]) set_mimic_sym(mtmp);
			if (mtmp->data == &mons[PM_TREE_ENT]) set_mimic_sym(mtmp);

			if (mndx == PM_POISON_CREEPER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_SIA_SNARE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_SMIF_SNARE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_PLAGUE_POPPY) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_CARRION_VINE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_CYCLE_OF_LIFE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_SOLAR_CREEPER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_VINES) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_PRION) {
				mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;
				mtmp->mtame = mtmp->mpeaceful = FALSE;
				mtmp->mfrenzied = TRUE;
			}

			break;

		case S_WORM:

			if (mndx == PM_CLEAR_WORM_MASS) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_NOT_REALLY_EXISTING_MORGELLON) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}

			break;

		case S_YETI:

			if (mndx == PM_NIGHT_MARAUDER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_SPIRIT_BABOON) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}

			break;

		case S_KOP:
			if (mtmp->data == &mons[PM_NETZAH_SEPHIRAH]) set_mimic_sym(mtmp);
			if (mtmp->data == &mons[PM_GNOSIS_SEPHIRAH]) set_mimic_sym(mtmp);

			if (mndx == PM_KEYSTONE_POLICEMAN) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_POLICEMAN_SERGEANT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_POLICEMAN_LIEUTENANT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_POLICEMAN_KAPTAIN) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_POLICEMAN_KOMMISSIONER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_POLICEMAN_KCHIEF) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_POLICEMAN_KATCHER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_POLICEMAN_KRIMINOLOGIST) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_POLICEMAN_KEELHAULER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_POLICEMAN_KLEEVER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}

			if (mndx == PM_KEYSTONE_WARDER) set_mimic_sym(mtmp);
			if (mndx == PM_WARDER_SERGEANT) set_mimic_sym(mtmp);
			if (mndx == PM_WARDER_LIEUTENANT) set_mimic_sym(mtmp);
			if (mndx == PM_WARDER_KAPTAIN) set_mimic_sym(mtmp);
			if (mndx == PM_WARDER_KOMMISSIONER) set_mimic_sym(mtmp);
			if (mndx == PM_WARDER_KCHIEF) set_mimic_sym(mtmp);
			if (mndx == PM_WARDER_KATCHER) set_mimic_sym(mtmp);
			if (mndx == PM_WARDER_KRIMINOLOGIST) set_mimic_sym(mtmp);
			if (mndx == PM_WARDER_KEELHAULER) set_mimic_sym(mtmp);
			if (mndx == PM_WARDER_KLEEVER) set_mimic_sym(mtmp);

			if (mndx == PM_KEYSTONE_INSPECTOR) set_mimic_sym(mtmp);
			if (mndx == PM_INSPECTOR_SERGEANT) set_mimic_sym(mtmp);
			if (mndx == PM_INSPECTOR_LIEUTENANT) set_mimic_sym(mtmp);
			if (mndx == PM_INSPECTOR_KAPTAIN) set_mimic_sym(mtmp);
			if (mndx == PM_INSPECTOR_KOMMISSIONER) set_mimic_sym(mtmp);
			if (mndx == PM_INSPECTOR_KCHIEF) set_mimic_sym(mtmp);
			if (mndx == PM_INSPECTOR_KATCHER) set_mimic_sym(mtmp);
			if (mndx == PM_INSPECTOR_KRIMINOLOGIST) set_mimic_sym(mtmp);
			if (mndx == PM_INSPECTOR_KEELHAULER) set_mimic_sym(mtmp);
			if (mndx == PM_INSPECTOR_KLEEVER) set_mimic_sym(mtmp);

			if (mndx == PM_HUMAN_WEREMIMIC) set_mimic_sym(mtmp);
			if (mndx == PM_HUMAN_WEREPERMAMIMIC) set_mimic_sym(mtmp);

			break;
		case S_XORN:
			if (mtmp->data == &mons[PM_XEROC]) set_mimic_sym(mtmp);
			if (mtmp->data == &mons[PM_PORTER_XORN_PERMAMIMIC]) set_mimic_sym(mtmp);
			if (mndx == PM_BOGUXORN) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			break;
		case S_BAD_COINS:
			if (mtmp->data == &mons[PM_FATA_MORGANA]) set_mimic_sym(mtmp);
			if (mndx == PM_YERLES_CYBORG_SOLDIER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_TANJA_CYBORG_SOLDIER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			break;
		case S_ZOMBIE:
			if (mtmp->data == &mons[PM_ALIENATED_UFO_PART]) set_mimic_sym(mtmp);
			if (mndx == PM_UNDEFINED_UFO_PART) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_PHONE_ZOMBIE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_DRONING_UFO_PART) set_mimic_sym(mtmp);
			if (mndx == PM_SUMTHINS_KILLIN_YA) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_THAT_STUFF_WASNT_YOURS_ANYWAY) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_HEHEHE_YOUR_GAME_ENDED_BRO) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_STREAM_KNIGHT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_INVISDRAUGR) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_UR_SHITS_BEING_STOLEN) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}

			break;
		case S_NAGA:
			if (mtmp->data == &mons[PM_MULTI_HUED_NAGA]) set_mimic_sym(mtmp);
			if (mndx == PM_ELONINJA) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_RED_NINJA) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			break;

		case S_FELINE:
			if (rn2(2) && mndx == PM_AIR_DEATH) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_KAGERO_AIR_DEATH) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_DEEPSTATECAT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_DEFORMED_CAT) set_mimic_sym(mtmp);
			if (mndx == PM_LINUS_THE_CAT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_KRRK_KRRK) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_YAY_YOU_DIED) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			break;

		case S_KOBOLD:

			if (mndx == PM_UNIDENTIFIED_KOBOLD_SHAMAN) set_mimic_sym(mtmp);

			if (mtmp->data == &mons[PM_FALLEN_SHAMAN]) {
				(void) makemon(&mons[PM_FALLEN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_FALLEN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_FALLEN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_FALLEN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_PLEASED_SHAMAN]) {
				(void) makemon(&mons[PM_PLEASURE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_PLEASURE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_PLEASURE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_PLEASURE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_CARVER_SHAMAN]) {
				(void) makemon(&mons[PM_CARVER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_CARVER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_CARVER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_CARVER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_BUTCHER_SHAMAN]) {
				(void) makemon(&mons[PM_BUTCHER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_BUTCHER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_BUTCHER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_BUTCHER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_DEVILKIN_SHAMAN]) {
				(void) makemon(&mons[PM_DEVILKIN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_DEVILKIN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_DEVILKIN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_DEVILKIN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_DARK_SHAMAN]) {
				(void) makemon(&mons[PM_DARK_CREATURE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_DARK_CREATURE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_DARK_CREATURE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_DARK_CREATURE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_WARPED_SHAMAN]) {
				(void) makemon(&mons[PM_WARPED_FALLEN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_WARPED_FALLEN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_WARPED_FALLEN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_WARPED_FALLEN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_MOVED_SHAMAN]) {
				(void) makemon(&mons[PM_MOVED_ONE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_MOVED_ONE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_MOVED_ONE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_MOVED_ONE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_TURNED_SHAMAN]) {
				(void) makemon(&mons[PM_TURNED_ONE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_TURNED_ONE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_TURNED_ONE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_TURNED_ONE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_ROTATED_SHAMAN]) {
				(void) makemon(&mons[PM_ROTATED_ONE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_ROTATED_ONE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_ROTATED_ONE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_ROTATED_ONE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_FEARSOME_BUTCHER_SHAMAN]) {
				(void) makemon(&mons[PM_FEARSOME_BUTCHER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_FEARSOME_BUTCHER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_FEARSOME_BUTCHER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_FEARSOME_BUTCHER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_DIABOLIC_SHAMAN]) {
				(void) makemon(&mons[PM_DIABOLIC_POTATO], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_DIABOLIC_POTATO], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_DIABOLIC_POTATO], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_DIABOLIC_POTATO], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_HIDDEN_SHAMAN]) {
			    mtmp->perminvis = TRUE;
			    mtmp->minvis = TRUE;
				(void) makemon(&mons[PM_HIDDEN_POTATO], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_HIDDEN_POTATO], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_HIDDEN_POTATO], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_HIDDEN_POTATO], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_DESERT_KOBOLD_SHAMAN]) {
				(void) makemon(&mons[PM_DESERT_KOBOLD], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_DESERT_KOBOLD], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_DESERT_KOBOLD], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_DESERT_KOBOLD], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_ARCANE_BUTCHER_SHAMAN]) {
				(void) makemon(&mons[PM_ARCANE_BUTCHER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_ARCANE_BUTCHER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_ARCANE_BUTCHER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_ARCANE_BUTCHER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_JUNGLE_WARRIOR_SHAMAN]) {
				(void) makemon(&mons[PM_JUNGLE_WARRIOR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_JUNGLE_WARRIOR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_JUNGLE_WARRIOR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_JUNGLE_WARRIOR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}


			if (mtmp->data == &mons[PM_HIDDEN_POTATO]) {
			    mtmp->perminvis = TRUE;
			    mtmp->minvis = TRUE;

			}

			break;

		case S_HUMANOID:

			if (mtmp->data == &mons[PM_AOE_PLAYER]) {
				int spawnnumber = rn1(10, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(426), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_ELONA_PLAYER]) {
				int spawnnumber = rn1(10, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(361), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_COURT_FOLLOWER]) {
				int spawnnumber = rn1(7, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(courtmon(), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_RELIGION_SPREADER]) {
				int spawnnumber = rn1(15, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(347), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}

			if (mtmp->data == &mons[PM_OVERSEER]) {
				(void) makemon(&mons[PM_MINION], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_MINION], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_MINION], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_MINION], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_LASHER]) {
				(void) makemon(&mons[PM_SLAYER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_SLAYER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_SLAYER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_SLAYER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_OVERLORD]) {
				(void) makemon(&mons[PM_ICE_BOAR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_ICE_BOAR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_ICE_BOAR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_ICE_BOAR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_BLOOD_BOSS]) {
				(void) makemon(&mons[PM_FIRE_BOAR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_FIRE_BOAR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_FIRE_BOAR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_FIRE_BOAR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_HELLWHIP]) {
				(void) makemon(&mons[PM_HELL_SPAWN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_HELL_SPAWN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_HELL_SPAWN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_HELL_SPAWN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_SEXTON]) {
				(void) makemon(&mons[PM_ZAKARUMITE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_ZAKARUMITE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_ZAKARUMITE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_ZAKARUMITE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_CHURCH_PREACHER]) {
				(void) makemon(&mons[PM_CHURCH_NOVICE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_CHURCH_NOVICE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_ROLLER_COASTER]) {
				(void) makemon(&mons[PM_GREAT_BAR_SLAYER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_GREAT_BAR_SLAYER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_GREAT_BAR_SLAYER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_GREAT_BAR_SLAYER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_CANTOR]) {
				(void) makemon(&mons[PM_FAITHFUL], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_FAITHFUL], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_FAITHFUL], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_FAITHFUL], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_HEIROPHANT]) {
				(void) makemon(&mons[PM_ZEALOT], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_ZEALOT], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_ZEALOT], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_ZEALOT], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_POPE]) {
				(void) makemon(&mons[PM_FANATICIAN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_FANATICIAN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_FANATICIAN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_FANATICIAN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_BAPTIST]) {
				(void) makemon(&mons[PM_BUTLER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_BUTLER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_BUTLER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_BUTLER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_HOLY_ROLLER_COASTER]) {
				(void) makemon(&mons[PM_BUTLER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_BUTLER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_BUTLER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_BUTLER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_BUTLER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_EGYPTIAN_POPE]) {
				(void) makemon(&mons[PM_BUTLER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_BUTLER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_BUTLER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_BUTLER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_BUTLER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_BUTLER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_FETISH_SHAMAN]) {
				(void) makemon(&mons[PM_FETISH], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_FETISH_BLOWDART], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_FETISH], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_FETISH_BLOWDART], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_PYGMY_WARRIOR_SHAMAN]) {
				(void) makemon(&mons[PM_PYGMY_WARRIOR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_PYGMY_WARRIOR_BLOWDART], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_PYGMY_WARRIOR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_PYGMY_WARRIOR_BLOWDART], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_FLAYER_SHAMAN]) {
				(void) makemon(&mons[PM_FLAYER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_FLAYER_BLOWDART], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_FLAYER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_FLAYER_BLOWDART], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_SOUL_KILLER_SHAMAN]) {
				(void) makemon(&mons[PM_SOUL_KILLER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_SOUL_KILLER_BLOWDART], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_SOUL_KILLER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_SOUL_KILLER_BLOWDART], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_STYGIAN_DOLL_SHAMAN]) {
				(void) makemon(&mons[PM_STYGIAN_DOLL], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_STYGIAN_DOLL_BLOWDART], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_STYGIAN_DOLL], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_STYGIAN_DOLL_BLOWDART], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_VOODOO_FETISH_SHAMAN]) {
				(void) makemon(&mons[PM_VOODOO_FETISH], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_VOODOO_FETISH_BLOWDART], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_VOODOO_FETISH], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_VOODOO_FETISH_BLOWDART], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}
			if (mtmp->data == &mons[PM_CANNIBAL_SHAMAN]) {
				(void) makemon(&mons[PM_CANNIBAL_CULTIST], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_CANNIBAL_CULTIST_BLOWDART], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_CANNIBAL_CULTIST], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_CANNIBAL_CULTIST_BLOWDART], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_GIANT_PYGMY_SHAMAN]) {
				(void) makemon(&mons[PM_GIANT_PYGMY], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_GIANT_PYGMY_BLOWDART], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_GIANT_PYGMY], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_GIANT_PYGMY_BLOWDART], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_WOLF_MAN_PACKLEADER]) {
				(void) makemon(&mons[PM_GRAY_WOLF], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_GRAY_WOLF], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_GRAY_WOLF], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_GRAY_WOLF], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_BEAR_MAN_PACKLEADER]) {
				(void) makemon(&mons[PM_BROWN_BEAR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_BROWN_BEAR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_BROWN_BEAR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_BROWN_BEAR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_DWARVEN_BULL_MAN_PACKLEADER]) {
				(void) makemon(&mons[PM_BULL], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_BULL], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_BULL], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_BULL], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mndx == PM_CAMO_DWARF) set_mimic_sym(mtmp);
			if (mndx == PM_DWARF_KING_PERMAMIMIC) set_mimic_sym(mtmp);
			if (mndx == PM_ONE_RING_HOBBIT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_MEAN_FLAYER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}

			break;

		case S_MUMMY:
			if (mtmp->data == &mons[PM_MIMIC_MUMMY]) set_mimic_sym(mtmp);
			if (mndx == PM_TROLL_PERMAMIMIC_MUMMY) set_mimic_sym(mtmp);
			if (mndx == PM_MODRON_RUPTOR) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_HAHA_YOU_JUST_DIED) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_WE_NUKED_YOUR_CHAR) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_MODRON_PARRICIDA) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_COME_AND_GET_ME_WIMP) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_CANNOT_KILL_WHAT_YOU_CANNOT_SEE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_MEAN_DRAUGR) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_YOU_DO_NOT_HAVE_YOUR_ITEMS_TO_NO_MORE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}

			if (mtmp->data == &mons[PM_REVIVAL_SPINNER]) (void) makemon(&mons[PM_SKELETON], mtmp->mx, mtmp->my, MM_ADJACENTOK);

			if (mtmp->data == &mons[PM_UPPER_SPINNER]) {
			(void) makemon(&mons[PM_SKELETON], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			(void) makemon(&mons[PM_SKELETON], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_HOLLOW_ONE] || mtmp->data == &mons[PM_EMPTY_CREATURE] || mtmp->data == &mons[PM_OLD_CORPSE]) {
				(void) makemon(&mons[PM_SKELETON], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_SKELETON], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_SKELETON], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_SKELETON], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_GUARDIAN]) {
				(void) makemon(&mons[PM_RETURNED_POTATO], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_RETURNED_POTATO], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_RETURNED_POTATO], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_RETURNED_POTATO], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_GIANT_NUT_MOTHER]) {
				(void) makemon(&mons[PM_ICE_WARRIOR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_ICE_WARRIOR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_ICE_WARRIOR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_ICE_WARRIOR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_GUY_WITH_THE_DOG]) {
				(void) makemon(&mons[PM_BLIND_DOG], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_UNRAVELER] || mtmp->data == &mons[PM_DISAFFECTOR]) {
				(void) makemon(&mons[PM_BONE_WARRIOR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_BONE_WARRIOR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_BONE_WARRIOR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_BONE_WARRIOR], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_BAAL_SUBJECT_MUMMY]) {
				(void) makemon(&mons[PM_BAAL_COLD_MAGE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_DEATH_MAGE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_BAAL_COLD_MAGE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_DEATH_MAGE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}
			if (mtmp->data == &mons[PM_HORADRIM_ANCIENT] || mtmp->data == &mons[PM_HORADRIM_ANCESTOR]) {
				(void) makemon(&mons[PM_BURNING_DEAD_POTATO], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_BURNING_DEAD_POTATO], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_BURNING_DEAD_POTATO], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_BURNING_DEAD_POTATO], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_CLOCK_OLD_HORADRIM]) {
				(void) makemon(&mons[PM_BLIGHTING_SKELETON], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_BLIGHTING_SKELETON], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_BLIGHTING_SKELETON], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_BLIGHTING_SKELETON], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}
			if (mtmp->data == &mons[PM_DECOMPOSER]) {
				(void) makemon(&mons[PM_BLIGHTING_SKELETON], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_BLIGHTING_SKELETON], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_BLIGHTING_SKELETON], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_BLIGHTING_SKELETON], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_BLIGHTING_SKELETON], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}
			if (mtmp->data == &mons[PM_PALEOLITHIC_MUMMY]) {
				(void) makemon(&mons[PM_ANIMATED_ICE_CUBES], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_ANIMATED_ICE_CUBES], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_ANIMATED_ICE_CUBES], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_ANIMATED_ICE_CUBES], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}
			if (mtmp->data == &mons[PM_DISSOLVED_UNDEAD_POTATO]) {
				(void) makemon(&mons[PM_ANIMATED_ICE_CUBES], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_ANIMATED_ICE_CUBES], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_ANIMATED_ICE_CUBES], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_ANIMATED_ICE_CUBES], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_ANIMATED_ICE_CUBES], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			break;
		case S_RUBMONST:
			if (mtmp->data == &mons[PM_MIMICRY_RUBBER]) set_mimic_sym(mtmp);
			if (mtmp->data == &mons[PM_UNKNOWN_ESCALATION_RUBBER]) set_mimic_sym(mtmp);
			if (mtmp->data == &mons[PM_DSCHIIM_RUBBER]) set_mimic_sym(mtmp);
			if (mndx == PM_CAMO_RUBBER) set_mimic_sym(mtmp);
			if (mndx == PM_WIPER_RUBBER) set_mimic_sym(mtmp);
			if (mndx == PM_PETTY_WIPER_RUBBER) set_mimic_sym(mtmp);

			if (mndx == PM_CLEAR_ICKY_THING) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_ITS_FUN_TO_SEE_YOU_HAVE_NO_CHANCE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_NONAME_KAMEREL) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_DEEPSTATESHADOW) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_I_VEL_KAMEREL) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}

			break;
		case S_GHOST:
			if (mtmp->data == &mons[PM_CURSED_SPIRIT]) set_mimic_sym(mtmp);
			if (mtmp->data == &mons[PM_DEVILISH_SPIRIT]) set_mimic_sym(mtmp);

			if (mndx == PM_SHADOW_SHAPE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_TOP_SECRET_AGENT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_UNSEEN_GHOST) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_FRIGHTGHOST) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mtmp->data == &mons[PM_CASTLE_OF_THE_WINDS_PLAYER]) {
				int spawnnumber = rn1(10, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(322), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}

			break;
		case S_QUADRUPED:
			if (mtmp->data == &mons[PM_BLENDING_TITANOTHERE]) set_mimic_sym(mtmp);
			if (mndx == PM_ASTRAY_SHEEP) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}

			if (mtmp->data == &mons[PM_SIEGE_BEAST] || mtmp->data == &mons[PM_TANKED_ELEPHANT]) {
				(void) makemon(&mons[PM_IMP], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_IMP], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_IMP], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_IMP], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}
			if (mtmp->data == &mons[PM_CRUSH_BEAST] || mtmp->data == &mons[PM_DIFFICULT_ELEPHANT]) {
				(void) makemon(&mons[PM_KOBOLD], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_KOBOLD], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_KOBOLD], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_KOBOLD], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}
			if (mtmp->data == &mons[PM_BLOOD_BRINGER]) {
				(void) makemon(&mons[PM_GOBLIN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_GOBLIN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_GOBLIN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_GOBLIN], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}
			if (mtmp->data == &mons[PM_GORE_BEARER] || mtmp->data == &mons[PM_GIANT_MILL_AUTO]) {
				(void) makemon(&mons[PM_DEMON_CHEATER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_DEMON_CHEATER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_DEMON_CHEATER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_DEMON_CHEATER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}
			if (mtmp->data == &mons[PM_DEMON_STEED]) {
				(void) makemon(&mons[PM_DEMON_SPRITE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_DEMON_SPRITE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_DEMON_SPRITE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_DEMON_SPRITE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			break;
		case S_VORTEX:
			if (mtmp->data == &mons[PM_MIMIC_VORTEX]) set_mimic_sym(mtmp);
			if (mndx == PM_MAELSTROM) set_mimic_sym(mtmp);

			if (mndx == PM_ENGULF_OUTTA_NOWHERE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_BURNEL_WHIRL) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_LLOIGOR) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mtmp->data == &mons[PM_STEAMBAND_PLAYER]) {
				int spawnnumber = rn1(10, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(326), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			break;
		case S_DEMON:
			if (mndx == PM_IT_MAKES_PITSCHAEFF_) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_FLUIDATOR_WEND) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mtmp->data == &mons[PM_HARDCORE_ALIEN]) {
				int spawnnumber = rn1(7, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(348), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			break;

		case S_GOLEM:
			if (mtmp->data == &mons[PM_EMPTY_GOLEM]) {
				int spawnnumber = rn1(8, 4);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(machineroommon(), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}

		break;

		case S_ANT:
			if (mtmp->data == &mons[PM_DISGUISED_SOLDIER_ANT]) set_mimic_sym(mtmp);
			if (mtmp->data == &mons[PM_MIMIC_ANT]) set_mimic_sym(mtmp);
			if (mndx == PM_SUPER_STEALTH_ANT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_INVISO_ANT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_KLSCHLSCHLSCHLSCHLSCH) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_THIS_IS_A_POISON_DEATH) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_DIB_DRAGONFLY) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_WOODEATER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_SUPERINVISO_ANT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}

			if (mtmp->data == &mons[PM_WANDERING_QUEEN_BEE]) {
				int spawnnumber = rn1(10, 4);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(beehivemon(), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_SUPER_QUEEN_BEE]) {
				int spawnnumber = rn1(20, 8);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(beehivemon(), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_MIGO_SUMMONER]) {
				int spawnnumber = rn1(10, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(migohivemon(), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}

			break;
		case S_HUMAN:

			if (mtmp->data == &mons[PM_TRUE_YOUNG_WOMAN]) {
				int spawnnumber = rn1(8, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(39), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_PFFFF_LADY]) {
				int spawnnumber = rn1(8, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(38), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_RUMBLE_HUSSY]) {
				int spawnnumber = rn1(8, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(40), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_ANGBAND_PLAYER]) {
				int spawnnumber = rn1(10, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(324), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_DNETHACK_MODDER]) {
				int spawnnumber = rn1(10, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(330), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_EVILVARIANT_PLAYER]) {
				int spawnnumber = rn1(10, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(341), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_SHOE_LOVER]) {
				int spawnnumber = rn1(10, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(332), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_ARABELLA_AGENT]) {
				int spawnnumber = rn1(3, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(insidemon(), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_DOOM_MULTIPLAYER]) {
				int spawnnumber = rn1(10, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(doomsquadmon(), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_MILITARY_GUY]) {
				int spawnnumber = rn1(7, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(squadmon(), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_MILITARIZER]) {
				int spawnnumber = rn1(9, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(squadmon(), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_COMMANDER_IN_CHIEF]) {
				int spawnnumber = rn1(12, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(squadmon(), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}

			if (mtmp->data == &mons[PM_BOEPA] && ((mvitals[PM_BOEPA].born % 2) != 0) ) {
				struct monst *boepamon = makemon(&mons[PM_BOEPA], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (boepamon) {
					boepamon->female = (mtmp->female) ? FALSE : TRUE;
				}
			}
			if (mtmp->data == &mons[PM_CLOCK_OLD_MARRIED_COUPLE] && ((mvitals[PM_CLOCK_OLD_MARRIED_COUPLE].born % 2) != 0) ) {
				struct monst *boepamon = makemon(&mons[PM_CLOCK_OLD_MARRIED_COUPLE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (boepamon) {
					boepamon->female = (mtmp->female) ? FALSE : TRUE;
				}
			}

			if (mtmp->data == &mons[PM_MECHTNED] && mvitals[PM_KLAPPTNIX].born == 0) {
				(void) makemon(&mons[PM_KLAPPTNIX], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}
			if (mtmp->data == &mons[PM_KLAPPTNIX] && mvitals[PM_MECHTNED].born == 0) {
				(void) makemon(&mons[PM_MECHTNED], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_STOOGE_MOE] && mvitals[PM_STOOGE_CURLY].born == 0) {
				(void) makemon(&mons[PM_STOOGE_CURLY], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}
			if (mtmp->data == &mons[PM_STOOGE_MOE] && mvitals[PM_STOOGE_LARRY].born == 0) {
				(void) makemon(&mons[PM_STOOGE_LARRY], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_STOOGE_CURLY] && mvitals[PM_STOOGE_MOE].born == 0) {
				(void) makemon(&mons[PM_STOOGE_MOE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}
			if (mtmp->data == &mons[PM_STOOGE_CURLY] && mvitals[PM_STOOGE_LARRY].born == 0) {
				(void) makemon(&mons[PM_STOOGE_LARRY], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_STOOGE_LARRY] && mvitals[PM_STOOGE_CURLY].born == 0) {
				(void) makemon(&mons[PM_STOOGE_CURLY], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}
			if (mtmp->data == &mons[PM_STOOGE_LARRY] && mvitals[PM_STOOGE_MOE].born == 0) {
				(void) makemon(&mons[PM_STOOGE_MOE], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if ((is_waterypool(x, y) || is_watertunnel(x, y) || is_shiftingsand(x, y)) && (mndx == PM_HUMAN_WEREPIRANHA || mndx == PM_HUMAN_WEREEEL || mndx == PM_HUMAN_WEREKRAKEN) )
			    mtmp->mundetected = TRUE;
			if ( (is_waterypool(x, y) || is_lava(x, y) ) && (mndx == PM_HUMAN_WEREFLYFISH) )
			    mtmp->mundetected = TRUE;
			if (mtmp->data == &mons[PM_OSCILLATOR]) set_mimic_sym(mtmp);

			if (mndx == PM_YOUR_HEALTH_SUDDENLY_WENT_FROM_FULL_TO_ZERO) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_KURAST_BOO) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_DEEPSTATE_DISALLAER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_DEEPSTATE_FARTER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_DEEPSTATE_RUMBLER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_STALKER_GIRL) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_HUMAN_WEREBLACKLIGHT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_HUMAN_WERESTALKER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_THE_INVISIBLE_MAN) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_LAG_MONSTER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_YOU_GOT_KILLED_OUT_OF_NOWHERE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_U_DIDNT_SEE_ME_COMING) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}

			if (mtmp->data == &mons[PM_PACK_LORD]) {
				(void) makemon(&mons[PM_ALPHA_WHO_WOLF], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_ALPHA_WHO_WOLF], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_ALPHA_WHO_WOLF], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_ALPHA_WHO_WOLF], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			break;
		case S_EYE:
			if (mtmp->data == &mons[PM_VOLTORB]) set_mimic_sym(mtmp);
			if (mtmp->data == &mons[PM_ELECTRODE]) set_mimic_sym(mtmp);
			if (mndx == PM_HIDDEN_PARALYSATOR) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_NEVER_RECOVER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_SERVES_YOU_RIGHT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_HAHA_YOU_CANNOT_SEE_THE_FLOATING_EYE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_HAHA_SOMETHING_JUST_PARALYZED_YOU) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_QANON) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_YOU_JUST_GOT_PARALYZED) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}

			if (mndx == PM_BLACK_LEYE) {
			    mtmp->perminvis = TRUE;
			    mtmp->minvis = TRUE;
			}
			break;
		case S_COCKATRICE:
			if (mtmp->data == &mons[PM_MIMIC_CHICKEN]) set_mimic_sym(mtmp);
			if (mtmp->data == &mons[PM_GRATING_CHICKEN]) set_mimic_sym(mtmp);
			break;
		case S_WRAITH:
			if (mtmp->data == &mons[PM_GELMER] && mvitals[PM_KELANA].born == 0) {
				(void) makemon(&mons[PM_KELANA], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}
			if (mndx == PM_ARCH_WRAITH) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			break;
		case S_SPIDER:
		case S_SNAKE:

			if (mtmp->data == &mons[PM_KELANA] && mvitals[PM_GELMER].born == 0) {
				(void) makemon(&mons[PM_GELMER], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_UPGRADED_SECRET_CAR]) set_mimic_sym(mtmp);
			if (mtmp->data == &mons[PM_EXPENSIVE_SECRET_CAR]) set_mimic_sym(mtmp);
			if (mtmp->data == &mons[PM_RUNNING_COBRA]) set_mimic_sym(mtmp);

			if (mndx == PM_DEEPSTATE_ROOMBA) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_HAMM_HAMM) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_OVERLY_REGULATED_SPIDER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_CLEAR_CENTIPEDE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_DEATH_SOUND_PLAYS) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_DILJER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_DAEDEAU_DIE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_DILJER_DILJER_DILJER_DILJER_DLOELOELOELOELOE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_DSCHIIIIIIII_) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_NOW_GOES_NIX_MORE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}

			break;
		case S_LIGHT:
		case S_ELEMENTAL:
			if (mndx == PM_STALKER || mndx == PM_FORCE_STALKER || mndx == PM_LANTERN_STALKER || mndx == PM_GREEN_STALKER || mndx == PM_YELLOW_STALKER || mndx == PM_RED_STALKER || mndx == PM_WHITE_STALKER || mndx == PM_CYAN_STALKER || mndx == PM_STONE_STALKER || mndx == PM_THE_HIDDEN || mndx == PM_INVISIBLE_BADGUY || mndx == PM_UNSEEN_POTATO || mndx == PM_CAMOUFLAGED_WATCHER || mndx == PM_UNSEEN_SERVANT || mndx == PM_SCHEDAU_STALKER || mndx == PM_HIDDEN_TRACKER || mndx == PM_SILENT_KILLER || mndx == PM_INVIS_SCORER || mndx == PM_INVIS_SAMER || mndx == PM_ILLUSION_WEAVER || mndx == PM_MIRAGE_WEAVER || mndx == PM_PAIN_MASTER || mndx == PM_PAIN_MISTER || mndx == PM_BLACK_LIGHT || mndx == PM_WEREBLACKLIGHT || mndx == PM_CHEATING_BLACK_LIGHT || mndx == PM_INVISIBLE_SPIRIT || mndx == PM_BLACK_LASER || mndx == PM_BLACK_BULB || mndx == PM_BLACK_BOOMER || mndx == PM_BLACK_STAR || mndx == PM_BLACK_BEAM || mndx == PM_BLACK_RAY || mndx == PM_POLTERGEIST || mndx == PM_WERESTALKER) {
			    mtmp->perminvis = TRUE;
			    mtmp->minvis = TRUE;
			}

			if (mndx == PM_HALLUCINATION_IMAGE) set_mimic_sym(mtmp);
			if (mndx == PM_CHEATING_BLACK_LIGHT) set_mimic_sym(mtmp);
			if (mndx == PM_WATERSPLASH_ELEMENTAL) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_WE_WON_AND_YOU_LOST) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_THAT_WAS_THE_JUSTIFIED_PUNISHMENT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_WE_DONT_CARE_ABOUT_FAIRNESS) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_PLATSCH__HAHAHAHAHA_) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_FIETZEGRALD_ELEMENTAL) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_LOL_UR_STUFF_IS_WET_NOW_HAHA) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mtmp->data == &mons[PM_CASTLE_BACKLINE]) {
				int spawnnumber = rn1(8, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(illusionmon(), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			if (mtmp->data == &mons[PM_CASTLE_MIDDLE_LINE]) {
				int spawnnumber = rn1(16, 6);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(illusionmon(), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}

			break;
		case S_FUNGUS:
			if (mndx == PM_INVISIBLE_MOLD || mndx == PM_INVISIBLE_FUNGUS || mndx == PM_INVISIBLE_PATCH || mndx == PM_INVISIBLE_FORCE_FUNGUS || mndx == PM_INVISIBLE_WORT || mndx == PM_INVISIBLE_FORCE_PATCH || mndx == PM_INVISIBLE_WARP_FUNGUS || mndx == PM_INVISIBLE_WARP_PATCH || mndx == PM_INVISIBLE_STALK || mndx == PM_INVISIBLE_SPORE || mndx == PM_INVISIBLE_MUSHROOM || mndx == PM_INVISIBLE_GROWTH || mndx == PM_INVISIBLE_COLONY || mndx == PM_STEALTHBOOST_LICHEN ) {
			    mtmp->perminvis = TRUE;
			    mtmp->minvis = TRUE;
			}
			if (mndx == PM_FALSE_MOLD || mndx == PM_DECEIVING_MOLD || mndx == PM_FALSE_FUNGUS || mndx == PM_DECEIVING_FUNGUS || mndx == PM_FALSE_PATCH || mndx == PM_DECEIVING_PATCH || mndx == PM_FALSE_FORCE_FUNGUS || mndx == PM_FALSE_WORT || mndx == PM_DECEIVING_FORCE_FUNGUS || mndx == PM_DECEIVING_WORT || mndx == PM_FALSE_FORCE_PATCH || mndx == PM_DECEIVING_FORCE_PATCH || mndx == PM_FALSE_WARP_FUNGUS || mndx == PM_DECEIVING_WARP_FUNGUS || mndx == PM_FALSE_WARP_PATCH || mndx == PM_DECEIVING_WARP_PATCH || mndx == PM_FALSE_STALK || mndx == PM_DECEIVING_STALK || mndx == PM_FALSE_SPORE || mndx == PM_DECEIVING_SPORE || mndx == PM_FALSE_MUSHROOM || mndx == PM_DECEIVING_MUSHROOM || mndx == PM_FALSE_GROWTH || mndx == PM_DECEIVING_GROWTH || mndx == PM_FALSE_COLONY || mndx == PM_DECEIVING_COLONY) mtmp->mpeaceful = TRUE;
			if (mndx == PM_HIDDEN_MOLD) set_mimic_sym(mtmp);
			if (mndx == PM_SECLUDED_MOLD) set_mimic_sym(mtmp);
			if (mndx == PM_HIDDEN_FUNGUS) set_mimic_sym(mtmp);
			if (mndx == PM_SECLUDED_FUNGUS) set_mimic_sym(mtmp);
			if (mndx == PM_HIDDEN_PATCH) set_mimic_sym(mtmp);
			if (mndx == PM_SECLUDED_PATCH) set_mimic_sym(mtmp);
			if (mndx == PM_HIDDEN_FORCE_FUNGUS) set_mimic_sym(mtmp);
			if (mndx == PM_HIDDEN_WORT) set_mimic_sym(mtmp);
			if (mndx == PM_SECLUDED_FORCE_FUNGUS) set_mimic_sym(mtmp);
			if (mndx == PM_SECLUDED_WORT) set_mimic_sym(mtmp);
			if (mndx == PM_HIDDEN_FORCE_PATCH) set_mimic_sym(mtmp);
			if (mndx == PM_SECLUDED_FORCE_PATCH) set_mimic_sym(mtmp);
			if (mndx == PM_HIDDEN_WARP_FUNGUS) set_mimic_sym(mtmp);
			if (mndx == PM_SECLUDED_WARP_FUNGUS) set_mimic_sym(mtmp);
			if (mndx == PM_HIDDEN_WARP_PATCH) set_mimic_sym(mtmp);
			if (mndx == PM_SECLUDED_WARP_PATCH) set_mimic_sym(mtmp);
			if (mndx == PM_HIDDEN_STALK) set_mimic_sym(mtmp);
			if (mndx == PM_SECLUDED_STALK) set_mimic_sym(mtmp);
			if (mndx == PM_HIDDEN_SPORE) set_mimic_sym(mtmp);
			if (mndx == PM_SECLUDED_SPORE) set_mimic_sym(mtmp);
			if (mndx == PM_HIDDEN_GROWTH) set_mimic_sym(mtmp);
			if (mndx == PM_SECLUDED_GROWTH) set_mimic_sym(mtmp);
			if (mndx == PM_HIDDEN_MUSHROOM) set_mimic_sym(mtmp);
			if (mndx == PM_SECLUDED_MUSHROOM) set_mimic_sym(mtmp);
			if (mndx == PM_HIDDEN_COLONY) set_mimic_sym(mtmp);
			if (mndx == PM_SECLUDED_COLONY) set_mimic_sym(mtmp);
			break;
		case S_EEL:
			if (is_waterypool(x, y) || is_watertunnel(x, y) || is_shiftingsand(x, y))
			    mtmp->mundetected = TRUE;
			if (mtmp->data == &mons[PM_CAMO_FISH] || mtmp->data == &mons[PM_DEFORMED_FISH] || mtmp->data == &mons[PM_AMORPHOUS_FISH]) set_mimic_sym(mtmp);

			if (mndx == PM_FLOUNDER || mndx == PM_FLAT_FISH) {
			    mtmp->perminvis = TRUE;
			    mtmp->minvis = TRUE;
			}
			if (ptr == &mons[PM_YOU_WONT_SEE_THE_JELLYFISH]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (ptr == &mons[PM_HA__INSTAKILLED]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (ptr == &mons[PM_YOU_PLAYED_ENOUGH_FOR_TODAY_ANYWAY]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}

			break;
		case S_FLYFISH:
			if (is_waterypool(x, y) || is_lava(x, y) || is_watertunnel(x, y) || is_shiftingsand(x, y) )
			    mtmp->mundetected = TRUE;
			if (mtmp->data == &mons[PM_FLYING_CAMO_FISH]) set_mimic_sym(mtmp);
			if (ptr == &mons[PM_STALKISH]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (ptr == &mons[PM_UBER_STALKISH]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (ptr == &mons[PM_JELLYFISH_KRAKEN]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (ptr == &mons[PM_SEA_FALLEN_ANGEL]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (ptr == &mons[PM_MARE_FALLEN_ANGEL]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			break;
		case S_PUDDING:
			if (ptr == &mons[PM_PHANTOM]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (ptr == &mons[PM_HOE_HOE_MIRAGE]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (ptr == &mons[PM_YOU_HAVENT_SEEN_IT_YET]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (ptr == &mons[PM_PHASE_SHIFTER]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			break;
		case S_ZOUTHERN:
			if (mndx == PM_MARSUPILAMI) set_mimic_sym(mtmp);
			if (ptr == &mons[PM_ZANAN_ASSASSIN]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (ptr == &mons[PM_VANESSA_ASSASSIN]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			break;
		case S_LEPRECHAUN:

			if (mtmp->data == &mons[PM_HEHEHE_HE_GUY]) set_mimic_sym(mtmp);
			if (mndx == PM_VESTY) set_mimic_sym(mtmp);
			if (ptr == &mons[PM_MALICIOUS_LEPRECHAUN]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (ptr == &mons[PM_DEATH_LEPRECHAUN]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}

      if (mndx == PM_POOKA){
	        if(!rn2(5)) (void) mongets(mtmp, CARROT);
		    if (!rn2(8)) (void) mongets(mtmp, HAWAIIAN_SHIRT); 
		    if (!rn2(4)) (void)mongets(mtmp, ELVEN_LEATHER_HELM);
		    switch (rn2(3)) {
		case 0:
			    if (!rn2(4)) (void)mongets(mtmp, ELVEN_SHIELD);
			    if (rn2(2)) (void)mongets(mtmp, ELVEN_SHORT_SWORD);
         case 1:
			    (void)mongets(mtmp, ELVEN_DAGGER);
			    break;
		case 2:
			    if (rn2(2)) {
				(void)mongets(mtmp, ELVEN_SPEAR);
				(void)mongets(mtmp, ELVEN_SHIELD);
			    }
			    break;
		    }
      }
         if (ptr == &mons[PM_POOKA] && !rn2(3)){
			    mtmp->perminvis = TRUE;
			    mtmp->minvis = TRUE;
         }
			mtmp->msleeping = 1;
			break;
		case S_JABBERWOCK:

		if (mndx == PM_PUTRID_DEFILER || mndx == PM_WRETCHED_DEFILER || mndx == PM_FETID_DEFILER || mndx == PM_RANCID_DEFILER || mndx == PM_MOLDY_DEFILER) { mtmp->mflee = 1; mtmp->mfleetim = 120;}

		if (mndx == PM_NEBULA_JABBERWOCK) {
		    mtmp->perminvis = TRUE;
		    mtmp->minvis = TRUE;
		}
		if (mndx == PM_HOHOHO_THAT_IS_SO_FUNNY) { mtmp->perminvis = TRUE; mtmp->minvis = TRUE; }

		if (mtmp->data == &mons[PM_PUTRID_DEFILER]) { 
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 3;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_PAIN_WORM, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}
		if (mtmp->data == &mons[PM_WRETCHED_DEFILER]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 4;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_TORMENT_WORM, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}
		if (mtmp->data == &mons[PM_FETID_DEFILER]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 5;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_AGONY_WORM, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}
		if (mtmp->data == &mons[PM_RANCID_DEFILER]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 6;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_ECSTASY_WORM, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}
		if (mtmp->data == &mons[PM_MOLDY_DEFILER]) {
			struct obj *otmpX = mksobj(EGG,TRUE,FALSE, FALSE);
			if (otmpX) {
				otmpX->spe = 0;
				otmpX->quan = 7;
				otmpX->owt = weight(otmpX);
				otmpX->corpsenm = egg_type_from_parent(PM_ANGUISH_WORM, FALSE);
				attach_egg_hatch_timeout(otmpX);
				mpickobj(mtmp,otmpX, TRUE);
			}
		}

	        if (rn2(2) && rn2(5) && (!u.uhave.amulet || u.freeplaymode || (!u.amuletcompletelyimbued && rn2(3))) ) mtmp->msleeping = 1;

			break; /* fall through removed by Amy */

		case S_GRUE:

	      if (mndx == PM_PERCENTS_____NIX) mtmp->msleeping = 1;
			if (mndx == PM_IT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_INVISIBLE_HORROR) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_SUPER_STEALTH_ANT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}

			break;

		case S_NYMPH:

			if (mndx == PM_SATYR && rn2(2)) (void) mongets(mtmp, DAGGER);

			if (rn2(5) && (!u.uhave.amulet || u.freeplaymode || (!u.amuletcompletelyimbued && rn2(3)) )) mtmp->msleeping = 1;

			if (mndx == PM_PIXIE || mndx == PM_ELOPIXIE || mndx == PM_HIDING_PIXIE || mndx == PM_ARMPIXIE || mndx == PM_PIXIE_ARCHER) {        
  			    mtmp->perminvis = TRUE;
  			    mtmp->minvis = TRUE;
			}
			if (mndx == PM_NON_SEEN_SIREN) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_PFUEH_HAHA) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_U_DO_NOT_HAVE_UR_STUFF_TO_NO_MORE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_WOA_HA_HA_HA_HA_) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_TYPICAL_DEEPSTATE_MEMBER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_ATYPICAL_DEEPSTATE_MEMBER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_GOTTA_STEAL_ALL_THEIR_SHIT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_HEH_HEH_HEH_NEREID) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (ptr == &mons[PM_LOL_U_HAVE_NO_CHANCE]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}

			if (mtmp->data == &mons[PM_MIMIC_NYMPH]) set_mimic_sym(mtmp);

			break;
		case S_DRAGON:
			if (mndx == PM_KLIEAU_MANTICORE) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mtmp->data == &mons[PM_ARTILLERY_DRAGON]) set_mimic_sym(mtmp);
			if (ptr == &mons[PM_SUPER_STEALTHER]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mtmp->data == &mons[PM_DIABLO_PLAYER]) {
				int spawnnumber = rn1(10, 3);
				while (spawnnumber > 0) {
					spawnnumber--;
					(void) makemon(specialtensmon(327), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				}
			}
			break;
		case S_ORC:

			if (mndx == PM_DECEPTIVE_ORC) set_mimic_sym(mtmp);
			if (mndx == PM_SAMURUKHAI) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_VERYDEEPSTATE_SENTAI) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_MORDOR_ORC_SILENT_KILLER) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_ORC_CAMO_TROOP) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (ptr == &mons[PM_CAMP_SENTAI]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}

			if (mtmp->data == &mons[PM_ALIEN_FROM_MARS]) {
				(void) makemon(&mons[PM_MAN_FROM_MARS], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_MAN_FROM_MARS], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_MAN_FROM_MARS], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_MAN_FROM_MARS], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (mtmp->data == &mons[PM_RUNT_SHAMAN]) {
				(void) makemon(&mons[PM_RUNT], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				(void) makemon(&mons[PM_RUNT], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(3)) (void) makemon(&mons[PM_RUNT], mtmp->mx, mtmp->my, MM_ADJACENTOK);
				if (!rn2(5)) (void) makemon(&mons[PM_RUNT], mtmp->mx, mtmp->my, MM_ADJACENTOK);
			}

			if (Race_if(PM_ELF)) mtmp->mpeaceful = FALSE;
			if (Race_if(PM_PLAYER_MYRKALFR)) mtmp->mpeaceful = FALSE;
			break;
		case S_UNICORN:

			if (mndx == PM_THESTRAL) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_MOLOCH_ALIGNED_UNICORN) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_DISGUISED_UNDEAD_UNICORN) set_mimic_sym(mtmp);

			if (is_unicorn(ptr) && mndx != PM_MOLOCH_ALIGNED_UNICORN && sgn(u.ualign.type) == sgn(ptr->maligntyp))
				mtmp->mpeaceful = TRUE;
			break;
		case S_BAT:

			if (mndx == PM_INVISIBLE_CC) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mndx == PM_I_LAUGH_MYSELF_EQUAL_DEAD) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (mtmp->data == &mons[PM_UNIDENTIFIED_RAVEN]) set_mimic_sym(mtmp);
			if (mndx == PM_KILILILILIGAUNT) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE;}
			if (ptr == &mons[PM_HAHAHA_HAHA_MUAHAHAHAHA]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}

			if (mndx == PM_RITA_S_SWEET_STILETTO) {
				(void) makemon(mkclass(S_SPIDER,0), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				(void) makemon(mkclass(S_SPIDER,0), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				(void) makemon(mkclass(S_SPIDER,0), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				(void) makemon(mkclass(S_SPIDER,0), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				(void) makemon(mkclass(S_SPIDER,0), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				(void) makemon(mkclass(S_SPIDER,0), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				(void) makemon(mkclass(S_SPIDER,0), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
				(void) makemon(mkclass(S_SPIDER,0), mtmp->mx, mtmp->my, MM_ADJACENTOK|MM_ANGRY);
			}

			if ((Race_if(PM_IMPERIAL) || (Inhell && !Race_if(PM_HERETIC) ) || flags.gehenna) && is_bat(ptr))
			    mon_adjust_speed(mtmp, 2, (struct obj *)0);
			break;
		case S_VAMPIRE:
			/* [DS] Star vampires are invisible until they feed */
			if (mndx == PM_STAR_VAMPIRE) {
			    mtmp->perminvis = TRUE;
			    mtmp->minvis = TRUE;
			}

			if (mndx == PM_ORIENTAL_VAMPIRE) {mtmp->perminvis = TRUE; mtmp->minvis = TRUE; }
			if (mndx == PM_SING_S_DEEPSTATE_AGENT) {mtmp->perminvis = TRUE; mtmp->minvis = TRUE; }
			if (mndx == PM_THE_DEEP_STATE_ALWAYS_WINS) {mtmp->perminvis = TRUE; mtmp->minvis = TRUE; }
			if (mndx == PM_YOU_WERE_DEFEATED_BY_THE_DEEP_STATE) {mtmp->perminvis = TRUE; mtmp->minvis = TRUE; }
			if (mndx == PM_HAHA_SOMETHING_INVISIBLE_IS_SUCKING_YOU_DRY) {mtmp->perminvis = TRUE; mtmp->minvis = TRUE; }
			if (ptr == &mons[PM_PERMACLOAK_OF_INVIS_VAMP]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}
			if (mndx == PM_GULP_GULP_GULP) {mtmp->perminvis = TRUE; mtmp->minvis = TRUE; }
			if (ptr == &mons[PM_SHE_S_SUCKING_YOU_DRY]) {mtmp->minvis = TRUE; mtmp->perminvis = TRUE; mtmp->minvisreal = TRUE;}

			if (mtmp->data == &mons[PM_VAMPIRE_SHADOWCLOAK]) set_mimic_sym(mtmp);
			break;
	}

	/* If you're a unicorn, everything will be fast because they need to be able to match your ultra-high speed. --Amy */
	if (Race_if(PM_PLAYER_UNICORN)) mon_adjust_speed(mtmp, 2, (struct obj *)0);

	if (mtmp->egotype_mimic || mtmp->egotype_permamimic) set_mimic_sym(mtmp);

	if (standardmimic(ptr) || permamimic(ptr)) set_mimic_sym(mtmp);


	if (ptr->mlet == u.speedymonster) mon_adjust_speed(mtmp, 2, (struct obj *)0);
	if (!rn2(20) && (ptr->mlet == u.musemonster) ) {
		switch (rnd(3)) {
			case 1:
				if (rn2(20)) (void) mongets(mtmp, rnd_defensive_item(mtmp));
				else (void) mongets(mtmp, rnd_defensive_item_new(mtmp));
				break;
			case 2:
				if (rn2(20)) (void) mongets(mtmp, rnd_offensive_item(mtmp));
				else (void) mongets(mtmp, rnd_offensive_item_new(mtmp));
				break;
			case 3:
				if (rn2(20)) (void) mongets(mtmp, rnd_misc_item(mtmp));
				else (void) mongets(mtmp, rnd_misc_item_new(mtmp));
				break;
		}

	}

	if ((ct = emits_light(mtmp->data)) > 0)
		new_light_source(mtmp->mx, mtmp->my, ct,
				 LS_MONSTER, (void *)mtmp);

	mitem = 0;	/* extra inventory item for this monster */

	if ((mcham = pm_to_cham(mndx)) != CHAM_ORDINARY) {
		/* If you're protected with a ring, don't create
		 * any shape-changing chameleons -dgk
		 */
		if (Protection_from_shape_changers)
			mtmp->cham = CHAM_ORDINARY;
		else {
			mtmp->cham = mcham;
			if (mndx != PM_THE_ZRUTINATOR) (void) mon_spec_poly(mtmp, rndmonst(), 0L, FALSE, FALSE, FALSE, FALSE);
		}

	} else if (mndx == PM_WIZARD_OF_YENDOR) {
		mtmp->iswiz = TRUE;
		flags.no_of_wizards++;
		if (flags.no_of_wizards == 1 && Is_earthlevel(&u.uz))
			mitem = SPE_DIG;
		if (Race_if(PM_RODNEYAN)) mtmp->mpeaceful = 1;
	} else if (mndx == PM_THE_ZRUTINATOR) {
		if (Race_if(PM_RODNEYAN)) mtmp->mpeaceful = 1;
	} else if (mndx == PM_DJINNI) {
		flags.djinni_count++;
	} else if (mndx == PM_DAO) {
		flags.dao_count++;
	} else if (mndx == PM_EFREETI) {
		flags.efreeti_count++;
	} else if (mndx == PM_MARID) {
		flags.marid_count++;
	} else if (mndx == PM_GHOST) {
		flags.ghost_count++;
		if (!(mmflags & MM_NONAME))
			mtmp = christen_monst(mtmp, rndghostname());

	/* undead player monsters don't have titles, so I'm assigning names to them instead --Amy */
	} else if (mndx >= PM_UNDEAD_ARCHEOLOGIST && mndx <= PM_UNDEAD_WIZARD && !(mmflags & MM_NONAME) ) {

		mtmp = christen_monst(mtmp, mtmp->female ? rndplrmonnamefemale() : rndplrmonname() );

	} else if (mndx == PM_NIGHTMARE) {
		struct obj *otmp;

		otmp = oname(mksobj(SKELETON_KEY, TRUE, FALSE, FALSE),
				artiname(ART_KEY_OF_LAW));
		if (otmp) {
			otmp->blessed = otmp->cursed = otmp->hvycurse = otmp->prmcurse = otmp->morgcurse = otmp->evilcurse = otmp->bbrcurse = otmp->stckcurse = 0;
			mpickobj(mtmp, otmp, TRUE);
		}
	} else if (mndx == PM_BEHOLDER) {
		struct obj *otmp;

		otmp = oname(mksobj(SKELETON_KEY, TRUE, FALSE, FALSE),
				artiname(ART_KEY_OF_NEUTRALITY));
		if (otmp) {
			otmp->blessed = otmp->cursed = otmp->hvycurse = otmp->prmcurse = otmp->morgcurse = otmp->evilcurse = otmp->bbrcurse = otmp->stckcurse = 0;
			mpickobj(mtmp, otmp, TRUE);
		}
	} else if (mndx == PM_VECNA) {
		struct obj *otmp;

		otmp = oname(mksobj(SKELETON_KEY, TRUE, FALSE, FALSE),
				artiname(ART_KEY_OF_CHAOS));
		if (otmp) {
			otmp->blessed = otmp->cursed = otmp->hvycurse = otmp->prmcurse = otmp->morgcurse = otmp->evilcurse = otmp->bbrcurse = otmp->stckcurse = 0;
			mpickobj(mtmp, otmp, TRUE);
		}
	} else if (mndx == PM_GYPSY) {
		/* KMH -- Gypsies are randomly generated; initialize them here */
		gypsy_init(mtmp);
	} else if (mndx == PM_VLAD_THE_IMPALER) {
		mitem = CANDELABRUM_OF_INVOCATION;
	} else if (mndx == PM_CROESUS) {
		mitem = TWO_HANDED_SWORD;
	} else if (ptr->msound == MS_NEMESIS && mndx >= PM_LORD_CARNARVON && mndx <= PM_UPPER_BULL && !(In_rivalquest(&u.uz)) ) {
		mitem = BELL_OF_OPENING; /* prevent new random nemesis monsters from dropping the bell --Amy */
	} else if (mndx == PM_PESTILENCE) {
		mitem = POT_SICKNESS;
	} 



	if (mitem && allow_minvent) (void) mongets(mtmp, mitem);

	if(in_mklev) {
		if(((is_ndemon(ptr)) ||
		    (mndx == PM_WUMPUS) ||
		    (mndx == PM_LONG_WORM) ||
		    (mndx == PM_GIANT_EEL)) && (!u.uhave.amulet || u.freeplaymode || (!u.amuletcompletelyimbued && rn2(3)) ) && rn2(5))
			mtmp->msleeping = 1;
	} else {
		if(byyou) {
			newsym(mtmp->mx,mtmp->my);
			set_apparxy(mtmp);
		}
	}
	if(is_dprince(ptr) && ptr->msound == MS_BRIBE) {
	    mtmp->mpeaceful = mtmp->minvis = mtmp->perminvis = 1;
	    mtmp->mavenge = 0;
	    if (uwep && uwep->oartifact == ART_EXCALIBUR)
		mtmp->mpeaceful = mtmp->mtame = FALSE;
	}

	if (u.uprops[GHOST_WORLD].extrinsic || (uarmc && uarmc->oartifact == ART_HAUNTNIGHT) || (uarmh && uarmh->oartifact == ART_RADAR_NOT_WORKING) || GhostWorld || have_ghostlystone() || (uwep && uwep->oartifact == ART_SCHWILLSCHWILLSCHWILLSCHWI) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_SCHWILLSCHWILLSCHWILLSCHWI) ) {
		mtmp->minvis = mtmp->perminvis = mtmp->minvisreal = 1;
	}

	if (Race_if(PM_PLAYER_NIBELUNG) && !rn2(20)) {
		mtmp->minvis = mtmp->perminvis = mtmp->minvisreal = 1;
	}

	if (mtmp->data->mlet == u.alwaysinvisible) mtmp->minvis = mtmp->perminvis = 1;
	if (mtmp->data->mlet == u.alwayshidden) mtmp->minvis = mtmp->perminvis = mtmp->minvisreal = 1;

	if (!rn2(100) && mtmp->minvis) mtmp->minvisreal = TRUE;

	if (!rn2(100) ) mtmp->noegodesc = TRUE;

	if (!rn2(100) ) mtmp->noegodisplay = TRUE;

	if (issoviet && rn2(3)) {
		mtmp->noegodesc = TRUE;
		if (!rn2(2)) mtmp->noegodisplay = TRUE;
	}

#ifndef DCC30_BUG
	if (mndx == PM_LONG_WORM && (mtmp->wormno = get_wormno()) != 0)
#else
	/* DICE 3.0 doesn't like assigning and comparing mtmp->wormno in the
	 * same expression.
	 */
	if (mndx == PM_LONG_WORM &&
		(mtmp->wormno = get_wormno(), mtmp->wormno != 0))
#endif
	{
	    /* we can now create worms with tails - 11/91 */
	    initworm(mtmp, rn2(5));
	    if (count_wsegs(mtmp)) place_worm_tail_randomly(mtmp, x, y);
	}
	set_malign(mtmp);		/* having finished peaceful changes */
	if(anymon || (ptr->geno & G_UNIQ) || !rn2((ptr->geno & G_VLGROUP) ? 500 : (ptr->geno & G_LGROUP) ? 200 : (ptr->geno & G_RGROUP) ? 100 : (ptr->geno & G_SGROUP) ? 50 : 5) ) { /* everything that spawns in groups can spawn in bigger groups --Amy */
	    if ((ptr->geno & G_SGROUP) && allow_special && rn2(isgrouper ? 5 : 2)) {
		if (!rn2(5000))  m_initxxlgrp(mtmp, mtmp->mx, mtmp->my);
		else if(!rn2(800))  m_initxlgrp(mtmp, mtmp->mx, mtmp->my);
		else if(!rn2(160))  m_initvlgrp(mtmp, mtmp->mx, mtmp->my);
		else if(!rn2(30))  m_initlgrp(mtmp, mtmp->mx, mtmp->my);
		else if (rn2(10))    m_initsgrp(mtmp, mtmp->mx, mtmp->my);
	    } else if (ptr->geno & G_LGROUP && allow_special && rn2(isgrouper ? 10 : 3) ) {
		if (!rn2(1000))  m_initxxlgrp(mtmp, mtmp->mx, mtmp->my);
		else if(!rn2(200))  m_initxlgrp(mtmp, mtmp->mx, mtmp->my);
		else if(!rn2(40))  m_initvlgrp(mtmp, mtmp->mx, mtmp->my);
		else if(rn2(3))  m_initlgrp(mtmp, mtmp->mx, mtmp->my);
		else if (rn2(10))	    m_initsgrp(mtmp, mtmp->mx, mtmp->my);
	    } else if(ptr->geno & G_VLGROUP && allow_special && rn2(isgrouper ? 15 : 5) ) {
		if (!rn2(200))  m_initxxlgrp(mtmp, mtmp->mx, mtmp->my);
		else if(!rn2(20))  m_initxlgrp(mtmp, mtmp->mx, mtmp->my);
		else if(rn2(3))  m_initvlgrp(mtmp, mtmp->mx, mtmp->my);
		else if(rn2(3))  m_initlgrp(mtmp, mtmp->mx, mtmp->my);
		else if (rn2(10))        m_initsgrp(mtmp, mtmp->mx, mtmp->my);
	    } else if(ptr->geno & G_RGROUP && allow_special && rn2(isgrouper ? 15 : 5) ) {
		if (!rn2(100))  m_initxxlgrp(mtmp, mtmp->mx, mtmp->my);
		else if(!rn2(10))  m_initxlgrp(mtmp, mtmp->mx, mtmp->my);
		else if(!rn2(5))  m_initvlgrp(mtmp, mtmp->mx, mtmp->my);
		else if(!rn2(5))  m_initlgrp(mtmp, mtmp->mx, mtmp->my);
		else if (rn2(10))        m_initsgrp(mtmp, mtmp->mx, mtmp->my);
	    }
		/* allow other monsters to spawn in groups too --Amy */
	    else if (!rn2(isgrouper ? 10 : 500) && allow_special && mndx != PM_SHOPKEEPER && mndx != PM_MASTER_SHOPKEEPER && mndx != PM_ELITE_SHOPKEEPER && mndx != PM_BLACK_MARKETEER && mndx != PM_ALIGNED_PRIEST && mndx != PM_MASTER_PRIEST && mndx != PM_ELITE_PRIEST && mndx != PM_HIGH_PRIEST && mndx != PM_DNETHACK_ELDER_PRIEST_TM_ && mndx != PM_GUARD && mndx != PM_MASTER_GUARD && mndx != PM_ELITE_GUARD && mndx != PM_CROUPIER && mndx != PM_MASTER_CROUPIER && mndx != PM_ELITE_CROUPIER && mndx != quest_info(MS_NEMESIS) /*&& !(ptr->geno & G_UNIQ)*/ ) {
		if (!rn2(isgrouper ? 100 : 500))  m_initxxlgrp(mtmp, mtmp->mx, mtmp->my);
		else if(!rn2(isgrouper ?  10 : 100))  m_initxlgrp(mtmp, mtmp->mx, mtmp->my);
		else if (!rn2(isgrouper ? 5 : 20)) m_initvlgrp(mtmp, mtmp->mx, mtmp->my);
		else if (!rn2(isgrouper ? 2 : 4)) m_initlgrp(mtmp, mtmp->mx, mtmp->my);
		else m_initsgrp(mtmp, mtmp->mx, mtmp->my);
	    }
	}

	if (allow_minvent) {
	    if(is_armed(ptr))
		m_initweap(mtmp);	/* equip with weapons / armor */

	    if (humanoid(ptr) && (ptr->msound == MS_CONVERT || ptr->msound == MS_HCALIEN) && !rn2(100)) {

			if ((find_shemagh()) != -1) (void)mongets(mtmp, find_shemagh());

	    }

	    if (!is_armed(ptr) && !is_animal(ptr) && !cantweararm(mtmp->data) && !rn2(25))
		m_initarmorpieces(mtmp); /* chance to have armor; monsters that are armed already had a bigger chance earlier */

		/* permafood should be more common in a way that allows you to get more of it even if you don't constantly
		 * move on to deeper levels; we'll try to achieve that by making intelligent humanoids capable of spawning
		 * with random FOOD_CLASS items. They shouldn't be too common though --Amy */
		if (timebasedlowerchance() && humanoid(ptr) && !mindless(ptr) && !(ptr->geno & G_NOCORPSE) ) {
			int foodchance = 100;
			switch (ptr->msize) {

				case MZ_TINY:
					foodchance = 1000; break;
				case MZ_SMALL:
					foodchance = 500; break;
				case MZ_MEDIUM:
					foodchance = 200; break;
				case MZ_LARGE:
					foodchance = 100; break;
				case MZ_HUGE:
					foodchance = 50; break;
				case MZ_GIGANTIC:
					foodchance = 25; break;
				default:
					foodchance = 200;
					if (ptr->msize > MZ_HUGE) foodchance = 30;
					break;
			}

			if (!rn2(foodchance))
				(void) mongets(mtmp, rnd_class(TRIPE_RATION,TIN));

		}

	    m_initinv(mtmp);  /* add on a few special items incl. more armor */
		m_initxtraitem(mtmp);

		/* for an elemental, monsters get musable items more often --Amy */
		if (Race_if(PM_ELEMENTAL) && mtmp->data->mmove && (rnd(mtmp->data->mmove) > 5) && !rn2(25)) {

			switch (rnd(10)) {
	
				case 1:
				case 2:
				case 3:
				case 4:
				case 5: 
					if (rn2(20)) mongets(mtmp, rnd_offensive_item(mtmp));
					else mongets(mtmp, rnd_offensive_item_new(mtmp)); break;
				case 6:
				case 7:
				case 8:
					if (rn2(20)) mongets(mtmp, rnd_defensive_item(mtmp));
					else mongets(mtmp, rnd_defensive_item_new(mtmp)); break;
				case 9:
				case 10:
					if (rn2(20)) mongets(mtmp, rnd_misc_item(mtmp));
					else mongets(mtmp, rnd_misc_item_new(mtmp)); break;
			}
		}

		if (FemtrapActiveKatia && (mtmp->data->msound == MS_FART_LOUD)) {
			struct obj *otmpX = mksobj(find_block_heeled_boots(),TRUE,FALSE, FALSE);
			if (otmpX) {
				(void) mpickobj(mtmp,otmpX, TRUE);
			}

		}

	    m_dowear(mtmp, TRUE);

	} else {
	    if (mtmp->minvent) discard_minvent(mtmp);
	    mtmp->minvent = (struct obj *)0;    /* caller expects this */
	    mtmp->minvent = (struct obj *)0;    /* caller expects this */
		if (allow_special) m_initxtraitem(mtmp);
	}
	if ((ptr->mflags3 & M3_WAITMASK) && !(mmflags & MM_NOWAIT)) {
		if (ptr->mflags3 & M3_WAITFORU)
			mtmp->mstrategy |= STRAT_WAITFORU;
		if (ptr->mflags3 & M3_CLOSE)
			mtmp->mstrategy |= STRAT_CLOSE;
	}

	if (ptr->msound == MS_DEAD && !monster_is_revived && !(mtmp->mrevived) ) {
		monkilled(mtmp, "", AD_PHYS);
		return((struct monst *)0);
	}

	if (mndx == PM_UNFORTUNATE_VICTIM && in_mklev ) { /* These are supposed to spawn already dead. --Amy */
			monkilled(mtmp, "", AD_PHYS);
			return((struct monst *)0);
	} 

	if (mndx == PM_SCROLLER_MASTER || mndx == PM_BOULDER_MASTER || mndx == PM_ITEM_MASTER || mndx == PM_GOOD_ITEM_MASTER || mndx == PM_BAD_ITEM_MASTER || mndx == PM_HOLE_MASTER || mndx == PM_TRAP_MASTER) {
		monkilled(mtmp, "", AD_PHYS); /* leave no trace of this monster --Amy */
		return((struct monst *)0);
	}

	if (mndx == PM_SHOCKING_SPHERE && Role_if(PM_ACID_MAGE) && Is_nemesis(&u.uz) ) {
			(void) mon_spec_polyX(mtmp,  &mons[PM_LIGHTNING_PROOF_WALL], 0L, FALSE, FALSE, FALSE, FALSE);
	} 

	/* Kop characters sometimes receive pets --Amy */
	if (mtmp->mpeaceful && Race_if(PM_KOP) && !rn2(10) && sgn(u.ualign.type) == sgn(mtmp->data->maligntyp) && (mtmp->data->mr < rnd(100) ) ) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (mtmp->mpeaceful && uarmh && uarmh->oartifact == ART_DOGGO_FRIENDSHIP && mtmp->data->mlet == S_DOG && !rn2(10)) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (!rn2(10) && uamul && uamul->oartifact == ART_MAX_ONE_GRAY && mtmp->data->mcolor == CLR_GRAY) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (!rn2(50) && ((mtmp->data->mcolor == CLR_GREEN) || ((mtmp->data->mcolor) == CLR_BRIGHT_GREEN)) && uarmc && itemhasappearance(uarmc, APP_GRASS_CLOAK) ) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (!rn2(10) && (mtmp->data->mcolor == CLR_RED) && RngeRedAttunement) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (!rn2(10) && (mtmp->data->mcolor == CLR_ORANGE) && uwep && uwep->oartifact == ART_ORANGERY) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (!rn2(50) && (mtmp->data->mcolor == CLR_ORANGE) && RngeRedAttunement) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (!rn2(33) && RngePolarOpposites && (resists_elec(mtmp) || resists_acid(mtmp)) && !(resists_elec(mtmp) && resists_acid(mtmp)) ) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (!rn2(20) && is_pokemon(mtmp->data) && uarmc && itemhasappearance(uarmc, APP_POKE_MONGO_CLOAK)) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (!rn2(25) && mtmp->data->mlet == S_BAD_FOOD && uarmg && itemhasappearance(uarmg, APP_FLOWER_GLOVES) ) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (!rn2(4) && uarmf && uarmf->oartifact == ART_SPEAK_TO_OJ && (mtmp->data->msound == MS_FART_NORMAL || mtmp->data->msound == MS_FART_QUIET || mtmp->data->msound == MS_FART_LOUD)) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (!rn2(100) && is_pokemon(mtmp->data) && RngePocketMonsters) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (!rn2(33) && is_pokemon(mtmp->data) && have_pokeloadstone() ) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (!rn2(4) && uarmh && uarmh->oartifact == ART_SQUEAKY_TENDERNESS && (mtmp->data->msound == MS_FART_LOUD || mtmp->data->msound == MS_FART_NORMAL || mtmp->data->msound == MS_FART_QUIET) ) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (!rn2(20) && uarmh && uarmh->oartifact == ART_ARMY_LEADER && (mndx == PM_SOLDIER || mndx == PM_SERGEANT || mndx == PM_LIEUTENANT || mndx == PM_CAPTAIN || mndx == PM_GENERAL || (mndx >= PM_TEUTON_SOLDIER && mndx <= PM_GOTHIC_CAPTAIN) ) ) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (!rn2(50) && uarmg && uarmg->oartifact == ART_WHAT_S_UP_BITCHES && (mtmp->data->mlet == S_NYMPH) ) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (!rn2(5) && uarmc && uarmc->oartifact == ART_WATERS_OF_OBLIVION && (mtmp->data->mlet == S_DEMON) ) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (mtmp->mpeaceful && is_animal(mtmp->data) && uarm && uarm->oartifact == ART_BEASTMASTER_S_DUSTER && !rn2(100)) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (mndx == PM_SIZZLE || mndx == PM_KATNISS) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (always_tame(mtmp->data) && peace_minded(mtmp->data) ) {
		(void) tamedog(mtmp, (struct obj *)0, FALSE);
		return((struct monst *)0);
	}

	if (!in_mklev)
	    newsym(mtmp->mx,mtmp->my);	/* make sure the mon shows up */

	if (Race_if(PM_SENSER)) { /* can sometimes sense a monster that spawns --Amy */
		if (u.ulevel < 5) senserchance = 3;
		else if (u.ulevel < 10) senserchance = 4;
		else if (u.ulevel < 15) senserchance = 5;
		else if (u.ulevel < 20) senserchance = 6;
		else if (u.ulevel < 25) senserchance = 7;
		else if (u.ulevel < 30) senserchance = 8;
		else senserchance = 9;

		if (rnd(10) < senserchance ) pline("You sense the arrival of %s.",noit_mon_nam(mtmp) );
	}

	if ((uarmc && itemhasappearance(uarmc, APP_HEARING_CLOAK) ) && !rn2(50)) pline("You sense the arrival of %s.",noit_mon_nam(mtmp) );

	/* immunizer needs a disadvantage; I'm randomly reducing their alignment --Amy */
	if (Race_if(PM_IMMUNIZER) && !rn2(3) ) adjalign(-1);

	if (!rn2(5000) && allow_special) { /* very rarely create some monsters with the same letter --Amy */
		randsp = (rn2(24) + 2);
		if (!rn2(3)) randsp *= 2;
		if (!rn2(7)) randsp *= 3;
		if (!rn2(20)) randsp *= 5;
		if (!rn2(100)) randsp *= 10;

		for (i = 0; i < randsp; i++) {
			if (!enexto(&cc, u.ux, u.uy, (struct permonst *)0) ) continue;
			(void) makemon(mkclass(ptr->mlet,0), mtmp->mx, mtmp->my, MM_ADJACENTOK);
		}
	}

	return(mtmp);
}

int
mbirth_limit(mndx)
int mndx;
{
	/* assert(MAXMONNO < 255); */
	return (mndx == PM_NAZGUL ? 9 : mndx == PM_ERINYS ? 3 : MAXMONNO); 
}

/* used for wand/scroll/spell of create monster */
/* returns TRUE iff you know monsters have been created */

boolean
create_critters(cnt, mptr)
int cnt;
struct permonst *mptr;		/* usually null; used for confused reading */
{
	coord c;
	int x, y;
	struct monst *mon;
	boolean known = FALSE;
#ifdef WIZARD
	boolean ask = wizard;
#endif

	if (Aggravate_monster) {
		u.aggravation = 1;
		reset_rndmonst(NON_PM);
	}

	while (cnt--) {
#ifdef WIZARD
	    if (ask) {
		if (create_particular()) {
		    known = TRUE;
		    continue;
		}
		else ask = FALSE;	/* ESC will shut off prompting */
	    }
#endif
	    x = u.ux,  y = u.uy;
	    /* if in water, try to encourage an aquatic monster
	       by finding and then specifying another wet location */
	    if (!mptr && u.uinwater && enexto(&c, x, y, &mons[PM_GIANT_EEL]))
		x = c.x,  y = c.y;

	    mon = makemon(mptr, x, y, NO_MM_FLAGS);
	    if (mon && canspotmon(mon)) known = TRUE;
	}

	u.aggravation = 0;

	return known;
}

#endif /* OVL1 */
#ifdef OVL0

boolean
jonaspecialspawn(ptr)
register struct permonst *ptr;
{
	if (is_jonadabmonster(ptr) || ptr->msound == MS_FLUIDATOR || ptr->msound == MS_POMPEJI) {
		if (is_jonadabmonster(ptr)) {

			if (isscriptor && (ptr->msound == MS_FLUIDATOR) && u.fluidatorwantedlevel) return TRUE;
			if (isscriptor && (ptr->msound == MS_POMPEJI) && u.pompejiwantedlevel) return TRUE;
			if (isscriptor && (ptr->msound != MS_POMPEJI) && (ptr->msound != MS_FLUIDATOR)) return TRUE;
		} else if ((ptr->msound == MS_FLUIDATOR) && u.fluidatorwantedlevel) return TRUE;
		else if ((ptr->msound == MS_POMPEJI) && u.pompejiwantedlevel) return TRUE;
	}
	return FALSE;
}


STATIC_OVL boolean
uncommon(mndx)
int mndx;
{
	int notuncommonlate = 0;
	if (moves > 100000) notuncommonlate = ((moves - 100000) / 10000);
	if (notuncommonlate < 0) notuncommonlate = 0;
	if (notuncommonlate > 1000) notuncommonlate = 1000;

	if (mons[mndx].geno & (G_NOGEN/* | G_UNIQ*/)) return TRUE;
	if ((mons[mndx].geno & (G_UNIQ)) && rn2(u.outtadepthtrap ? 5 : ((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) ? 10 : 20) && !(Bossfights || u.uprops[BOSSFIGHT].extrinsic || have_bossfightstone() || (ublindf && ublindf->oartifact == ART_CRAWLING_FROM_THE_WOODWORK) || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE) ) && !Race_if(PM_PLAYER_DYNAMO) && !Role_if(PM_TRANSSYLVANIAN) && !isbossrusher && !Role_if(PM_GANG_SCHOLAR) ) return TRUE;
	if (mvitals[mndx].mvflags & G_GONE) return TRUE;

	/* In Soviet Russia, uncommon entities are more common because "harharhar har!" --Amy */

	/* Amy reminder to self: converting a monster index number to permonst is &mons[NUMBER]
	 * keywords: int to permonst */

	if (uncommon2(&mons[mndx]) && !jonaspecialspawn(&mons[mndx]) && (issoviet ? !rn2(3) : rn2(2)) && !(EntireLevelMode || u.uprops[ENTIRE_LEVEL].extrinsic || have_entirelevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) && !Race_if(PM_RODNEYAN) ) return TRUE;
	if (uncommon3(&mons[mndx]) && !jonaspecialspawn(&mons[mndx]) && rn2(issoviet ? 2 : 3) && !(EntireLevelMode || u.uprops[ENTIRE_LEVEL].extrinsic || have_entirelevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) && !Race_if(PM_RODNEYAN) ) return TRUE;
	if (uncommon5(&mons[mndx]) && !jonaspecialspawn(&mons[mndx]) && rn2(issoviet ? 3 : 5) && !(EntireLevelMode || u.uprops[ENTIRE_LEVEL].extrinsic || have_entirelevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) && !Race_if(PM_RODNEYAN) ) return TRUE;
	if (uncommon7(&mons[mndx]) && !jonaspecialspawn(&mons[mndx]) && rn2(issoviet ? 4 : 7) && !(EntireLevelMode || u.uprops[ENTIRE_LEVEL].extrinsic || have_entirelevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) && !Race_if(PM_RODNEYAN) ) return TRUE;
	if (uncommon10(&mons[mndx]) && !jonaspecialspawn(&mons[mndx]) && rn2(issoviet ? 5 : 10) && !(EntireLevelMode || u.uprops[ENTIRE_LEVEL].extrinsic || have_entirelevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) && !Race_if(PM_RODNEYAN) ) return TRUE;

	if (monstr[mndx] >= 9 && (rn2(100) >= notuncommonlate) && !(HighlevelStatus || u.uprops[HIGHLEVEL_STATUS].extrinsic || have_highlevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) && monstr[mndx] < 14 && !rn2(10)) return TRUE;
	if (monstr[mndx] >= 14 && (rn2(150) >= notuncommonlate) && !(HighlevelStatus || u.uprops[HIGHLEVEL_STATUS].extrinsic || have_highlevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) && monstr[mndx] < 19 && !rn2(5)) return TRUE;
	if (monstr[mndx] >= 19 && (rn2(200) >= notuncommonlate) && !(HighlevelStatus || u.uprops[HIGHLEVEL_STATUS].extrinsic || have_highlevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) && monstr[mndx] < 24 && (rnd(10) > 3) ) return TRUE;
	if (monstr[mndx] >= 24 && (rn2(250) >= notuncommonlate) && !(HighlevelStatus || u.uprops[HIGHLEVEL_STATUS].extrinsic || have_highlevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) && monstr[mndx] < 28 && (rnd(10) > 4) ) return TRUE;
	if (monstr[mndx] >= 28 && (rn2(290) >= notuncommonlate) && !(HighlevelStatus || u.uprops[HIGHLEVEL_STATUS].extrinsic || have_highlevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) && monstr[mndx] < 33 && !rn2(2)) return TRUE;
	if (monstr[mndx] >= 33 && (rn2(340) >= notuncommonlate) && !(HighlevelStatus || u.uprops[HIGHLEVEL_STATUS].extrinsic || have_highlevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) && monstr[mndx] < 37 && (rnd(10) > 6) ) return TRUE;
	if (monstr[mndx] >= 37 && (rn2(380) >= notuncommonlate) && !(HighlevelStatus || u.uprops[HIGHLEVEL_STATUS].extrinsic || have_highlevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) && monstr[mndx] < 42 && (rnd(10) > 7) ) return TRUE;
	if (monstr[mndx] >= 42 && (rn2(420) >= notuncommonlate) && !(HighlevelStatus || u.uprops[HIGHLEVEL_STATUS].extrinsic || have_highlevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) && monstr[mndx] < 46 && rn2(5)) return TRUE;
	if (monstr[mndx] >= 46 && (rn2(460) >= notuncommonlate) && !(HighlevelStatus || u.uprops[HIGHLEVEL_STATUS].extrinsic || have_highlevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) && monstr[mndx] < 50 && rn2(10)) return TRUE;
	if (monstr[mndx] >= 50 && (rn2(500) >= notuncommonlate) && !(HighlevelStatus || u.uprops[HIGHLEVEL_STATUS].extrinsic || have_highlevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) && monstr[mndx] < 60 && rn2(20)) return TRUE;
	if (monstr[mndx] >= 60 && (rn2(600) >= notuncommonlate) && !(HighlevelStatus || u.uprops[HIGHLEVEL_STATUS].extrinsic || have_highlevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) && monstr[mndx] < 70 && rn2(50)) return TRUE;
	if (monstr[mndx] >= 70 && (rn2(700) >= notuncommonlate) && !(HighlevelStatus || u.uprops[HIGHLEVEL_STATUS].extrinsic || have_highlevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) && rn2(100)) return TRUE;

	/*if (Inhell)
		return(mons[mndx].maligntyp > A_NEUTRAL);
	else
		return((mons[mndx].geno & G_HELL) != 0);*/
	return FALSE;
}

/*
 *	shift the probability of a monster's generation by
 *	comparing the dungeon alignment and monster alignment.
 *	return an integer in the range of 0-5.
 */
STATIC_OVL int
align_shift(ptr)
register struct permonst *ptr;
{
    static NEARDATA long oldmoves = 0L;	/* != 1, starting value of moves */
    static NEARDATA s_level *lev;
    register int alshift;
	aligntyp alignment;

	alignment = ptr->maligntyp;
	alignment = (alignment > 0) ? A_LAWFUL :
		(alignment < 0) ? A_CHAOTIC :
		A_NEUTRAL;

    if(oldmoves != moves) {
	lev = Is_special(&u.uz);
	oldmoves = moves;
    }
    switch((lev) ? lev->flags.align : dungeons[u.uz.dnum].flags.align) {
    default:	/* just in case */
    case AM_NONE:	alshift = 0;
			break;
    case AM_LAWFUL:	alshift = (ptr->maligntyp+20)/(2*ALIGNWEIGHT);
	if (alignment == A_LAWFUL && u.ualign.type == A_CHAOTIC) alshift++;
			break;
    case AM_NEUTRAL:	alshift = (20 - abs(ptr->maligntyp))/ALIGNWEIGHT;
		if (alignment == A_NEUTRAL && u.ualign.type == A_NEUTRAL) alshift++;
			break;
    case AM_CHAOTIC:	alshift = (-(ptr->maligntyp-20))/(2*ALIGNWEIGHT);
		if (alignment == A_CHAOTIC && u.ualign.type == A_LAWFUL) alshift++;
			break;
    }

	/* player's alignment should have a bigger effect --Amy */
	if (alignment == A_NEUTRAL && u.ualign.type == A_NEUTRAL) alshift++;
	if (alignment == A_CHAOTIC && u.ualign.type == A_LAWFUL) alshift++;
	if (alignment == A_LAWFUL && u.ualign.type == A_CHAOTIC) alshift++;

	/* make the game harder for player liches */
	if (Race_if(PM_LICH_WARRIOR) && ptr->mlevel > 9) alshift++;
	if (Race_if(PM_LICH_WARRIOR) && ptr->mlevel > 19) alshift++;
	if (Race_if(PM_LICH_WARRIOR) && ptr->mlevel > 29) alshift++;
	if (Race_if(PM_LICH_WARRIOR) && ptr->mlevel > 39) alshift += 2;

	/* and also for rodney players */

	if (Race_if(PM_RODNEYAN) && ptr->mlevel > 9) alshift++;
	if (Race_if(PM_RODNEYAN) && ptr->mlevel > 19) alshift += 2;
	if (Race_if(PM_RODNEYAN) && ptr->mlevel > 29) alshift += 4;
	if (Race_if(PM_RODNEYAN) && ptr->mlevel > 39) alshift += 10;
	if (Race_if(PM_RODNEYAN) && ptr->mlevel > 49) alshift += 25;

    return alshift;
}

static NEARDATA struct {
	int choice_count;
	/*char*/int mchoices[SPECIAL_PM];	/* value range is 0..127, Amy edit: way too few! */
} rndmonst_state = { -1, {0} };

/* select a random monster type */
struct permonst *
rndmonst()
{
	register struct permonst *ptr;
	register int mndx, ct;

	int randmnst;
	int randmnsx;

	if(u.ukinghill){ /* You have pirate quest artifact in open inventory */
		if(rnd(100)>98){
			if(In_endgame(&u.uz)) return &mons[PM_GITHYANKI_PIRATE];
			else if(Inhell) return &mons[PM_DAMNED_PIRATE];
			else return &mons[PM_SKELETAL_PIRATE];
		}
	}
	
	if (!rn2(500)) { /* all monster "teams" have at least some chance of being selected --Amy */
		randmnst = (rn2(187) + 1);
		randmnsx = (rn2(100) + 1);

		if (randmnst < 6)
	 	    return(mkclass(S_ANT,0));
		else if (randmnst < 9)
		    return(mkclass(S_BLOB,0));
			else if (randmnst < 11)
		    return(mkclass(S_COCKATRICE,0));
			else if (randmnst < 15)
		    return(mkclass(S_DOG,0));
			else if (randmnst < 18)
		    return(mkclass(S_EYE,0));
			else if (randmnst < 22)
		    return(mkclass(S_FELINE,0));
			else if (randmnst < 24)
		    return(mkclass(S_GREMLIN,0));
			else if (randmnst < 29)
		    return(mkclass(S_HUMANOID,0));
			else if (randmnst < 33)
		    return(mkclass(S_IMP,0));
			else if (randmnst < 36)
		    return(mkclass(S_JELLY,0));
			else if (randmnst < 41)
		    return(mkclass(S_KOBOLD,0));
			else if (randmnst < 44)
		    return(mkclass(S_LEPRECHAUN,0));
			else if (randmnst < 47)
		    return(mkclass(S_MIMIC,0));
			else if (randmnst < 50)
		    return(mkclass(S_NYMPH,0));
			else if (randmnst < 54)
		    return(mkclass(S_ORC,0));
			else if (randmnst < 55)
		    return(mkclass(S_PIERCER,0));
			else if (randmnst < 58)
		    return(mkclass(S_QUADRUPED,0));
			else if (randmnst < 62)
		    return(mkclass(S_RODENT,0));
			else if (randmnst < 65)
		    return(mkclass(S_SPIDER,0));
			else if (randmnst < 66)
		    return(mkclass(S_TRAPPER,0));
			else if (randmnst < 69)
		    return(mkclass(S_UNICORN,0));
			else if (randmnst < 71)
		    return(mkclass(S_VORTEX,0));
			else if (randmnst < 73)
		    return(mkclass(S_WORM,0));
			else if (randmnst < 75)
		    return(mkclass(S_XAN,0));
			else if (randmnst < 76)
		    return(mkclass(S_LIGHT,0));
			else if (randmnst < 77)
		    return(mkclass(S_ZOUTHERN,0));
			else if (randmnst < 78)
		    return(mkclass(S_ANGEL,0));
			else if (randmnst < 81)
		    return(mkclass(S_BAT,0));
			else if (randmnst < 83)
		    return(mkclass(S_CENTAUR,0));
			else if (randmnst < 86)
		    return(mkclass(S_DRAGON,0));
			else if (randmnst < 89)
		    return(mkclass(S_ELEMENTAL,0));
			else if (randmnst < 94)
		    return(mkclass(S_FUNGUS,0));
			else if (randmnst < 99)
		    return(mkclass(S_GNOME,0));
			else if (randmnst < 102)
		    return(mkclass(S_GIANT,0));
			else if (randmnst < 103)
		    return(mkclass(S_JABBERWOCK,0));
			else if (randmnst < 104)
		    return(mkclass(S_KOP,0));
			else if (randmnst < 105)
		    return(mkclass(S_LICH,0));
			else if (randmnst < 108)
		    return(mkclass(S_MUMMY,0));
			else if (randmnst < 110)
		    return(mkclass(S_NAGA,0));
			else if (randmnst < 113)
		    return(mkclass(S_OGRE,0));
			else if (randmnst < 115)
		    return(mkclass(S_PUDDING,0));
			else if (randmnst < 116)
		    return(mkclass(S_QUANTMECH,0));
			else if (randmnst < 118)
		    return(mkclass(S_RUSTMONST,0));
			else if (randmnst < 121)
		    return(mkclass(S_SNAKE,0));
			else if (randmnst < 123)
		    return(mkclass(S_TROLL,0));
			else if (randmnst < 124)
		    return(mkclass(S_UMBER,0));
			else if (randmnst < 125)
		    return(mkclass(S_VAMPIRE,0));
			else if (randmnst < 127)
		    return(mkclass(S_WRAITH,0));
			else if (randmnst < 128)
		    return(mkclass(S_XORN,0));
			else if (randmnst < 130)
		    return(mkclass(S_YETI,0));
			else if (randmnst < 135)
		    return(mkclass(S_ZOMBIE,0));
			else if (randmnst < 145)
		    return(mkclass(S_HUMAN,0));
			else if (randmnst < 147)
		    return(mkclass(S_GHOST,0));
			else if (randmnst < 149)
		    return(mkclass(S_GOLEM,0));
			else if (randmnst < 152)
		    return(mkclass(S_DEMON,0));
			else if (randmnst < 155)
		    return(mkclass(S_EEL,0));
			else if (randmnst < 160)
		    return(mkclass(S_LIZARD,0));
			else if (randmnst < 162)
		    return(mkclass(S_BAD_FOOD,0));
			else if (randmnst < 165)
		    return(mkclass(S_BAD_COINS,0));
			else if (randmnst < 166) {
				if (randmnsx < 96)
		 	    return(mkclass(S_HUMAN,0));
				else
		 	    return(mkclass(S_NEMESE,0));
				}
			else if (randmnst < 171)
		    return(mkclass(S_GRUE,0));
			else if (randmnst < 176)
		    return(mkclass(S_WALLMONST,0));
			else if (randmnst < 180)
		    return(mkclass(S_RUBMONST,0));
			else if (randmnst < 181) {
				if (randmnsx < 99)
		    return(mkclass(S_HUMAN,0));
				else
		    return(mkclass(S_ARCHFIEND,0));
				}
			else if (randmnst < 186)
		    return(mkclass(S_TURRET,0));
			else if (randmnst < 187)
		    return(mkclass(S_FLYFISH,0));

			/* otherwise, don't return */
	}

/* [Tom] this was locking up priest quest... who knows why? */
/* fixed it! no 'W' class monsters with corpses! oops! */
/*    if(u.uz.dnum == quest_dnum && (ptr = qt_montype())) return(ptr); */
/*	if(u.uz.dnum == quest_dnum) {
		if ((ptr = qt_montype())) {
			return(ptr);
		}
	}*/

	/* KMH -- February 2 is Groundhog Day! */
	if (Is_oracle_level(&u.uz) && (!!flags.groundhogday ^ !rn2(20)))
		return (&mons[PM_WOODCHUCK]);

      if (u.uz.dnum == quest_dnum && (!rn2(20)) && (ptr = qt_montype()) != 0)
	    return ptr; 

      if (u.uz.dnum == subquest_dnum && (!rn2(20)) && (ptr = qt_montype()) != 0)
	    return ptr; 

      if (u.uz.dnum == rivalquest_dnum && (!rn2(20)) && (ptr = qt_rival_montype()) != 0)
	    return ptr; 

	if (rndmonst_state.choice_count < 0) {	/* need to recalculate */
	    int zlevel, minmlev, maxmlev;
	    boolean elemlevel;
#ifdef REINCARNATION
	    boolean upper;
#endif
	    rndmonst_state.choice_count = 0;
	    /* look for first common monster */
	    for (mndx = LOW_PM; mndx < SPECIAL_PM; mndx++) {
		if (!uncommon(mndx)) break;
		rndmonst_state.mchoices[mndx] = 0;
	    }		
	    if (mndx == SPECIAL_PM) {
		/* evidently they've all been exterminated */
#ifdef DEBUG
		pline("rndmonst: no common mons!");
#endif
		return (struct permonst *)0;
	    } /* else `mndx' now ready for use below */
	    zlevel = level_difficulty();
	    /* determine the level of the weakest monster to make. */
	    minmlev = /*zlevel / 6*/0;
	    /* determine the level of the strongest monster to make. */
	    maxmlev = (zlevel + u.ulevel + 1)>>1;

	    if (!rn2(100)) maxmlev *= 2;
	    if (!rn2(1000)) maxmlev *= 4;
	    if (!rn2(10000)) maxmlev = 127;
		if (maxmlev > 127) maxmlev = 127; /* maxmlev is an int, but better safe than sorry. --Amy */

		/* In Soviet Russia, things can never be difficult enough. Don't bother the player with weak stuff like newts,
		 * when we could spawn all kinds of barbazus, chthonians and great wyrms of the elements in Gehennom. --Amy */
	    if (issoviet && !rn2(2) && maxmlev > 2) minmlev = (maxmlev / 2);
		if ((ScalingBug || u.uprops[SCALING_BUG].extrinsic || have_scalingstone() || (uarm && uarm->oartifact == ART_ALPHA_TAURI) ) && maxmlev > 2) minmlev += (maxmlev / 2);

		if (((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) && !rn2(3)) {
			minmlev += u.ulevel;
		}

		if (u.outtadepthtrap && rn2(4)) {
			if (minmlev < (maxmlev / 2)) minmlev = maxmlev / 2;
		}

		if (Role_if(PM_PSION) && u.ulevel >= 7) {
			minmlev += maxmlev / 5;
		}

		/* fail safes */
		if (minmlev > 126) minmlev = 126;
		if (minmlev >= maxmlev) maxmlev = minmlev + 1;
		if (maxmlev > 127) maxmlev = 127;
		if (minmlev < 0) minmlev = 0;

#ifdef REINCARNATION
	    upper = Is_rogue_level(&u.uz);
#endif
	    elemlevel = In_endgame(&u.uz) && !Is_astralevel(&u.uz);

/*
 *	Find out how many monsters exist in the range we have selected.
 */

		/*pline("maxmlev %d", maxmlev);*/
	     
loopback:
	    /* (`mndx' initialized above) */
	    for ( ; mndx < SPECIAL_PM; mndx++) {
		ptr = &mons[mndx];
		rndmonst_state.mchoices[mndx] = 0;
		if (tooweak(mndx, minmlev) || (rn2(20) ? toostrong(mndx, maxmlev) : ptr->mlevel > maxmlev ) )
		    continue;
#ifdef REINCARNATION
		if (upper && !isupper((int)def_monsyms[(int)(ptr->mlet)]) && rn2(5) ) continue;
#endif
		if (elemlevel && wrong_elem_type(ptr) && rn2(20) ) continue;
		if (uncommon(mndx)) continue;
		/*if (Inhell && (ptr->geno & G_NOHELL)) continue;*/
		ct = (int)(ptr->geno & G_FREQ);

		/* mystics have different generation frequencies. I decided that it depends on their gender, too. --Amy */

		if (ct > 0 && (Role_if(PM_MYSTIC) || (uarmc && uarmc->oartifact == ART_NOW_IT_BECOMES_DIFFERENT)) && flags.female) ct = 1;

		if (ct && (ct + align_shift(ptr)) > 0) ct += align_shift(ptr);

		if (ct > 0 && (Role_if(PM_MYSTIC) || (uarmc && uarmc->oartifact == ART_NOW_IT_BECOMES_DIFFERENT)) && !flags.female) ct = 1;

		if (((int)(ptr->geno & G_FREQ)) == 1 && uarmc && itemhasappearance(uarmc, APP_DIFFERENT_CLOAK)) ct++;

		/* evil patch - one monster class is always generated with a higher frequency (even for mystics) --Amy */
		if (ct > 0 && (ptr->mlet == u.frequentmonster)) ct += u.freqmonsterbonus;
		if (ct > 0 && (ptr->mlet == urole.enemy1sym)) ct += 5;
		if (ct > 0 && (ptr->mlet == urole.enemy2sym)) ct += 2;

		if (ct > 0 && (ptr->mcolor == u.frequentcolor)) ct += u.freqcolorbonus;
		if (ct > 0 && (ptr->mcolor == CLR_MAGENTA || ptr->mcolor == CLR_BRIGHT_MAGENTA) && SpellColorViolet) ct += 20;

		if (ct > 0 && (In_gehennom(&u.uz) && is_demon(ptr))) ct += 10;
		if (ct > 0 && (In_gehennom(&u.uz) && dmgtype(ptr, AD_FIRE) )) ct += 1;
		if (ct > 0 && (In_gehennom(&u.uz) && dmgtype(ptr, AD_BURN) )) ct += 1;
		if (ct > 0 && (In_gehennom(&u.uz) && dmgtype(ptr, AD_LAVA) )) ct += 1;
		if (ct > 0 && (In_gehennom(&u.uz) && is_fire_resistant(ptr) )) ct += 1;
		if (ct > 0 && (In_mines(&u.uz) && (ptr->mlet == S_GNOME) )) ct += 5;
		if (ct > 0 && (In_mines(&u.uz) && (ptr->mlet == S_HUMANOID) )) ct += 5;
		if (ct > 0 && (In_mines(&u.uz) && tunnels(ptr) )) ct += 2;
		if (ct > 0 && (In_sheol(&u.uz) && is_cold_resistant(ptr) )) ct += 5;
		if (ct > 0 && (In_sheol(&u.uz) && dmgtype(ptr, AD_COLD) )) ct += 5;
		if (ct > 0 && (In_sheol(&u.uz) && dmgtype(ptr, AD_FRZE) )) ct += 5;
		if (ct > 0 && (In_sheol(&u.uz) && dmgtype(ptr, AD_ICEB) )) ct += 2;
		if (ct > 0 && (In_icequeen(&u.uz) && is_cold_resistant(ptr) )) ct += 5;
		if (ct > 0 && (In_icequeen(&u.uz) && dmgtype(ptr, AD_COLD) )) ct += 5;
		if (ct > 0 && (In_icequeen(&u.uz) && dmgtype(ptr, AD_FRZE) )) ct += 5;
		if (ct > 0 && (In_icequeen(&u.uz) && dmgtype(ptr, AD_ICEB) )) ct += 5;
		if (ct > 0 && (In_towndungeon(&u.uz) && is_angbandmonster(ptr) )) ct += 5;
		if (ct > 0 && (In_towndungeon(&u.uz) && is_steammonster(ptr) )) ct += 1;
		if (ct > 0 && (In_towndungeon(&u.uz) && is_animemonster(ptr) )) ct += 1;
		if (ct > 0 && (In_spiders(&u.uz) && webmaker(ptr) )) ct += 10;
		if (ct > 0 && (Is_lawful_quest(&u.uz) && dmgtype(ptr, AD_SPC2) )) ct += 1;
		if (ct > 0 && (Is_lawful_quest(&u.uz) && is_covetous(ptr) )) ct += 2;
		if (ct > 0 && (uarmf && uarmf->oartifact == ART_POWERWARP && is_covetous(ptr))) ct += 5;
		if (ct > 0 && (uarmf && uarmf->oartifact == ART_SATAN_S_CHOPPING_BLOCK && attackdamagetype(ptr, AT_BREA, AD_DISN) )) ct += 200;
		if (ct > 0 && (uamul && uamul->oartifact == ART_MOSH_PIT_SCRAMBLE && is_female(ptr) && attacktype(ptr, AT_KICK) )) ct += 20;
		if (ct > 0 && (uarmh && uarmh->oartifact == ART_VACUUM_CLEANER_DEATH && dmgtype(ptr, AD_SUCK) )) ct += 50;
		if (ct > 0 && (uarmf && uarmf->oartifact == ART_CLICHE_WEAR && dmgtype(ptr, AD_RUST) )) ct += 5;
		if (ct > 0 && (uarmf && uarmf->oartifact == ART_CLICHE_WEAR && dmgtype(ptr, AD_CORR) )) ct += 5;
		if (ct > 0 && (uarmf && uarmf->oartifact == ART_CLICHE_WEAR && dmgtype(ptr, AD_WTHR) )) ct += 5;
		if (ct > 0 && (uarmf && uarmf->oartifact == ART_CLICHE_WEAR && dmgtype(ptr, AD_DCAY) )) ct += 5;
		if (ct > 0 && (Is_lawful_quest(&u.uz) && cannot_be_tamed(ptr) )) ct += 1;
		if (ct > 0 && (Is_lawful_quest(&u.uz) && is_shade(ptr) )) ct += 2;
		if (ct > 0 && (Is_lawful_quest(&u.uz) && dmgtype(ptr, AD_RBRE) )) ct += 2;
		if (ct > 0 && (Is_neutral_quest(&u.uz) && (ptr->mlet == S_EYE) )) ct += 5;
		if (ct > 0 && (Is_chaotic_quest(&u.uz) && (ptr->mlet == S_LICH) )) ct += 2;
		if (ct > 0 && (Is_chaotic_quest(&u.uz) && (ptr->mlet == S_VAMPIRE) )) ct += 2;
		if (ct > 0 && (Is_chaotic_quest(&u.uz) && (ptr->mlet == S_WRAITH) )) ct += 2;
		if (ct > 0 && (Is_chaotic_quest(&u.uz) && (ptr->mlet == S_ZOMBIE) )) ct += 2;
		if (ct > 0 && (In_grund(&u.uz) && (ptr->mlet == S_ORC) )) ct += 5;
		if (ct > 0 && (In_wyrm(&u.uz) && (ptr->mlet == S_DRAGON) )) ct += 5;
		if (ct > 0 && (In_wyrm(&u.uz) && attacktype(ptr, AT_BREA) )) ct += 5;
		if (ct > 0 && (In_wyrm(&u.uz) && dmgtype(ptr, AD_DISE) )) ct += 3;
		if (ct > 0 && (In_tomb(&u.uz) && is_undead(ptr) )) ct += 10;
		if (ct > 0 && (In_slsea(&u.uz) && (ptr->mlet == S_EEL) )) ct += 20;
		if (ct > 0 && (In_slsea(&u.uz) && dmgtype(ptr, AD_WRAP) )) ct += 5;
		if (ct > 0 && (In_mtemple(&u.uz) && dmgtype(ptr, AD_CLRC) )) ct += 7;
		if (ct > 0 && (In_gcavern(&u.uz) && (ptr->mlet == S_GIANT) )) ct += 5;
		if (ct > 0 && (In_gcavern(&u.uz) && throws_rocks(ptr) )) ct += 5;
		if (ct > 0 && (In_gcavern(&u.uz) && hugemonst(ptr) )) ct += 3;
		if (ct > 0 && (In_frnkn(&u.uz) && dmgtype(ptr, AD_POLY) )) ct += 2;
		if (ct > 0 && (In_frnkn(&u.uz) && (ptr->mlet == S_GOLEM) )) ct += 2;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_SPC2) )) ct += 15;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_STUN) )) ct += 7;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_DRIN) )) ct += 5;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_HALU) )) ct += 8;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_DARK) )) ct += 5;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_FEAR) )) ct += 4;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_FAKE) )) ct += 7;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_LETH) )) ct += 2;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_CNCL) )) ct += 1;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_BLAS) )) ct += 1;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_BANI) )) ct += 2;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_WISD) )) ct += 3;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_HODS) )) ct += 3;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_CHRN) )) ct += 7;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_WEEP) )) ct += 2;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_STTP) )) ct += 1;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_DEPR) )) ct += 5;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_LAZY) )) ct += 5;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_INER) )) ct += 3;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_VULN) )) ct += 4;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_AMNE) )) ct += 10;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_INSA) )) ct += 10;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_SANI) )) ct += 10;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_TRAP) )) ct += 8;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_SHAN) )) ct += 8;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_TERR) )) ct += 10;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_FEMI) )) ct += 4;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_LEVI) )) ct += 7;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_MCRE) )) ct += 5;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_DEBU) )) ct += 5;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_UNPR) )) ct += 10;
		if (ct > 0 && (In_illusorycastle(&u.uz) && dmgtype(ptr, AD_ILLU) )) ct += 20;
		if (ct > 0 && (In_illusorycastle(&u.uz) && shapechanger(ptr) )) ct += 5;
		if (ct > 0 && (In_illusorycastle(&u.uz) && is_angbandmonster(ptr) )) ct += 3;
		if (ct > 0 && (In_illusorycastle(&u.uz) && is_animemonster(ptr) )) ct += 1;
		if (ct > 0 && (In_illusorycastle(&u.uz) && is_steammonster(ptr) )) ct += 1;
		if (ct > 0 && (In_voiddungeon(&u.uz) && (ptr->mlet == S_GHOST) )) ct += 20;
		if (ct > 0 && (In_voiddungeon(&u.uz) && is_angbandmonster(ptr) )) ct += 5;
		if (ct > 0 && (In_voiddungeon(&u.uz) && is_animemonster(ptr) )) ct += 3;
		if (ct > 0 && (In_voiddungeon(&u.uz) && is_steammonster(ptr) )) ct += 3;
		if (ct > 0 && (In_voiddungeon(&u.uz) && passes_walls(ptr) )) ct += 5;
		if (ct > 0 && (In_netherrealm(&u.uz) && (ptr->mlet == S_DEMON) )) ct += 10;
		if (ct > 0 && (In_netherrealm(&u.uz) && is_demon(ptr) )) ct += 10;
		if (ct > 0 && (In_netherrealm(&u.uz) && dmgtype(ptr, AD_NTHR) )) ct += 5;
		if (ct > 0 && (In_netherrealm(&u.uz) && dmgtype(ptr, AD_DRLI) )) ct += 5;
		if (ct > 0 && (In_deepmines(&u.uz) && (ptr->mlet == S_OGRE) )) ct += 5;
		if (ct > 0 && (In_deepmines(&u.uz) && (ptr->mlet == S_GIANT) )) ct += 1;
		if (ct > 0 && (In_deepmines(&u.uz) && (ptr->mlet == S_ORC) )) ct += 5;
		if (ct > 0 && (In_deepmines(&u.uz) && (ptr->mlet == S_GNOME) )) ct += 5;
		if (ct > 0 && (In_deepmines(&u.uz) && (ptr->mlet == S_KOBOLD) )) ct += 5;
		if (ct > 0 && (In_deepmines(&u.uz) && (ptr->mlet == S_TROLL) )) ct += 3;
		if (ct > 0 && (In_deepmines(&u.uz) && (ptr->mlet == S_CENTAUR) )) ct += 2;
		if (ct > 0 && (In_deepmines(&u.uz) && (ptr->mlet == S_HUMANOID) )) ct += 4;
		if (ct > 0 && (In_deepmines(&u.uz) && (ptr->mlet == S_RUBMONST) )) ct += 5;
		if (ct > 0 && (In_deepmines(&u.uz) && tunnels(ptr) )) ct += 4;
		if (ct > 0 && (In_deepmines(&u.uz) && humanoid(ptr) )) ct += 2;
		if (ct > 0 && (In_angmar(&u.uz) && (ptr->maligntyp < 0) )) ct += 15;
		if (ct > 0 && (In_emynluin(&u.uz) && is_angbandmonster(ptr) )) ct += 10;
		if (ct > 0 && (In_emynluin(&u.uz) && is_animemonster(ptr) )) ct += 2;
		if (ct > 0 && (In_emynluin(&u.uz) && is_steammonster(ptr) )) ct += 5;
		if (ct > 0 && (In_greencross(&u.uz) && is_cowmonster(ptr) )) ct += 50;
		if (ct > 0 && (In_greencross(&u.uz) && is_jokemonster(ptr) )) ct += 5;
		if (ct > 0 && (In_swimmingpool(&u.uz) && (ptr->mlet == S_EEL) )) ct += 20;
		if (ct > 0 && (In_swimmingpool(&u.uz) && (ptr->mlet == S_FLYFISH) )) ct += 20;
		if (ct > 0 && (In_swimmingpool(&u.uz) && dmgtype(ptr, AD_WRAP) )) ct += 10;
		if (ct > 0 && (In_swimmingpool(&u.uz) && amphibious(ptr) )) ct += 10;
		if (ct > 0 && (In_swimmingpool(&u.uz) && is_swimmer(ptr) )) ct += 10;
		if (ct > 0 && (In_hellbathroom(&u.uz) && (ptr->msound == MS_FART_NORMAL) )) ct += 10;
		if (ct > 0 && (In_hellbathroom(&u.uz) && (ptr->msound == MS_FART_QUIET) )) ct += 10;
		if (ct > 0 && (In_hellbathroom(&u.uz) && (ptr->msound == MS_FART_LOUD) )) ct += 10;
		if (ct > 0 && (uwep && uwep->oartifact == ART_BIDETHANDER && (ptr->msound == MS_FART_LOUD) )) ct += 20;
		if (ct > 0 && (u.twoweap && uswapwep && uswapwep->oartifact == ART_BIDETHANDER && (ptr->msound == MS_FART_LOUD) )) ct += 20;
		if (ct > 0 && (In_hellbathroom(&u.uz) && dmgtype(ptr, AD_FEMI) )) ct += 15;
		if (ct > 0 && (In_minusworld(&u.uz) && (ptr->mlet == S_WORM_TAIL) )) ct += 500;
		if (ct > 0 && (In_minusworld(&u.uz) && is_randomizedmonster(ptr) )) ct += 500;
		if (ct > 0 && (In_ZAPM(&u.uz) && is_evilpatchmonster(ptr) )) ct += 20;
		if (ct > 0 && (In_sewerplant(&u.uz) && (ptr->mlet == S_RODENT) )) ct += 5;
		if (ct > 0 && (In_sewerplant(&u.uz) && (ptr->mlet == S_BLOB) )) ct += 3;
		if (ct > 0 && (In_sewerplant(&u.uz) && (ptr->mlet == S_JELLY) )) ct += 5;
		if (ct > 0 && (In_sewerplant(&u.uz) && (ptr->mlet == S_FUNGUS) )) ct += 3;
		if (ct > 0 && (In_sewerplant(&u.uz) && (ptr->mlet == S_PUDDING) )) ct += 2;
		if (ct > 0 && (In_sewerplant(&u.uz) && acidic(ptr) )) ct += 4;
		if (ct > 0 && (In_sewerplant(&u.uz) && poisonous(ptr) )) ct += 3;
		if (ct > 0 && (In_gammacaves(&u.uz) && dmgtype(ptr, AD_CONT) )) ct += 7;
		if (ct > 0 && (In_mainframe(&u.uz) && (ptr->mlet == S_DEMON) )) ct += 25;
		if (ct > 0 && (In_mainframe(&u.uz) && is_demon(ptr) )) ct += 25;
		if (ct > 0 && (In_mainframe(&u.uz) && attacktype(ptr, AT_BREA) )) ct += 10;

		if (ct > 0 && (Race_if(PM_DICTIONARY_ATTACK) && (ptr->mlet >= S_ANT && ptr->mlet <= S_ZOMBIE) )) ct += 5;
		if (ct > 0 && (Race_if(PM_DICTIONARY_ATTACK) && (ptr->mlet == S_FLYFISH) )) ct += 5;
		if (ct > 0 && (Race_if(PM_BABYLONIAN) && (ptr->mlet == S_TURRET) )) ct += 5;
		if (ct > 0 && (Role_if(PM_ACTIVISTOR) && always_hostile(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_ALTMER) && is_reflector(ptr))) ct += 3;
		if (ct > 0 && (Role_if(PM_AMAZON) && is_diablomonster(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_AMAZON) && attacktype(ptr, AT_CLAW) )) ct += 1;
		if (ct > 0 && (Role_if(PM_ANACHRONIST) && is_dnethackmonster(ptr))) ct += 10;
		if (ct > 0 && (Role_if(PM_ARCHEOLOGIST) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (uimplant && uimplant->oartifact == ART_GELMER_KELANA_TWIN && is_vanillamonster(ptr))) ct += 10;
		if (ct > 0 && (Role_if(PM_ARTIST) && attacktype(ptr, AT_GAZE))) ct += 2;
		if (ct > 0 && (Role_if(PM_ASSASSIN) && is_diablomonster(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_BARBARIAN) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_NOOB_MODE_BARB) && is_vanillamonster(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_BARBARIAN) && is_diablomonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_BINDER) && is_dnethackmonster(ptr))) ct += 10;
		if (ct > 0 && (Role_if(PM_ANACHRONOUNBINDER) && is_dnethackmonster(ptr))) ct += 10;
		if (ct > 0 && (Role_if(PM_BINDER) && extra_nasty(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_BINDER) && is_undead(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_BLEEDER) && (ptr->msound == MS_SHOE))) ct += 10;
		if (ct > 0 && (Role_if(PM_BLOODSEEKER) && has_blood(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_CAMPERSTRIKER) && is_cowmonster(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_CAMPERSTRIKER) && is_jokemonster(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_CAVEMAN) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_CHEVALIER) && dmgtype(ptr, AD_ICUR))) ct += 1;
		if (ct > 0 && (Role_if(PM_CONVICT) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_CONVICT) && (ptr->msound == MS_ARREST))) ct += 2;
		if (ct > 0 && (Role_if(PM_COURIER) && is_animal(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_CRUEL_ABUSER) && cannot_be_tamed(ptr))) ct += 3;
		if (ct > 0 && (Role_if(PM_DOLL_MISTRESS) && is_animemonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_DOOM_MARINE) && attacktype(ptr, AT_BEAM))) ct += 5;
		if (ct > 0 && (Role_if(PM_DQ_SLIME) && verysmall(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_DRUID) && is_diablomonster(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_ERDRICK) && is_multihued(ptr))) ct += 10;
		if (ct > 0 && (Role_if(PM_FAILED_EXISTENCE) && (ptr->msound == MS_SHOE))) ct += 5;
		if (ct > 0 && (Role_if(PM_FIREFIGHTER) && is_fire_resistant(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_FLAME_MAGE) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_GLADIATOR) && is_animal(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_GLADIATOR) && humanoid(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_GOFF) && (ptr->msound == MS_CUSS))) ct += 2;
		if (ct > 0 && (Role_if(PM_HEALER) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_ICE_MAGE) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_JEDI) && is_cowmonster(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_JEDI) && is_jokemonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_KNIGHT) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_KNIGHT) && (ptr->msound == MS_NEIGH))) ct += 2;
		if (ct > 0 && (Role_if(PM_LADIESMAN) && (ptr->msound == MS_FART_NORMAL))) ct += 10;
		if (ct > 0 && (Role_if(PM_LADIESMAN) && (ptr->msound == MS_FART_QUIET))) ct += 10;
		if (ct > 0 && (Role_if(PM_LADIESMAN) && (ptr->msound == MS_FART_LOUD))) ct += 10;
		if (ct > 0 && (Role_if(PM_LADIESMAN) && (ptr->msound == MS_WHORE))) ct += 25;
		if (ct > 0 && (Role_if(PM_MAHOU_SHOUJO) && is_animemonster(ptr))) ct += 10;
		if (ct > 0 && (Role_if(PM_MEDIUM) && dmgtype(ptr, AD_SPC2))) ct += 2;
		if (ct > 0 && (Role_if(PM_MEDIUM) && is_mind_flayer(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_MONK) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_HALF_BAKED) && is_vanillamonster(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_MURDERER) && (ptr->msound == MS_ARREST))) ct += 5;
		if (ct > 0 && (Role_if(PM_NECROMANCER) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_NECROMANCER) && is_diablomonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_NECROMANCER) && is_undead(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_NOBLEMAN) && is_dnethackmonster(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_OCCULT_MASTER) && is_dlordsmonster(ptr))) ct += 3;
		if (ct > 0 && (Role_if(PM_OTAKU) && is_elonamonster(ptr))) ct += 3;
		if (ct > 0 && (uarm && uarm->oartifact == ART_ALPHA_TAURI && is_elonamonster(ptr))) ct += 20;
		if (ct > 0 && (Race_if(PM_WISP) && is_elonamonster(ptr))) ct += 3;
		if (ct > 0 && (Race_if(PM_MAZIN) && is_elonamonster(ptr))) ct += 5;
		if (ct > 0 && (Race_if(PM_MAZIN) && attacktype(ptr, AT_MAGC))) ct += 3;
		if (ct > 0 && (Race_if(PM_HUNKAJUNK) && dmgtype(ptr, AD_TERR))) ct += 5;
		if (ct > 0 && (Race_if(PM_HUNKAJUNK) && (ptr->msound == MS_SOVIET))) ct += 10;
		if (ct > 0 && (Race_if(PM_ELONA_SNAIL) && is_elonamonster(ptr))) ct += 10;
		if (ct > 0 && (Race_if(PM_WEAPONIZED_DINOSAUR) && is_elonamonster(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_OFFICER) && always_hostile(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_OTAKU) && is_animemonster(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_PALADIN) && is_diablomonster(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_PIRATE) && is_dnethackmonster(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_POKEMON) && is_pokemon(ptr))) ct += 10;
		if (ct > 0 && (Role_if(PM_PRIEST) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_PSION) && extra_nasty(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_PSION) && is_covetous(ptr))) ct += 10;
		if (ct > 0 && (Role_if(PM_PSION) && is_reviver(ptr))) ct += 3;
		if (ct > 0 && (Role_if(PM_PSION) && is_reflector(ptr))) ct += 3;
		if (ct > 0 && (Role_if(PM_PSION) && attacktype(ptr, AT_MAGC))) ct += 5;
		if (ct > 0 && (Role_if(PM_PSION) && passes_walls(ptr))) ct += 3;	
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_SPC2))) ct += 3;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_SSEX))) ct += 5;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_DETH))) ct += 1;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_FAMN))) ct += 1;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_PEST))) ct += 1;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_SLIM))) ct += 3;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_WTHR))) ct += 5;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_NPRO))) ct += 1;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_LETH))) ct += 2;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_CNCL))) ct += 3;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_BLAS))) ct += 3;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_BANI))) ct += 5;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_SUCK))) ct += 2;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_UVUU))) ct += 7;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_STTP))) ct += 5;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_WRAT))) ct += 2;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_DFOO))) ct += 2;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_NAST))) ct += 5;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_AMNE))) ct += 3;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_CURS))) ct += 20;
		if (ct > 0 && (Role_if(PM_RANGER) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_ROCKER) && is_ston_resistant(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_ROGUE) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_ROGUE) && has_head(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_SAGE) && is_undead(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_SAIYAN) && is_animemonster(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_SAMURAI) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_SHAPESHIFTER) && extra_nasty(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_SHAPESHIFTER) && is_covetous(ptr))) ct += 3;
		if (ct > 0 && (Role_if(PM_SHAPESHIFTER) && dmgtype(ptr, AD_SLIM))) ct += 2;
		if (ct > 0 && (Role_if(PM_SHAPESHIFTER) && dmgtype(ptr, AD_CNCL))) ct += 1;
		if (ct > 0 && (Role_if(PM_SHAPESHIFTER) && dmgtype(ptr, AD_STTP))) ct += 2;
		if (ct > 0 && (Role_if(PM_SHAPESHIFTER) && dmgtype(ptr, AD_NAST))) ct += 20;
		if (ct > 0 && (Role_if(PM_SLAVE_MASTER) && is_domestic(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_SPACEWARS_FIGHTER) && is_cowmonster(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_SPACEWARS_FIGHTER) && is_jokemonster(ptr))) ct += 3;
		if (ct > 0 && (Role_if(PM_SUPERMARKET_CASHIER) && likes_gold(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_TOPMODEL) && (ptr->msound == MS_SHOE))) ct += 5;
		if (ct > 0 && (Role_if(PM_TOURIST) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_TOURIST) && haseyes(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_TRANSSYLVANIAN) && (ptr->msound == MS_SHOE))) ct += 5;
		if (ct > 0 && (Role_if(PM_TRANSSYLVANIAN) && dmgtype(ptr, AD_NAST))) ct += 5;
		if (ct > 0 && (Role_if(PM_TRANSVESTITE) && (ptr->msound == MS_SHOE))) ct += 5;
		if (ct > 0 && (Role_if(PM_PROSTITUTE) && (ptr->msound == MS_SHOE))) ct += 5;
		if (ct > 0 && (Role_if(PM_KURWA) && (ptr->msound == MS_SHOE))) ct += 5;
		if (ct > 0 && (Role_if(PM_PROSTITUTE) && attacktype(ptr, AT_CLAW) && (ptr->msound == MS_SQEEK))) ct += 30;
		if (ct > 0 && (Role_if(PM_KURWA) && attacktype(ptr, AT_CLAW) && (ptr->msound == MS_SQEEK))) ct += 30;
		if (ct > 0 && (FemtrapActiveDora && attacktype(ptr, AT_CLAW) && (ptr->msound == MS_SQEEK))) ct += 30;
		if (ct > 0 && (FemtrapActiveManuela && spawnswithblockheels(ptr) )) ct += 100;
		if (ct > 0 && (uarmf && uarmf->oartifact == ART_RUEA_S_FAILED_CONVERSION && attacktype(ptr, AT_CLAW) && (ptr->msound == MS_SQEEK))) ct += 30;
		if (ct > 0 && (Role_if(PM_PROSTITUTE) && dmgtype(ptr, AD_SSEX))) ct += 20;
		if (ct > 0 && (Role_if(PM_KURWA) && dmgtype(ptr, AD_SSEX))) ct += 20;
		if (ct > 0 && (Role_if(PM_UNBELIEVER) && is_angbandmonster(ptr))) ct += 10;
		if (ct > 0 && (Role_if(PM_UNBELIEVER) && is_steammonster(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_UNDEAD_SLAYER) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_UNDEAD_SLAYER) && is_undead(ptr))) ct += 10;
		if (ct > 0 && (Role_if(PM_UNDERTAKER) && is_undead(ptr))) ct += 20;
		if (ct > 0 && (Role_if(PM_STAND_USER) && amorphous(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_VALKYRIE) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_VANILLA_VALK) && is_vanillamonster(ptr))) ct += 10;
		if (ct > 0 && (Role_if(PM_WANDKEEPER) && is_poison_resistant(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_WARRIOR) && is_dlordsmonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_WILD_TALENT) && is_angbandmonster(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_WILD_TALENT) && is_steammonster(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_WILD_TALENT) && is_animemonster(ptr))) ct += 3;
		if (ct > 0 && (Role_if(PM_WIZARD) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_YEOMAN) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_YEOMAN) && is_domestic(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_ZOOKEEPER) && is_domestic(ptr))) ct += 20;
		if (ct > 0 && (Race_if(PM_AK_THIEF_IS_DEAD_) && is_cowmonster(ptr))) ct += 10;
		if (ct > 0 && (Race_if(PM_AK_THIEF_IS_DEAD_) && is_jokemonster(ptr))) ct += 10;
		if (ct > 0 && (Race_if(PM_ALCHEMIST) && is_covetous(ptr))) ct += 5;
		if (ct > 0 && (Race_if(PM_ALCHEMIST) && extra_nasty(ptr))) ct += 5;
		if (ct > 0 && (Race_if(PM_ANGBANDER) && is_angbandmonster(ptr))) ct += 5;
		if (ct > 0 && (Race_if(PM_ANGBANDER) && is_steammonster(ptr))) ct += 3;
		if (ct > 0 && (Race_if(PM_ANGBANDER) && is_animemonster(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_HUMANOID_ANGEL) && is_demon(ptr))) ct += 10;
		if (ct > 0 && (Race_if(PM_HUMANOID_ANGEL) && always_hostile(ptr))) ct += 4;
		if (ct > 0 && (Race_if(PM_HUMANOID_ANGEL) && extra_nasty(ptr))) ct += 1;
		if (ct > 0 && (isaquarian && is_swimmer(ptr))) ct += 5;
		if (ct > 0 && (Race_if(PM_BATMAN) && is_neuter(ptr))) ct += 20;
		if (ct > 0 && (Race_if(PM_BATMAN) && is_animal(ptr))) ct += 5;
		if (ct > 0 && (Race_if(PM_CHIROPTERAN) && is_dnethackmonster(ptr))) ct += 5;
		if (ct > 0 && (Race_if(PM_ETHEREALOID) && is_dnethackmonster(ptr))) ct += 10;
		if (ct > 0 && (Race_if(PM_INCORPOREALOID) && is_dnethackmonster(ptr))) ct += 10;
		if (ct > 0 && (Race_if(PM_CLOCKWORK_AUTOMATON) && is_dnethackmonster(ptr))) ct += 3;
		if (ct > 0 && (Race_if(PM_CLOCKWORK_AUTOMATON) && always_peaceful(ptr))) ct += 2;
		if (ct > 0 && (Race_if(PM_CORTEX) && unsolid(ptr))) ct += 2;
		if (ct > 0 && (Race_if(PM_CORTEX) && nolimbs(ptr))) ct += 5;
		if (ct > 0 && (Race_if(PM_DEATHMOLD) && is_angbandmonster(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_DEATHMOLD) && is_steammonster(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_DEATHMOLD) && is_animemonster(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_DOPPELGANGER) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_BORG) && is_jokemonster(ptr))) ct += 4;
		if (ct > 0 && (Race_if(PM_DROW) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_DWARF) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_ELF) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_GNOME) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_PLAYER_GREMLIN) && dmgtype(ptr, AD_DARK))) ct += 3;
		if (ct > 0 && (Race_if(PM_HERBALIST) && is_covetous(ptr))) ct += 5;
		if (ct > 0 && (Race_if(PM_HERBALIST) && extra_nasty(ptr))) ct += 5;
		if (ct > 0 && (Race_if(PM_BORG) && extra_nasty(ptr))) ct += 3;
		if (ct > 0 && (Race_if(PM_HOBBIT) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_HUMAN) && is_vanillamonster(ptr))) ct += 2;
		if (ct > 0 && (Race_if(PM_IMMUNIZER) && dmgtype(ptr, AD_CURS))) ct += 7;
		if (ct > 0 && (Race_if(PM_INCANTIFIER) && is_dnethackmonster(ptr))) ct += 3;
		if (ct > 0 && (Race_if(PM_INKA) && is_elf(ptr))) ct += 3;
		if (ct > 0 && (Race_if(PM_INSECTOID) && (ptr->msound == MS_BUZZ))) ct += 4;
		if (ct > 0 && (Race_if(PM_KOP) && always_tame(ptr))) ct += 5;
		if (ct > 0 && (Race_if(PM_HUMAN_WEREWOLF) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_MISSINGNO) && is_pokemon(ptr))) ct += 3;
		if (ct > 0 && (Race_if(PM_NAVI) && (ptr->msound == MS_SHOE))) ct += 2;
		if (ct > 0 && (Race_if(PM_ORC) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_PEACEMAKER) && always_hostile(ptr))) ct += 3;
		if (ct > 0 && (Race_if(PM_PEACEMAKER) && cannot_be_tamed(ptr))) ct += 2;
		if (ct > 0 && (isrougelike && is_vanillamonster(ptr))) ct += 5;
		if (ct > 0 && (Race_if(PM_SINNER) && dmgtype(ptr, AD_SSEX))) ct += 2;
		if (ct > 0 && (Race_if(PM_SKILLOR) && dmgtype(ptr, AD_SKIL))) ct += 5;
		if (ct > 0 && (issoviet && is_vanillamonster(ptr))) ct += 20;
		if (ct > 0 && (Race_if(PM_SPIRIT) && passes_walls(ptr))) ct += 2;
		if (ct > 0 && (Race_if(PM_WEAPON_TRAPPER) && dmgtype(ptr, AD_WEBS))) ct += 2;
		if (ct > 0 && (Race_if(PM_UNALIGNMENT_THING) && is_dnethackmonster(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_VAMPIRE) && is_vanillamonster(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_VENTURE_CAPITALIST) && likes_gold(ptr))) ct += 4;
		if (ct > 0 && (Race_if(PM_VORTEX) && unsolid(ptr))) ct += 5;
		if (ct > 0 && (Race_if(PM_VORTEX) && nolimbs(ptr))) ct += 12;
		if (ct > 0 && (iswindinhabitant && is_cowmonster(ptr))) ct += 5;
		if (ct > 0 && (iswindinhabitant && is_jokemonster(ptr))) ct += 2;
		if (ct > 0 && (Race_if(PM_WORM_THAT_WALKS) && is_dnethackmonster(ptr))) ct += 5;
		if (ct > 0 && (Race_if(PM_YUKI_PLAYA) && is_dnethackmonster(ptr))) ct += 5;
		if (ct > 0 && (Is_oracle_level(&u.uz) && (ptr->mlet == S_SNAKE))) ct += 3;
		if (ct > 0 && (Is_oracle_level(&u.uz) && (ptr->mlet == S_ELEMENTAL))) ct += 3;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_VAPO))) ct += 2;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_EDGE))) ct += 2;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_NGEN))) ct += 3;
		if (ct > 0 && (Race_if(PM_WEAPON_TRAPPER) && dmgtype(ptr, AD_TRAP))) ct += 1;
		if (ct > 0 && (Role_if(PM_ALTMER) && (ptr->msound == MS_STENCH))) ct += 1;
		if (ct > 0 && (Role_if(PM_ALTMER) && dmgtype(ptr, AD_WGHT))) ct += 2;
		if (ct > 0 && (Role_if(PM_CHAOS_SORCEROR) && dmgtype(ptr, AD_CHAO))) ct += 1;
		if (ct > 0 && (Role_if(PM_FAILED_EXISTENCE) && (ptr->msound == MS_STENCH))) ct += 2;
		if (ct > 0 && (Role_if(PM_MAHOU_SHOUJO) && (ptr->msound == MS_STENCH))) ct += 3;
		if (ct > 0 && (Role_if(PM_MONK) && dmgtype(ptr, AD_CAST))) ct += 1;
		if (ct > 0 && (Role_if(PM_MUSICIAN) && dmgtype(ptr, AD_MIDI))) ct += 2;
		if (ct > 0 && (Role_if(PM_PSION) && (ptr->msound == MS_STENCH))) ct += 4;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_RNG))) ct += 3;
		if (ct > 0 && (Role_if(PM_SHAPESHIFTER) && dmgtype(ptr, AD_RNG))) ct += 2;
		if (ct > 0 && (Role_if(PM_SHAPESHIFTER) && dmgtype(ptr, AD_MIDI))) ct += 2;
		if (ct > 0 && (Role_if(PM_SHAPESHIFTER) && dmgtype(ptr, AD_CAST))) ct += 2;
		if (ct > 0 && (Role_if(PM_WILD_TALENT) && dmgtype(ptr, AD_RNG))) ct += 3;
		if (ct > 0 && (Race_if(PM_ALCHEMIST) && (ptr->msound == MS_STENCH))) ct += 3;
		if (ct > 0 && (Race_if(PM_ALCHEMIST) && dmgtype(ptr, AD_RNG))) ct += 1;
		if (ct > 0 && (Race_if(PM_ALCHEMIST) && dmgtype(ptr, AD_LITT))) ct += 2;
		if (ct > 0 && (Race_if(PM_HUMANOID_ANGEL) && dmgtype(ptr, AD_CAST))) ct += 4;
		if (ct > 0 && (Race_if(PM_BORG) && dmgtype(ptr, AD_ICEB))) ct += 1;
		if (ct > 0 && (Race_if(PM_BORG) && dmgtype(ptr, AD_VOMT))) ct += 2;
		if (ct > 0 && (Race_if(PM_BORG) && dmgtype(ptr, AD_FREN))) ct += 5;
		if (ct > 0 && (Race_if(PM_BORG) && dmgtype(ptr, AD_INSA))) ct += 2;
		if (ct > 0 && (Race_if(PM_BORG) && dmgtype(ptr, AD_TRAP))) ct += 3;
		if (ct > 0 && (Race_if(PM_BORG) && dmgtype(ptr, AD_NTHR))) ct += 2;
		if (ct > 0 && (Race_if(PM_BORG) && dmgtype(ptr, AD_MIDI))) ct += 1;
		if (ct > 0 && (Race_if(PM_DEATHMOLD) && dmgtype(ptr, AD_MIDI))) ct += 2;
		if (ct > 0 && (Race_if(PM_DEATHMOLD) && dmgtype(ptr, AD_RNG))) ct += 3;
		if (ct > 0 && (Race_if(PM_DESTABILIZER) && dmgtype(ptr, AD_VAPO))) ct += 4;
		if (ct > 0 && (Race_if(PM_DESTABILIZER) && dmgtype(ptr, AD_EDGE))) ct += 2;
		if (ct > 0 && (Race_if(PM_DESTABILIZER) && dmgtype(ptr, AD_LITT))) ct += 1;
		if (ct > 0 && (Race_if(PM_DOPPELGANGER) && dmgtype(ptr, AD_RNG))) ct += 2;
		if (ct > 0 && (Race_if(PM_HEMI_DOPPELGANGER) && dmgtype(ptr, AD_RNG))) ct += 1;
		if (ct > 0 && (Race_if(PM_PLAYER_GOLEM) && dmgtype(ptr, AD_FAMN))) ct += 20;
		if (ct > 0 && (Race_if(PM_PLAYER_JABBERWOCK) && bigmonst(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_HERBALIST) && dmgtype(ptr, AD_LITT))) ct += 4;
		if (ct > 0 && (Race_if(PM_HERBALIST) && (ptr->msound == MS_STENCH))) ct += 5;
		if (ct > 0 && (Race_if(PM_RODNEYAN) && (ptr->msound == MS_STENCH))) ct += 4;
		if (ct > 0 && (Race_if(PM_RODNEYAN) && dmgtype(ptr, AD_CAST))) ct += 10;
		if (ct > 0 && (Race_if(PM_RODNEYAN) && dmgtype(ptr, AD_RNG))) ct += 4;
		if (ct > 0 && (Race_if(PM_HUMANOID_ANGEL) && dmgtype(ptr, AD_CONT))) ct += 10;
		if (ct > 0 && (Role_if(PM_ALTMER) && dmgtype(ptr, AD_CONT) )) ct += 5;
		if (ct > 0 && (Role_if(PM_ALTMER) && dmgtype(ptr, AD_MINA) )) ct += 2;
		if (ct > 0 && (Role_if(PM_ALTMER) && dmgtype(ptr, AD_AGGR) )) ct += 2;
		if (ct > 0 && (Role_if(PM_ASSASSIN) && dmgtype(ptr, AD_ALIN) )) ct += 1;
		if (ct > 0 && (Role_if(PM_BINDER) && dmgtype(ptr, AD_SIN) )) ct += 5;
		if (ct > 0 && (Role_if(PM_CONVICT) && dmgtype(ptr, AD_SIN) )) ct += 1;
		if (ct > 0 && (Role_if(PM_MURDERER) && dmgtype(ptr, AD_SIN) )) ct += 1;
		if (ct > 0 && (Role_if(PM_COURIER) && dmgtype(ptr, AD_AGGR) )) ct += 3;
		if (ct > 0 && (Role_if(PM_DQ_SLIME) && dmgtype(ptr, AD_CONT) )) ct += 1;
		if (ct > 0 && (Role_if(PM_FAILED_EXISTENCE) && dmgtype(ptr, AD_AGGR) )) ct += 2;
		if (ct > 0 && (Role_if(PM_KURWA) && dmgtype(ptr, AD_MINA) )) ct += 2;
		if (ct > 0 && (Role_if(PM_MAHOU_SHOUJO) && dmgtype(ptr, AD_AGGR) )) ct += 1;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_CONT) )) ct += 5;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_MINA) )) ct += 10;
		if (ct > 0 && (Role_if(PM_SCIENTIST) && dmgtype(ptr, AD_CONT) )) ct += 4;
		if (ct > 0 && (Role_if(PM_SHAPESHIFTER) && dmgtype(ptr, AD_CONT) )) ct += 5;
		if (ct > 0 && (Role_if(PM_SHAPESHIFTER) && dmgtype(ptr, AD_MINA) )) ct += 3;
		if (ct > 0 && (Role_if(PM_SHAPESHIFTER) && dmgtype(ptr, AD_SIN) )) ct += 2;
		if (ct > 0 && (Role_if(PM_UNBELIEVER) && dmgtype(ptr, AD_ALIN) )) ct += 2;
		if (ct > 0 && (Role_if(PM_ZYBORG) && dmgtype(ptr, AD_CONT) )) ct += 1;
		if (ct > 0 && (Race_if(PM_ALBAE) && dmgtype(ptr, AD_AGGR) )) ct += 5;
		if (ct > 0 && (Race_if(PM_ALCHEMIST) && dmgtype(ptr, AD_CONT) )) ct += 5;
		if (ct > 0 && (Race_if(PM_DOPPELGANGER) && dmgtype(ptr, AD_CONT) )) ct += 3;
		if (ct > 0 && (Race_if(PM_DOPPELGANGER) && dmgtype(ptr, AD_AGGR) )) ct += 5;
		if (ct > 0 && (Race_if(PM_HERBALIST) && dmgtype(ptr, AD_CONT) )) ct += 5;
		if (ct > 0 && (Race_if(PM_IMMUNIZER) && dmgtype(ptr, AD_CONT) )) ct += 5;
		if (ct > 0 && (Race_if(PM_IMMUNIZER) && dmgtype(ptr, AD_AGGR) )) ct += 5;
		if (ct > 0 && (Race_if(PM_RODNEYAN) && dmgtype(ptr, AD_CONT) )) ct += 7;
		if (ct > 0 && (Race_if(PM_RODNEYAN) && dmgtype(ptr, AD_MINA) )) ct += 6;
		if (ct > 0 && (Race_if(PM_SINNER) && dmgtype(ptr, AD_SIN) )) ct += 2;
		if (ct > 0 && (Race_if(PM_SPIRIT) && dmgtype(ptr, AD_AGGR) )) ct += 6;
		if (ct > 0 && (Role_if(PM_FEMINIST) && is_male(ptr) )) ct += 2;
		if (ct > 0 && (Role_if(PM_FEMINIST) && attacktype(ptr, AT_LASH) )) ct += 3;
		if (ct > 0 && (Role_if(PM_GANG_SCHOLAR) && (ptr->msound == MS_FART_NORMAL) )) ct += 20;
		if (ct > 0 && (Role_if(PM_GANG_SCHOLAR) && (ptr->msound == MS_FART_QUIET) )) ct += 20;
		if (ct > 0 && (Role_if(PM_GANG_SCHOLAR) && (ptr->msound == MS_FART_LOUD) )) ct += 20;
		if (ct > 0 && (Role_if(PM_GANG_SCHOLAR) && (ptr->msound == MS_STENCH) )) ct += 50;
		if (ct > 0 && (Role_if(PM_GANG_SCHOLAR) && is_jokemonster(ptr) )) ct += 100;
		if (ct > 0 && (Role_if(PM_GANG_SCHOLAR) && is_cowmonster(ptr) )) ct += 20;
		if (ct > 0 && (FemtrapActiveAriane && (ptr->msound == MS_FART_NORMAL) )) ct += 20;
		if (ct > 0 && (FemtrapActiveAriane && (ptr->msound == MS_FART_QUIET) )) ct += 20;
		if (ct > 0 && (FemtrapActiveAriane && (ptr->msound == MS_FART_LOUD) )) ct += 20;
		if (ct > 0 && (FemtrapActiveAriane && (ptr->msound == MS_STENCH) )) ct += 50;
		if (ct > 0 && (FemtrapActiveAriane && is_jokemonster(ptr) )) ct += 100;
		if (ct > 0 && (FemtrapActiveAriane && is_cowmonster(ptr) )) ct += 20;
		if (ct > 0 && (Role_if(PM_WALSCHOLAR) && is_jokemonster(ptr) )) ct += 20;
		if (ct > 0 && (Role_if(PM_WALSCHOLAR) && (ptr->msound == MS_FART_NORMAL) )) ct += 5;
		if (ct > 0 && (Role_if(PM_WALSCHOLAR) && (ptr->msound == MS_FART_QUIET) )) ct += 5;
		if (ct > 0 && (Role_if(PM_WALSCHOLAR) && (ptr->msound == MS_FART_LOUD) )) ct += 5;
		if (ct > 0 && (Role_if(PM_WALSCHOLAR) && (ptr->msound == MS_STENCH) )) ct += 20;
		if (ct > 0 && (Role_if(PM_WALSCHOLAR) && (ptr->msound == MS_CONVERT) )) ct += 5;
		if (ct > 0 && (Role_if(PM_WALSCHOLAR) && (ptr->msound == MS_HCALIEN) )) ct += 5;
		if (ct > 0 && (Role_if(PM_SINGSLAVE) && (ptr->msound == MS_SING) )) ct += 25;
		if (ct > 0 && (Role_if(PM_CELLAR_CHILD) && is_angbandmonster(ptr) )) ct += 20;
		if (ct > 0 && (uamul && uamul->oartifact == ART_WALT_VERSUS_ANNA && (ptr->msound == MS_FART_NORMAL) )) ct += 5;
		if (ct > 0 && (uamul && uamul->oartifact == ART_WALT_VERSUS_ANNA && (ptr->msound == MS_FART_QUIET) )) ct += 5;
		if (ct > 0 && (uamul && uamul->oartifact == ART_WALT_VERSUS_ANNA && (ptr->msound == MS_FART_LOUD) )) ct += 5;
		if (ct > 0 && (uamul && uamul->oartifact == ART_WALT_VERSUS_ANNA && (ptr->msound == MS_STENCH) )) ct += 20;
		if (ct > 0 && (Role_if(PM_DEMAGOGUE) && (ptr->mlet == S_KOP))) ct += 5;
		if (ct > 0 && (Role_if(PM_DEMAGOGUE) && (ptr->mresists & MR_PLUSFOUR))) ct += 1;
		if (ct > 0 && (Role_if(PM_SOCIAL_JUSTICE_WARRIOR) && (ptr->mflags2 & M2_DEMON) )) ct += 5;
		if (ct > 0 && (Role_if(PM_DEMAGOGUE) && (ptr->mflags3 & M3_NOTAME) )) ct += 2;
		if (ct > 0 && (Race_if(PM_DEMAGOGUE) && dmgtype(ptr, AD_WTHR) )) ct += 2;
		if (ct > 0 && (Race_if(PM_DEMAGOGUE) && dmgtype(ptr, AD_LETH) )) ct += 1;
		if (ct > 0 && (Race_if(PM_DEMAGOGUE) && dmgtype(ptr, AD_CNCL) )) ct += 2;
		if (ct > 0 && (Race_if(PM_DEMAGOGUE) && dmgtype(ptr, AD_SIN) )) ct += 2;
		if (ct > 0 && (Race_if(PM_DEMAGOGUE) && dmgtype(ptr, AD_DEST) )) ct += 2;
		if (ct > 0 && (Race_if(PM_DEMAGOGUE) && dmgtype(ptr, AD_AGGR) )) ct += 5;
		if (ct > 0 && (Race_if(PM_CELLAR_CHILD) && dmgtype(ptr, AD_SANI) )) ct += 5;
		if (ct > 0 && (Race_if(PM_SOCIAL_JUSTICE_WARRIOR) && dmgtype(ptr, AD_BANI) )) ct += 1;
		if (ct > 0 && (Race_if(PM_SOCIAL_JUSTICE_WARRIOR) && dmgtype(ptr, AD_DFOO) )) ct += 2;
		if (ct > 0 && (Race_if(PM_HUMANOID_ANGEL) && is_evilpatchmonster(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_PSION) && is_evilpatchmonster(ptr))) ct += 10;
		if (ct > 0 && (Race_if(PM_DOPPELGANGER) && is_evilpatchmonster(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_ALTMER) && is_evilpatchmonster(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_DATA) )) ct += 1;
		if (ct > 0 && (uwep && uwep->oartifact == ART_RAFSCHAR_S_SUPERWEAPON && dmgtype(ptr, AD_DATA) )) ct += 1000;
		if (ct > 0 && (uswapwep && uswapwep->oartifact == ART_RAFSCHAR_S_SUPERWEAPON && dmgtype(ptr, AD_DATA) )) ct += 1000;
		if (ct > 0 && (Role_if(PM_SHAPESHIFTER) && is_evilpatchmonster(ptr))) ct += 5;
		if (ct > 0 && (Race_if(PM_RODNEYAN) && is_evilpatchmonster(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_SOFTWARE_ENGINEER) && is_evilpatchmonster(ptr))) ct += 3;
		if (ct > 0 && (Role_if(PM_CRACKER) && is_evilpatchmonster(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_JANITOR) && is_evilpatchmonster(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_SPACE_MARINE) && is_evilpatchmonster(ptr))) ct += 10;
		if (ct > 0 && (Role_if(PM_QUARTERBACK) && is_evilpatchmonster(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_PSYKER) && is_evilpatchmonster(ptr))) ct += 10;
		if (ct > 0 && (Role_if(PM_EMPATH) && is_evilpatchmonster(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_MASTERMIND) && is_evilpatchmonster(ptr))) ct += 3;
		if (ct > 0 && (Role_if(PM_ASTRONAUT) && is_evilpatchmonster(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_CYBERNINJA) && is_evilpatchmonster(ptr))) ct += 3;
		if (ct > 0 && (Role_if(PM_SOFTWARE_ENGINEER) && (ptr->mlet == S_XAN))) ct += 5;
		if (ct > 0 && (Role_if(PM_CRACKER) && (ptr->maligntyp < 0))) ct += 4;
		if (ct > 0 && (Role_if(PM_CRACKER) && (ptr->mlet == S_LICH))) ct += 2;
		if (ct > 0 && (Role_if(PM_CRACKER) && (ptr->mlet == S_KOP))) ct += 3;
		if (ct > 0 && (Role_if(PM_JANITOR) && !(ptr->mflags1 & M1_METALLIVORE) && !(ptr->mflags3 & M3_LITHIVORE) && !(ptr->mflags4 & M4_ORGANIVORE) )) ct += 5;
		if (ct > 0 && (Role_if(PM_JANITOR) && dmgtype(ptr, AD_TRAP))) ct += 5;
		if (ct > 0 && (Role_if(PM_JANITOR) && dmgtype(ptr, AD_WEBS))) ct += 3;
		if (ct > 0 && (Role_if(PM_STORMBOY) && is_swimmer(ptr))) ct += 4;
		if (ct > 0 && (Role_if(PM_STORMBOY) && breathless(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_STORMBOY) && amphibious(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_STORMBOY) && is_elf(ptr))) ct += 10;
		if (ct > 0 && (Role_if(PM_STORMBOY) && (ptr->maligntyp > 0) )) ct += 7;
		if (ct > 0 && (Role_if(PM_STORMBOY) && (ptr->mlet == S_HUMAN))) ct += 3;
		if (ct > 0 && (Role_if(PM_YAUTJA) && is_animal(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_YAUTJA) && extra_nasty(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_YAUTJA) && dmgtype(ptr, AD_DGST))) ct += 4;
		if (ct > 0 && (Role_if(PM_QUARTERBACK) && attacktype(ptr, AT_WEAP))) ct += 7;
		if (ct > 0 && (Role_if(PM_QUARTERBACK) && dmgtype(ptr, AD_PAIN))) ct += 2;
		if (ct > 0 && (Role_if(PM_PSYKER) && does_need_four(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_PSYKER) && does_hit_as_four(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_PSYKER) && passes_walls(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_PSYKER) && strongmonst(ptr))) ct += 3;
		if (ct > 0 && (Role_if(PM_PSYKER) && extra_nasty(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_PSYKER) && is_covetous(ptr))) ct += 3;
		if (ct > 0 && (Role_if(PM_PSYKER) && is_shade(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_PSYKER) && (ptr->msound == MS_SHRIEK))) ct += 1;
		if (ct > 0 && (Role_if(PM_PSYKER) && attacktype(ptr, AT_MAGC))) ct += 3;
		if (ct > 0 && (Role_if(PM_PSYKER) && dmgtype(ptr, AD_POLY))) ct += 1;
		if (ct > 0 && (Role_if(PM_PSYKER) && dmgtype(ptr, AD_DREA))) ct += 2;
		if (ct > 0 && (Role_if(PM_PSYKER) && dmgtype(ptr, AD_BADE))) ct += 2;
		if (ct > 0 && (Role_if(PM_PSYKER) && dmgtype(ptr, AD_WISD))) ct += 2;
		if (ct > 0 && (Role_if(PM_PSYKER) && dmgtype(ptr, AD_SIN))) ct += 2;
		if (ct > 0 && (Role_if(PM_EMPATH) && (ptr->mflags2 & M2_PEACEFUL) )) ct += 4;
		if (ct > 0 && (Role_if(PM_EMPATH) && dmgtype(ptr, AD_HEAL))) ct += 2;
		if (ct > 0 && (Role_if(PM_MASTERMIND) && dmgtype(ptr, AD_DRIN))) ct += 3;
		if (ct > 0 && (Role_if(PM_MASTERMIND) && dmgtype(ptr, AD_NAST))) ct += 2;
		if (ct > 0 && (Role_if(PM_MASTERMIND) && dmgtype(ptr, AD_MINA))) ct += 2;
		if (ct > 0 && (Role_if(PM_MASTERMIND) && dmgtype(ptr, AD_RUNS))) ct += 2;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_SPC2) )) ct += 15;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_STUN) )) ct += 7;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_DRIN) )) ct += 5;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_HALU) )) ct += 8;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_DARK) )) ct += 5;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_FEAR) )) ct += 4;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_FAKE) )) ct += 7;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_LETH) )) ct += 2;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_CNCL) )) ct += 1;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_BLAS) )) ct += 1;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_BANI) )) ct += 2;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_WISD) )) ct += 3;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_HODS) )) ct += 3;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_CHRN) )) ct += 7;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_WEEP) )) ct += 2;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_STTP) )) ct += 1;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_DEPR) )) ct += 5;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_LAZY) )) ct += 5;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_INER) )) ct += 3;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_VULN) )) ct += 4;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_AMNE) )) ct += 10;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_INSA) )) ct += 10;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_SANI) )) ct += 10;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_TRAP) )) ct += 8;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_SHAN) )) ct += 8;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_TERR) )) ct += 10;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_FEMI) )) ct += 4;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_LEVI) )) ct += 7;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_MCRE) )) ct += 5;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_DEBU) )) ct += 5;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_UNPR) )) ct += 10;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && dmgtype(ptr, AD_ILLU) )) ct += 20;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && shapechanger(ptr) )) ct += 5;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && is_angbandmonster(ptr) )) ct += 3;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && is_animemonster(ptr) )) ct += 1;
		if (ct > 0 && (Role_if(PM_WEIRDBOY) && is_steammonster(ptr) )) ct += 1;
		if (ct > 0 && (Role_if(PM_ASTRONAUT) && is_flyer(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_ASTRONAUT) && bigmonst(ptr))) ct += 3;
		if (ct > 0 && (Role_if(PM_ASTRONAUT) && hugemonst(ptr))) ct += 4;
		if (ct > 0 && (Role_if(PM_ASTRONAUT) && strongmonst(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_ASTRONAUT) && (ptr->mlet == S_GRUE))) ct += 2;
		if (ct > 0 && (Role_if(PM_ASTRONAUT) && (ptr->mlet == S_WORM_TAIL))) ct += 1;
		if (ct > 0 && (Role_if(PM_ASTRONAUT) && (ptr->mlet == S_WALLMONST))) ct += 2;
		if (ct > 0 && (Role_if(PM_ASTRONAUT) && (ptr->mlet == S_GOLEM))) ct += 1;
		if (ct > 0 && (Role_if(PM_CYBERNINJA) && (ptr->mflags2 & M2_STALK))) ct += 4;
		if (ct > 0 && (Role_if(PM_DISSIDENT) && is_lord(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_DISSIDENT) && is_prince(ptr))) ct += 15;
		if (ct > 0 && (Role_if(PM_DISSIDENT) && type_is_pname(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_XELNAGA) && is_death_resistant(ptr))) ct += 3;
		if (ct > 0 && (Role_if(PM_XELNAGA) && amorphous(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_XELNAGA) && is_silent(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_XELNAGA) && thick_skinned(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_XELNAGA) && shapechanger(ptr))) ct += 4;
		if (ct > 0 && (Role_if(PM_XELNAGA) && your_race(ptr))) ct += 4;
		if (ct > 0 && (Role_if(PM_XELNAGA) && always_hostile(ptr))) ct += 7;
		if (ct > 0 && (Role_if(PM_XELNAGA) && extra_nasty(ptr))) ct += 10;
		if (ct > 0 && (Role_if(PM_XELNAGA) && strongmonst(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_XELNAGA) && cannot_be_tamed(ptr))) ct += 4;
		if (ct > 0 && (Role_if(PM_XELNAGA) && is_mplayer(ptr))) ct += 3;
		if (ct > 0 && (Role_if(PM_XELNAGA) && is_umplayer(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_XELNAGA) && slime_on_touch(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_XELNAGA) && uncommon2(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_XELNAGA) && uncommon3(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_XELNAGA) && uncommon5(ptr))) ct += 3;
		if (ct > 0 && (Role_if(PM_XELNAGA) && uncommon7(ptr))) ct += 4;
		if (ct > 0 && (Role_if(PM_XELNAGA) && uncommon10(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_XELNAGA) && dmgtype(ptr, AD_DISN))) ct += 1;
		if (ct > 0 && (Role_if(PM_XELNAGA) && dmgtype(ptr, AD_LUCK))) ct += 2;
		if (ct > 0 && (Role_if(PM_XELNAGA) && dmgtype(ptr, AD_INER))) ct += 2;
		if (ct > 0 && (Role_if(PM_XELNAGA) && dmgtype(ptr, AD_NEXU))) ct += 2;
		if (ct > 0 && (Role_if(PM_XELNAGA) && dmgtype(ptr, AD_LETH))) ct += 1;
		if (ct > 0 && (Role_if(PM_XELNAGA) && dmgtype(ptr, AD_UVUU))) ct += 1;
		if (ct > 0 && (Role_if(PM_XELNAGA) && dmgtype(ptr, AD_IDAM))) ct += 1;
		if (ct > 0 && (Role_if(PM_XELNAGA) && dmgtype(ptr, AD_TRAI))) ct += 1;
		if (ct > 0 && (Role_if(PM_XELNAGA) && dmgtype(ptr, AD_SANI))) ct += 3;
		if (ct > 0 && (Role_if(PM_XELNAGA) && dmgtype(ptr, AD_SAMU))) ct += 3;
		if (ct > 0 && (Role_if(PM_XELNAGA) && dmgtype(ptr, AD_CHAO))) ct += 2;
		if (ct > 0 && flags.friday13 && is_evilpatchmonster(ptr)) ct += 25;
		if (ct > 0 && (flags.friday13 && dmgtype(ptr, AD_STAT) )) ct += 2;
		if (ct > 0 && (flags.friday13 && dmgtype(ptr, AD_DAMA) )) ct += 2;
		if (ct > 0 && (flags.friday13 && dmgtype(ptr, AD_THIE) )) ct += 2;
		if (ct > 0 && (flags.friday13 && dmgtype(ptr, AD_DATA) )) ct += 1;
		if (ct > 0 && (flags.friday13 && dmgtype(ptr, AD_RAGN) )) ct += 20;
		if (ct > 0 && (flags.friday13 && dmgtype(ptr, AD_DEST) )) ct += 2;
		if (ct > 0 && flags.elmstreet && is_evilpatchmonster(ptr)) ct += 25;
		if (ct > 0 && (flags.elmstreet && dmgtype(ptr, AD_STAT) )) ct += 2;
		if (ct > 0 && (flags.elmstreet && dmgtype(ptr, AD_DAMA) )) ct += 2;
		if (ct > 0 && (flags.elmstreet && dmgtype(ptr, AD_THIE) )) ct += 2;
		if (ct > 0 && (flags.elmstreet && dmgtype(ptr, AD_DATA) )) ct += 1;
		if (ct > 0 && (flags.elmstreet && dmgtype(ptr, AD_RAGN) )) ct += 20;
		if (ct > 0 && (flags.elmstreet && dmgtype(ptr, AD_DEST) )) ct += 2;
		if (ct > 0 && (Race_if(PM_RODNEYAN) && dmgtype(ptr, AD_DATA) )) ct += 1;
		if (ct > 0 && (isevilvariant && dmgtype(ptr, AD_DATA) )) ct += 20;
		if (ct > 0 && (isevilvariant && is_evilpatchmonster(ptr) )) ct += 100;
		if (ct > 0 && (isevilvariant && dmgtype(ptr, AD_RAGN) )) ct += 20;
		if (ct > 0 && (isevilvariant && dmgtype(ptr, AD_DEST) )) ct += 5;
		if (ct > 0 && (Role_if(PM_HUSSY) && is_demon(ptr) )) ct += 30;
		if (ct > 0 && (Role_if(PM_HUSSY) && is_demon(ptr) && (ptr)->geno & G_UNIQ)) ct += 100;
		if (ct > 0 && (Role_if(PM_COURIER) && dmgtype(ptr, AD_IDAM) )) ct += 1;
		if (ct > 0 && (Role_if(PM_MURDERER) && dmgtype(ptr, AD_STAT) )) ct += 2;
		if (ct > 0 && (Role_if(PM_NUCLEAR_PHYSICIST) && dmgtype(ptr, AD_PAIN) )) ct += 1;
		if (ct > 0 && (uarmf && itemhasappearance(uarmf, APP_PRINCESS_PUMPS) && attacktype(ptr, AT_SCRA) )) ct += 2;
		if (ct > 0 && (uarmf && itemhasappearance(uarmf, APP_PRINCESS_PUMPS) && attacktype(ptr, AT_LASH) )) ct += 2;
		if (ct > 0 && (uarmf && itemhasappearance(uarmf, APP_PRINCESS_PUMPS) && attacktype(ptr, AT_STNG) )) ct += 2;
		if (ct > 0 && uarmh && itemhasappearance(uarmh, APP_GRUNTER_HELMET) && dmgtype(ptr, AD_DISE) ) ct += 5;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_IDAM) )) ct += 2;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_ANTI) )) ct += 5;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_TECH) )) ct += 2;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_MEMO) )) ct += 5;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_TRAI) )) ct += 10;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_STAT) )) ct += 10;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_DAMA) )) ct += 5;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_THIE) )) ct += 5;
		if (ct > 0 && (Role_if(PM_SHAPESHIFTER) && dmgtype(ptr, AD_IDAM) )) ct += 2;
		if (ct > 0 && (Role_if(PM_SHAPESHIFTER) && dmgtype(ptr, AD_STAT) )) ct += 3;
		if (ct > 0 && (Race_if(PM_AK_THIEF_IS_DEAD_) && dmgtype(ptr, AD_DAMA) )) ct += 2;
		if (ct > 0 && (Race_if(PM_AK_THIEF_IS_DEAD_) && dmgtype(ptr, AD_THIE) )) ct += 2;
		if (ct > 0 && (Race_if(PM_ALBAE) && dmgtype(ptr, AD_ANTI) )) ct += 1;
		if (ct > 0 && (Race_if(PM_ALBAE) && dmgtype(ptr, AD_STAT) )) ct += 3;
		if (ct > 0 && (Race_if(PM_ALCHEMIST) && dmgtype(ptr, AD_IDAM) )) ct += 2;
		if (ct > 0 && (Race_if(PM_HUMANOID_ANGEL) && dmgtype(ptr, AD_PAIN) )) ct += 3;
		if (ct > 0 && (Race_if(PM_HUMANOID_ANGEL) && dmgtype(ptr, AD_MEMO) )) ct += 10;
		if (ct > 0 && (Race_if(PM_HUMANOID_ANGEL) && dmgtype(ptr, AD_TRAI) )) ct += 5;
		if (ct > 0 && (Race_if(PM_HUMANOID_ANGEL) && dmgtype(ptr, AD_STAT) )) ct += 2;
		if (ct > 0 && (Race_if(PM_HUMANOID_ANGEL) && dmgtype(ptr, AD_DAMA) )) ct += 1;
		if (ct > 0 && (Race_if(PM_HUMANOID_ANGEL) && dmgtype(ptr, AD_THIE) )) ct += 2;
		if (ct > 0 && (Race_if(PM_DEATHMOLD) && dmgtype(ptr, AD_ANTI) )) ct += 1;
		if (ct > 0 && (Race_if(PM_DOPPELGANGER) && dmgtype(ptr, AD_TRAI) )) ct += 2;
		if (ct > 0 && (isevilvariant && dmgtype(ptr, AD_STAT) )) ct += 5;
		if (ct > 0 && (isevilvariant && dmgtype(ptr, AD_DAMA) )) ct += 3;
		if (ct > 0 && (isevilvariant && dmgtype(ptr, AD_THIE) )) ct += 3;
		if (ct > 0 && (Race_if(PM_HERBALIST) && dmgtype(ptr, AD_MEMO) )) ct += 5;
		if (ct > 0 && (Race_if(PM_HERBALIST) && dmgtype(ptr, AD_TRAI) )) ct += 3;
		if (ct > 0 && (Race_if(PM_PEACEMAKER) && dmgtype(ptr, AD_DAMA) )) ct += 4;
		if (ct > 0 && (Race_if(PM_RODNEYAN) && dmgtype(ptr, AD_ANTI) )) ct += 2;
		if (ct > 0 && (Race_if(PM_RODNEYAN) && dmgtype(ptr, AD_MEMO) )) ct += 5;
		if (ct > 0 && (Race_if(PM_RODNEYAN) && dmgtype(ptr, AD_STAT) )) ct += 4;
		if (ct > 0 && (Race_if(PM_RODNEYAN) && dmgtype(ptr, AD_DAMA) )) ct += 3;
		if (ct > 0 && (Race_if(PM_RODNEYAN) && dmgtype(ptr, AD_THIE) )) ct += 7;
		if (ct > 0 && (Race_if(PM_SPIRIT) && dmgtype(ptr, AD_MEMO) )) ct += 6;
		if (ct > 0 && (Race_if(PM_SPIRIT) && dmgtype(ptr, AD_TRAI) )) ct += 3;
		if (ct > 0 && (Race_if(PM_SPIRIT) && dmgtype(ptr, AD_THIE) )) ct += 3;
		if (ct > 0 && (Race_if(PM_WEAPON_XORN) && dmgtype(ptr, AD_IDAM) )) ct += 4;
		if (ct > 0 && (Race_if(PM_WEAPON_XORN) && dmgtype(ptr, AD_ANTI) )) ct += 3;
		if (ct > 0 && (Race_if(PM_WEAPON_XORN) && dmgtype(ptr, AD_TECH) )) ct += 1;
		if (ct > 0 && (Race_if(PM_WEAPON_XORN) && dmgtype(ptr, AD_DAMA) )) ct += 2;

		if (ct > 0 && (Role_if(PM_ALTMER) && dmgtype(ptr, AD_RBAD) )) ct += 1;
		if (ct > 0 && (Role_if(PM_ANACHRONIST) && dmgtype(ptr, AD_TERR) )) ct += 1;
		if (ct > 0 && (Role_if(PM_ANACHRONOUNBINDER) && dmgtype(ptr, AD_ILLU) )) ct += 2;
		if (ct > 0 && (Role_if(PM_ASTRONAUT) && dmgtype(ptr, AD_LEVI) )) ct += 1;
		if (ct > 0 && (Role_if(PM_BLEEDER) && dmgtype(ptr, AD_BLEE) )) ct += 5;
		if (ct > 0 && (Role_if(PM_CELLAR_CHILD) && dmgtype(ptr, AD_RBAD) )) ct += 2;
		if (ct > 0 && (Role_if(PM_CHAOS_SORCEROR) && dmgtype(ptr, AD_TERR) )) ct += 1;
		if (ct > 0 && (Role_if(PM_CRACKER) && dmgtype(ptr, AD_SHAN) )) ct += 2;
		if (ct > 0 && (Role_if(PM_CRUEL_ABUSER) && dmgtype(ptr, AD_FEMI) )) ct += 3;
		if (ct > 0 && (Role_if(PM_GAMER) && dmgtype(ptr, AD_SCOR) )) ct += 3;
		if (ct > 0 && (Role_if(PM_GOFF) && dmgtype(ptr, AD_ILLU) )) ct += 2;
		if (ct > 0 && (Role_if(PM_GOFF) && dmgtype(ptr, AD_BLEE) )) ct += 3;
		if (ct > 0 && (Role_if(PM_GRENADONIN) && dmgtype(ptr, AD_RBAD) )) ct += 1;
		if (ct > 0 && (isevilvariant && dmgtype(ptr, AD_NACU) )) ct += 10;
		if (ct > 0 && (Role_if(PM_LUNATIC) && dmgtype(ptr, AD_ILLU) )) ct += 2;
		if (ct > 0 && (Role_if(PM_MAHOU_SHOUJO) && dmgtype(ptr, AD_SHAN) )) ct += 2;
		if (ct > 0 && (Role_if(PM_MEDIUM) && dmgtype(ptr, AD_LEVI) )) ct += 1;
		if (ct > 0 && (Role_if(PM_OCCULT_MASTER) && dmgtype(ptr, AD_ILLU) )) ct += 2;
		if (ct > 0 && (Role_if(PM_POLITICIAN) && dmgtype(ptr, AD_FEMI) )) ct += 3;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_RBAD) )) ct += 1;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_ILLU) )) ct += 3;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_SHAN) )) ct += 1;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_LEVI) )) ct += 1;
		if (ct > 0 && (Role_if(PM_ROCKER) && dmgtype(ptr, AD_TERR) )) ct += 2;
		if (ct > 0 && (Role_if(PM_SHAPESHIFTER) && dmgtype(ptr, AD_RBAD) )) ct += 4;
		if (ct > 0 && (Role_if(PM_SOCIAL_JUSTICE_WARRIOR) && dmgtype(ptr, AD_BLEE) )) ct += 3;
		if (ct > 0 && (Role_if(PM_TRANSSYLVANIAN) && dmgtype(ptr, AD_FEMI) )) ct += 4;
		if (ct > 0 && (Role_if(PM_TRANSVESTITE) && dmgtype(ptr, AD_FEMI) )) ct += 4;
		if (ct > 0 && (Role_if(PM_STAND_USER) && dmgtype(ptr, AD_TERR) )) ct += 3;
		if (ct > 0 && (Role_if(PM_STAND_USER) && dmgtype(ptr, AD_LEVI) )) ct += 1;
		if (ct > 0 && (Role_if(PM_WALSCHOLAR) && dmgtype(ptr, AD_FEMI) )) ct += 6;
		if (ct > 0 && (Role_if(PM_XELNAGA) && dmgtype(ptr, AD_ILLU) )) ct += 3;
		if (ct > 0 && (Role_if(PM_XELNAGA) && dmgtype(ptr, AD_FEMI) )) ct += 1;
		if (ct > 0 && (Role_if(PM_YAUTJA) && dmgtype(ptr, AD_SHAN) )) ct += 3;
		if (ct > 0 && (Race_if(PM_ALBAE) && dmgtype(ptr, AD_RBAD) )) ct += 1;
		if (ct > 0 && (Race_if(PM_HUMANOID_ANGEL) && dmgtype(ptr, AD_LEVI) )) ct += 5;
		if (ct > 0 && (Race_if(PM_ASURA) && is_elonamonster(ptr) )) ct += 1;
		if (ct > 0 && (Race_if(PM_PLAYER_FAIRY) && is_elonamonster(ptr) )) ct += 3;
		if (ct > 0 && (Race_if(PM_BASTARD) && dmgtype(ptr, AD_SHAN) )) ct += 1;
		if (ct > 0 && (Race_if(PM_BATMAN) && dmgtype(ptr, AD_FEMI) )) ct += 2;
		if (ct > 0 && (Race_if(PM_BATMAN) && dmgtype(ptr, AD_TERR) )) ct += 1;
		if (ct > 0 && (Race_if(PM_BORG) && dmgtype(ptr, AD_ILLU) )) ct += 2;
		if (ct > 0 && (Race_if(PM_BURNINATOR) && dmgtype(ptr, AD_BLEE) )) ct += 2;
		if (ct > 0 && (Race_if(PM_DOPPELGANGER) && dmgtype(ptr, AD_RBAD) )) ct += 1;
		if (ct > 0 && (Race_if(PM_HERBALIST) && dmgtype(ptr, AD_BLEE) )) ct += 5;
		if (ct > 0 && (Race_if(PM_PLAYER_JABBERWOCK) && dmgtype(ptr, AD_RBAD) )) ct += 2;
		if (ct > 0 && (Race_if(PM_LOLI) && dmgtype(ptr, AD_FEMI) )) ct += 5;
		if (ct > 0 && (Race_if(PM_METAL) && is_elonamonster(ptr) )) ct += 20;
		if (ct > 0 && (Race_if(PM_PLAYER_MIMIC) && dmgtype(ptr, AD_ILLU) )) ct += 4;
		if (ct > 0 && (Race_if(PM_PLAYER_MUSHROOM) && is_elonamonster(ptr) )) ct += 5;
		if (ct > 0 && (Race_if(PM_PEACEMAKER) && dmgtype(ptr, AD_SHAN) )) ct += 3;
		if (ct > 0 && (Race_if(PM_RODNEYAN) && dmgtype(ptr, AD_ILLU) )) ct += 3;
		if (ct > 0 && (Race_if(PM_SCURRIER) && dmgtype(ptr, AD_SHAN) )) ct += 2;
		if (ct > 0 && (Race_if(PM_SHELL) && is_elonamonster(ptr) )) ct += 8;
		if (ct > 0 && (Race_if(PM_SPIRIT) && dmgtype(ptr, AD_LEVI) )) ct += 2;

		if (ct > 0 && (Race_if(PM_INHERITOR) && is_dnethackmonster(ptr) )) ct += 10;
		if (ct > 0 && (Race_if(PM_PLAYER_MYRKALFR) && is_dnethackmonster(ptr))) ct += 10;
		if (ct > 0 && (Race_if(PM_PLAYER_MYRKALFR) && attacktype(ptr, AT_MAGC))) ct += 5;
		if (ct > 0 && (Race_if(PM_PLAYER_ANDROID) && is_dnethackmonster(ptr))) ct += 15;
		if (ct > 0 && (Race_if(PM_PLAYER_ANDROID) && dmgtype(ptr, AD_TERR) )) ct += 1;
		if (ct > 0 && (Race_if(PM_PLAYER_ANDROID) && (ptr->geno & G_NOCORPSE) )) ct += 5;
		if (ct > 0 && (Race_if(PM_RETICULAN) && is_evilpatchmonster(ptr))) ct += 7;
		if (ct > 0 && (Race_if(PM_RETICULAN) && dmgtype(ptr, AD_DRIN))) ct += 2;
		if (ct > 0 && (Race_if(PM_RETICULAN) && dmgtype(ptr, AD_NAST))) ct += 1;
		if (ct > 0 && (Race_if(PM_RETICULAN) && dmgtype(ptr, AD_MINA))) ct += 1;
		if (ct > 0 && (Race_if(PM_RETICULAN) && dmgtype(ptr, AD_RUNS))) ct += 1;
		if (ct > 0 && (Race_if(PM_RETICULAN) && dmgtype(ptr, AD_INSA))) ct += 4;
		if (ct > 0 && (Race_if(PM_RETICULAN) && dmgtype(ptr, AD_SANI))) ct += 6;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && is_evilpatchmonster(ptr))) ct += 5;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && is_death_resistant(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && amorphous(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && thick_skinned(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && shapechanger(ptr))) ct += 2;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && always_hostile(ptr))) ct += 4;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && extra_nasty(ptr))) ct += 5;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && strongmonst(ptr))) ct += 3;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && cannot_be_tamed(ptr))) ct += 3;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && is_mplayer(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && is_umplayer(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && dmgtype(ptr, AD_DISN))) ct += 1;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && dmgtype(ptr, AD_LUCK))) ct += 2;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && dmgtype(ptr, AD_INER))) ct += 2;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && dmgtype(ptr, AD_NEXU))) ct += 2;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && dmgtype(ptr, AD_LETH))) ct += 1;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && dmgtype(ptr, AD_UVUU))) ct += 1;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && dmgtype(ptr, AD_IDAM))) ct += 1;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && dmgtype(ptr, AD_TRAI))) ct += 1;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && dmgtype(ptr, AD_SANI))) ct += 2;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && dmgtype(ptr, AD_SAMU))) ct += 2;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && dmgtype(ptr, AD_CHAO))) ct += 2;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && dmgtype(ptr, AD_ILLU) )) ct += 2;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && dmgtype(ptr, AD_FEMI) )) ct += 1;
		if (ct > 0 && (Race_if(PM_PLAYER_DYNAMO) && (ptr->mlet == S_KOP) )) ct += 5;
		if (ct > 0 && (Race_if(PM_PLAYER_DYNAMO) && (ptr->msound == MS_ARREST) )) ct += 5;
		if (ct > 0 && (Race_if(PM_NEMESIS) && always_hostile(ptr) )) ct += 10;
		if (ct > 0 && (Race_if(PM_UNMAGIC_FISH) && dmgtype(ptr, AD_MCRE) )) ct += 3;
		if (ct > 0 && (Race_if(PM_RETICULAN) && dmgtype(ptr, AD_MCRE) )) ct += 5;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && dmgtype(ptr, AD_MCRE) )) ct += 2;
		if (ct > 0 && (Race_if(PM_PLAYER_MYRKALFR) && dmgtype(ptr, AD_MCRE) )) ct += 1;
		if (ct > 0 && (Race_if(PM_PLAYER_DYNAMO) && dmgtype(ptr, AD_MCRE) )) ct += 3;
		if (ct > 0 && (Race_if(PM_CLOCKWORK_AUTOMATON) && dmgtype(ptr, AD_MCRE) )) ct += 1;
		if (ct > 0 && (Role_if(PM_ALTMER) && dmgtype(ptr, AD_MCRE) )) ct += 1;
		if (ct > 0 && (Role_if(PM_CELLAR_CHILD) && dmgtype(ptr, AD_MCRE) )) ct += 2;
		if (ct > 0 && (Role_if(PM_MAHOU_SHOUJO) && dmgtype(ptr, AD_MCRE) )) ct += 1;
		if (ct > 0 && (Role_if(PM_PSION) && dmgtype(ptr, AD_MCRE) )) ct += 2;
		if (ct > 0 && (Role_if(PM_SHAPESHIFTER) && dmgtype(ptr, AD_MCRE) )) ct += 4;
		if (ct > 0 && (Role_if(PM_TRACER) && dmgtype(ptr, AD_MCRE) )) ct += 1;
		if (ct > 0 && (Role_if(PM_UNBELIEVER) && dmgtype(ptr, AD_MCRE) )) ct += 5;
		if (ct > 0 && (Race_if(PM_CUPID) && is_elonamonster(ptr) )) ct += 2;
		if (ct > 0 && (Race_if(PM_BACTERIA) && is_elonamonster(ptr) )) ct += 10;
		if (ct > 0 && (Race_if(PM_PIECE) && is_elonamonster(ptr) )) ct += 5;
		if (ct > 0 && (Race_if(PM_PLAYER_SHEEP) && is_elonamonster(ptr) )) ct += 1;
		if (ct > 0 && (Race_if(PM_PLAYER_HOUND) && is_elonamonster(ptr) )) ct += 3;
		if (ct > 0 && (Race_if(PM_PLAYER_CERBERUS) && is_elonamonster(ptr) )) ct += 5;
		if (ct > 0 && (Race_if(PM_BOVER) && dmgtype(ptr, AD_DISE) )) ct += 5;
		if (ct > 0 && (Race_if(PM_BOVER) && dmgtype(ptr, AD_POIS) )) ct += 5;

		if (ct > 0 && (Role_if(PM_FJORDE) && (ptr->mlet == S_EEL) )) ct += 50;
		if (ct > 0 && (Role_if(PM_DRAGONMASTER) && attacktype(ptr, AT_BREA) )) ct += 2;
		if (ct > 0 && (Role_if(PM_FJORDE) && amphibious(ptr) )) ct += 5;
		if (ct > 0 && (Role_if(PM_PRACTICANT) && is_lord(ptr) )) ct += 4;
		if (ct > 0 && (Role_if(PM_PRACTICANT) && is_prince(ptr) )) ct += 12;
		if (ct > 0 && (Role_if(PM_PRACTICANT) && attacktype(ptr, AT_LASH) )) ct += 2;
		if (ct > 0 && (Role_if(PM_PRACTICANT) && dmgtype(ptr, AD_DEPR) )) ct += 4;
		if (ct > 0 && (Role_if(PM_PRACTICANT) && dmgtype(ptr, AD_WRAT) )) ct += 10;
		if (ct > 0 && (Role_if(PM_PRACTICANT) && dmgtype(ptr, AD_DFOO) )) ct += 5;
		if (ct > 0 && (Role_if(PM_PRACTICANT) && dmgtype(ptr, AD_SLUD) )) ct += 1;
		if (ct > 0 && (Role_if(PM_PRACTICANT) && dmgtype(ptr, AD_DEST) )) ct += 1;
		if (ct > 0 && (Role_if(PM_PRACTICANT) && dmgtype(ptr, AD_PAIN) )) ct += 5;
		if (ct > 0 && (Role_if(PM_PRACTICANT) && always_hostile(ptr) )) ct += 3;
		if (ct > 0 && (Role_if(PM_EMERA) && is_female(ptr) )) ct += 2;
		if (ct > 0 && (Role_if(PM_EMERA) && (ptr->msound == MS_STENCH))) ct += 10;
		if (ct > 0 && (Role_if(PM_EMERA) && (ptr->msound == MS_SHOE))) ct += 10;
		if (ct > 0 && (Role_if(PM_EMERA) && (ptr->msound == MS_FART_NORMAL))) ct += 10;
		if (ct > 0 && (Role_if(PM_EMERA) && (ptr->msound == MS_FART_LOUD))) ct += 10;
		if (ct > 0 && (Role_if(PM_EMERA) && (ptr->msound == MS_FART_QUIET))) ct += 10;
		if (ct > 0 && (Role_if(PM_EMERA) && always_hostile(ptr) )) ct += 1;
		if (ct > 0 && (Role_if(PM_MILL_SWALLOWER) && always_peaceful(ptr) )) ct += 3;
		if (ct > 0 && (Role_if(PM_MILL_SWALLOWER) && is_nonmoving(ptr) )) ct += 4;
		if (ct > 0 && (Role_if(PM_MILL_SWALLOWER) && nocorpsedecay(ptr) )) ct += 2;
		if (ct > 0 && (Role_if(PM_SYMBIANT) && is_angbandmonster(ptr) )) ct += 5;
		if (ct > 0 && (Role_if(PM_SYMBIANT) && is_animemonster(ptr) )) ct += 2;
		if (ct > 0 && (Role_if(PM_SYMBIANT) && is_steammonster(ptr) )) ct += 2;
		if (ct > 0 && (Role_if(PM_GENDERSTARIST) && is_neuter(ptr) )) ct += 10;
		if (ct > 0 && (Role_if(PM_GENDERSTARIST) && dmgtype(ptr, AD_SSEX) )) ct += 3;
		if (ct > 0 && (Role_if(PM_GENDERSTARIST) && (ptr->msound == MS_CUSS))) ct += 5;
		if (ct > 0 && (Race_if(PM_GOAULD) && is_dnethackmonster(ptr))) ct += 10;
		if (ct > 0 && (Role_if(PM_CELLAR_CHILD) && dmgtype(ptr, AD_DEBU) )) ct += 5;
		if (ct > 0 && (Role_if(PM_GENDERSTARIST) && dmgtype(ptr, AD_DEBU) )) ct += 5;
		if (ct > 0 && (Role_if(PM_ICE_MAGE) && dmgtype(ptr, AD_FLAM) )) ct += 1;
		if (ct > 0 && (Role_if(PM_PRACTICANT) && dmgtype(ptr, AD_DEBU) )) ct += 3;
		if (ct > 0 && (Role_if(PM_SOCIAL_JUSTICE_WARRIOR) && dmgtype(ptr, AD_DEBU) )) ct += 5;
		if (ct > 0 && (Race_if(PM_LOWER_ENT) && dmgtype(ptr, AD_FLAM) )) ct += 2;
		if (ct > 0 && (Race_if(PM_LOLI) && dmgtype(ptr, AD_DEBU) )) ct += 2;
		if (ct > 0 && (Race_if(PM_SEA_ELF) && dmgtype(ptr, AD_FLAM) )) ct += 4;
		if (ct > 0 && (Race_if(PM_SPRIGGAN) && dmgtype(ptr, AD_FLAM) )) ct += 2;
		if (ct > 0 && (Role_if(PM_ALTMER) && dmgtype(ptr, AD_NIVE) )) ct += 2;
		if (ct > 0 && (Role_if(PM_CELLAR_CHILD) && dmgtype(ptr, AD_UNPR) )) ct += 1;
		if (ct > 0 && (Role_if(PM_FJORDE) && dmgtype(ptr, AD_UNPR) )) ct += 3;
		if (ct > 0 && (Role_if(PM_MYSTIC) && dmgtype(ptr, AD_NIVE) )) ct += 10;
		if (ct > 0 && (Role_if(PM_SOCIAL_JUSTICE_WARRIOR) && dmgtype(ptr, AD_UNPR) )) ct += 3;
		if (ct > 0 && (iserosator && dmgtype(ptr, AD_UNPR) )) ct += 10;
		if (ct > 0 && (Race_if(PM_INCANTIFIER) && dmgtype(ptr, AD_NIVE) )) ct += 1;
		if (ct > 0 && (Race_if(PM_MONGUNG) && dmgtype(ptr, AD_NIVE) )) ct += 2;
		if (ct > 0 && (isfeminizer && dmgtype(ptr, AD_FEMI) )) ct += 10;
		if (ct > 0 && (Race_if(PM_IRAHA) && (ptr->maligntyp > 0) )) ct += 10;
		if (ct > 0 && (Race_if(PM_PLAYER_NIBELUNG) && is_angbandmonster(ptr) )) ct += 5;
		if (ct > 0 && (Race_if(PM_KLACKON) && humanoid(ptr) )) ct += 3;
		if (ct > 0 && (Race_if(PM_KLACKON) && is_angbandmonster(ptr) )) ct += 4;
		if (ct > 0 && (Race_if(PM_KLACKON) && is_animemonster(ptr) )) ct += 2;
		if (ct > 0 && (Race_if(PM_KUTAR) && is_angbandmonster(ptr) )) ct += 3;
		if (ct > 0 && (Race_if(PM_KUTAR) && is_animemonster(ptr) )) ct += 7;
		if (ct > 0 && (Race_if(PM_KUTAR) && is_steammonster(ptr) )) ct += 3;
		if (ct > 0 && (Race_if(PM_TONBERRY) && is_angbandmonster(ptr) )) ct += 10;
		if (ct > 0 && (Race_if(PM_TONBERRY) && is_animemonster(ptr) )) ct += 10;
		if (ct > 0 && (Race_if(PM_TONBERRY) && is_steammonster(ptr) )) ct += 10;
		if (ct > 0 && (Race_if(PM_TONBERRY) && is_jokemonster(ptr) )) ct += 2;
		if (ct > 0 && (Race_if(PM_PLAYER_GLORKUM) && is_randomizedmonster(ptr) )) ct += 50;
		if (ct > 0 && (Race_if(PM_RACE_THAT_DOESN_T_EXIST) && always_peaceful(ptr) )) ct += 10;
		if (ct > 0 && (Race_if(PM_HYBRIDRAGON) && is_dnethackmonster(ptr) )) ct += 12;
		if (ct > 0 && (ischallenger && (ptr->msound == MS_STENCH) )) ct += (((int)(ptr->geno & G_FREQ)) * 4);
		if (ct > 0 && (ischallenger && (ptr->msound == MS_WHORE) )) ct += (((int)(ptr->geno & G_FREQ)) * 4);
		if (ct > 0 && (ischallenger && (ptr->msound == MS_FART_QUIET) )) ct += (((int)(ptr->geno & G_FREQ)) * 4);
		if (ct > 0 && (ischallenger && (ptr->msound == MS_FART_LOUD) )) ct += (((int)(ptr->geno & G_FREQ)) * 4);
		if (ct > 0 && (ischallenger && (ptr->msound == MS_FART_NORMAL) )) ct += (((int)(ptr->geno & G_FREQ)) * 4);
		if (ct > 0 && (ischallenger && (ptr->msound == MS_SHOE) )) ct += (((int)(ptr->geno & G_FREQ)) * 4);
		if (ct > 0 && (ischallenger && (ptr->msound == MS_SOCKS) )) ct += (((int)(ptr->geno & G_FREQ)) * 4);
		if (ct > 0 && (ischallenger && (ptr->msound == MS_PANTS) )) ct += (((int)(ptr->geno & G_FREQ)) * 4);
		if (ct > 0 && (ischallenger && (ptr->msound == MS_CONVERT) )) ct += (((int)(ptr->geno & G_FREQ)) * 4);
		if (ct > 0 && (ischallenger && (ptr->msound == MS_HCALIEN) )) ct += (((int)(ptr->geno & G_FREQ)) * 4);
		if (ct > 0 && (uarmf && uarmf->oartifact == ART_STRONG_GETAWAY_DESIRE && dmgtype(ptr, AD_WEEP) )) ct += 20;
		if (ct > 0 && (Role_if(PM_ANACHRONIST) && dmgtype(ptr, AD_TDRA) )) ct += 3;
		if (ct > 0 && (Role_if(PM_SHAPESHIFTER) && dmgtype(ptr, AD_BLAS) )) ct += 5;
		if (ct > 0 && (Race_if(PM_HUMANOID_ANGEL) && dmgtype(ptr, AD_BLAS) )) ct += 1;
		if (ct > 0 && (Race_if(PM_HUMANOID_DEVIL) && dmgtype(ptr, AD_BLAS) )) ct += 2;
		if (ct > 0 && (Race_if(PM_DEVELOPER) && dmgtype(ptr, AD_BLAS) )) ct += 2;
		if (ct > 0 && (Race_if(PM_PLAYER_DYNAMO) && dmgtype(ptr, AD_TDRA) )) ct += 1;
		if (ct > 0 && (Race_if(PM_GAVIL) && dmgtype(ptr, AD_BLAS) )) ct += 1;
		if (ct > 0 && (Race_if(PM_HC_ALIEN) && dmgtype(ptr, AD_BLAS) )) ct += 1;
		if (ct > 0 && (isheretic && dmgtype(ptr, AD_BLAS) )) ct += 3;
		if (ct > 0 && (Race_if(PM_IMPERIAL) && dmgtype(ptr, AD_BLAS) )) ct += 5;
		if (ct > 0 && (Race_if(PM_SINNER) && dmgtype(ptr, AD_BLAS) )) ct += 1;
		if (ct > 0 && (Race_if(PM_SPIRIT) && dmgtype(ptr, AD_TDRA) )) ct += 3;
		if (ct > 0 && (Role_if(PM_BUTT_LOVER) && (ptr->msound == MS_FART_NORMAL) )) ct += 50;
		if (ct > 0 && (Role_if(PM_BUTT_LOVER) && (ptr->msound == MS_FART_LOUD) )) ct += 50;
		if (ct > 0 && (Role_if(PM_BUTT_LOVER) && (ptr->msound == MS_FART_QUIET) )) ct += 50;
		if (ct > 0 && (Role_if(PM_DIABLIST) && is_diablomonster(ptr))) ct += 20;
		if (ct > 0 && (Role_if(PM_PREVERSIONER) && is_cowmonster(ptr) )) ct += 50;
		if (ct > 0 && (Role_if(PM_PREVERSIONER) && is_jokemonster(ptr) )) ct += 5;
		if (ct > 0 && (Role_if(PM_SHOE_FETISHIST) && (ptr->msound == MS_SHOE) )) ct += 100;
		if (ct > 0 && (FemtrapActiveJohanna && (ptr->msound == MS_SHOE) )) ct += 100;
		if (ct > 0 && (Role_if(PM_SECRET_ADVICE_MEMBER) && (ptr->msound == MS_ARREST) )) ct += 4;
		if (ct > 0 && (Role_if(PM_SECRET_ADVICE_MEMBER) && (ptr->msound == MS_SOLDIER) )) ct += 2;
		if (ct > 0 && (Role_if(PM_SECRET_ADVICE_MEMBER) && strongmonst(ptr) )) ct += 2;
		if (ct > 0 && (Role_if(PM_SECRET_ADVICE_MEMBER) && extra_nasty(ptr) )) ct += 3;
		if (ct > 0 && (Role_if(PM_SECRET_ADVICE_MEMBER) && dmgtype(ptr, AD_TDRA) )) ct += 5;
		if (ct > 0 && (Role_if(PM_SECRET_ADVICE_MEMBER) && dmgtype(ptr, AD_TECH) )) ct += 5;
		if (ct > 0 && (Role_if(PM_SECRET_ADVICE_MEMBER) && is_cowmonster(ptr) )) ct += 5;
		if (ct > 0 && (Role_if(PM_SECRET_ADVICE_MEMBER) && is_jokemonster(ptr) )) ct += 2;
		if (ct > 0 && (PlayerInConeHeels && (P_MAX_SKILL(P_HIGH_HEELS) == P_ISRESTRICTED) && dmgtype(ptr, AD_DROP) )) ct += 5;
		if (ct > 0 && (Role_if(PM_BARD) && dmgtype(ptr, AD_DROP) )) ct += 1;
		if (ct > 0 && (Role_if(PM_BUTT_LOVER) && dmgtype(ptr, AD_DROP) )) ct += 10;
		if (ct > 0 && (Role_if(PM_CONVICT) && dmgtype(ptr, AD_DROP) )) ct += 1;
		if (ct > 0 && (Role_if(PM_MURDERER) && dmgtype(ptr, AD_DROP) )) ct += 1;
		if (ct > 0 && (Role_if(PM_DOLL_MISTRESS) && dmgtype(ptr, AD_DROP) )) ct += 2;
		if (ct > 0 && (Role_if(PM_DRUNK) && dmgtype(ptr, AD_DROP) )) ct += 3;
		if (ct > 0 && (Role_if(PM_GENDERSTARIST) && dmgtype(ptr, AD_DROP) )) ct += 2;
		if (ct > 0 && (Role_if(PM_JESTER) && dmgtype(ptr, AD_DROP) )) ct += 5;
		if (ct > 0 && (Role_if(PM_POLITICIAN) && dmgtype(ptr, AD_DROP) )) ct += 2;
		if (ct > 0 && (Role_if(PM_PRACTICANT) && dmgtype(ptr, AD_DROP) )) ct += 1;
		if (ct > 0 && (Race_if(PM_ALCHEMIST) && dmgtype(ptr, AD_DROP) )) ct += 2;
		if (ct > 0 && (Race_if(PM_DUFFLEPUD) && dmgtype(ptr, AD_DROP) )) ct += 2;
		if (ct > 0 && (Race_if(PM_PERVERT) && dmgtype(ptr, AD_DROP) )) ct += 2;
		if (ct > 0 && (Race_if(PM_TUMBLRER) && dmgtype(ptr, AD_DROP) )) ct += 10;
		if (ct > 0 && (Race_if(PM_WOOKIE) && dmgtype(ptr, AD_DROP) )) ct += 2;
		if (ct > 0 && (Race_if(PM_CLIMACTERIAL) && dmgtype(ptr, AD_FEMI) )) ct += 50;
		if (ct > 0 && (Role_if(PM_WOMANIZER) && is_female(ptr) )) ct += 1;
		if (ct > 0 && (uwep && uwep->oartifact == ART_SLEXCALIBUR && !is_angbandmonster(ptr) && !is_cowmonster(ptr) && !is_vanillamonster(ptr) && !is_animemonster(ptr) && !is_steammonster(ptr) && !is_dlordsmonster(ptr) && !is_dnethackmonster(ptr) && !is_jokemonster(ptr) && !is_diablomonster(ptr) && !is_jonadabmonster(ptr) && !is_evilpatchmonster(ptr) && !is_randomizedmonster(ptr) && !is_elonamonster(ptr) && !is_aoemonster(ptr) && !is_elderscrollsmonster(ptr) )) ct += 5;
		if (ct > 0 && (u.twoweap && uswapwep && uswapwep->oartifact == ART_SLEXCALIBUR && !is_angbandmonster(ptr) && !is_cowmonster(ptr) && !is_vanillamonster(ptr) && !is_animemonster(ptr) && !is_steammonster(ptr) && !is_dlordsmonster(ptr) && !is_dnethackmonster(ptr) && !is_jokemonster(ptr) && !is_diablomonster(ptr) && !is_jonadabmonster(ptr) && !is_evilpatchmonster(ptr) && !is_randomizedmonster(ptr) && !is_elonamonster(ptr) && !is_aoemonster(ptr) && !is_elderscrollsmonster(ptr) )) ct += 5;
		if (ct > 0 && (Role_if(PM_ACID_MAGE) && (ptr->msound == MS_DRUGS) )) ct += 1;
		if (ct > 0 && (Role_if(PM_ANACHRONIST) && (ptr->msound == MS_BOT) )) ct += 7;
		if (ct > 0 && (Role_if(PM_ANACHRONOUNBINDER) && (ptr->msound == MS_GLYPHS) )) ct += 1;
		if (ct > 0 && (Role_if(PM_BOSMER) && monsterflees(ptr))) ct += 2;
		if (ct > 0 && (Role_if(PM_BULLY) && (ptr->msound == MS_BRAG) )) ct += 1;
		if (ct > 0 && (Role_if(PM_BULLY) && (ptr->msound == MS_SISSY) )) ct += 2;
		if (ct > 0 && (Role_if(PM_CARTOMANCER) && (ptr->msound == MS_CASINO) )) ct += 3;
		if (ct > 0 && (Role_if(PM_COMBATANT) && (ptr->msound == MS_COMBAT) )) ct += 5;
		if (ct > 0 && (Role_if(PM_COURIER) && (ptr->msound == MS_GIBBERISH) )) ct += 2;
		if (ct > 0 && (Role_if(PM_CRACKER) && (ptr->msound == MS_BOT) )) ct += 2;
		if (ct > 0 && (Role_if(PM_CRUEL_ABUSER) && (ptr->msound == MS_SISSY) )) ct += 5;
		if (ct > 0 && (Role_if(PM_CYBERNINJA) && (ptr->msound == MS_JAPANESE) )) ct += 1;
		if (ct > 0 && (Role_if(PM_DANCER) && (ptr->msound == MS_SING) )) ct += 1;
		if (ct > 0 && (Role_if(PM_DANCER) && (ptr->msound == MS_PRINCESSLEIA) )) ct += 1;
		if (ct > 0 && (Role_if(PM_DEMAGOGUE) && (ptr->msound == MS_CORONA) )) ct += 5;
		if (ct > 0 && (Role_if(PM_DOLL_MISTRESS) && (ptr->msound == MS_POKEDEX) )) ct += 2;
		if (ct > 0 && (Role_if(PM_DOOM_MARINE) && (ptr->msound == MS_BOT) )) ct += 1;
		if (ct > 0 && (Role_if(PM_DQ_SLIME) && (ptr->msound == MS_COMBAT) )) ct += 1;
		if (ct > 0 && (Role_if(PM_DRUNK) && (ptr->msound == MS_DRUGS) )) ct += 10;
		if (ct > 0 && (Role_if(PM_EMERA) && (ptr->msound == MS_SING) )) ct += 1;
		if (ct > 0 && (Role_if(PM_EMERA) && (ptr->msound == MS_SOCKS) )) ct += 3;
		if (ct > 0 && (Role_if(PM_EMERA) && (ptr->msound == MS_PANTS) )) ct += 3;
		if (ct > 0 && (Role_if(PM_EMPATH) && (ptr->msound == MS_PAIN) )) ct += 3;
		if (ct > 0 && (Role_if(PM_FEAT_MASTER) && (ptr->msound == MS_PHOTO) )) ct += 5;
		if (ct > 0 && (Role_if(PM_FENCER) && (ptr->msound == MS_COMBAT) )) ct += 1;
		if (ct > 0 && (Role_if(PM_FIGHTER) && (ptr->msound == MS_COMBAT) )) ct += 2;
		if (ct > 0 && (Role_if(PM_FIREFIGHTER) && (ptr->msound == MS_CAR) )) ct += 1;
		if (ct > 0 && (Role_if(PM_GANGSTER) && (ptr->msound == MS_CASINO) )) ct += 3;
		if (ct > 0 && (Role_if(PM_GEEK) && (ptr->msound == MS_BOT) )) ct += 1;
		if (ct > 0 && (Role_if(PM_GRENADONIN) && (ptr->msound == MS_JAPANESE) )) ct += 5;
		if (ct > 0 && (Role_if(PM_SAMURAI) && (ptr->msound == MS_JAPANESE) )) ct += 1;
		if (ct > 0 && (Role_if(PM_HEALER) && (ptr->msound == MS_PAIN) )) ct += 1;
		if (ct > 0 && (Role_if(PM_HUSSY) && (ptr->msound == MS_SISSY) )) ct += 4;
		if (ct > 0 && (Role_if(PM_JEDI) && (ptr->msound == MS_PRINCESSLEIA) )) ct += 10;
		if (ct > 0 && (Role_if(PM_SHADOW_JEDI) && (ptr->msound == MS_PRINCESSLEIA) )) ct += 5;
		if (ct > 0 && (Role_if(PM_HEDDERJEDI) && (ptr->msound == MS_PRINCESSLEIA) )) ct += 20;
		if (ct > 0 && (Role_if(PM_JESTER) && (ptr->msound == MS_SING) )) ct += 3;
		if (ct > 0 && (Role_if(PM_JUSTICE_KEEPER) && (ptr->msound == MS_APOC) )) ct += 1;
		if (ct > 0 && (Role_if(PM_LADIESMAN) && (ptr->msound == MS_PHOTO) )) ct += 10;
		if (ct > 0 && (Role_if(PM_MAHOU_SHOUJO) && (ptr->msound == MS_JAPANESE) )) ct += 2;
		if (ct > 0 && (Role_if(PM_MAHOU_SHOUJO) && (ptr->msound == MS_BRAG) )) ct += 1;
		if (ct > 0 && (Role_if(PM_NINJA) && (ptr->msound == MS_JAPANESE) )) ct += 2;
		if (ct > 0 && (Role_if(PM_NOBLEMAN) && (ptr->msound == MS_PRINCESSLEIA) )) ct += 2;
		if (ct > 0 && (Role_if(PM_OTAKU) && (ptr->msound == MS_JAPANESE) )) ct += 10;
		if (ct > 0 && (Role_if(PM_PICKPOCKET) && (ptr->msound == MS_SISSY) )) ct += 1;
		if (ct > 0 && (Role_if(PM_POKEMON) && (ptr->msound == MS_POKEDEX) )) ct += 2;
		if (ct > 0 && (Role_if(PM_POLITICIAN) && (ptr->msound == MS_APOC) )) ct += 4;
		if (ct > 0 && (Role_if(PM_PSION) && (ptr->msound == MS_ALLA) )) ct += 8;
		if (ct > 0 && (Role_if(PM_RANGER) && monsterrandomwalk(ptr))) ct += 5;
		if (ct > 0 && (Role_if(PM_RANGER) && monsterflees(ptr))) ct += 1;
		if (ct > 0 && (Role_if(PM_ROCKER) && (ptr->msound == MS_CAR) )) ct += 3;
		if (ct > 0 && (Role_if(PM_SAIYAN) && (ptr->msound == MS_JAPANESE) )) ct += 2;
		if (ct > 0 && (Role_if(PM_SAIYAN) && (ptr->msound == MS_COMBAT) )) ct += 2;
		if (ct > 0 && (Role_if(PM_SHOE_FETISHIST) && (ptr->msound == MS_SOCKS) )) ct += 1;
		if (ct > 0 && (Role_if(PM_SHOE_FETISHIST) && (ptr->msound == MS_SING) )) ct += 2;
		if (ct > 0 && (Role_if(PM_SOFTWARE_ENGINEER) && (ptr->msound == MS_BOT) )) ct += 2;
		if (ct > 0 && (Role_if(PM_ZOOKEEPER) && monsterrandomwalk(ptr))) ct += 4;

		if (ct > 0 && (Race_if(PM_ADDICT) && (ptr->msound == MS_DRUGS) )) ct += 1;
		if (ct > 0 && (Race_if(PM_PLAYER_ANDROID) && (ptr->msound == MS_BOT) )) ct += 4;
		if (ct > 0 && (Race_if(PM_CHIQUAI) && (ptr->msound == MS_JAPANESE) )) ct += 3;
		if (ct > 0 && (Race_if(PM_JAPURA) && (ptr->msound == MS_JAPANESE) )) ct += 6;
		if (ct > 0 && (Race_if(PM_JAVA) && monsterrandomwalk(ptr))) ct += 2;
		if (ct > 0 && (Race_if(PM_NAVI) && monsterrandomwalk(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_NAVI) && monsterflees(ptr))) ct += 1;
		if (ct > 0 && (Race_if(PM_RUSMOT) && (ptr->msound == MS_SOVIET) )) ct += 5;
		if (ct > 0 && (issoviet && (ptr->msound == MS_SOVIET) )) ct += 10;
		if (ct > 0 && (Race_if(PM_SPAMMER) && (ptr->msound == MS_GIBBERISH) )) ct += 1;
		if (ct > 0 && (Race_if(PM_VIETIS) && (ptr->msound == MS_JAPANESE) )) ct += 1;
		if (ct > 0 && (Race_if(PM_WOOKIE) && (ptr->msound == MS_BOT) )) ct += 1;
		if (ct > 0 && (Race_if(PM_RELEASIER) && (ptr->mlet == S_LIZARD))) ct += 10;

		if (ct > 0 && (Role_if(PM_BOSMER) && (ptr->msound == MS_TREESQUAD) )) ct += 10;
		if (ct > 0 && (Role_if(PM_AMAZON) && (ptr->msound == MS_TREESQUAD) )) ct += 1;
		if (ct > 0 && (Role_if(PM_ANACHRONOUNBINDER) && (ptr->msound == MS_SPOILER) )) ct += 1;
		if (ct > 0 && (Role_if(PM_ARCHEOLOGIST) && (ptr->msound == MS_DEAD) )) ct += 2;
		if (ct > 0 && (Role_if(PM_ASTRONAUT) && (ptr->msound == MS_CODE) )) ct += 2;
		if (ct > 0 && (Role_if(PM_ASTRONAUT) && (ptr->msound == MS_STABILIZE) )) ct += 3;
		if (ct > 0 && (Role_if(PM_BLOODSEEKER) && (ptr->msound == MS_SELFHARM) )) ct += 1;
		if (ct > 0 && (Role_if(PM_BULLY) && (ptr->msound == MS_WOLLOH) )) ct += 5;
		if (ct > 0 && (Role_if(PM_CONVICT) && (ptr->msound == MS_METALMAFIA) )) ct += 3;
		if (ct > 0 && (Role_if(PM_MURDERER) && (ptr->msound == MS_METALMAFIA) )) ct += 5;
		if (ct > 0 && (Role_if(PM_CRACKER) && (ptr->msound == MS_CODE) )) ct += 5;
		if (ct > 0 && (Role_if(PM_DANCER) && (ptr->msound == MS_AREOLA) )) ct += 1;
		if (ct > 0 && (Role_if(PM_DEMAGOGUE) && (ptr->msound == MS_DEEPSTATE) )) ct += 5;
		if (ct > 0 && (Role_if(PM_DISSIDENT) && (ptr->msound == MS_DEEPSTATE) )) ct += 10;
		if (ct > 0 && (Role_if(PM_DQ_SLIME) && (ptr->msound == MS_LIEDER) )) ct += 1;
		if (ct > 0 && (Role_if(PM_DQ_SLIME) && (ptr->msound == MS_GAARDIEN) )) ct += 5;
		if (ct > 0 && (Role_if(PM_DRUID) && (ptr->msound == MS_TREESQUAD) )) ct += 2;
		if (ct > 0 && (Role_if(PM_DRUNK) && (ptr->msound == MS_WOLLOH) )) ct += 1;
		if (ct > 0 && (Role_if(PM_ELPH) && (ptr->msound == MS_TREESQUAD) )) ct += 3;
		if (ct > 0 && (Role_if(PM_EMPATH) && (ptr->msound == MS_AREOLA) )) ct += 1;
		if (ct > 0 && (Role_if(PM_ERDRICK) && (ptr->msound == MS_LIEDER) )) ct += 3;
		if (ct > 0 && (Role_if(PM_ERDRICK) && (ptr->msound == MS_GAARDIEN) )) ct += 3;
		if (ct > 0 && (Role_if(PM_FOXHOUND_AGENT) && (ptr->msound == MS_ESCAPE) )) ct += 2;
		if (ct > 0 && (Role_if(PM_GAMER) && (ptr->msound == MS_CODE) )) ct += 2;
		if (ct > 0 && (Role_if(PM_GANGSTER) && (ptr->msound == MS_METALMAFIA) )) ct += 1;
		if (ct > 0 && (Role_if(PM_GEEK) && (ptr->msound == MS_CODE) )) ct += 3;
		if (ct > 0 && (Role_if(PM_GRADUATE) && (ptr->msound == MS_CODE) )) ct += 3;
		if (ct > 0 && (Role_if(PM_GOFF) && (ptr->msound == MS_AREOLA) )) ct += 6;
		if (ct > 0 && (Role_if(PM_JANITOR) && (ptr->msound == MS_DEAD) )) ct += 1;
		if (ct > 0 && (Role_if(PM_LADIESMAN) && (ptr->msound == MS_BARBER) )) ct += 3;
		if (ct > 0 && (Role_if(PM_LOCKSMITH) && (ptr->msound == MS_CODE) )) ct += 2;
		if (ct > 0 && (Role_if(PM_MASTERMIND) && (ptr->msound == MS_CODE) )) ct += 10;
		if (ct > 0 && (Role_if(PM_NECROMANCER) && (ptr->msound == MS_DEAD) )) ct += 1;
		if (ct > 0 && (Role_if(PM_NUCLEAR_PHYSICIST) && (ptr->msound == MS_STABILIZE) )) ct += 1;
		if (ct > 0 && (Role_if(PM_OFFICER) && (ptr->msound == MS_METALMAFIA) )) ct += 3;
		if (ct > 0 && (Role_if(PM_POKEMON) && (ptr->msound == MS_MISSING) )) ct += 2;
		if (ct > 0 && (Role_if(PM_POLITICIAN) && (ptr->msound == MS_DEEPSTATE) )) ct += 5;
		if (ct > 0 && (Role_if(PM_PREVERSIONER) && (ptr->msound == MS_MISSING) )) ct += 3;
		if (ct > 0 && (Role_if(PM_QUARTERBACK) && (ptr->msound == MS_BARBER) )) ct += 1;
		if (ct > 0 && (Role_if(PM_RANGER) && (ptr->msound == MS_TREESQUAD) )) ct += 2;
		if (ct > 0 && (Role_if(PM_RANGER) && (ptr->msound == MS_FEARHARE) )) ct += 1;
		if (ct > 0 && (Role_if(PM_SLAVE_MASTER) && (ptr->msound == MS_FEARHARE) )) ct += 4;
		if (ct > 0 && (Role_if(PM_SOFTWARE_ENGINEER) && (ptr->msound == MS_CODE) )) ct += 1;
		if (ct > 0 && (Role_if(PM_SUPERMARKET_CASHIER) && (ptr->msound == MS_WOLLOH) )) ct += 1;
		if (ct > 0 && (Role_if(PM_UNDERTAKER) && (ptr->msound == MS_DEAD) )) ct += 5;
		if (ct > 0 && (Role_if(PM_STAND_USER) && (ptr->msound == MS_OHGOD) )) ct += 5;
		if (ct > 0 && (Role_if(PM_WOMANIZER) && (ptr->msound == MS_BARBER) )) ct += 1;
		if (ct > 0 && (Role_if(PM_SEXYMATE) && (ptr->msound == MS_BARBER) )) ct += 2;

		if (ct > 0 && (Race_if(PM_AK_THIEF_IS_DEAD_) && (ptr->msound == MS_SPOILER) )) ct += 2;
		if (ct > 0 && (Race_if(PM_BULDOZGAR) && (ptr->msound == MS_METALMAFIA) )) ct += 1;
		if (ct > 0 && (Race_if(PM_DESTABILIZER) && (ptr->msound == MS_STABILIZE) )) ct += 2;
		if (ct > 0 && (Race_if(PM_DRYAD) && (ptr->msound == MS_TREESQUAD) )) ct += 1;
		if (ct > 0 && (Race_if(PM_DYNAMO) && (ptr->msound == MS_METALMAFIA) )) ct += 2;
		if (ct > 0 && (Race_if(PM_ELF) && (ptr->msound == MS_TREESQUAD) )) ct += 1;
		if (ct > 0 && (Race_if(PM_LOWER_ENT) && (ptr->msound == MS_TREESQUAD) )) ct += 10;
		if (ct > 0 && (Race_if(PM_EROSATOR) && (ptr->msound == MS_AREOLA) )) ct += 4;
		if (ct > 0 && (Race_if(PM_PLAYER_FAIRY) && (ptr->msound == MS_STABILIZE) )) ct += 1;
		if (ct > 0 && (Race_if(PM_PLAYER_GLORKUM) && (ptr->msound == MS_MISSING) )) ct += 2;
		if (ct > 0 && (Race_if(PM_PLAYER_GLORKUM) && (ptr->msound == MS_SPOILER) )) ct += 1;
		if (ct > 0 && (Race_if(PM_HC_ALIEN) && (ptr->msound == MS_BARBER) )) ct += 1;
		if (ct > 0 && (Race_if(PM_HC_ALIEN) && (ptr->msound == MS_WOLLOH) )) ct += 4;
		if (ct > 0 && (Race_if(PM_KOP) && (ptr->msound == MS_METALMAFIA) )) ct += 6;
		if (ct > 0 && (Race_if(PM_LIZARDMAN) && (ptr->msound == MS_STABILIZE) )) ct += 3;
		if (ct > 0 && (Race_if(PM_LOLI) && (ptr->msound == MS_AREOLA) )) ct += 2;
		if (ct > 0 && (Race_if(PM_METAL) && (ptr->msound == MS_ESCAPE) )) ct += 2;
		if (ct > 0 && (Race_if(PM_MISSINGNO) && (ptr->msound == MS_MISSING) )) ct += 20;
		if (ct > 0 && (Race_if(PM_MONGUNG) && (ptr->msound == MS_FEARHARE) )) ct += 5;
		if (ct > 0 && (Race_if(PM_NAVI) && (ptr->msound == MS_FEARHARE) )) ct += 1;
		if (ct > 0 && (Race_if(PM_NEMESIS) && (ptr->msound == MS_LIEDER) )) ct += 1;
		if (ct > 0 && (Race_if(PM_OUTSIDER) && (ptr->msound == MS_DEEPSTATE) )) ct += 2;
		if (ct > 0 && (Race_if(PM_PERVERT) && (ptr->msound == MS_AREOLA) )) ct += 2;
		if (ct > 0 && (Race_if(PM_PIECE) && (ptr->msound == MS_STABILIZE) )) ct += 1;
		if (ct > 0 && (Race_if(PM_RACE_THAT_DOESN_T_EXIST) && (ptr->msound == MS_MISSING) )) ct += 5;
		if (ct > 0 && (Race_if(PM_SHEEP) && (ptr->msound == MS_ESCAPE) )) ct += 1;
		if (ct > 0 && (Race_if(PM_SPRIGGAN) && (ptr->msound == MS_TREESQUAD) )) ct += 3;
		if (ct > 0 && (Race_if(PM_SUSTAINER) && (ptr->msound == MS_TREESQUAD) )) ct += 1;
		if (ct > 0 && (Race_if(PM_SYLPH) && (ptr->msound == MS_TREESQUAD) )) ct += 2;
		if (ct > 0 && (Race_if(PM_TURMENE) && (ptr->msound == MS_WOLLOH) )) ct += 5;
		if (ct > 0 && (Race_if(PM_VENTURE_CAPITALIST) && (ptr->msound == MS_DEEPSTATE) )) ct += 1;
		if (ct > 0 && (Race_if(PM_WORM_THAT_WALKS) && (ptr->msound == MS_DEAD) )) ct += 3;

		if (ct > 0 && (uarmc && uarmc->oartifact == ART_PHEROMONE_CASE && (ptr->msound == MS_STENCH))) ct += 10;
		if (ct > 0 && (FemtrapActiveAnna && (ptr->msound == MS_STENCH))) ct += 50;
		if (ct > 0 && (FemtrapActiveLydia && (spawnswithpumps(ptr)) )) ct += 1000;
		if (ct > 0 && (FemtrapActiveMarike && (ptr->msound == MS_FART_NORMAL))) ct += 10;
		if (ct > 0 && (FemtrapActiveVictoria && is_female(ptr) && attacktype(ptr, AT_KICK) )) ct += 20;
		if (ct > 0 && (FemtrapActiveJil && (ptr->msound == MS_SOCKS))) ct += 25;
		if (ct > 0 && (FemtrapActiveLaura && (ptr->msound == MS_SOCKS))) ct += 50;
		if (ct > 0 && (FemtrapActiveLaura && (ptr->msound == MS_PANTS))) ct += 50;
		if (ct > 0 && (FemtrapActiveLaura && (ptr->msound == MS_SHOE))) ct += 50;
		if (ct > 0 && u.pompejiwantedlevel && (ptr->msound == MS_POMPEJI)) ct += min(1000, u.pompejiwantedlevel);

		if (ct > 0 && RngeExtinction && mvitals[mndx].born) ct += mvitals[mndx].born;

		if (ct > 0 && monster_with_trait(ptr, u.frequenttrait1)) ct += u.freqtraitbonus1;
		if (ct > 0 && u.frequenttrait2 && monster_with_trait(ptr, u.frequenttrait2)) ct += u.freqtraitbonus2;
		if (ct > 0 && u.frequenttrait3 && monster_with_trait(ptr, u.frequenttrait3)) ct += u.freqtraitbonus3;
		if (ct > 0 && u.frequenttrait4 && monster_with_trait(ptr, u.frequenttrait4)) ct += u.freqtraitbonus4;
		if (ct > 0 && u.frequenttrait5 && monster_with_trait(ptr, u.frequenttrait5)) ct += u.freqtraitbonus5;
		if (ct > 0 && u.frequenttrait6 && monster_with_trait(ptr, u.frequenttrait6)) ct += u.freqtraitbonus6;
		if (ct > 0 && u.frequenttrait7 && monster_with_trait(ptr, u.frequenttrait7)) ct += u.freqtraitbonus7;
		if (ct > 0 && u.frequenttrait8 && monster_with_trait(ptr, u.frequenttrait8)) ct += u.freqtraitbonus8;
		if (ct > 0 && u.frequenttrait9 && monster_with_trait(ptr, u.frequenttrait9)) ct += u.freqtraitbonus9;
		if (ct > 0 && u.frequenttrait10 && monster_with_trait(ptr, u.frequenttrait10)) ct += u.freqtraitbonus10;

		if (ct > 0 && (FrequentationSpawns || u.uprops[FREQUENTATION_SPAWNS].extrinsic || have_frequentationspawnstone()) && u.frequentationtrait && monster_with_trait(ptr, u.frequentationtrait) ) ct += 10;

		if (ct > 0 && (mndx == u.frequentspecies)) ct += u.freqspeciesbonus;
		if (ct > 0 && (mndx == u.frequentspecies2)) ct += u.freqspeciesbonus2;
		if (ct > 0 && (mndx == u.frequentspecies3)) ct += u.freqspeciesbonus3;
		if (ct > 0 && (mndx == u.frequentspecies4)) ct += u.freqspeciesbonus4;
		if (ct > 0 && (mndx == u.frequentspecies5)) ct += u.freqspeciesbonus5;
		if (ct > 0 && (mndx == u.frequentspecies6)) ct += u.freqspeciesbonus6;
		if (ct > 0 && (mndx == u.frequentspecies7)) ct += u.freqspeciesbonus7;
		if (ct > 0 && (mndx == u.frequentspecies8)) ct += u.freqspeciesbonus8;
		if (ct > 0 && (mndx == u.frequentspecies9)) ct += u.freqspeciesbonus9;
		if (ct > 0 && (mndx == u.frequentspecies10)) ct += u.freqspeciesbonus10;
		if (ct > 0 && (mndx == u.frequentspecies11)) ct += u.freqspeciesbonus11;
		if (ct > 0 && (mndx == u.frequentspecies12)) ct += u.freqspeciesbonus12;
		if (ct > 0 && (mndx == u.frequentspecies13)) ct += u.freqspeciesbonus13;
		if (ct > 0 && (mndx == u.frequentspecies14)) ct += u.freqspeciesbonus14;
		if (ct > 0 && (mndx == u.frequentspecies15)) ct += u.freqspeciesbonus15;
		if (ct > 0 && (mndx == u.frequentspecies16)) ct += u.freqspeciesbonus16;
		if (ct > 0 && (mndx == u.frequentspecies17)) ct += u.freqspeciesbonus17;
		if (ct > 0 && (mndx == u.frequentspecies18)) ct += u.freqspeciesbonus18;
		if (ct > 0 && (mndx == u.frequentspecies19)) ct += u.freqspeciesbonus19;
		if (ct > 0 && (mndx == u.frequentspecies20)) ct += u.freqspeciesbonus20;

		if (ct > 0 && (mndx == urole.nemesnum)) ct += (Qstats(killed_nemesis) ? 500 : 100);

		if (ct > 0 && (urole.enemy1num != NON_PM) && (mndx == urole.enemy1num)) ct += 125;
		if (ct > 0 && (urole.enemy2num != NON_PM) && (mndx == urole.enemy2num)) ct += 25;

		if (ct > 0 && (mndx == u.nospawnspecies)) ct = 0;
		if (ct > 0 && (mndx == u.nospawnspecies2)) ct = 0;
		if (ct > 0 && (mndx == u.nospawnspecies3)) ct = 0;
		if (ct > 0 && (mndx == u.nospawnspecies4)) ct = 0;
		if (ct > 0 && (mndx == u.nospawnspecies5)) ct = 0;
		if (ct > 0 && (mndx == u.nospawnspecies6)) ct = 0;
		if (ct > 0 && (mndx == u.nospawnspecies7)) ct = 0;
		if (ct > 0 && (mndx == u.nospawnspecies8)) ct = 0;
		if (ct > 0 && (mndx == u.nospawnspecies9)) ct = 0;
		if (ct > 0 && (mndx == u.nospawnspecies10)) ct = 0;

		/*if (ct < 0 || ct > 127)
		    panic("rndmonst: bad count [#%d: %d]", mndx, ct);*/
		if (ct < 0) {pline("rndmonst: bad count [#%d: %d]", mndx, ct); ct = 0;}
		if (ct > 10000) {pline("rndmonst: bad count [#%d: %d]", mndx, ct); ct = 10000;} /* arbitrary --Amy */
		rndmonst_state.choice_count += ct;
		rndmonst_state.mchoices[mndx] = ct;
	    }
/*
 *	    Possible modification:  if choice_count is "too low",
 *	    expand minmlev..maxmlev range and try again.
 */
	} /* choice_count+mchoices[] recalc */

	if (rndmonst_state.choice_count <= 0) {
	    /* maybe no common mons left, or all are too weak or too strong */
#ifdef DEBUG
	    Norep("rndmonst: choice_count=%d", rndmonst_state.choice_count);
#endif
	    return (struct permonst *)0;
	}

	if (u.maxrndmonstchoicecount < rndmonst_state.choice_count) u.maxrndmonstchoicecount = rndmonst_state.choice_count;
	if (rndmonst_state.choice_count < 0) impossible("rndmonst_state.choice_count %d", rndmonst_state.choice_count);

/*
 *	Now, select a monster at random.
 */
	ct = rnd(rndmonst_state.choice_count);
	for (mndx = LOW_PM; mndx < SPECIAL_PM; mndx++)
	    if ((ct -= (int)rndmonst_state.mchoices[mndx]) <= 0) break;

	/*if (mndx == SPECIAL_PM || uncommon(mndx)) {*/	/* shouldn't happen */
		/* but Amy edit: possible due to new spawn routine that involves the uncommon function */
	    /*impossible("rndmonst: bad `mndx' [#%d]", mndx);
	    return (struct permonst *)0;
	}*/

	return &mons[mndx];

/*
 * [Tom] Your rival adventurers are a special case:
 *       - They have varying levels, and thus can always appear
 *       - But they need to be sorta rare or else they're a large
 *         percentage of the dungeon inhabitants.
 */

	/* Sorry, but this code is not working, so I'm commenting it out. --Amy */
/*	      if ((monsndx(ptr-1) >= PM_ARCHEOLOGIST) &&
		  (monsndx(ptr-1) <= PM_WIZARD)
		   && (rn2(4))) goto loopback;
*/

}

/* called when you change level (experience or dungeon depth) or when
   monster species can no longer be created (genocide or extinction) */
void
reset_rndmonst(mndx)
int mndx;	/* particular species that can no longer be created */
{
	/* cached selection info is out of date */
	if (mndx == NON_PM) {
	    rndmonst_state.choice_count = -1;	/* full recalc needed */
	} else if (mndx < SPECIAL_PM) {
	    rndmonst_state.choice_count -= rndmonst_state.mchoices[mndx];
	    rndmonst_state.mchoices[mndx] = 0;
	} /* note: safe to ignore extinction of unique monsters */
}

#endif /* OVL0 */
#ifdef OVL1

/*	The routine below is used to make one of the multiple types
 *	of a given monster class.  The second parameter specifies a
 *	special casing bit mask to allow the normal genesis
 *	masks to be deactivated.  Returns 0 if no monsters
 *	in that class can be made.
 */

struct permonst *
mkclass(class,spc)
char	class;
int	spc;
{
	register int    first;
	int tryct = 0;

newtry:
	first = pm_mkclass(class,spc);

	if ((first == -1) && tryct < 1000) {
		tryct++;
		goto newtry;
	}

	if ((mons[first].mlet != class) && tryct < 1000) {
		tryct++;
		goto newtry;
	}
	
	if (first == -1) return((struct permonst *) 0);

	return(&mons[first]);
}

/* Called by mkclass() - returns the pm of the monster 
 * Returns -1 (PM_PLAYERMON) if can't find monster of the class
 *
 * spc may have G_UNIQ and/or G_NOGEN set to allow monsters of
 * this type (otherwise they will be ignored). It may also have
 * MKC_ULIMIT set to place an upper limit on the difficulty of
 * the monster returned.
 */
int
pm_mkclass(class,spc)
char    class;
int     spc;
{
	register int	first, last, num = 0;
	int maxmlev, mask = (G_NOGEN | G_UNIQ) & ~spc;
	if (!rn2(((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) ? 10 : 20) || (Bossfights || u.uprops[BOSSFIGHT].extrinsic || have_bossfightstone() || (ublindf && ublindf->oartifact == ART_CRAWLING_FROM_THE_WOODWORK) || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE) ) || Role_if(PM_TRANSSYLVANIAN) || Race_if(PM_PLAYER_DYNAMO) || isbossrusher || Role_if(PM_GANG_SCHOLAR) ) mask = (G_NOGEN) & ~spc;

	int uncommontwo = 0;
	int uncommonthree = 0;
	int uncommonfive = 0;
	int uncommonseven = 0;
	int uncommonten = 0;
	int minmlev = 0;

	if (!issoviet) {
		uncommontwo = rn2(2) ? 1 : 0;
		uncommonthree = rn2(3) ? 1 : 0;
		uncommonfive = rn2(5) ? 1 : 0;
		uncommonseven = rn2(7) ? 1 : 0;
		uncommonten = rn2(10) ? 1 : 0;
	} else {
		uncommontwo = !rn2(3) ? 1 : 0;
		uncommonthree = rn2(2) ? 1 : 0;
		uncommonfive = rn2(3) ? 1 : 0;
		uncommonseven = rn2(4) ? 1 : 0;
		uncommonten = rn2(5) ? 1 : 0;
	}

	if (((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) && rn2(2)) uncommontwo = 0;
	if (((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) && !rn2(3)) uncommonthree = 0;
	if (((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) && !rn2(5)) uncommonfive = 0;
	if (((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) && !rn2(7)) uncommonseven = 0;
	if (((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) && !rn2(10)) uncommonten = 0;

	if (EntireLevelMode || u.uprops[ENTIRE_LEVEL].extrinsic || have_entirelevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) {
		uncommontwo = 0;
		uncommonthree = 0;
		uncommonfive = 0;
		uncommonseven = 0;
		uncommonten = 0;
	}

	int uncommonnewten = !rn2(10) ? 1 : 0;
	int uncommonnewfifteen = !rn2(5) ? 1 : 0;
	int uncommonnewtwenty = (rnd(10) > 3) ? 1 : 0;
	int uncommonnewtwentyfive = (rnd(10) > 4) ? 1 : 0;
	int uncommonnewthirty = !rn2(2) ? 1 : 0;
	int uncommonnewthirtyfive = (rnd(10) > 6) ? 1 : 0;
	int uncommonnewforty = (rnd(10) > 7) ? 1 : 0;
	int uncommonnewfortyfive = rn2(5) ? 1 : 0;
	int uncommonnewfifty = rn2(10) ? 1 : 0;
	int uncommonnewsixty = rn2(20) ? 1 : 0;
	int uncommonnewseventy = rn2(50) ? 1 : 0;

	if (moves > 100000) {
		int notuncommonlate = 0;
		notuncommonlate = ((moves - 100000) / 10000);
		if (notuncommonlate < 0) notuncommonlate = 0;
		if (notuncommonlate > 1000) notuncommonlate = 1000;

		if (rn2(100) < notuncommonlate) {
			uncommonnewten = 0;
		}
		if (rn2(150) < notuncommonlate) {
			uncommonnewfifteen = 0;
		}
		if (rn2(200) < notuncommonlate) {
			uncommonnewtwenty = 0;
		}
		if (rn2(250) < notuncommonlate) {
			uncommonnewtwentyfive = 0;
		}
		if (rn2(300) < notuncommonlate) {
			uncommonnewthirty = 0;
		}
		if (rn2(350) < notuncommonlate) {
			uncommonnewthirtyfive = 0;
		}
		if (rn2(400) < notuncommonlate) {
			uncommonnewforty = 0;
		}
		if (rn2(450) < notuncommonlate) {
			uncommonnewfortyfive = 0;
		}
		if (rn2(500) < notuncommonlate) {
			uncommonnewfifty = 0;
		}
		if (rn2(600) < notuncommonlate) {
			uncommonnewsixty = 0;
		}
		if (rn2(700) < notuncommonlate) {
			uncommonnewseventy = 0;
		}
	}

	if (((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) && rn2(5)) uncommonnewten = 0;
	if (((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) && rn2(4)) uncommonnewfifteen = 0;
	if (((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) && rn2(3)) uncommonnewtwenty = 0;
	if (((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) && rn2(2)) uncommonnewtwentyfive = 0;
	if (((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) && !rn2(3)) uncommonnewthirty = 0;
	if (((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) && !rn2(4)) uncommonnewthirtyfive = 0;
	if (((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) && !rn2(5)) uncommonnewforty = 0;
	if (((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) && !rn2(6)) uncommonnewfortyfive = 0;
	if (((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) && !rn2(7)) uncommonnewfifty = 0;
	if (((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) && !rn2(8)) uncommonnewsixty = 0;
	if (((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) && !rn2(9)) uncommonnewseventy = 0;

	if (HighlevelStatus || u.uprops[HIGHLEVEL_STATUS].extrinsic || have_highlevelstone() || (uwep && uwep->oartifact == ART_EXTREMELY_HARD_MODE) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_EXTREMELY_HARD_MODE)) {
		uncommonnewten = 0;
		uncommonnewfifteen = 0;
		uncommonnewtwenty = 0;
		uncommonnewtwentyfive = 0;
		uncommonnewthirty = 0;
		uncommonnewthirtyfive = 0;
		uncommonnewforty = 0;
		uncommonnewfortyfive = 0;
		uncommonnewfifty = 0;
		uncommonnewsixty = 0;
		uncommonnewseventy = 0;
	}

	int bonuslevel;
	boolean calctype;

	bonuslevel = 0;
	if (!rn2(5)) bonuslevel += rnd(5);
	if (!rn2(20)) bonuslevel += rnd(7);
	if (!rn2(100)) bonuslevel += rnd(10);
	if (!rn2(500)) bonuslevel += rnd(15);
	if (!rn2(2500)) bonuslevel += rnd(20);
	if (!rn2(20000)) bonuslevel += rnd(30);
	if (!rn2(50000)) bonuslevel += rnd(50);
	if (!rn2(100000)) bonuslevel += rnd(100);

	if (rn2(5)) calctype = 1;
	else calctype = 0;

	/*maxmlev = level_difficulty() >> 1;*/ /* what the heck? does that divide the actual result by 2?! --Amy */
	  maxmlev = monster_difficulty();
	    if (!rn2(100)) maxmlev *= 2;
	    if (!rn2(1000)) maxmlev *= 4;
	    if (!rn2(5)) maxmlev += rnz(2);
	    if (!rn2(20)) maxmlev += rnz(3);
	    if (!rn2(100)) maxmlev += rnz(4);
	    if (!rn2(10000)) maxmlev = 127;
		if (maxmlev > 127) maxmlev = 127; /* very important! The game might otherwise crash or become unstable! */
	if(class < 1 || class >= MAXMCLASSES) {
	    impossible("mkclass called with bad class!");
	    return(-1);
	}

	minmlev = 0;

	if (issoviet && rn2(2) && maxmlev > 2) minmlev = (maxmlev / 2);
	if ((ScalingBug || u.uprops[SCALING_BUG].extrinsic || have_scalingstone() || (uarm && uarm->oartifact == ART_ALPHA_TAURI)) && maxmlev > 2) minmlev += (maxmlev / 2);

	if (((u.aggravation || isaggravator || isextravator || GravationAggravation) && ((ExtAggravate_monster || isextravator || GravationAggravation) || !rn2(2))) && !rn2(3)) {
		minmlev += u.ulevel;
	}

	if (Role_if(PM_PSION) && u.ulevel >= 7) {
		minmlev += maxmlev / 5;
	}

	/* fail safes */
	if (minmlev > 126) minmlev = 126;
	if (minmlev >= maxmlev) maxmlev = minmlev + 1;
	if (maxmlev > 127) maxmlev = 127;
	if (minmlev < 0) minmlev = 0;

	/*pline("max spawn level %d",maxmlev);*/

/*	Assumption #1:	monsters of a given class are contiguous in the
 *			mons[] array.
 */
	for (first = LOW_PM; first < SPECIAL_PM; first++)
	    if (mons[first].mlet == class && !tooweak(first, minmlev) ) break;
	if (first == SPECIAL_PM) return (-1);

	for (last = first;
		last < SPECIAL_PM && mons[last].mlet == class; last++)
	    if (!(mvitals[last].mvflags & G_GONE) && !(mons[last].geno & mask)
					&& !is_placeholder(&mons[last])
					&& !(uncommontwo && uncommon2(&mons[last]) && !jonaspecialspawn(&mons[last]) && !Race_if(PM_RODNEYAN) )
					&& !(uncommonthree && uncommon3(&mons[last]) && !jonaspecialspawn(&mons[last]) && !Race_if(PM_RODNEYAN) )
					&& !(uncommonfive && uncommon5(&mons[last]) && !jonaspecialspawn(&mons[last]) && !Race_if(PM_RODNEYAN) )
					&& !(uncommonseven && uncommon7(&mons[last]) && !jonaspecialspawn(&mons[last]) && !Race_if(PM_RODNEYAN) )
					&& !(uncommonten && uncommon10(&mons[last]) && !jonaspecialspawn(&mons[last]) && !Race_if(PM_RODNEYAN) )
					&& !(uncommonnewten && monstr[last] >= 10 && monstr[last] < 15 )
					&& !(uncommonnewfifteen && monstr[last] >= 15 && monstr[last] < 20 )
					&& !(uncommonnewtwenty && monstr[last] >= 20 && monstr[last] < 25 )
					&& !(uncommonnewtwentyfive && monstr[last] >= 25 && monstr[last] < 30 )
					&& !(uncommonnewthirty && monstr[last] >= 30 && monstr[last] < 35 )
					&& !(uncommonnewthirtyfive && monstr[last] >= 35 && monstr[last] < 40 )
					&& !(uncommonnewforty && monstr[last] >= 40 && monstr[last] < 45 )
					&& !(uncommonnewfortyfive && monstr[last] >= 45 && monstr[last] < 50 )
					&& !(uncommonnewfifty && monstr[last] >= 50 && monstr[last] < 60 )
					&& !(uncommonnewsixty && monstr[last] >= 60 && monstr[last] < 70 )
					&& !(calctype && toostrong(last, (maxmlev + bonuslevel) ) ) 
					&& !(!calctype && (mons[last].mlevel > (maxmlev + bonuslevel)) ) 
					&& !(uncommonnewseventy && monstr[last] >= 70 )
					&& (last != u.nospawnspecies) && (last != u.nospawnspecies2) && (last != u.nospawnspecies3) && (last != u.nospawnspecies4) && (last != u.nospawnspecies5) && (last != u.nospawnspecies6) && (last != u.nospawnspecies7) && (last != u.nospawnspecies8) && (last != u.nospawnspecies9) && (last != u.nospawnspecies10)

				) {
		/* consider it */
		/*if(spc & MKC_ULIMIT && toostrong(last, 4 * maxmlev)) break;*/

		/* too strong calculation shifted to above, so we can finally stop caring about the order in monst.c --Amy */
/*		if(num && (calctype ? toostrong(last, (maxmlev + bonuslevel) ) : mons[last].mlevel > (maxmlev + bonuslevel) ) &&
		   monstr[last] != monstr[last-1]) break; */

		num += mons[last].geno & G_FREQ;
		if (((int)(mons[last].geno & G_FREQ)) == 1 && uarmc && itemhasappearance(uarmc, APP_DIFFERENT_CLOAK)) num++;
		if (last == u.frequentspecies) num += u.freqspeciesbonus;
		if (last == u.frequentspecies2) num += u.freqspeciesbonus2;
		if (last == u.frequentspecies3) num += u.freqspeciesbonus3;
		if (last == u.frequentspecies4) num += u.freqspeciesbonus4;
		if (last == u.frequentspecies5) num += u.freqspeciesbonus5;
		if (last == u.frequentspecies6) num += u.freqspeciesbonus6;
		if (last == u.frequentspecies7) num += u.freqspeciesbonus7;
		if (last == u.frequentspecies8) num += u.freqspeciesbonus8;
		if (last == u.frequentspecies9) num += u.freqspeciesbonus9;
		if (last == u.frequentspecies10) num += u.freqspeciesbonus10;
		if (last == u.frequentspecies11) num += u.freqspeciesbonus11;
		if (last == u.frequentspecies12) num += u.freqspeciesbonus12;
		if (last == u.frequentspecies13) num += u.freqspeciesbonus13;
		if (last == u.frequentspecies14) num += u.freqspeciesbonus14;
		if (last == u.frequentspecies15) num += u.freqspeciesbonus15;
		if (last == u.frequentspecies16) num += u.freqspeciesbonus16;
		if (last == u.frequentspecies17) num += u.freqspeciesbonus17;
		if (last == u.frequentspecies18) num += u.freqspeciesbonus18;
		if (last == u.frequentspecies19) num += u.freqspeciesbonus19;
		if (last == u.frequentspecies20) num += u.freqspeciesbonus20;
		if (mons[last].mcolor == u.frequentcolor) num += u.freqcolorbonus;
		if ((mons[last].mcolor == CLR_MAGENTA || mons[last].mcolor == CLR_BRIGHT_MAGENTA) && SpellColorViolet) num += 20;

		if ((In_gehennom(&u.uz) && is_demon(&mons[last]))) num += 10;
		if ((In_gehennom(&u.uz) && dmgtype(&mons[last], AD_FIRE) )) num += 1;
		if ((In_gehennom(&u.uz) && dmgtype(&mons[last], AD_BURN) )) num += 1;
		if ((In_gehennom(&u.uz) && dmgtype(&mons[last], AD_LAVA) )) num += 1;
		if ((In_gehennom(&u.uz) && is_fire_resistant(&mons[last]) )) num += 1;
		if ((In_mines(&u.uz) && tunnels(&mons[last]) )) num += 2;
		if ((In_sheol(&u.uz) && is_cold_resistant(&mons[last]) )) num += 5;
		if ((In_sheol(&u.uz) && dmgtype(&mons[last], AD_COLD) )) num += 5;
		if ((In_sheol(&u.uz) && dmgtype(&mons[last], AD_FRZE) )) num += 5;
		if ((In_sheol(&u.uz) && dmgtype(&mons[last], AD_ICEB) )) num += 2;
		if ((In_icequeen(&u.uz) && is_cold_resistant(&mons[last]) )) num += 5;
		if ((In_icequeen(&u.uz) && dmgtype(&mons[last], AD_COLD) )) num += 5;
		if ((In_icequeen(&u.uz) && dmgtype(&mons[last], AD_FRZE) )) num += 5;
		if ((In_icequeen(&u.uz) && dmgtype(&mons[last], AD_ICEB) )) num += 5;
		if ((In_towndungeon(&u.uz) && is_angbandmonster(&mons[last]) )) num += 5;
		if ((In_towndungeon(&u.uz) && is_steammonster(&mons[last]) )) num += 1;
		if ((In_towndungeon(&u.uz) && is_animemonster(&mons[last]) )) num += 1;
		if ((In_spiders(&u.uz) && webmaker(&mons[last]) )) num += 10;
		if ((Is_lawful_quest(&u.uz) && dmgtype(&mons[last], AD_SPC2) )) num += 1;
		if ((Is_lawful_quest(&u.uz) && is_covetous(&mons[last]) )) num += 2;
		if ((uarmf && uarmf->oartifact == ART_POWERWARP && is_covetous(&mons[last]) )) num += 5;
		if ((uarmf && uarmf->oartifact == ART_SATAN_S_CHOPPING_BLOCK && attackdamagetype(&mons[last], AT_BREA, AD_DISN) )) num += 200;
		if ((uamul && uamul->oartifact == ART_MOSH_PIT_SCRAMBLE && is_female(&mons[last]) && attacktype(&mons[last], AT_KICK) )) num += 20;
		if ((uarmh && uarmh->oartifact == ART_VACUUM_CLEANER_DEATH && dmgtype(&mons[last], AD_SUCK) )) num += 50;
		if ((uarmf && uarmf->oartifact == ART_CLICHE_WEAR && dmgtype(&mons[last], AD_RUST) )) num += 5;
		if ((uarmf && uarmf->oartifact == ART_CLICHE_WEAR && dmgtype(&mons[last], AD_CORR) )) num += 5;
		if ((uarmf && uarmf->oartifact == ART_CLICHE_WEAR && dmgtype(&mons[last], AD_WTHR) )) num += 5;
		if ((uarmf && uarmf->oartifact == ART_CLICHE_WEAR && dmgtype(&mons[last], AD_DCAY) )) num += 5;
		if ((Is_lawful_quest(&u.uz) && cannot_be_tamed(&mons[last]) )) num += 1;
		if ((Is_lawful_quest(&u.uz) && is_shade(&mons[last]) )) num += 2;
		if ((Is_lawful_quest(&u.uz) && dmgtype(&mons[last], AD_RBRE) )) num += 2;
		if ((In_wyrm(&u.uz) && attacktype(&mons[last], AT_BREA) )) num += 5;
		if ((In_wyrm(&u.uz) && dmgtype(&mons[last], AD_DISE) )) num += 3;
		if ((In_tomb(&u.uz) && is_undead(&mons[last]) )) num += 10;
		if ((In_slsea(&u.uz) && dmgtype(&mons[last], AD_WRAP) )) num += 5;
		if ((In_mtemple(&u.uz) && dmgtype(&mons[last], AD_CLRC) )) num += 7;
		if ((In_gcavern(&u.uz) && throws_rocks(&mons[last]) )) num += 5;
		if ((In_gcavern(&u.uz) && hugemonst(&mons[last]) )) num += 3;
		if ((In_frnkn(&u.uz) && dmgtype(&mons[last], AD_POLY) )) num += 2;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_SPC2) )) num += 15;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_STUN) )) num += 7;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_DRIN) )) num += 5;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_HALU) )) num += 8;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_DARK) )) num += 5;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_FEAR) )) num += 4;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_FAKE) )) num += 7;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_LETH) )) num += 2;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_CNCL) )) num += 1;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_BLAS) )) num += 1;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_BANI) )) num += 2;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_WISD) )) num += 3;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_HODS) )) num += 3;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_CHRN) )) num += 7;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_WEEP) )) num += 2;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_STTP) )) num += 1;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_DEPR) )) num += 5;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_LAZY) )) num += 5;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_INER) )) num += 3;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_VULN) )) num += 4;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_AMNE) )) num += 10;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_INSA) )) num += 10;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_SANI) )) num += 10;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_TRAP) )) num += 8;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_SHAN) )) num += 8;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_TERR) )) num += 10;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_FEMI) )) num += 4;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_LEVI) )) num += 7;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_MCRE) )) num += 5;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_DEBU) )) num += 5;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_UNPR) )) num += 10;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[last], AD_ILLU) )) num += 20;
		if ((In_illusorycastle(&u.uz) && shapechanger(&mons[last]) )) num += 5;
		if ((In_illusorycastle(&u.uz) && is_angbandmonster(&mons[last]) )) num += 3;
		if ((In_illusorycastle(&u.uz) && is_animemonster(&mons[last]) )) num += 1;
		if ((In_illusorycastle(&u.uz) && is_steammonster(&mons[last]) )) num += 1;
		if ((In_voiddungeon(&u.uz) && is_angbandmonster(&mons[last]) )) num += 5;
		if ((In_voiddungeon(&u.uz) && is_animemonster(&mons[last]) )) num += 3;
		if ((In_voiddungeon(&u.uz) && is_steammonster(&mons[last]) )) num += 3;
		if ((In_voiddungeon(&u.uz) && passes_walls(&mons[last]) )) num += 5;
		if ((In_netherrealm(&u.uz) && is_demon(&mons[last]) )) num += 10;
		if ((In_netherrealm(&u.uz) && dmgtype(&mons[last], AD_NTHR) )) num += 5;
		if ((In_netherrealm(&u.uz) && dmgtype(&mons[last], AD_DRLI) )) num += 5;
		if ((In_deepmines(&u.uz) && tunnels(&mons[last]) )) num += 4;
		if ((In_deepmines(&u.uz) && humanoid(&mons[last]) )) num += 2;
		if ((In_angmar(&u.uz) && (mons[last].maligntyp < 0) )) num += 15;
		if ((In_emynluin(&u.uz) && is_angbandmonster(&mons[last]) )) num += 10;
		if ((In_emynluin(&u.uz) && is_animemonster(&mons[last]) )) num += 2;
		if ((In_emynluin(&u.uz) && is_steammonster(&mons[last]) )) num += 5;
		if ((In_greencross(&u.uz) && is_cowmonster(&mons[last]) )) num += 50;
		if ((In_greencross(&u.uz) && is_jokemonster(&mons[last]) )) num += 5;
		if ((In_swimmingpool(&u.uz) && dmgtype(&mons[last], AD_WRAP) )) num += 10;
		if ((In_swimmingpool(&u.uz) && amphibious(&mons[last]) )) num += 10;
		if ((In_swimmingpool(&u.uz) && is_swimmer(&mons[last]) )) num += 10;
		if ((In_hellbathroom(&u.uz) && (mons[last].msound == MS_FART_NORMAL) )) num += 10;
		if ((In_hellbathroom(&u.uz) && (mons[last].msound == MS_FART_QUIET) )) num += 10;
		if ((In_hellbathroom(&u.uz) && (mons[last].msound == MS_FART_LOUD) )) num += 10;
		if ((uwep && uwep->oartifact == ART_BIDETHANDER && (mons[last].msound == MS_FART_LOUD) )) num += 20;
		if ((u.twoweap && uswapwep && uswapwep->oartifact == ART_BIDETHANDER && (mons[last].msound == MS_FART_LOUD) )) num += 20;
		if ((In_hellbathroom(&u.uz) && dmgtype(&mons[last], AD_FEMI) )) num += 15;
		if ((In_minusworld(&u.uz) && is_randomizedmonster(&mons[last]) )) num += 500;
		if ((In_ZAPM(&u.uz) && is_evilpatchmonster(&mons[last]) )) num += 20;
		if ((In_sewerplant(&u.uz) && acidic(&mons[last]) )) num += 4;
		if ((In_sewerplant(&u.uz) && poisonous(&mons[last]) )) num += 3;
		if ((In_gammacaves(&u.uz) && dmgtype(&mons[last], AD_CONT) )) num += 7;
		if ((In_mainframe(&u.uz) && is_demon(&mons[last]) )) num += 25;
		if ((In_mainframe(&u.uz) && attacktype(&mons[last], AT_BREA) )) num += 10;

		if ((Role_if(PM_ACTIVISTOR) && always_hostile(&mons[last]))) num += 5;
		if ((Role_if(PM_ALTMER) && is_reflector(&mons[last]))) num += 3;
		if ((Role_if(PM_AMAZON) && is_diablomonster(&mons[last]))) num += 5;
		if ((Role_if(PM_AMAZON) && attacktype(&mons[last], AT_CLAW) )) num += 1;
		if ((Role_if(PM_ANACHRONIST) && is_dnethackmonster(&mons[last]))) num += 10;
		if ((Role_if(PM_ARCHEOLOGIST) && is_vanillamonster(&mons[last]))) num += 1;
		if ((uimplant && uimplant->oartifact == ART_GELMER_KELANA_TWIN && is_vanillamonster(&mons[last]))) num += 10;
		if ((Role_if(PM_ARTIST) && attacktype(&mons[last], AT_GAZE))) num += 2;
		if ((Role_if(PM_ASSASSIN) && is_diablomonster(&mons[last]))) num += 5;
		if ((Role_if(PM_BARBARIAN) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Role_if(PM_NOOB_MODE_BARB) && is_vanillamonster(&mons[last]))) num += 5;
		if ((Role_if(PM_BARBARIAN) && is_diablomonster(&mons[last]))) num += 1;
		if ((Role_if(PM_BINDER) && is_dnethackmonster(&mons[last]))) num += 10;
		if ((Role_if(PM_ANACHRONOUNBINDER) && is_dnethackmonster(&mons[last]))) num += 10;
		if ((Role_if(PM_BINDER) && extra_nasty(&mons[last]))) num += 2;
		if ((Role_if(PM_BINDER) && is_undead(&mons[last]))) num += 2;
		if ((Role_if(PM_BLEEDER) && (mons[last].msound == MS_SHOE))) num += 10;
		if ((Role_if(PM_BLOODSEEKER) && has_blood(&mons[last]))) num += 1;
		if ((Role_if(PM_CAMPERSTRIKER) && is_cowmonster(&mons[last]))) num += 5;
		if ((Role_if(PM_CAMPERSTRIKER) && is_jokemonster(&mons[last]))) num += 5;
		if ((Role_if(PM_CAVEMAN) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Role_if(PM_CHEVALIER) && dmgtype(&mons[last], AD_ICUR))) num += 1;
		if ((Role_if(PM_CONVICT) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Role_if(PM_CONVICT) && (mons[last].msound == MS_ARREST))) num += 2;
		if ((Role_if(PM_COURIER) && is_animal(&mons[last]))) num += 1;
		if ((Role_if(PM_CRUEL_ABUSER) && cannot_be_tamed(&mons[last]))) num += 3;
		if ((Role_if(PM_DOLL_MISTRESS) && is_animemonster(&mons[last]))) num += 1;
		if ((Role_if(PM_DOOM_MARINE) && attacktype(&mons[last], AT_BEAM))) num += 5;
		if ((Role_if(PM_DQ_SLIME) && verysmall(&mons[last]))) num += 5;
		if ((Role_if(PM_DRUID) && is_diablomonster(&mons[last]))) num += 5;
		if ((Role_if(PM_ERDRICK) && is_multihued(&mons[last]))) num += 10;
		if ((Role_if(PM_FAILED_EXISTENCE) && (mons[last].msound == MS_SHOE))) num += 5;
		if ((Role_if(PM_FIREFIGHTER) && is_fire_resistant(&mons[last]))) num += 2;
		if ((Role_if(PM_FLAME_MAGE) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Role_if(PM_GLADIATOR) && is_animal(&mons[last]))) num += 1;
		if ((Role_if(PM_GLADIATOR) && humanoid(&mons[last]))) num += 1;
		if ((Role_if(PM_GOFF) && (mons[last].msound == MS_CUSS))) num += 2;
		if ((Role_if(PM_HEALER) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Role_if(PM_ICE_MAGE) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Role_if(PM_JEDI) && is_cowmonster(&mons[last]))) num += 2;
		if ((Role_if(PM_JEDI) && is_jokemonster(&mons[last]))) num += 1;
		if ((Role_if(PM_KNIGHT) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Role_if(PM_KNIGHT) && (mons[last].msound == MS_NEIGH))) num += 2;
		if ((Role_if(PM_LADIESMAN) && (mons[last].msound == MS_FART_NORMAL))) num += 10;
		if ((Role_if(PM_LADIESMAN) && (mons[last].msound == MS_FART_QUIET))) num += 10;
		if ((Role_if(PM_LADIESMAN) && (mons[last].msound == MS_FART_LOUD))) num += 10;
		if ((Role_if(PM_LADIESMAN) && (mons[last].msound == MS_WHORE))) num += 25;
		if ((Role_if(PM_MAHOU_SHOUJO) && is_animemonster(&mons[last]))) num += 10;
		if ((Role_if(PM_MEDIUM) && dmgtype(&mons[last], AD_SPC2))) num += 2;
		if ((Role_if(PM_MEDIUM) && is_mind_flayer(&mons[last]))) num += 1;
		if ((Role_if(PM_MONK) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Role_if(PM_HALF_BAKED) && is_vanillamonster(&mons[last]))) num += 5;
		if ((Role_if(PM_MURDERER) && (mons[last].msound == MS_ARREST))) num += 5;
		if ((Role_if(PM_NECROMANCER) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Role_if(PM_NECROMANCER) && is_diablomonster(&mons[last]))) num += 1;
		if ((Role_if(PM_NECROMANCER) && is_undead(&mons[last]))) num += 2;
		if ((Role_if(PM_NOBLEMAN) && is_dnethackmonster(&mons[last]))) num += 5;
		if ((Role_if(PM_OCCULT_MASTER) && is_dlordsmonster(&mons[last]))) num += 3;
		if ((Role_if(PM_OTAKU) && is_elonamonster(&mons[last]))) num += 3;
		if ((uarm && uarm->oartifact == ART_ALPHA_TAURI && is_elonamonster(&mons[last]))) num += 20;
		if ((Race_if(PM_WISP) && is_elonamonster(&mons[last]))) num += 3;
		if ((Race_if(PM_MAZIN) && is_elonamonster(&mons[last]))) num += 5;
		if ((Race_if(PM_MAZIN) && attacktype(&mons[last], AT_MAGC))) num += 3;
		if ((Race_if(PM_HUNKAJUNK) && dmgtype(&mons[last], AD_TERR))) num += 5;
		if ((Race_if(PM_HUNKAJUNK) && (mons[last].msound == MS_SOVIET))) num += 10;
		if ((Race_if(PM_ELONA_SNAIL) && is_elonamonster(&mons[last]))) num += 10;
		if ((Race_if(PM_WEAPONIZED_DINOSAUR) && is_elonamonster(&mons[last]))) num += 2;
		if ((Role_if(PM_OFFICER) && always_hostile(&mons[last]))) num += 2;
		if ((Role_if(PM_OTAKU) && is_animemonster(&mons[last]))) num += 5;
		if ((Role_if(PM_PALADIN) && is_diablomonster(&mons[last]))) num += 5;
		if ((Role_if(PM_PIRATE) && is_dnethackmonster(&mons[last]))) num += 5;
		if ((Role_if(PM_POKEMON) && is_pokemon(&mons[last]))) num += 10;
		if ((Role_if(PM_PRIEST) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Role_if(PM_PSION) && extra_nasty(&mons[last]))) num += 2;
		if ((Role_if(PM_PSION) && is_covetous(&mons[last]))) num += 10;
		if ((Role_if(PM_PSION) && is_reviver(&mons[last]))) num += 3;
		if ((Role_if(PM_PSION) && is_reflector(&mons[last]))) num += 3;
		if ((Role_if(PM_PSION) && attacktype(&mons[last], AT_MAGC))) num += 5;
		if ((Role_if(PM_PSION) && passes_walls(&mons[last]))) num += 3;	
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_SPC2))) num += 3;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_SSEX))) num += 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_DETH))) num += 1;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_FAMN))) num += 1;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_PEST))) num += 1;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_SLIM))) num += 3;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_WTHR))) num += 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_NPRO))) num += 1;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_LETH))) num += 2;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_CNCL))) num += 3;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_BLAS))) num += 3;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_BANI))) num += 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_SUCK))) num += 2;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_UVUU))) num += 7;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_STTP))) num += 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_WRAT))) num += 2;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_DFOO))) num += 2;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_NAST))) num += 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_AMNE))) num += 3;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_CURS))) num += 20;
		if ((Role_if(PM_RANGER) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Role_if(PM_ROCKER) && is_ston_resistant(&mons[last]))) num += 2;
		if ((Role_if(PM_ROGUE) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Role_if(PM_ROGUE) && has_head(&mons[last]))) num += 1;
		if ((Role_if(PM_SAGE) && is_undead(&mons[last]))) num += 1;
		if ((Role_if(PM_SAIYAN) && is_animemonster(&mons[last]))) num += 2;
		if ((Role_if(PM_SAMURAI) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Role_if(PM_SHAPESHIFTER) && extra_nasty(&mons[last]))) num += 1;
		if ((Role_if(PM_SHAPESHIFTER) && is_covetous(&mons[last]))) num += 3;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[last], AD_SLIM))) num += 2;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[last], AD_CNCL))) num += 1;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[last], AD_STTP))) num += 2;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[last], AD_NAST))) num += 20;
		if ((Role_if(PM_SLAVE_MASTER) && is_domestic(&mons[last]))) num += 2;
		if ((Role_if(PM_SPACEWARS_FIGHTER) && is_cowmonster(&mons[last]))) num += 5;
		if ((Role_if(PM_SPACEWARS_FIGHTER) && is_jokemonster(&mons[last]))) num += 3;
		if ((Role_if(PM_SUPERMARKET_CASHIER) && likes_gold(&mons[last]))) num += 5;
		if ((Role_if(PM_TOPMODEL) && (mons[last].msound == MS_SHOE))) num += 5;
		if ((Role_if(PM_TOURIST) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Role_if(PM_TOURIST) && haseyes(&mons[last]))) num += 5;
		if ((Role_if(PM_TRANSSYLVANIAN) && (mons[last].msound == MS_SHOE))) num += 5;
		if ((Role_if(PM_TRANSSYLVANIAN) && dmgtype(&mons[last], AD_NAST))) num += 5;
		if ((Role_if(PM_TRANSVESTITE) && (mons[last].msound == MS_SHOE))) num += 5;
		if ((Role_if(PM_PROSTITUTE) && (mons[last].msound == MS_SHOE))) num += 5;
		if ((Role_if(PM_KURWA) && (mons[last].msound == MS_SHOE))) num += 5;
		if ((Role_if(PM_PROSTITUTE) && attacktype(&mons[last], AT_CLAW) && (mons[last].msound == MS_SQEEK))) num += 30;
		if ((Role_if(PM_KURWA) && attacktype(&mons[last], AT_CLAW) && (mons[last].msound == MS_SQEEK))) num += 30;
		if ((FemtrapActiveDora && attacktype(&mons[last], AT_CLAW) && (mons[last].msound == MS_SQEEK))) num += 30;
		if ((FemtrapActiveManuela && spawnswithblockheels(&mons[last]) )) num += 100;
		if ((uarmf && uarmf->oartifact == ART_RUEA_S_FAILED_CONVERSION && attacktype(&mons[last], AT_CLAW) && (mons[last].msound == MS_SQEEK))) num += 30;
		if ((Role_if(PM_PROSTITUTE) && dmgtype(&mons[last], AD_SSEX))) num += 20;
		if ((Role_if(PM_KURWA) && dmgtype(&mons[last], AD_SSEX))) num += 20;
		if ((Role_if(PM_UNBELIEVER) && is_angbandmonster(&mons[last]))) num += 10;
		if ((Role_if(PM_UNBELIEVER) && is_steammonster(&mons[last]))) num += 2;
		if ((Role_if(PM_UNDEAD_SLAYER) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Role_if(PM_UNDEAD_SLAYER) && is_undead(&mons[last]))) num += 10;
		if ((Role_if(PM_UNDERTAKER) && is_undead(&mons[last]))) num += 20;
		if ((Role_if(PM_STAND_USER) && amorphous(&mons[last]))) num += 5;
		if ((Role_if(PM_VALKYRIE) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Role_if(PM_VANILLA_VALK) && is_vanillamonster(&mons[last]))) num += 10;
		if ((Role_if(PM_WANDKEEPER) && is_poison_resistant(&mons[last]))) num += 1;
		if ((Role_if(PM_WARRIOR) && is_dlordsmonster(&mons[last]))) num += 1;
		if ((Role_if(PM_WILD_TALENT) && is_angbandmonster(&mons[last]))) num += 5;
		if ((Role_if(PM_WILD_TALENT) && is_steammonster(&mons[last]))) num += 5;
		if ((Role_if(PM_WILD_TALENT) && is_animemonster(&mons[last]))) num += 3;
		if ((Role_if(PM_WIZARD) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Role_if(PM_YEOMAN) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Role_if(PM_YEOMAN) && is_domestic(&mons[last]))) num += 2;
		if ((Role_if(PM_ZOOKEEPER) && is_domestic(&mons[last]))) num += 20;
		if ((Race_if(PM_AK_THIEF_IS_DEAD_) && is_cowmonster(&mons[last]))) num += 10;
		if ((Race_if(PM_AK_THIEF_IS_DEAD_) && is_jokemonster(&mons[last]))) num += 10;
		if ((Race_if(PM_ALCHEMIST) && is_covetous(&mons[last]))) num += 5;
		if ((Race_if(PM_ALCHEMIST) && extra_nasty(&mons[last]))) num += 5;
		if ((Race_if(PM_ANGBANDER) && is_angbandmonster(&mons[last]))) num += 5;
		if ((Race_if(PM_ANGBANDER) && is_steammonster(&mons[last]))) num += 3;
		if ((Race_if(PM_ANGBANDER) && is_animemonster(&mons[last]))) num += 1;
		if ((Race_if(PM_HUMANOID_ANGEL) && is_demon(&mons[last]))) num += 10;
		if ((Race_if(PM_HUMANOID_ANGEL) && always_hostile(&mons[last]))) num += 4;
		if ((Race_if(PM_HUMANOID_ANGEL) && extra_nasty(&mons[last]))) num += 1;
		if ((isaquarian && is_swimmer(&mons[last]))) num += 5;
		if ((Race_if(PM_BATMAN) && is_neuter(&mons[last]))) num += 20;
		if ((Race_if(PM_BATMAN) && is_animal(&mons[last]))) num += 5;
		if ((Race_if(PM_CHIROPTERAN) && is_dnethackmonster(&mons[last]))) num += 5;
		if ((Race_if(PM_ETHEREALOID) && is_dnethackmonster(&mons[last]))) num += 10;
		if ((Race_if(PM_INCORPOREALOID) && is_dnethackmonster(&mons[last]))) num += 10;
		if ((Race_if(PM_CLOCKWORK_AUTOMATON) && is_dnethackmonster(&mons[last]))) num += 3;
		if ((Race_if(PM_CLOCKWORK_AUTOMATON) && always_peaceful(&mons[last]))) num += 2;
		if ((Race_if(PM_CORTEX) && unsolid(&mons[last]))) num += 2;
		if ((Race_if(PM_CORTEX) && nolimbs(&mons[last]))) num += 5;
		if ((Race_if(PM_DEATHMOLD) && is_angbandmonster(&mons[last]))) num += 1;
		if ((Race_if(PM_DEATHMOLD) && is_steammonster(&mons[last]))) num += 1;
		if ((Race_if(PM_DEATHMOLD) && is_animemonster(&mons[last]))) num += 1;
		if ((Race_if(PM_DOPPELGANGER) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Race_if(PM_BORG) && is_jokemonster(&mons[last]))) num += 4;
		if ((Race_if(PM_DROW) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Race_if(PM_DWARF) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Race_if(PM_ELF) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Race_if(PM_GNOME) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Race_if(PM_PLAYER_GREMLIN) && dmgtype(&mons[last], AD_DARK))) num += 3;
		if ((Race_if(PM_HERBALIST) && is_covetous(&mons[last]))) num += 5;
		if ((Race_if(PM_HERBALIST) && extra_nasty(&mons[last]))) num += 5;
		if ((Race_if(PM_BORG) && extra_nasty(&mons[last]))) num += 3;
		if ((Race_if(PM_HOBBIT) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Race_if(PM_HUMAN) && is_vanillamonster(&mons[last]))) num += 2;
		if ((Race_if(PM_IMMUNIZER) && dmgtype(&mons[last], AD_CURS))) num += 7;
		if ((Race_if(PM_INCANTIFIER) && is_dnethackmonster(&mons[last]))) num += 3;
		if ((Race_if(PM_INKA) && is_elf(&mons[last]))) num += 3;
		if ((Race_if(PM_INSECTOID) && (mons[last].msound == MS_BUZZ))) num += 4;
		if ((Race_if(PM_KOP) && always_tame(&mons[last]))) num += 5;
		if ((Race_if(PM_HUMAN_WEREWOLF) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Race_if(PM_MISSINGNO) && is_pokemon(&mons[last]))) num += 3;
		if ((Race_if(PM_NAVI) && (mons[last].msound == MS_SHOE))) num += 2;
		if ((Race_if(PM_ORC) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Race_if(PM_PEACEMAKER) && always_hostile(&mons[last]))) num += 3;
		if ((Race_if(PM_PEACEMAKER) && cannot_be_tamed(&mons[last]))) num += 2;
		if ((isrougelike && is_vanillamonster(&mons[last]))) num += 5;
		if ((Race_if(PM_SINNER) && dmgtype(&mons[last], AD_SSEX))) num += 2;
		if ((Race_if(PM_SKILLOR) && dmgtype(&mons[last], AD_SKIL))) num += 5;
		if ((issoviet && is_vanillamonster(&mons[last]))) num += 20;
		if ((Race_if(PM_SPIRIT) && passes_walls(&mons[last]))) num += 2;
		if ((Race_if(PM_WEAPON_TRAPPER) && dmgtype(&mons[last], AD_WEBS))) num += 2;
		if ((Race_if(PM_UNALIGNMENT_THING) && is_dnethackmonster(&mons[last]))) num += 1;
		if ((Race_if(PM_VAMPIRE) && is_vanillamonster(&mons[last]))) num += 1;
		if ((Race_if(PM_VENTURE_CAPITALIST) && likes_gold(&mons[last]))) num += 4;
		if ((Race_if(PM_VORTEX) && unsolid(&mons[last]))) num += 5;
		if ((Race_if(PM_VORTEX) && nolimbs(&mons[last]))) num += 12;
		if ((iswindinhabitant && is_cowmonster(&mons[last]))) num += 5;
		if ((iswindinhabitant && is_jokemonster(&mons[last]))) num += 2;
		if ((Race_if(PM_WORM_THAT_WALKS) && is_dnethackmonster(&mons[last]))) num += 5;
		if ((Race_if(PM_YUKI_PLAYA) && is_dnethackmonster(&mons[last]))) num += 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_VAPO))) num += 2;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_EDGE))) num += 2;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_NGEN))) num += 3;
		if ((Race_if(PM_WEAPON_TRAPPER) && dmgtype(&mons[last], AD_TRAP))) num += 1;
		if ((Role_if(PM_ALTMER) && (mons[last].msound == MS_STENCH))) num += 1;
		if ((Role_if(PM_ALTMER) && dmgtype(&mons[last], AD_WGHT))) num += 2;
		if ((Role_if(PM_CHAOS_SORCEROR) && dmgtype(&mons[last], AD_CHAO))) num += 1;
		if ((Role_if(PM_FAILED_EXISTENCE) && (mons[last].msound == MS_STENCH))) num += 2;
		if ((Role_if(PM_MAHOU_SHOUJO) && (mons[last].msound == MS_STENCH))) num += 3;
		if ((Role_if(PM_MONK) && dmgtype(&mons[last], AD_CAST))) num += 1;
		if ((Role_if(PM_MUSICIAN) && dmgtype(&mons[last], AD_MIDI))) num += 2;
		if ((Role_if(PM_PSION) && (mons[last].msound == MS_STENCH))) num += 4;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_RNG))) num += 3;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[last], AD_RNG))) num += 2;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[last], AD_MIDI))) num += 2;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[last], AD_CAST))) num += 2;
		if ((Role_if(PM_WILD_TALENT) && dmgtype(&mons[last], AD_RNG))) num += 3;
		if ((Race_if(PM_ALCHEMIST) && (mons[last].msound == MS_STENCH))) num += 3;
		if ((Race_if(PM_ALCHEMIST) && dmgtype(&mons[last], AD_RNG))) num += 1;
		if ((Race_if(PM_ALCHEMIST) && dmgtype(&mons[last], AD_LITT))) num += 2;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[last], AD_CAST))) num += 4;
		if ((Race_if(PM_BORG) && dmgtype(&mons[last], AD_ICEB))) num += 1;
		if ((Race_if(PM_BORG) && dmgtype(&mons[last], AD_VOMT))) num += 2;
		if ((Race_if(PM_BORG) && dmgtype(&mons[last], AD_FREN))) num += 5;
		if ((Race_if(PM_BORG) && dmgtype(&mons[last], AD_INSA))) num += 2;
		if ((Race_if(PM_BORG) && dmgtype(&mons[last], AD_TRAP))) num += 3;
		if ((Race_if(PM_BORG) && dmgtype(&mons[last], AD_NTHR))) num += 2;
		if ((Race_if(PM_BORG) && dmgtype(&mons[last], AD_MIDI))) num += 1;
		if ((Race_if(PM_DEATHMOLD) && dmgtype(&mons[last], AD_MIDI))) num += 2;
		if ((Race_if(PM_DEATHMOLD) && dmgtype(&mons[last], AD_RNG))) num += 3;
		if ((Race_if(PM_DESTABILIZER) && dmgtype(&mons[last], AD_VAPO))) num += 4;
		if ((Race_if(PM_DESTABILIZER) && dmgtype(&mons[last], AD_EDGE))) num += 2;
		if ((Race_if(PM_DESTABILIZER) && dmgtype(&mons[last], AD_LITT))) num += 1;
		if ((Race_if(PM_DOPPELGANGER) && dmgtype(&mons[last], AD_RNG))) num += 2;
		if ((Race_if(PM_HEMI_DOPPELGANGER) && dmgtype(&mons[last], AD_RNG))) num += 1;
		if ((Race_if(PM_PLAYER_GOLEM) && dmgtype(&mons[last], AD_FAMN))) num += 20;
		if ((Race_if(PM_PLAYER_JABBERWOCK) && bigmonst(&mons[last]))) num += 1;
		if ((Race_if(PM_HERBALIST) && dmgtype(&mons[last], AD_LITT))) num += 4;
		if ((Race_if(PM_HERBALIST) && (mons[last].msound == MS_STENCH))) num += 5;
		if ((Race_if(PM_RODNEYAN) && (mons[last].msound == MS_STENCH))) num += 4;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[last], AD_CAST))) num += 10;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[last], AD_RNG))) num += 4;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[last], AD_CONT))) num += 10;
		if ((Role_if(PM_ALTMER) && dmgtype(&mons[last], AD_CONT) )) num += 5;
		if ((Role_if(PM_ALTMER) && dmgtype(&mons[last], AD_MINA) )) num += 2;
		if ((Role_if(PM_ALTMER) && dmgtype(&mons[last], AD_AGGR) )) num += 2;
		if ((Role_if(PM_ASSASSIN) && dmgtype(&mons[last], AD_ALIN) )) num += 1;
		if ((Role_if(PM_BINDER) && dmgtype(&mons[last], AD_SIN) )) num += 5;
		if ((Role_if(PM_CONVICT) && dmgtype(&mons[last], AD_SIN) )) num += 1;
		if ((Role_if(PM_MURDERER) && dmgtype(&mons[last], AD_SIN) )) num += 1;
		if ((Role_if(PM_COURIER) && dmgtype(&mons[last], AD_AGGR) )) num += 3;
		if ((Role_if(PM_DQ_SLIME) && dmgtype(&mons[last], AD_CONT) )) num += 1;
		if ((Role_if(PM_FAILED_EXISTENCE) && dmgtype(&mons[last], AD_AGGR) )) num += 2;
		if ((Role_if(PM_KURWA) && dmgtype(&mons[last], AD_MINA) )) num += 2;
		if ((Role_if(PM_MAHOU_SHOUJO) && dmgtype(&mons[last], AD_AGGR) )) num += 1;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_CONT) )) num += 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_MINA) )) num += 10;
		if ((Role_if(PM_SCIENTIST) && dmgtype(&mons[last], AD_CONT) )) num += 4;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[last], AD_CONT) )) num += 5;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[last], AD_MINA) )) num += 3;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[last], AD_SIN) )) num += 2;
		if ((Role_if(PM_UNBELIEVER) && dmgtype(&mons[last], AD_ALIN) )) num += 2;
		if ((Role_if(PM_ZYBORG) && dmgtype(&mons[last], AD_CONT) )) num += 1;
		if ((Race_if(PM_ALBAE) && dmgtype(&mons[last], AD_AGGR) )) num += 5;
		if ((Race_if(PM_ALCHEMIST) && dmgtype(&mons[last], AD_CONT) )) num += 5;
		if ((Race_if(PM_DOPPELGANGER) && dmgtype(&mons[last], AD_CONT) )) num += 3;
		if ((Race_if(PM_DOPPELGANGER) && dmgtype(&mons[last], AD_AGGR) )) num += 5;
		if ((Race_if(PM_HERBALIST) && dmgtype(&mons[last], AD_CONT) )) num += 5;
		if ((Race_if(PM_IMMUNIZER) && dmgtype(&mons[last], AD_CONT) )) num += 5;
		if ((Race_if(PM_IMMUNIZER) && dmgtype(&mons[last], AD_AGGR) )) num += 5;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[last], AD_CONT) )) num += 7;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[last], AD_MINA) )) num += 6;
		if ((Race_if(PM_SINNER) && dmgtype(&mons[last], AD_SIN) )) num += 2;
		if ((Race_if(PM_SPIRIT) && dmgtype(&mons[last], AD_AGGR) )) num += 6;
		if ((Role_if(PM_FEMINIST) && is_male(&mons[last]) )) num += 2;
		if ((Role_if(PM_FEMINIST) && attacktype(&mons[last], AT_LASH) )) num += 3;
		if ((Role_if(PM_GANG_SCHOLAR) && (mons[last].msound == MS_FART_NORMAL) )) num += 20;
		if ((Role_if(PM_GANG_SCHOLAR) && (mons[last].msound == MS_FART_QUIET) )) num += 20;
		if ((Role_if(PM_GANG_SCHOLAR) && (mons[last].msound == MS_FART_LOUD) )) num += 20;
		if ((Role_if(PM_GANG_SCHOLAR) && (mons[last].msound == MS_STENCH) )) num += 50;
		if ((Role_if(PM_GANG_SCHOLAR) && is_jokemonster(&mons[last]) )) num += 100;
		if ((Role_if(PM_GANG_SCHOLAR) && is_cowmonster(&mons[last]) )) num += 20;
		if ((FemtrapActiveAriane && (mons[last].msound == MS_FART_NORMAL) )) num += 20;
		if ((FemtrapActiveAriane && (mons[last].msound == MS_FART_QUIET) )) num += 20;
		if ((FemtrapActiveAriane && (mons[last].msound == MS_FART_LOUD) )) num += 20;
		if ((FemtrapActiveAriane && (mons[last].msound == MS_STENCH) )) num += 50;
		if ((FemtrapActiveAriane && is_jokemonster(&mons[last]) )) num += 100;
		if ((FemtrapActiveAriane && is_cowmonster(&mons[last]) )) num += 20;

		if ((Role_if(PM_WALSCHOLAR) && is_jokemonster(&mons[last]) )) num += 20;
		if ((Role_if(PM_WALSCHOLAR) && (mons[last].msound == MS_FART_NORMAL) )) num += 5;
		if ((Role_if(PM_WALSCHOLAR) && (mons[last].msound == MS_FART_QUIET) )) num += 5;
		if ((Role_if(PM_WALSCHOLAR) && (mons[last].msound == MS_FART_LOUD) )) num += 5;
		if ((Role_if(PM_WALSCHOLAR) && (mons[last].msound == MS_STENCH) )) num += 20;
		if ((Role_if(PM_WALSCHOLAR) && (mons[last].msound == MS_CONVERT) )) num += 5;
		if ((Role_if(PM_WALSCHOLAR) && (mons[last].msound == MS_HCALIEN) )) num += 5;
		if ((Role_if(PM_SINGSLAVE) && (mons[last].msound == MS_SING) )) num += 25;
		if ((Role_if(PM_CELLAR_CHILD) && is_angbandmonster(&mons[last]) )) num += 20;
		if ((uamul && uamul->oartifact == ART_WALT_VERSUS_ANNA && (mons[last].msound == MS_FART_NORMAL) )) num += 5;
		if ((uamul && uamul->oartifact == ART_WALT_VERSUS_ANNA && (mons[last].msound == MS_FART_QUIET) )) num += 5;
		if ((uamul && uamul->oartifact == ART_WALT_VERSUS_ANNA && (mons[last].msound == MS_FART_LOUD) )) num += 5;
		if ((uamul && uamul->oartifact == ART_WALT_VERSUS_ANNA && (mons[last].msound == MS_STENCH) )) num += 20;
		if ((Role_if(PM_DEMAGOGUE) && (mons[last].mresists & MR_PLUSFOUR))) num += 1;
		if ((Role_if(PM_SOCIAL_JUSTICE_WARRIOR) && (mons[last].mflags2 & M2_DEMON) )) num += 5;
		if ((Role_if(PM_DEMAGOGUE) && (mons[last].mflags3 & M3_NOTAME) )) num += 2;
		if ((Race_if(PM_DEMAGOGUE) && dmgtype(&mons[last], AD_WTHR) )) num += 2;
		if ((Race_if(PM_DEMAGOGUE) && dmgtype(&mons[last], AD_LETH) )) num += 1;
		if ((Race_if(PM_DEMAGOGUE) && dmgtype(&mons[last], AD_CNCL) )) num += 2;
		if ((Race_if(PM_DEMAGOGUE) && dmgtype(&mons[last], AD_SIN) )) num += 2;
		if ((Race_if(PM_DEMAGOGUE) && dmgtype(&mons[last], AD_DEST) )) num += 2;
		if ((Race_if(PM_DEMAGOGUE) && dmgtype(&mons[last], AD_AGGR) )) num += 5;
		if ((Race_if(PM_CELLAR_CHILD) && dmgtype(&mons[last], AD_SANI) )) num += 5;
		if ((Race_if(PM_SOCIAL_JUSTICE_WARRIOR) && dmgtype(&mons[last], AD_BANI) )) num += 1;
		if ((Race_if(PM_SOCIAL_JUSTICE_WARRIOR) && dmgtype(&mons[last], AD_DFOO) )) num += 2;

		if ((Race_if(PM_HUMANOID_ANGEL) && is_evilpatchmonster(&mons[last]))) num += 5;
		if ((Role_if(PM_PSION) && is_evilpatchmonster(&mons[last]))) num += 10;
		if ((Race_if(PM_DOPPELGANGER) && is_evilpatchmonster(&mons[last]))) num += 2;
		if ((Role_if(PM_ALTMER) && is_evilpatchmonster(&mons[last]))) num += 1;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_DATA) )) num += 1;
		if ((uwep && uwep->oartifact == ART_RAFSCHAR_S_SUPERWEAPON && dmgtype(&mons[last], AD_DATA) )) num += 1000;
		if ((uswapwep && uswapwep->oartifact == ART_RAFSCHAR_S_SUPERWEAPON && dmgtype(&mons[last], AD_DATA) )) num += 1000;
		if ((Role_if(PM_SHAPESHIFTER) && is_evilpatchmonster(&mons[last]))) num += 5;
		if ((Race_if(PM_RODNEYAN) && is_evilpatchmonster(&mons[last]))) num += 5;

		if ((Role_if(PM_SOFTWARE_ENGINEER) && is_evilpatchmonster(&mons[last]))) num += 3;
		if ((Role_if(PM_CRACKER) && is_evilpatchmonster(&mons[last]))) num += 5;
		if ((Role_if(PM_JANITOR) && is_evilpatchmonster(&mons[last]))) num += 5;
		if ((Role_if(PM_SPACE_MARINE) && is_evilpatchmonster(&mons[last]))) num += 10;
		if ((Role_if(PM_QUARTERBACK) && is_evilpatchmonster(&mons[last]))) num += 2;
		if ((Role_if(PM_PSYKER) && is_evilpatchmonster(&mons[last]))) num += 10;
		if ((Role_if(PM_EMPATH) && is_evilpatchmonster(&mons[last]))) num += 2;
		if ((Role_if(PM_MASTERMIND) && is_evilpatchmonster(&mons[last]))) num += 3;
		if ((Role_if(PM_ASTRONAUT) && is_evilpatchmonster(&mons[last]))) num += 2;
		if ((Role_if(PM_CYBERNINJA) && is_evilpatchmonster(&mons[last]))) num += 3;
		if ((Role_if(PM_CRACKER) && (mons[last].maligntyp < 0))) num += 4;
		if ((Role_if(PM_JANITOR) && !(mons[last].mflags1 & M1_METALLIVORE) && !(mons[last].mflags3 & M3_LITHIVORE) && !(mons[last].mflags4 & M4_ORGANIVORE) )) num += 5;
		if ((Role_if(PM_JANITOR) && dmgtype(&mons[last], AD_TRAP))) num += 5;
		if ((Role_if(PM_JANITOR) && dmgtype(&mons[last], AD_WEBS))) num += 3;
		if ((Role_if(PM_STORMBOY) && is_swimmer(&mons[last]))) num += 4;
		if ((Role_if(PM_STORMBOY) && breathless(&mons[last]))) num += 2;
		if ((Role_if(PM_STORMBOY) && amphibious(&mons[last]))) num += 5;
		if ((Role_if(PM_STORMBOY) && is_elf(&mons[last]))) num += 10;
		if ((Role_if(PM_STORMBOY) && (mons[last].maligntyp > 0) )) num += 7;
		if ((Role_if(PM_YAUTJA) && is_animal(&mons[last]))) num += 5;
		if ((Role_if(PM_YAUTJA) && extra_nasty(&mons[last]))) num += 5;
		if ((Role_if(PM_YAUTJA) && dmgtype(&mons[last], AD_DGST))) num += 4;
		if ((Role_if(PM_QUARTERBACK) && attacktype(&mons[last], AT_WEAP))) num += 7;
		if ((Role_if(PM_QUARTERBACK) && dmgtype(&mons[last], AD_PAIN))) num += 2;
		if ((Role_if(PM_PSYKER) && does_need_four(&mons[last]))) num += 1;
		if ((Role_if(PM_PSYKER) && does_hit_as_four(&mons[last]))) num += 1;
		if ((Role_if(PM_PSYKER) && passes_walls(&mons[last]))) num += 2;
		if ((Role_if(PM_PSYKER) && strongmonst(&mons[last]))) num += 3;
		if ((Role_if(PM_PSYKER) && extra_nasty(&mons[last]))) num += 5;
		if ((Role_if(PM_PSYKER) && is_covetous(&mons[last]))) num += 3;
		if ((Role_if(PM_PSYKER) && is_shade(&mons[last]))) num += 2;
		if ((Role_if(PM_PSYKER) && (mons[last].msound == MS_SHRIEK))) num += 1;
		if ((Role_if(PM_PSYKER) && attacktype(&mons[last], AT_MAGC))) num += 3;
		if ((Role_if(PM_PSYKER) && dmgtype(&mons[last], AD_POLY))) num += 1;
		if ((Role_if(PM_PSYKER) && dmgtype(&mons[last], AD_DREA))) num += 2;
		if ((Role_if(PM_PSYKER) && dmgtype(&mons[last], AD_BADE))) num += 2;
		if ((Role_if(PM_PSYKER) && dmgtype(&mons[last], AD_WISD))) num += 2;
		if ((Role_if(PM_PSYKER) && dmgtype(&mons[last], AD_SIN))) num += 2;
		if ((Role_if(PM_EMPATH) && (mons[last].mflags2 & M2_PEACEFUL) )) num += 4;
		if ((Role_if(PM_EMPATH) && dmgtype(&mons[last], AD_HEAL))) num += 2;
		if ((Role_if(PM_MASTERMIND) && dmgtype(&mons[last], AD_DRIN))) num += 3;
		if ((Role_if(PM_MASTERMIND) && dmgtype(&mons[last], AD_NAST))) num += 2;
		if ((Role_if(PM_MASTERMIND) && dmgtype(&mons[last], AD_MINA))) num += 2;
		if ((Role_if(PM_MASTERMIND) && dmgtype(&mons[last], AD_RUNS))) num += 2;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_SPC2) )) num += 15;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_STUN) )) num += 7;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_DRIN) )) num += 5;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_HALU) )) num += 8;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_DARK) )) num += 5;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_FEAR) )) num += 4;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_FAKE) )) num += 7;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_LETH) )) num += 2;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_CNCL) )) num += 1;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_BLAS) )) num += 1;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_BANI) )) num += 2;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_WISD) )) num += 3;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_HODS) )) num += 3;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_CHRN) )) num += 7;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_WEEP) )) num += 2;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_STTP) )) num += 1;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_DEPR) )) num += 5;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_LAZY) )) num += 5;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_INER) )) num += 3;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_VULN) )) num += 4;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_AMNE) )) num += 10;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_INSA) )) num += 10;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_SANI) )) num += 10;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_TRAP) )) num += 8;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_SHAN) )) num += 8;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_TERR) )) num += 10;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_FEMI) )) num += 4;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_LEVI) )) num += 7;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_MCRE) )) num += 5;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_DEBU) )) num += 5;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_UNPR) )) num += 10;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[last], AD_ILLU) )) num += 20;
		if ((Role_if(PM_WEIRDBOY) && shapechanger(&mons[last]) )) num += 5;
		if ((Role_if(PM_WEIRDBOY) && is_angbandmonster(&mons[last]) )) num += 3;
		if ((Role_if(PM_WEIRDBOY) && is_animemonster(&mons[last]) )) num += 1;
		if ((Role_if(PM_WEIRDBOY) && is_steammonster(&mons[last]) )) num += 1;
		if ((Role_if(PM_ASTRONAUT) && is_flyer(&mons[last]))) num += 5;
		if ((Role_if(PM_ASTRONAUT) && bigmonst(&mons[last]))) num += 3;
		if ((Role_if(PM_ASTRONAUT) && hugemonst(&mons[last]))) num += 4;
		if ((Role_if(PM_ASTRONAUT) && strongmonst(&mons[last]))) num += 5;
		if ((Role_if(PM_CYBERNINJA) && (mons[last].mflags2 & M2_STALK))) num += 4;
		if ((Role_if(PM_DISSIDENT) && is_lord(&mons[last]))) num += 5;
		if ((Role_if(PM_DISSIDENT) && is_prince(&mons[last]))) num += 15;
		if ((Role_if(PM_DISSIDENT) && type_is_pname(&mons[last]))) num += 5;
		if ((Role_if(PM_XELNAGA) && is_death_resistant(&mons[last]))) num += 3;
		if ((Role_if(PM_XELNAGA) && amorphous(&mons[last]))) num += 2;
		if ((Role_if(PM_XELNAGA) && is_silent(&mons[last]))) num += 2;
		if ((Role_if(PM_XELNAGA) && thick_skinned(&mons[last]))) num += 2;
		if ((Role_if(PM_XELNAGA) && shapechanger(&mons[last]))) num += 4;
		if ((Role_if(PM_XELNAGA) && your_race(&mons[last]))) num += 4;
		if ((Role_if(PM_XELNAGA) && always_hostile(&mons[last]))) num += 7;
		if ((Role_if(PM_XELNAGA) && extra_nasty(&mons[last]))) num += 10;
		if ((Role_if(PM_XELNAGA) && strongmonst(&mons[last]))) num += 5;
		if ((Role_if(PM_XELNAGA) && cannot_be_tamed(&mons[last]))) num += 4;
		if ((Role_if(PM_XELNAGA) && is_mplayer(&mons[last]))) num += 3;
		if ((Role_if(PM_XELNAGA) && is_umplayer(&mons[last]))) num += 2;
		if ((Role_if(PM_XELNAGA) && slime_on_touch(&mons[last]))) num += 2;
		if ((Role_if(PM_XELNAGA) && uncommon2(&mons[last]))) num += 1;
		if ((Role_if(PM_XELNAGA) && uncommon3(&mons[last]))) num += 2;
		if ((Role_if(PM_XELNAGA) && uncommon5(&mons[last]))) num += 3;
		if ((Role_if(PM_XELNAGA) && uncommon7(&mons[last]))) num += 4;
		if ((Role_if(PM_XELNAGA) && uncommon10(&mons[last]))) num += 5;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[last], AD_DISN))) num += 1;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[last], AD_LUCK))) num += 2;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[last], AD_INER))) num += 2;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[last], AD_NEXU))) num += 2;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[last], AD_LETH))) num += 1;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[last], AD_UVUU))) num += 1;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[last], AD_IDAM))) num += 1;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[last], AD_TRAI))) num += 1;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[last], AD_SANI))) num += 3;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[last], AD_SAMU))) num += 3;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[last], AD_CHAO))) num += 2;

		if (flags.friday13 && is_evilpatchmonster(&mons[last])) num += 25;
		if (flags.friday13 && dmgtype(&mons[last], AD_STAT) ) num += 2;
		if (flags.friday13 && dmgtype(&mons[last], AD_DAMA) ) num += 2;
		if (flags.friday13 && dmgtype(&mons[last], AD_THIE) ) num += 2;
		if (flags.friday13 && dmgtype(&mons[last], AD_DATA) ) num += 1;
		if (flags.friday13 && dmgtype(&mons[last], AD_RAGN) ) num += 20;
		if (flags.friday13 && dmgtype(&mons[last], AD_DEST) ) num += 2;
		if (flags.elmstreet && is_evilpatchmonster(&mons[last])) num += 25;
		if (flags.elmstreet && dmgtype(&mons[last], AD_STAT) ) num += 2;
		if (flags.elmstreet && dmgtype(&mons[last], AD_DAMA) ) num += 2;
		if (flags.elmstreet && dmgtype(&mons[last], AD_THIE) ) num += 2;
		if (flags.elmstreet && dmgtype(&mons[last], AD_DATA) ) num += 1;
		if (flags.elmstreet && dmgtype(&mons[last], AD_RAGN) ) num += 20;
		if (flags.elmstreet && dmgtype(&mons[last], AD_DEST) ) num += 2;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[last], AD_DATA) )) num += 1;
		if ((isevilvariant && dmgtype(&mons[last], AD_DATA) )) num += 20;
		if ((isevilvariant && is_evilpatchmonster(&mons[last]) )) num += 100;
		if ((isevilvariant && dmgtype(&mons[last], AD_RAGN) )) num += 20;
		if ((isevilvariant && dmgtype(&mons[last], AD_DEST) )) num += 5;
		if ((Role_if(PM_HUSSY) && is_demon(&mons[last]) )) num += 30;
		if ((Role_if(PM_HUSSY) && is_demon(&mons[last]) && (mons[last].geno & G_UNIQ) )) num += 100;
		if ((Role_if(PM_COURIER) && dmgtype(&mons[last], AD_IDAM) )) num += 1;
		if ((Role_if(PM_MURDERER) && dmgtype(&mons[last], AD_STAT) )) num += 2;
		if ((Role_if(PM_NUCLEAR_PHYSICIST) && dmgtype(&mons[last], AD_PAIN) )) num += 1;
		if ((uarmf && itemhasappearance(uarmf, APP_PRINCESS_PUMPS) && attacktype(&mons[last], AT_SCRA) )) num += 2;
		if ((uarmf && itemhasappearance(uarmf, APP_PRINCESS_PUMPS) && attacktype(&mons[last], AT_LASH) )) num += 2;
		if ((uarmf && itemhasappearance(uarmf, APP_PRINCESS_PUMPS) && attacktype(&mons[last], AT_STNG) )) num += 2;
		if (uarmh && itemhasappearance(uarmh, APP_GRUNTER_HELMET) && dmgtype(&mons[last], AD_DISE) ) num += 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_IDAM) )) num += 2;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_ANTI) )) num += 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_TECH) )) num += 2;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_MEMO) )) num += 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_TRAI) )) num += 10;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_STAT) )) num += 10;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_DAMA) )) num += 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_THIE) )) num += 5;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[last], AD_IDAM) )) num += 2;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[last], AD_STAT) )) num += 3;
		if ((Race_if(PM_AK_THIEF_IS_DEAD_) && dmgtype(&mons[last], AD_DAMA) )) num += 2;
		if ((Race_if(PM_AK_THIEF_IS_DEAD_) && dmgtype(&mons[last], AD_THIE) )) num += 2;
		if ((Race_if(PM_ALBAE) && dmgtype(&mons[last], AD_ANTI) )) num += 1;
		if ((Race_if(PM_ALBAE) && dmgtype(&mons[last], AD_STAT) )) num += 3;
		if ((Race_if(PM_ALCHEMIST) && dmgtype(&mons[last], AD_IDAM) )) num += 2;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[last], AD_PAIN) )) num += 3;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[last], AD_MEMO) )) num += 10;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[last], AD_TRAI) )) num += 5;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[last], AD_STAT) )) num += 2;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[last], AD_DAMA) )) num += 1;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[last], AD_THIE) )) num += 2;
		if ((Race_if(PM_DEATHMOLD) && dmgtype(&mons[last], AD_ANTI) )) num += 1;
		if ((Race_if(PM_DOPPELGANGER) && dmgtype(&mons[last], AD_TRAI) )) num += 2;
		if ((isevilvariant && dmgtype(&mons[last], AD_STAT) )) num += 5;
		if ((isevilvariant && dmgtype(&mons[last], AD_DAMA) )) num += 3;
		if ((isevilvariant && dmgtype(&mons[last], AD_THIE) )) num += 3;
		if ((Race_if(PM_HERBALIST) && dmgtype(&mons[last], AD_MEMO) )) num += 5;
		if ((Race_if(PM_HERBALIST) && dmgtype(&mons[last], AD_TRAI) )) num += 3;
		if ((Race_if(PM_PEACEMAKER) && dmgtype(&mons[last], AD_DAMA) )) num += 4;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[last], AD_ANTI) )) num += 2;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[last], AD_MEMO) )) num += 5;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[last], AD_STAT) )) num += 4;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[last], AD_DAMA) )) num += 3;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[last], AD_THIE) )) num += 7;
		if ((Race_if(PM_SPIRIT) && dmgtype(&mons[last], AD_MEMO) )) num += 6;
		if ((Race_if(PM_SPIRIT) && dmgtype(&mons[last], AD_TRAI) )) num += 3;
		if ((Race_if(PM_SPIRIT) && dmgtype(&mons[last], AD_THIE) )) num += 3;
		if ((Race_if(PM_WEAPON_XORN) && dmgtype(&mons[last], AD_IDAM) )) num += 4;
		if ((Race_if(PM_WEAPON_XORN) && dmgtype(&mons[last], AD_ANTI) )) num += 3;
		if ((Race_if(PM_WEAPON_XORN) && dmgtype(&mons[last], AD_TECH) )) num += 1;
		if ((Race_if(PM_WEAPON_XORN) && dmgtype(&mons[last], AD_DAMA) )) num += 2;

		if ((Role_if(PM_ALTMER) && dmgtype(&mons[last], AD_RBAD) )) num += 1;
		if ((Role_if(PM_ANACHRONIST) && dmgtype(&mons[last], AD_TERR) )) num += 1;
		if ((Role_if(PM_ANACHRONOUNBINDER) && dmgtype(&mons[last], AD_ILLU) )) num += 2;
		if ((Role_if(PM_ASTRONAUT) && dmgtype(&mons[last], AD_LEVI) )) num += 1;
		if ((Role_if(PM_BLEEDER) && dmgtype(&mons[last], AD_BLEE) )) num += 5;
		if ((Role_if(PM_CELLAR_CHILD) && dmgtype(&mons[last], AD_RBAD) )) num += 2;
		if ((Role_if(PM_CHAOS_SORCEROR) && dmgtype(&mons[last], AD_TERR) )) num += 1;
		if ((Role_if(PM_CRACKER) && dmgtype(&mons[last], AD_SHAN) )) num += 2;
		if ((Role_if(PM_CRUEL_ABUSER) && dmgtype(&mons[last], AD_FEMI) )) num += 3;
		if ((Role_if(PM_GAMER) && dmgtype(&mons[last], AD_SCOR) )) num += 3;
		if ((Role_if(PM_GOFF) && dmgtype(&mons[last], AD_ILLU) )) num += 2;
		if ((Role_if(PM_GOFF) && dmgtype(&mons[last], AD_BLEE) )) num += 3;
		if ((Role_if(PM_GRENADONIN) && dmgtype(&mons[last], AD_RBAD) )) num += 1;
		if ((isevilvariant && dmgtype(&mons[last], AD_NACU) )) num += 10;
		if ((Role_if(PM_LUNATIC) && dmgtype(&mons[last], AD_ILLU) )) num += 2;
		if ((Role_if(PM_MAHOU_SHOUJO) && dmgtype(&mons[last], AD_SHAN) )) num += 2;
		if ((Role_if(PM_MEDIUM) && dmgtype(&mons[last], AD_LEVI) )) num += 1;
		if ((Role_if(PM_OCCULT_MASTER) && dmgtype(&mons[last], AD_ILLU) )) num += 2;
		if ((Role_if(PM_POLITICIAN) && dmgtype(&mons[last], AD_FEMI) )) num += 3;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_RBAD) )) num += 1;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_ILLU) )) num += 3;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_SHAN) )) num += 1;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_LEVI) )) num += 1;
		if ((Role_if(PM_ROCKER) && dmgtype(&mons[last], AD_TERR) )) num += 2;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[last], AD_RBAD) )) num += 4;
		if ((Role_if(PM_SOCIAL_JUSTICE_WARRIOR) && dmgtype(&mons[last], AD_BLEE) )) num += 3;
		if ((Role_if(PM_TRANSSYLVANIAN) && dmgtype(&mons[last], AD_FEMI) )) num += 4;
		if ((Role_if(PM_TRANSVESTITE) && dmgtype(&mons[last], AD_FEMI) )) num += 4;
		if ((Role_if(PM_STAND_USER) && dmgtype(&mons[last], AD_TERR) )) num += 3;
		if ((Role_if(PM_STAND_USER) && dmgtype(&mons[last], AD_LEVI) )) num += 1;
		if ((Role_if(PM_WALSCHOLAR) && dmgtype(&mons[last], AD_FEMI) )) num += 6;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[last], AD_ILLU) )) num += 3;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[last], AD_FEMI) )) num += 1;
		if ((Role_if(PM_YAUTJA) && dmgtype(&mons[last], AD_SHAN) )) num += 3;
		if ((Race_if(PM_ALBAE) && dmgtype(&mons[last], AD_RBAD) )) num += 1;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[last], AD_LEVI) )) num += 5;
		if ((Race_if(PM_ASURA) && is_elonamonster(&mons[last]) )) num += 1;
		if ((Race_if(PM_PLAYER_FAIRY) && is_elonamonster(&mons[last]) )) num += 3;
		if ((Race_if(PM_BASTARD) && dmgtype(&mons[last], AD_SHAN) )) num += 1;
		if ((Race_if(PM_BATMAN) && dmgtype(&mons[last], AD_FEMI) )) num += 2;
		if ((Race_if(PM_BATMAN) && dmgtype(&mons[last], AD_TERR) )) num += 1;
		if ((Race_if(PM_BORG) && dmgtype(&mons[last], AD_ILLU) )) num += 2;
		if ((Race_if(PM_BURNINATOR) && dmgtype(&mons[last], AD_BLEE) )) num += 2;
		if ((Race_if(PM_DOPPELGANGER) && dmgtype(&mons[last], AD_RBAD) )) num += 1;
		if ((Race_if(PM_HERBALIST) && dmgtype(&mons[last], AD_BLEE) )) num += 5;
		if ((Race_if(PM_PLAYER_JABBERWOCK) && dmgtype(&mons[last], AD_RBAD) )) num += 2;
		if ((Race_if(PM_LOLI) && dmgtype(&mons[last], AD_FEMI) )) num += 5;
		if ((Race_if(PM_METAL) && is_elonamonster(&mons[last]) )) num += 20;
		if ((Race_if(PM_PLAYER_MIMIC) && dmgtype(&mons[last], AD_ILLU) )) num += 4;
		if ((Race_if(PM_PLAYER_MUSHROOM) && is_elonamonster(&mons[last]) )) num += 5;
		if ((Race_if(PM_PEACEMAKER) && dmgtype(&mons[last], AD_SHAN) )) num += 3;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[last], AD_ILLU) )) num += 3;
		if ((Race_if(PM_SCURRIER) && dmgtype(&mons[last], AD_SHAN) )) num += 2;
		if ((Race_if(PM_SHELL) && is_elonamonster(&mons[last]) )) num += 8;
		if ((Race_if(PM_SPIRIT) && dmgtype(&mons[last], AD_LEVI) )) num += 2;

		if ((Race_if(PM_INHERITOR) && is_dnethackmonster(&mons[last]) )) num += 10;
		if ((Race_if(PM_PLAYER_MYRKALFR) && is_dnethackmonster(&mons[last]))) num += 10;
		if ((Race_if(PM_PLAYER_MYRKALFR) && attacktype(&mons[last], AT_MAGC))) num += 5;
		if ((Race_if(PM_PLAYER_ANDROID) && is_dnethackmonster(&mons[last]))) num += 15;
		if ((Race_if(PM_PLAYER_ANDROID) && dmgtype(&mons[last], AD_TERR) )) num += 1;
		if ((Race_if(PM_PLAYER_ANDROID) && (mons[last].geno & G_NOCORPSE) )) num += 5;
		if ((Race_if(PM_RETICULAN) && is_evilpatchmonster(&mons[last]))) num += 7;
		if ((Race_if(PM_RETICULAN) && dmgtype(&mons[last], AD_DRIN))) num += 2;
		if ((Race_if(PM_RETICULAN) && dmgtype(&mons[last], AD_NAST))) num += 1;
		if ((Race_if(PM_RETICULAN) && dmgtype(&mons[last], AD_MINA))) num += 1;
		if ((Race_if(PM_RETICULAN) && dmgtype(&mons[last], AD_RUNS))) num += 1;
		if ((Race_if(PM_RETICULAN) && dmgtype(&mons[last], AD_INSA))) num += 4;
		if ((Race_if(PM_RETICULAN) && dmgtype(&mons[last], AD_SANI))) num += 6;
		if ((Race_if(PM_OUTSIDER) && is_evilpatchmonster(&mons[last]))) num += 5;
		if ((Race_if(PM_OUTSIDER) && is_death_resistant(&mons[last]))) num += 1;
		if ((Race_if(PM_OUTSIDER) && amorphous(&mons[last]))) num += 1;
		if ((Race_if(PM_OUTSIDER) && thick_skinned(&mons[last]))) num += 1;
		if ((Race_if(PM_OUTSIDER) && shapechanger(&mons[last]))) num += 2;
		if ((Race_if(PM_OUTSIDER) && always_hostile(&mons[last]))) num += 4;
		if ((Race_if(PM_OUTSIDER) && extra_nasty(&mons[last]))) num += 5;
		if ((Race_if(PM_OUTSIDER) && strongmonst(&mons[last]))) num += 3;
		if ((Race_if(PM_OUTSIDER) && cannot_be_tamed(&mons[last]))) num += 3;
		if ((Race_if(PM_OUTSIDER) && is_mplayer(&mons[last]))) num += 1;
		if ((Race_if(PM_OUTSIDER) && is_umplayer(&mons[last]))) num += 1;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[last], AD_DISN))) num += 1;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[last], AD_LUCK))) num += 2;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[last], AD_INER))) num += 2;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[last], AD_NEXU))) num += 2;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[last], AD_LETH))) num += 1;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[last], AD_UVUU))) num += 1;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[last], AD_IDAM))) num += 1;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[last], AD_TRAI))) num += 1;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[last], AD_SANI))) num += 2;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[last], AD_SAMU))) num += 2;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[last], AD_CHAO))) num += 2;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[last], AD_ILLU) )) num += 2;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[last], AD_FEMI) )) num += 1;
		if ((Race_if(PM_PLAYER_DYNAMO) && (mons[last].msound == MS_ARREST) )) num += 5;
		if ((Race_if(PM_NEMESIS) && always_hostile(&mons[last]) )) num += 10;
		if ((Race_if(PM_UNMAGIC_FISH) && dmgtype(&mons[last], AD_MCRE) )) num += 3;
		if ((Race_if(PM_RETICULAN) && dmgtype(&mons[last], AD_MCRE) )) num += 5;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[last], AD_MCRE) )) num += 2;
		if ((Race_if(PM_PLAYER_MYRKALFR) && dmgtype(&mons[last], AD_MCRE) )) num += 1;
		if ((Race_if(PM_PLAYER_DYNAMO) && dmgtype(&mons[last], AD_MCRE) )) num += 3;
		if ((Race_if(PM_CLOCKWORK_AUTOMATON) && dmgtype(&mons[last], AD_MCRE) )) num += 1;
		if ((Role_if(PM_ALTMER) && dmgtype(&mons[last], AD_MCRE) )) num += 1;
		if ((Role_if(PM_CELLAR_CHILD) && dmgtype(&mons[last], AD_MCRE) )) num += 2;
		if ((Role_if(PM_MAHOU_SHOUJO) && dmgtype(&mons[last], AD_MCRE) )) num += 1;
		if ((Role_if(PM_PSION) && dmgtype(&mons[last], AD_MCRE) )) num += 2;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[last], AD_MCRE) )) num += 4;
		if ((Role_if(PM_TRACER) && dmgtype(&mons[last], AD_MCRE) )) num += 1;
		if ((Role_if(PM_UNBELIEVER) && dmgtype(&mons[last], AD_MCRE) )) num += 5;
		if ((Race_if(PM_CUPID) && is_elonamonster(&mons[last]) )) num += 2;
		if ((Race_if(PM_BACTERIA) && is_elonamonster(&mons[last]) )) num += 10;
		if ((Race_if(PM_PIECE) && is_elonamonster(&mons[last]) )) num += 5;
		if ((Race_if(PM_PLAYER_SHEEP) && is_elonamonster(&mons[last]) )) num += 1;
		if ((Race_if(PM_PLAYER_HOUND) && is_elonamonster(&mons[last]) )) num += 3;
		if ((Race_if(PM_PLAYER_CERBERUS) && is_elonamonster(&mons[last]) )) num += 5;
		if ((Race_if(PM_BOVER) && dmgtype(&mons[last], AD_DISE) )) num += 5;
		if ((Race_if(PM_BOVER) && dmgtype(&mons[last], AD_POIS) )) num += 5;

		if ((Role_if(PM_DRAGONMASTER) && attacktype(&mons[last], AT_BREA) )) num += 2;
		if ((Role_if(PM_FJORDE) && amphibious(&mons[last]) )) num += 5;
		if ((Role_if(PM_PRACTICANT) && is_lord(&mons[last]) )) num += 4;
		if ((Role_if(PM_PRACTICANT) && is_prince(&mons[last]) )) num += 12;
		if ((Role_if(PM_PRACTICANT) && attacktype(&mons[last], AT_LASH) )) num += 2;
		if ((Role_if(PM_PRACTICANT) && dmgtype(&mons[last], AD_DEPR) )) num += 4;
		if ((Role_if(PM_PRACTICANT) && dmgtype(&mons[last], AD_WRAT) )) num += 10;
		if ((Role_if(PM_PRACTICANT) && dmgtype(&mons[last], AD_DFOO) )) num += 5;
		if ((Role_if(PM_PRACTICANT) && dmgtype(&mons[last], AD_SLUD) )) num += 1;
		if ((Role_if(PM_PRACTICANT) && dmgtype(&mons[last], AD_DEST) )) num += 1;
		if ((Role_if(PM_PRACTICANT) && dmgtype(&mons[last], AD_PAIN) )) num += 5;
		if ((Role_if(PM_PRACTICANT) && always_hostile(&mons[last]) )) num += 3;
		if ((Role_if(PM_EMERA) && is_female(&mons[last]) )) num += 2;
		if ((Role_if(PM_EMERA) && (mons[last].msound == MS_STENCH))) num += 10;
		if ((Role_if(PM_EMERA) && (mons[last].msound == MS_SHOE))) num += 10;
		if ((Role_if(PM_EMERA) && (mons[last].msound == MS_FART_NORMAL))) num += 10;
		if ((Role_if(PM_EMERA) && (mons[last].msound == MS_FART_LOUD))) num += 10;
		if ((Role_if(PM_EMERA) && (mons[last].msound == MS_FART_QUIET))) num += 10;
		if ((Role_if(PM_EMERA) && always_hostile(&mons[last]) )) num += 1;
		if ((Role_if(PM_MILL_SWALLOWER) && always_peaceful(&mons[last]) )) num += 3;
		if ((Role_if(PM_MILL_SWALLOWER) && is_nonmoving(&mons[last]) )) num += 4;
		if ((Role_if(PM_MILL_SWALLOWER) && nocorpsedecay(&mons[last]) )) num += 2;
		if ((Role_if(PM_SYMBIANT) && is_angbandmonster(&mons[last]) )) num += 5;
		if ((Role_if(PM_SYMBIANT) && is_animemonster(&mons[last]) )) num += 2;
		if ((Role_if(PM_SYMBIANT) && is_steammonster(&mons[last]) )) num += 2;
		if ((Role_if(PM_GENDERSTARIST) && is_neuter(&mons[last]) )) num += 10;
		if ((Role_if(PM_GENDERSTARIST) && dmgtype(&mons[last], AD_SSEX) )) num += 3;
		if ((Role_if(PM_GENDERSTARIST) && (mons[last].msound == MS_CUSS))) num += 5;
		if ((Race_if(PM_GOAULD) && is_dnethackmonster(&mons[last]))) num += 10;
		if ((Role_if(PM_CELLAR_CHILD) && dmgtype(&mons[last], AD_DEBU) )) num += 5;
		if ((Role_if(PM_GENDERSTARIST) && dmgtype(&mons[last], AD_DEBU) )) num += 5;
		if ((Role_if(PM_ICE_MAGE) && dmgtype(&mons[last], AD_FLAM) )) num += 1;
		if ((Role_if(PM_PRACTICANT) && dmgtype(&mons[last], AD_DEBU) )) num += 3;
		if ((Role_if(PM_SOCIAL_JUSTICE_WARRIOR) && dmgtype(&mons[last], AD_DEBU) )) num += 5;
		if ((Race_if(PM_LOWER_ENT) && dmgtype(&mons[last], AD_FLAM) )) num += 2;
		if ((Race_if(PM_LOLI) && dmgtype(&mons[last], AD_DEBU) )) num += 2;
		if ((Race_if(PM_SEA_ELF) && dmgtype(&mons[last], AD_FLAM) )) num += 4;
		if ((Race_if(PM_SPRIGGAN) && dmgtype(&mons[last], AD_FLAM) )) num += 2;
		if ((Role_if(PM_ALTMER) && dmgtype(&mons[last], AD_NIVE) )) num += 2;
		if ((Role_if(PM_CELLAR_CHILD) && dmgtype(&mons[last], AD_UNPR) )) num += 1;
		if ((Role_if(PM_FJORDE) && dmgtype(&mons[last], AD_UNPR) )) num += 3;
		if ((Role_if(PM_MYSTIC) && dmgtype(&mons[last], AD_NIVE) )) num += 10;
		if ((Role_if(PM_SOCIAL_JUSTICE_WARRIOR) && dmgtype(&mons[last], AD_UNPR) )) num += 3;
		if ((iserosator && dmgtype(&mons[last], AD_UNPR) )) num += 10;
		if ((Race_if(PM_INCANTIFIER) && dmgtype(&mons[last], AD_NIVE) )) num += 1;
		if ((Race_if(PM_MONGUNG) && dmgtype(&mons[last], AD_NIVE) )) num += 2;
		if ((isfeminizer && dmgtype(&mons[last], AD_FEMI) )) num += 10;
		if ((Race_if(PM_IRAHA) && (mons[last].maligntyp > 0) )) num += 10;
		if ((Race_if(PM_PLAYER_NIBELUNG) && is_angbandmonster(&mons[last]) )) num += 5;
		if ((Race_if(PM_KLACKON) && humanoid(&mons[last]) )) num += 3;
		if ((Race_if(PM_KLACKON) && is_angbandmonster(&mons[last]) )) num += 4;
		if ((Race_if(PM_KLACKON) && is_animemonster(&mons[last]) )) num += 2;
		if ((Race_if(PM_KUTAR) && is_angbandmonster(&mons[last]) )) num += 3;
		if ((Race_if(PM_KUTAR) && is_animemonster(&mons[last]) )) num += 7;
		if ((Race_if(PM_KUTAR) && is_steammonster(&mons[last]) )) num += 3;
		if ((Race_if(PM_TONBERRY) && is_angbandmonster(&mons[last]) )) num += 10;
		if ((Race_if(PM_TONBERRY) && is_animemonster(&mons[last]) )) num += 10;
		if ((Race_if(PM_TONBERRY) && is_steammonster(&mons[last]) )) num += 10;
		if ((Race_if(PM_TONBERRY) && is_jokemonster(&mons[last]) )) num += 2;
		if ((Race_if(PM_PLAYER_GLORKUM) && is_randomizedmonster(&mons[last]) )) num += 50;
		if ((Race_if(PM_RACE_THAT_DOESN_T_EXIST) && always_peaceful(&mons[last]) )) num += 10;
		if ((Race_if(PM_HYBRIDRAGON) && is_dnethackmonster(&mons[last]) )) num += 12;
		if ((ischallenger && (mons[last].msound == MS_STENCH) )) num += ((mons[last].geno & G_FREQ) * 4);
		if ((ischallenger && (mons[last].msound == MS_WHORE) )) num += ((mons[last].geno & G_FREQ) * 4);
		if ((ischallenger && (mons[last].msound == MS_FART_QUIET) )) num += ((mons[last].geno & G_FREQ) * 4);
		if ((ischallenger && (mons[last].msound == MS_FART_LOUD) )) num += ((mons[last].geno & G_FREQ) * 4);
		if ((ischallenger && (mons[last].msound == MS_FART_NORMAL) )) num += ((mons[last].geno & G_FREQ) * 4);
		if ((ischallenger && (mons[last].msound == MS_SHOE) )) num += ((mons[last].geno & G_FREQ) * 4);
		if ((ischallenger && (mons[last].msound == MS_SOCKS) )) num += ((mons[last].geno & G_FREQ) * 4);
		if ((ischallenger && (mons[last].msound == MS_PANTS) )) num += ((mons[last].geno & G_FREQ) * 4);
		if ((ischallenger && (mons[last].msound == MS_CONVERT) )) num += ((mons[last].geno & G_FREQ) * 4);
		if ((ischallenger && (mons[last].msound == MS_HCALIEN) )) num += ((mons[last].geno & G_FREQ) * 4);
		if ((uarmf && uarmf->oartifact == ART_STRONG_GETAWAY_DESIRE && dmgtype(&mons[last], AD_WEEP) )) num += 20;
		if ((Role_if(PM_ANACHRONIST) && dmgtype(&mons[last], AD_TDRA) )) num += 3;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[last], AD_BLAS) )) num += 5;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[last], AD_BLAS) )) num += 1;
		if ((Race_if(PM_HUMANOID_DEVIL) && dmgtype(&mons[last], AD_BLAS) )) num += 2;
		if ((Race_if(PM_DEVELOPER) && dmgtype(&mons[last], AD_BLAS) )) num += 2;
		if ((Race_if(PM_PLAYER_DYNAMO) && dmgtype(&mons[last], AD_TDRA) )) num += 1;
		if ((Race_if(PM_GAVIL) && dmgtype(&mons[last], AD_BLAS) )) num += 1;
		if ((Race_if(PM_HC_ALIEN) && dmgtype(&mons[last], AD_BLAS) )) num += 1;
		if ((isheretic && dmgtype(&mons[last], AD_BLAS) )) num += 3;
		if ((Race_if(PM_IMPERIAL) && dmgtype(&mons[last], AD_BLAS) )) num += 5;
		if ((Race_if(PM_SINNER) && dmgtype(&mons[last], AD_BLAS) )) num += 1;
		if ((Race_if(PM_SPIRIT) && dmgtype(&mons[last], AD_TDRA) )) num += 3;
		if ((Role_if(PM_BUTT_LOVER) && (mons[last].msound == MS_FART_NORMAL) )) num += 50;
		if ((Role_if(PM_BUTT_LOVER) && (mons[last].msound == MS_FART_LOUD) )) num += 50;
		if ((Role_if(PM_BUTT_LOVER) && (mons[last].msound == MS_FART_QUIET) )) num += 50;
		if ((Role_if(PM_DIABLIST) && is_diablomonster(&mons[last]))) num += 20;
		if ((Role_if(PM_PREVERSIONER) && is_cowmonster(&mons[last]) )) num += 50;
		if ((Role_if(PM_PREVERSIONER) && is_jokemonster(&mons[last]) )) num += 5;
		if ((Role_if(PM_SHOE_FETISHIST) && (mons[last].msound == MS_SHOE) )) num += 100;
		if ((FemtrapActiveJohanna && (mons[last].msound == MS_SHOE) )) num += 100;
		if ((Role_if(PM_SECRET_ADVICE_MEMBER) && (mons[last].msound == MS_ARREST) )) num += 4;
		if ((Role_if(PM_SECRET_ADVICE_MEMBER) && (mons[last].msound == MS_SOLDIER) )) num += 2;
		if ((Role_if(PM_SECRET_ADVICE_MEMBER) && strongmonst(&mons[last]) )) num += 2;
		if ((Role_if(PM_SECRET_ADVICE_MEMBER) && extra_nasty(&mons[last]) )) num += 3;
		if ((Role_if(PM_SECRET_ADVICE_MEMBER) && dmgtype(&mons[last], AD_TDRA) )) num += 5;
		if ((Role_if(PM_SECRET_ADVICE_MEMBER) && dmgtype(&mons[last], AD_TECH) )) num += 5;
		if ((Role_if(PM_SECRET_ADVICE_MEMBER) && is_cowmonster(&mons[last]) )) num += 5;
		if ((Role_if(PM_SECRET_ADVICE_MEMBER) && is_jokemonster(&mons[last]) )) num += 2;
		if ((PlayerInConeHeels && (P_MAX_SKILL(P_HIGH_HEELS) == P_ISRESTRICTED) && dmgtype(&mons[last], AD_DROP) )) num += 5;
		if ((Role_if(PM_BARD) && dmgtype(&mons[last], AD_DROP) )) num += 1;
		if ((Role_if(PM_BUTT_LOVER) && dmgtype(&mons[last], AD_DROP) )) num += 10;
		if ((Role_if(PM_CONVICT) && dmgtype(&mons[last], AD_DROP) )) num += 1;
		if ((Role_if(PM_MURDERER) && dmgtype(&mons[last], AD_DROP) )) num += 1;
		if ((Role_if(PM_DOLL_MISTRESS) && dmgtype(&mons[last], AD_DROP) )) num += 2;
		if ((Role_if(PM_DRUNK) && dmgtype(&mons[last], AD_DROP) )) num += 3;
		if ((Role_if(PM_GENDERSTARIST) && dmgtype(&mons[last], AD_DROP) )) num += 2;
		if ((Role_if(PM_JESTER) && dmgtype(&mons[last], AD_DROP) )) num += 5;
		if ((Role_if(PM_POLITICIAN) && dmgtype(&mons[last], AD_DROP) )) num += 2;
		if ((Role_if(PM_PRACTICANT) && dmgtype(&mons[last], AD_DROP) )) num += 1;
		if ((Race_if(PM_ALCHEMIST) && dmgtype(&mons[last], AD_DROP) )) num += 2;
		if ((Race_if(PM_DUFFLEPUD) && dmgtype(&mons[last], AD_DROP) )) num += 2;
		if ((Race_if(PM_PERVERT) && dmgtype(&mons[last], AD_DROP) )) num += 2;
		if ((Race_if(PM_TUMBLRER) && dmgtype(&mons[last], AD_DROP) )) num += 10;
		if ((Race_if(PM_WOOKIE) && dmgtype(&mons[last], AD_DROP) )) num += 2;
		if ((Race_if(PM_CLIMACTERIAL) && dmgtype(&mons[last], AD_FEMI) )) num += 50;
		if ((Role_if(PM_WOMANIZER) && is_female(&mons[last]) )) num += 1;
		if ((uwep && uwep->oartifact == ART_SLEXCALIBUR && !is_dlordsmonster(&mons[last]) && !is_dnethackmonster(&mons[last]) && !is_jokemonster(&mons[last]) && !is_diablomonster(&mons[last]) && !is_jonadabmonster(&mons[last]) && !is_evilpatchmonster(&mons[last]) && !is_randomizedmonster(&mons[last]) && !is_elonamonster(&mons[last]) && !is_aoemonster(&mons[last]) && !is_elderscrollsmonster(&mons[last]) )) num += 5;
		if ((u.twoweap && uswapwep && uswapwep->oartifact == ART_SLEXCALIBUR && !is_dlordsmonster(&mons[last]) && !is_dnethackmonster(&mons[last]) && !is_jokemonster(&mons[last]) && !is_diablomonster(&mons[last]) && !is_jonadabmonster(&mons[last]) && !is_evilpatchmonster(&mons[last]) && !is_randomizedmonster(&mons[last]) && !is_elonamonster(&mons[last]) && !is_aoemonster(&mons[last]) && !is_elderscrollsmonster(&mons[last]) )) num += 5;
		if ((Role_if(PM_ACID_MAGE) && (mons[last].msound == MS_DRUGS) )) num += 1;
		if ((Role_if(PM_ANACHRONIST) && (mons[last].msound == MS_BOT) )) num += 7;
		if ((Role_if(PM_ANACHRONOUNBINDER) && (mons[last].msound == MS_GLYPHS) )) num += 1;
		if ((Role_if(PM_BOSMER) && monsterflees(&mons[last]))) num += 2;
		if ((Role_if(PM_BULLY) && (mons[last].msound == MS_BRAG) )) num += 1;
		if ((Role_if(PM_BULLY) && (mons[last].msound == MS_SISSY) )) num += 2;
		if ((Role_if(PM_CARTOMANCER) && (mons[last].msound == MS_CASINO) )) num += 3;
		if ((Role_if(PM_COMBATANT) && (mons[last].msound == MS_COMBAT) )) num += 5;
		if ((Role_if(PM_COURIER) && (mons[last].msound == MS_GIBBERISH) )) num += 2;
		if ((Role_if(PM_CRACKER) && (mons[last].msound == MS_BOT) )) num += 2;
		if ((Role_if(PM_CRUEL_ABUSER) && (mons[last].msound == MS_SISSY) )) num += 5;
		if ((Role_if(PM_CYBERNINJA) && (mons[last].msound == MS_JAPANESE) )) num += 1;
		if ((Role_if(PM_DANCER) && (mons[last].msound == MS_SING) )) num += 1;
		if ((Role_if(PM_DANCER) && (mons[last].msound == MS_PRINCESSLEIA) )) num += 1;
		if ((Role_if(PM_DEMAGOGUE) && (mons[last].msound == MS_CORONA) )) num += 5;
		if ((Role_if(PM_DOLL_MISTRESS) && (mons[last].msound == MS_POKEDEX) )) num += 2;
		if ((Role_if(PM_DOOM_MARINE) && (mons[last].msound == MS_BOT) )) num += 1;
		if ((Role_if(PM_DQ_SLIME) && (mons[last].msound == MS_COMBAT) )) num += 1;
		if ((Role_if(PM_DRUNK) && (mons[last].msound == MS_DRUGS) )) num += 10;
		if ((Role_if(PM_EMERA) && (mons[last].msound == MS_SING) )) num += 1;
		if ((Role_if(PM_EMERA) && (mons[last].msound == MS_SOCKS) )) num += 3;
		if ((Role_if(PM_EMERA) && (mons[last].msound == MS_PANTS) )) num += 3;
		if ((Role_if(PM_EMPATH) && (mons[last].msound == MS_PAIN) )) num += 3;
		if ((Role_if(PM_FEAT_MASTER) && (mons[last].msound == MS_PHOTO) )) num += 5;
		if ((Role_if(PM_FENCER) && (mons[last].msound == MS_COMBAT) )) num += 1;
		if ((Role_if(PM_FIGHTER) && (mons[last].msound == MS_COMBAT) )) num += 2;
		if ((Role_if(PM_FIREFIGHTER) && (mons[last].msound == MS_CAR) )) num += 1;
		if ((Role_if(PM_GANGSTER) && (mons[last].msound == MS_CASINO) )) num += 3;
		if ((Role_if(PM_GEEK) && (mons[last].msound == MS_BOT) )) num += 1;
		if ((Role_if(PM_GRENADONIN) && (mons[last].msound == MS_JAPANESE) )) num += 5;
		if ((Role_if(PM_SAMURAI) && (mons[last].msound == MS_JAPANESE) )) num += 1;
		if ((Role_if(PM_HEALER) && (mons[last].msound == MS_PAIN) )) num += 1;
		if ((Role_if(PM_HUSSY) && (mons[last].msound == MS_SISSY) )) num += 4;
		if ((Role_if(PM_JEDI) && (mons[last].msound == MS_PRINCESSLEIA) )) num += 10;
		if ((Role_if(PM_SHADOW_JEDI) && (mons[last].msound == MS_PRINCESSLEIA) )) num += 5;
		if ((Role_if(PM_HEDDERJEDI) && (mons[last].msound == MS_PRINCESSLEIA) )) num += 20;
		if ((Role_if(PM_JESTER) && (mons[last].msound == MS_SING) )) num += 3;
		if ((Role_if(PM_JUSTICE_KEEPER) && (mons[last].msound == MS_APOC) )) num += 1;
		if ((Role_if(PM_LADIESMAN) && (mons[last].msound == MS_PHOTO) )) num += 10;
		if ((Role_if(PM_MAHOU_SHOUJO) && (mons[last].msound == MS_JAPANESE) )) num += 2;
		if ((Role_if(PM_MAHOU_SHOUJO) && (mons[last].msound == MS_BRAG) )) num += 1;
		if ((Role_if(PM_NINJA) && (mons[last].msound == MS_JAPANESE) )) num += 2;
		if ((Role_if(PM_NOBLEMAN) && (mons[last].msound == MS_PRINCESSLEIA) )) num += 2;
		if ((Role_if(PM_OTAKU) && (mons[last].msound == MS_JAPANESE) )) num += 10;
		if ((Role_if(PM_PICKPOCKET) && (mons[last].msound == MS_SISSY) )) num += 1;
		if ((Role_if(PM_POKEMON) && (mons[last].msound == MS_POKEDEX) )) num += 2;
		if ((Role_if(PM_POLITICIAN) && (mons[last].msound == MS_APOC) )) num += 4;
		if ((Role_if(PM_PSION) && (mons[last].msound == MS_ALLA) )) num += 8;
		if ((Role_if(PM_RANGER) && monsterrandomwalk(&mons[last]))) num += 5;
		if ((Role_if(PM_RANGER) && monsterflees(&mons[last]))) num += 1;
		if ((Role_if(PM_ROCKER) && (mons[last].msound == MS_CAR) )) num += 3;
		if ((Role_if(PM_SAIYAN) && (mons[last].msound == MS_JAPANESE) )) num += 2;
		if ((Role_if(PM_SAIYAN) && (mons[last].msound == MS_COMBAT) )) num += 2;
		if ((Role_if(PM_SHOE_FETISHIST) && (mons[last].msound == MS_SOCKS) )) num += 1;
		if ((Role_if(PM_SHOE_FETISHIST) && (mons[last].msound == MS_SING) )) num += 2;
		if ((Role_if(PM_SOFTWARE_ENGINEER) && (mons[last].msound == MS_BOT) )) num += 2;
		if ((Role_if(PM_ZOOKEEPER) && monsterrandomwalk(&mons[last]))) num += 4;

		if ((Race_if(PM_ADDICT) && (mons[last].msound == MS_DRUGS) )) num += 1;
		if ((Race_if(PM_PLAYER_ANDROID) && (mons[last].msound == MS_BOT) )) num += 4;
		if ((Race_if(PM_CHIQUAI) && (mons[last].msound == MS_JAPANESE) )) num += 3;
		if ((Race_if(PM_JAPURA) && (mons[last].msound == MS_JAPANESE) )) num += 6;
		if ((Race_if(PM_JAVA) && monsterrandomwalk(&mons[last]))) num += 2;
		if ((Race_if(PM_NAVI) && monsterrandomwalk(&mons[last]))) num += 1;
		if ((Race_if(PM_NAVI) && monsterflees(&mons[last]))) num += 1;
		if ((Race_if(PM_RUSMOT) && (mons[last].msound == MS_SOVIET) )) num += 5;
		if ((issoviet && (mons[last].msound == MS_SOVIET) )) num += 10;
		if ((Race_if(PM_SPAMMER) && (mons[last].msound == MS_GIBBERISH) )) num += 1;
		if ((Race_if(PM_VIETIS) && (mons[last].msound == MS_JAPANESE) )) num += 1;
		if ((Race_if(PM_WOOKIE) && (mons[last].msound == MS_BOT) )) num += 1;

		if ((Role_if(PM_BOSMER) && (mons[last].msound == MS_TREESQUAD) )) num += 10;
		if ((Role_if(PM_AMAZON) && (mons[last].msound == MS_TREESQUAD) )) num += 1;
		if ((Role_if(PM_ANACHRONOUNBINDER) && (mons[last].msound == MS_SPOILER) )) num += 1;
		if ((Role_if(PM_ARCHEOLOGIST) && (mons[last].msound == MS_DEAD) )) num += 2;
		if ((Role_if(PM_ASTRONAUT) && (mons[last].msound == MS_CODE) )) num += 2;
		if ((Role_if(PM_ASTRONAUT) && (mons[last].msound == MS_STABILIZE) )) num += 3;
		if ((Role_if(PM_BLOODSEEKER) && (mons[last].msound == MS_SELFHARM) )) num += 1;
		if ((Role_if(PM_BULLY) && (mons[last].msound == MS_WOLLOH) )) num += 5;
		if ((Role_if(PM_CONVICT) && (mons[last].msound == MS_METALMAFIA) )) num += 3;
		if ((Role_if(PM_MURDERER) && (mons[last].msound == MS_METALMAFIA) )) num += 5;
		if ((Role_if(PM_CRACKER) && (mons[last].msound == MS_CODE) )) num += 5;
		if ((Role_if(PM_DANCER) && (mons[last].msound == MS_AREOLA) )) num += 1;
		if ((Role_if(PM_DEMAGOGUE) && (mons[last].msound == MS_DEEPSTATE) )) num += 5;
		if ((Role_if(PM_DISSIDENT) && (mons[last].msound == MS_DEEPSTATE) )) num += 10;
		if ((Role_if(PM_DQ_SLIME) && (mons[last].msound == MS_LIEDER) )) num += 1;
		if ((Role_if(PM_DQ_SLIME) && (mons[last].msound == MS_GAARDIEN) )) num += 5;
		if ((Role_if(PM_DRUID) && (mons[last].msound == MS_TREESQUAD) )) num += 2;
		if ((Role_if(PM_DRUNK) && (mons[last].msound == MS_WOLLOH) )) num += 1;
		if ((Role_if(PM_ELPH) && (mons[last].msound == MS_TREESQUAD) )) num += 3;
		if ((Role_if(PM_EMPATH) && (mons[last].msound == MS_AREOLA) )) num += 1;
		if ((Role_if(PM_ERDRICK) && (mons[last].msound == MS_LIEDER) )) num += 3;
		if ((Role_if(PM_ERDRICK) && (mons[last].msound == MS_GAARDIEN) )) num += 3;
		if ((Role_if(PM_FOXHOUND_AGENT) && (mons[last].msound == MS_ESCAPE) )) num += 2;
		if ((Role_if(PM_GAMER) && (mons[last].msound == MS_CODE) )) num += 2;
		if ((Role_if(PM_GANGSTER) && (mons[last].msound == MS_METALMAFIA) )) num += 1;
		if ((Role_if(PM_GEEK) && (mons[last].msound == MS_CODE) )) num += 3;
		if ((Role_if(PM_GRADUATE) && (mons[last].msound == MS_CODE) )) num += 3;
		if ((Role_if(PM_GOFF) && (mons[last].msound == MS_AREOLA) )) num += 6;
		if ((Role_if(PM_JANITOR) && (mons[last].msound == MS_DEAD) )) num += 1;
		if ((Role_if(PM_LADIESMAN) && (mons[last].msound == MS_BARBER) )) num += 3;
		if ((Role_if(PM_LOCKSMITH) && (mons[last].msound == MS_CODE) )) num += 2;
		if ((Role_if(PM_MASTERMIND) && (mons[last].msound == MS_CODE) )) num += 10;
		if ((Role_if(PM_NECROMANCER) && (mons[last].msound == MS_DEAD) )) num += 1;
		if ((Role_if(PM_NUCLEAR_PHYSICIST) && (mons[last].msound == MS_STABILIZE) )) num += 1;
		if ((Role_if(PM_OFFICER) && (mons[last].msound == MS_METALMAFIA) )) num += 3;
		if ((Role_if(PM_POKEMON) && (mons[last].msound == MS_MISSING) )) num += 2;
		if ((Role_if(PM_POLITICIAN) && (mons[last].msound == MS_DEEPSTATE) )) num += 5;
		if ((Role_if(PM_PREVERSIONER) && (mons[last].msound == MS_MISSING) )) num += 3;
		if ((Role_if(PM_QUARTERBACK) && (mons[last].msound == MS_BARBER) )) num += 1;
		if ((Role_if(PM_RANGER) && (mons[last].msound == MS_TREESQUAD) )) num += 2;
		if ((Role_if(PM_RANGER) && (mons[last].msound == MS_FEARHARE) )) num += 1;
		if ((Role_if(PM_SLAVE_MASTER) && (mons[last].msound == MS_FEARHARE) )) num += 4;
		if ((Role_if(PM_SOFTWARE_ENGINEER) && (mons[last].msound == MS_CODE) )) num += 1;
		if ((Role_if(PM_SUPERMARKET_CASHIER) && (mons[last].msound == MS_WOLLOH) )) num += 1;
		if ((Role_if(PM_UNDERTAKER) && (mons[last].msound == MS_DEAD) )) num += 5;
		if ((Role_if(PM_STAND_USER) && (mons[last].msound == MS_OHGOD) )) num += 5;
		if ((Role_if(PM_WOMANIZER) && (mons[last].msound == MS_BARBER) )) num += 1;
		if ((Role_if(PM_SEXYMATE) && (mons[last].msound == MS_BARBER) )) num += 2;

		if ((Race_if(PM_AK_THIEF_IS_DEAD_) && (mons[last].msound == MS_SPOILER) )) num += 2;
		if ((Race_if(PM_BULDOZGAR) && (mons[last].msound == MS_METALMAFIA) )) num += 1;
		if ((Race_if(PM_DESTABILIZER) && (mons[last].msound == MS_STABILIZE) )) num += 2;
		if ((Race_if(PM_DRYAD) && (mons[last].msound == MS_TREESQUAD) )) num += 1;
		if ((Race_if(PM_DYNAMO) && (mons[last].msound == MS_METALMAFIA) )) num += 2;
		if ((Race_if(PM_ELF) && (mons[last].msound == MS_TREESQUAD) )) num += 1;
		if ((Race_if(PM_LOWER_ENT) && (mons[last].msound == MS_TREESQUAD) )) num += 10;
		if ((Race_if(PM_EROSATOR) && (mons[last].msound == MS_AREOLA) )) num += 4;
		if ((Race_if(PM_PLAYER_FAIRY) && (mons[last].msound == MS_STABILIZE) )) num += 1;
		if ((Race_if(PM_PLAYER_GLORKUM) && (mons[last].msound == MS_MISSING) )) num += 2;
		if ((Race_if(PM_PLAYER_GLORKUM) && (mons[last].msound == MS_SPOILER) )) num += 1;
		if ((Race_if(PM_HC_ALIEN) && (mons[last].msound == MS_BARBER) )) num += 1;
		if ((Race_if(PM_HC_ALIEN) && (mons[last].msound == MS_WOLLOH) )) num += 4;
		if ((Race_if(PM_KOP) && (mons[last].msound == MS_METALMAFIA) )) num += 6;
		if ((Race_if(PM_LIZARDMAN) && (mons[last].msound == MS_STABILIZE) )) num += 3;
		if ((Race_if(PM_LOLI) && (mons[last].msound == MS_AREOLA) )) num += 2;
		if ((Race_if(PM_METAL) && (mons[last].msound == MS_ESCAPE) )) num += 2;
		if ((Race_if(PM_MISSINGNO) && (mons[last].msound == MS_MISSING) )) num += 20;
		if ((Race_if(PM_MONGUNG) && (mons[last].msound == MS_FEARHARE) )) num += 5;
		if ((Race_if(PM_NAVI) && (mons[last].msound == MS_FEARHARE) )) num += 1;
		if ((Race_if(PM_NEMESIS) && (mons[last].msound == MS_LIEDER) )) num += 1;
		if ((Race_if(PM_OUTSIDER) && (mons[last].msound == MS_DEEPSTATE) )) num += 2;
		if ((Race_if(PM_PERVERT) && (mons[last].msound == MS_AREOLA) )) num += 2;
		if ((Race_if(PM_PIECE) && (mons[last].msound == MS_STABILIZE) )) num += 1;
		if ((Race_if(PM_RACE_THAT_DOESN_T_EXIST) && (mons[last].msound == MS_MISSING) )) num += 5;
		if ((Race_if(PM_SHEEP) && (mons[last].msound == MS_ESCAPE) )) num += 1;
		if ((Race_if(PM_SPRIGGAN) && (mons[last].msound == MS_TREESQUAD) )) num += 3;
		if ((Race_if(PM_SUSTAINER) && (mons[last].msound == MS_TREESQUAD) )) num += 1;
		if ((Race_if(PM_SYLPH) && (mons[last].msound == MS_TREESQUAD) )) num += 2;
		if ((Race_if(PM_TURMENE) && (mons[last].msound == MS_WOLLOH) )) num += 5;
		if ((Race_if(PM_VENTURE_CAPITALIST) && (mons[last].msound == MS_DEEPSTATE) )) num += 1;
		if ((Race_if(PM_WORM_THAT_WALKS) && (mons[last].msound == MS_DEAD) )) num += 3;

		if ((uarmc && uarmc->oartifact == ART_PHEROMONE_CASE && (mons[last].msound == MS_STENCH))) num += 10;
		if ((FemtrapActiveAnna && (mons[last].msound == MS_STENCH))) num += 50;
		if ((FemtrapActiveLydia && (spawnswithpumps(&mons[last])) )) num += 1000;
		if ((FemtrapActiveMarike && (mons[last].msound == MS_FART_NORMAL))) num += 10;
		if ((FemtrapActiveVictoria && is_female(&mons[last]) && attacktype(&mons[last], AT_KICK) )) num += 20;
		if ((FemtrapActiveJil && (mons[last].msound == MS_SOCKS))) num += 25;
		if ((FemtrapActiveLaura && (mons[last].msound == MS_SOCKS))) num += 50;
		if ((FemtrapActiveLaura && (mons[last].msound == MS_PANTS))) num += 50;
		if ((FemtrapActiveLaura && (mons[last].msound == MS_SHOE))) num += 50;
		if (u.pompejiwantedlevel && (mons[last].msound == MS_POMPEJI)) num += min(1000, u.pompejiwantedlevel);

		if (monster_with_trait(&mons[last], u.frequenttrait1)) num += u.freqtraitbonus1;
		if (u.frequenttrait2 && monster_with_trait(&mons[last], u.frequenttrait2)) num += u.freqtraitbonus2;
		if (u.frequenttrait3 && monster_with_trait(&mons[last], u.frequenttrait3)) num += u.freqtraitbonus3;
		if (u.frequenttrait4 && monster_with_trait(&mons[last], u.frequenttrait4)) num += u.freqtraitbonus4;
		if (u.frequenttrait5 && monster_with_trait(&mons[last], u.frequenttrait5)) num += u.freqtraitbonus5;
		if (u.frequenttrait6 && monster_with_trait(&mons[last], u.frequenttrait6)) num += u.freqtraitbonus6;
		if (u.frequenttrait7 && monster_with_trait(&mons[last], u.frequenttrait7)) num += u.freqtraitbonus7;
		if (u.frequenttrait8 && monster_with_trait(&mons[last], u.frequenttrait8)) num += u.freqtraitbonus8;
		if (u.frequenttrait9 && monster_with_trait(&mons[last], u.frequenttrait9)) num += u.freqtraitbonus9;
		if (u.frequenttrait10 && monster_with_trait(&mons[last], u.frequenttrait10)) num += u.freqtraitbonus10;

		if ((FrequentationSpawns || u.uprops[FREQUENTATION_SPAWNS].extrinsic || have_frequentationspawnstone()) && u.frequentationtrait && monster_with_trait(&mons[last], u.frequentationtrait) ) num += 10;

		if (RngeExtinction && mvitals[last].born) num += mvitals[last].born;

		if (last == urole.nemesnum) num += (Qstats(killed_nemesis) ? 500 : 100);

		if ((urole.enemy1num != NON_PM) && (last == urole.enemy1num)) num += 125;
		if ((urole.enemy2num != NON_PM) && (last == urole.enemy2num)) num += 25;

	    }

	if(!num) return(-1);

/*	Assumption #2:	monsters of a given class are presented in ascending
 *			order of strength.
 */
	for(num = rnd(num); num > 0; first++)
	    if (!(mvitals[first].mvflags & G_GONE) && !(mons[first].geno & mask)
					&& !is_placeholder(&mons[first])
					&& !(uncommontwo && uncommon2(&mons[first]) && !jonaspecialspawn(&mons[first]) && !Race_if(PM_RODNEYAN) )
					&& !(uncommonthree && uncommon3(&mons[first]) && !jonaspecialspawn(&mons[first]) && !Race_if(PM_RODNEYAN) )
					&& !(uncommonfive && uncommon5(&mons[first]) && !jonaspecialspawn(&mons[first]) && !Race_if(PM_RODNEYAN) )
					&& !(uncommonseven && uncommon7(&mons[first]) && !jonaspecialspawn(&mons[first]) && !Race_if(PM_RODNEYAN) )
					&& !(uncommonten && uncommon10(&mons[first]) && !jonaspecialspawn(&mons[first]) && !Race_if(PM_RODNEYAN) )
					&& !(uncommonnewten && monstr[first] >= 10 && monstr[first] < 15 )
					&& !(uncommonnewfifteen && monstr[first] >= 15 && monstr[first] < 20 )
					&& !(uncommonnewtwenty && monstr[first] >= 20 && monstr[first] < 25 )
					&& !(uncommonnewtwentyfive && monstr[first] >= 25 && monstr[first] < 30 )
					&& !(uncommonnewthirty && monstr[first] >= 30 && monstr[first] < 35 )
					&& !(uncommonnewthirtyfive && monstr[first] >= 35 && monstr[first] < 40 )
					&& !(uncommonnewforty && monstr[first] >= 40 && monstr[first] < 45 )
					&& !(uncommonnewfortyfive && monstr[first] >= 45 && monstr[first] < 50 )
					&& !(uncommonnewfifty && monstr[first] >= 50 && monstr[first] < 60 )
					&& !(uncommonnewsixty && monstr[first] >= 60 && monstr[first] < 70 )
					&& !(calctype && toostrong(first, (maxmlev + bonuslevel) ) ) 
					&& !(!calctype && (mons[first].mlevel > (maxmlev + bonuslevel)) ) 
					&& !(uncommonnewseventy && monstr[first] >= 70 )
					&& (first != u.nospawnspecies) && (first != u.nospawnspecies2) && (first != u.nospawnspecies3) && (first != u.nospawnspecies4) && (first != u.nospawnspecies5) && (first != u.nospawnspecies6) && (first != u.nospawnspecies7) && (first != u.nospawnspecies8) && (first != u.nospawnspecies9) && (first != u.nospawnspecies10)
				) {
		num -= mons[first].geno & G_FREQ;
		if (((int)(mons[first].geno & G_FREQ)) == 1 && uarmc && itemhasappearance(uarmc, APP_DIFFERENT_CLOAK)) num--;
		if (first == u.frequentspecies) num -= u.freqspeciesbonus;
		if (first == u.frequentspecies2) num -= u.freqspeciesbonus2;
		if (first == u.frequentspecies3) num -= u.freqspeciesbonus3;
		if (first == u.frequentspecies4) num -= u.freqspeciesbonus4;
		if (first == u.frequentspecies5) num -= u.freqspeciesbonus5;
		if (first == u.frequentspecies6) num -= u.freqspeciesbonus6;
		if (first == u.frequentspecies7) num -= u.freqspeciesbonus7;
		if (first == u.frequentspecies8) num -= u.freqspeciesbonus8;
		if (first == u.frequentspecies9) num -= u.freqspeciesbonus9;
		if (first == u.frequentspecies10) num -= u.freqspeciesbonus10;
		if (first == u.frequentspecies11) num -= u.freqspeciesbonus11;
		if (first == u.frequentspecies12) num -= u.freqspeciesbonus12;
		if (first == u.frequentspecies13) num -= u.freqspeciesbonus13;
		if (first == u.frequentspecies14) num -= u.freqspeciesbonus14;
		if (first == u.frequentspecies15) num -= u.freqspeciesbonus15;
		if (first == u.frequentspecies16) num -= u.freqspeciesbonus16;
		if (first == u.frequentspecies17) num -= u.freqspeciesbonus17;
		if (first == u.frequentspecies18) num -= u.freqspeciesbonus18;
		if (first == u.frequentspecies19) num -= u.freqspeciesbonus19;
		if (first == u.frequentspecies20) num -= u.freqspeciesbonus20;
		if (mons[first].mcolor == u.frequentcolor) num -= u.freqcolorbonus;
		if ((mons[first].mcolor == CLR_MAGENTA || mons[first].mcolor == CLR_BRIGHT_MAGENTA) && SpellColorViolet) num -= 20;

		if ((In_gehennom(&u.uz) && is_demon(&mons[first]))) num -= 10;
		if ((In_gehennom(&u.uz) && dmgtype(&mons[first], AD_FIRE) )) num -= 1;
		if ((In_gehennom(&u.uz) && dmgtype(&mons[first], AD_BURN) )) num -= 1;
		if ((In_gehennom(&u.uz) && dmgtype(&mons[first], AD_LAVA) )) num -= 1;
		if ((In_gehennom(&u.uz) && is_fire_resistant(&mons[first]) )) num -= 1;
		if ((In_mines(&u.uz) && tunnels(&mons[first]) )) num -= 2;
		if ((In_sheol(&u.uz) && is_cold_resistant(&mons[first]) )) num -= 5;
		if ((In_sheol(&u.uz) && dmgtype(&mons[first], AD_COLD) )) num -= 5;
		if ((In_sheol(&u.uz) && dmgtype(&mons[first], AD_FRZE) )) num -= 5;
		if ((In_sheol(&u.uz) && dmgtype(&mons[first], AD_ICEB) )) num -= 2;
		if ((In_icequeen(&u.uz) && is_cold_resistant(&mons[first]) )) num -= 5;
		if ((In_icequeen(&u.uz) && dmgtype(&mons[first], AD_COLD) )) num -= 5;
		if ((In_icequeen(&u.uz) && dmgtype(&mons[first], AD_FRZE) )) num -= 5;
		if ((In_icequeen(&u.uz) && dmgtype(&mons[first], AD_ICEB) )) num -= 5;
		if ((In_towndungeon(&u.uz) && is_angbandmonster(&mons[first]) )) num -= 5;
		if ((In_towndungeon(&u.uz) && is_steammonster(&mons[first]) )) num -= 1;
		if ((In_towndungeon(&u.uz) && is_animemonster(&mons[first]) )) num -= 1;
		if ((In_spiders(&u.uz) && webmaker(&mons[first]) )) num -= 10;
		if ((Is_lawful_quest(&u.uz) && dmgtype(&mons[first], AD_SPC2) )) num -= 1;
		if ((Is_lawful_quest(&u.uz) && is_covetous(&mons[first]) )) num -= 2;
		if ((uarmf && uarmf->oartifact == ART_POWERWARP && is_covetous(&mons[first]) )) num -= 5;
		if ((uarmf && uarmf->oartifact == ART_SATAN_S_CHOPPING_BLOCK && attackdamagetype(&mons[first], AT_BREA, AD_DISN) )) num -= 200;
		if ((uamul && uamul->oartifact == ART_MOSH_PIT_SCRAMBLE && is_female(&mons[first]) && attacktype(&mons[first], AT_KICK) )) num -= 20;
		if ((uarmh && uarmh->oartifact == ART_VACUUM_CLEANER_DEATH && dmgtype(&mons[first], AD_SUCK) )) num -= 50;
		if ((uarmf && uarmf->oartifact == ART_CLICHE_WEAR && dmgtype(&mons[first], AD_RUST) )) num -= 5;
		if ((uarmf && uarmf->oartifact == ART_CLICHE_WEAR && dmgtype(&mons[first], AD_CORR) )) num -= 5;
		if ((uarmf && uarmf->oartifact == ART_CLICHE_WEAR && dmgtype(&mons[first], AD_WTHR) )) num -= 5;
		if ((uarmf && uarmf->oartifact == ART_CLICHE_WEAR && dmgtype(&mons[first], AD_DCAY) )) num -= 5;
		if ((Is_lawful_quest(&u.uz) && cannot_be_tamed(&mons[first]) )) num -= 1;
		if ((Is_lawful_quest(&u.uz) && is_shade(&mons[first]) )) num -= 2;
		if ((Is_lawful_quest(&u.uz) && dmgtype(&mons[first], AD_RBRE) )) num -= 2;
		if ((In_wyrm(&u.uz) && attacktype(&mons[first], AT_BREA) )) num -= 5;
		if ((In_wyrm(&u.uz) && dmgtype(&mons[first], AD_DISE) )) num -= 3;
		if ((In_tomb(&u.uz) && is_undead(&mons[first]) )) num -= 10;
		if ((In_slsea(&u.uz) && dmgtype(&mons[first], AD_WRAP) )) num -= 5;
		if ((In_mtemple(&u.uz) && dmgtype(&mons[first], AD_CLRC) )) num -= 7;
		if ((In_gcavern(&u.uz) && throws_rocks(&mons[first]) )) num -= 5;
		if ((In_gcavern(&u.uz) && hugemonst(&mons[first]) )) num -= 3;
		if ((In_frnkn(&u.uz) && dmgtype(&mons[first], AD_POLY) )) num -= 2;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_SPC2) )) num -= 15;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_STUN) )) num -= 7;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_DRIN) )) num -= 5;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_HALU) )) num -= 8;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_DARK) )) num -= 5;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_FEAR) )) num -= 4;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_FAKE) )) num -= 7;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_LETH) )) num -= 2;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_CNCL) )) num -= 1;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_BLAS) )) num -= 1;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_BANI) )) num -= 2;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_WISD) )) num -= 3;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_HODS) )) num -= 3;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_CHRN) )) num -= 7;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_WEEP) )) num -= 2;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_STTP) )) num -= 1;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_DEPR) )) num -= 5;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_LAZY) )) num -= 5;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_INER) )) num -= 3;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_VULN) )) num -= 4;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_AMNE) )) num -= 10;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_INSA) )) num -= 10;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_SANI) )) num -= 10;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_TRAP) )) num -= 8;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_SHAN) )) num -= 8;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_TERR) )) num -= 10;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_FEMI) )) num -= 4;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_LEVI) )) num -= 7;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_MCRE) )) num -= 5;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_DEBU) )) num -= 5;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_UNPR) )) num -= 10;
		if ((In_illusorycastle(&u.uz) && dmgtype(&mons[first], AD_ILLU) )) num -= 20;
		if ((In_illusorycastle(&u.uz) && shapechanger(&mons[first]) )) num -= 5;
		if ((In_illusorycastle(&u.uz) && is_angbandmonster(&mons[first]) )) num -= 3;
		if ((In_illusorycastle(&u.uz) && is_animemonster(&mons[first]) )) num -= 1;
		if ((In_illusorycastle(&u.uz) && is_steammonster(&mons[first]) )) num -= 1;
		if ((In_voiddungeon(&u.uz) && is_angbandmonster(&mons[first]) )) num -= 5;
		if ((In_voiddungeon(&u.uz) && is_animemonster(&mons[first]) )) num -= 3;
		if ((In_voiddungeon(&u.uz) && is_steammonster(&mons[first]) )) num -= 3;
		if ((In_voiddungeon(&u.uz) && passes_walls(&mons[first]) )) num -= 5;
		if ((In_netherrealm(&u.uz) && is_demon(&mons[first]) )) num -= 10;
		if ((In_netherrealm(&u.uz) && dmgtype(&mons[first], AD_NTHR) )) num -= 5;
		if ((In_netherrealm(&u.uz) && dmgtype(&mons[first], AD_DRLI) )) num -= 5;
		if ((In_deepmines(&u.uz) && tunnels(&mons[first]) )) num -= 4;
		if ((In_deepmines(&u.uz) && humanoid(&mons[first]) )) num -= 2;
		if ((In_angmar(&u.uz) && (mons[first].maligntyp < 0) )) num -= 15;
		if ((In_emynluin(&u.uz) && is_angbandmonster(&mons[first]) )) num -= 10;
		if ((In_emynluin(&u.uz) && is_animemonster(&mons[first]) )) num -= 2;
		if ((In_emynluin(&u.uz) && is_steammonster(&mons[first]) )) num -= 5;
		if ((In_greencross(&u.uz) && is_cowmonster(&mons[first]) )) num -= 50;
		if ((In_greencross(&u.uz) && is_jokemonster(&mons[first]) )) num -= 5;
		if ((In_swimmingpool(&u.uz) && dmgtype(&mons[first], AD_WRAP) )) num -= 10;
		if ((In_swimmingpool(&u.uz) && amphibious(&mons[first]) )) num -= 10;
		if ((In_swimmingpool(&u.uz) && is_swimmer(&mons[first]) )) num -= 10;
		if ((In_hellbathroom(&u.uz) && (mons[first].msound == MS_FART_NORMAL) )) num -= 10;
		if ((In_hellbathroom(&u.uz) && (mons[first].msound == MS_FART_QUIET) )) num -= 10;
		if ((In_hellbathroom(&u.uz) && (mons[first].msound == MS_FART_LOUD) )) num -= 10;
		if ((uwep && uwep->oartifact == ART_BIDETHANDER && (mons[first].msound == MS_FART_LOUD) )) num -= 20;
		if ((u.twoweap && uswapwep && uswapwep->oartifact == ART_BIDETHANDER && (mons[first].msound == MS_FART_LOUD) )) num -= 20;
		if ((In_hellbathroom(&u.uz) && dmgtype(&mons[first], AD_FEMI) )) num -= 15;
		if ((In_minusworld(&u.uz) && is_randomizedmonster(&mons[first]) )) num -= 500;
		if ((In_ZAPM(&u.uz) && is_evilpatchmonster(&mons[first]) )) num -= 20;
		if ((In_sewerplant(&u.uz) && acidic(&mons[first]) )) num -= 4;
		if ((In_sewerplant(&u.uz) && poisonous(&mons[first]) )) num -= 3;
		if ((In_gammacaves(&u.uz) && dmgtype(&mons[first], AD_CONT) )) num -= 7;
		if ((In_mainframe(&u.uz) && is_demon(&mons[first]) )) num -= 25;
		if ((In_mainframe(&u.uz) && attacktype(&mons[first], AT_BREA) )) num -= 10;

		if ((Role_if(PM_ACTIVISTOR) && always_hostile(&mons[first]))) num -= 5;
		if ((Role_if(PM_ALTMER) && is_reflector(&mons[first]))) num -= 3;
		if ((Role_if(PM_AMAZON) && is_diablomonster(&mons[first]))) num -= 5;
		if ((Role_if(PM_AMAZON) && attacktype(&mons[first], AT_CLAW) )) num -= 1;
		if ((Role_if(PM_ANACHRONIST) && is_dnethackmonster(&mons[first]))) num -= 10;
		if ((Role_if(PM_ARCHEOLOGIST) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((uimplant && uimplant->oartifact == ART_GELMER_KELANA_TWIN && is_vanillamonster(&mons[first]))) num -= 10;
		if ((Role_if(PM_ARTIST) && attacktype(&mons[first], AT_GAZE))) num -= 2;
		if ((Role_if(PM_ASSASSIN) && is_diablomonster(&mons[first]))) num -= 5;
		if ((Role_if(PM_BARBARIAN) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_NOOB_MODE_BARB) && is_vanillamonster(&mons[first]))) num -= 5;
		if ((Role_if(PM_BARBARIAN) && is_diablomonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_BINDER) && is_dnethackmonster(&mons[first]))) num -= 10;
		if ((Role_if(PM_ANACHRONOUNBINDER) && is_dnethackmonster(&mons[first]))) num -= 10;
		if ((Role_if(PM_BINDER) && extra_nasty(&mons[first]))) num -= 2;
		if ((Role_if(PM_BINDER) && is_undead(&mons[first]))) num -= 2;
		if ((Role_if(PM_BLEEDER) && (mons[first].msound == MS_SHOE))) num -= 10;
		if ((Role_if(PM_BLOODSEEKER) && has_blood(&mons[first]))) num -= 1;
		if ((Role_if(PM_CAMPERSTRIKER) && is_cowmonster(&mons[first]))) num -= 5;
		if ((Role_if(PM_CAMPERSTRIKER) && is_jokemonster(&mons[first]))) num -= 5;
		if ((Role_if(PM_CAVEMAN) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_CHEVALIER) && dmgtype(&mons[first], AD_ICUR))) num -= 1;
		if ((Role_if(PM_CONVICT) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_CONVICT) && (mons[first].msound == MS_ARREST))) num -= 2;
		if ((Role_if(PM_COURIER) && is_animal(&mons[first]))) num -= 1;
		if ((Role_if(PM_CRUEL_ABUSER) && cannot_be_tamed(&mons[first]))) num -= 3;
		if ((Role_if(PM_DOLL_MISTRESS) && is_animemonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_DOOM_MARINE) && attacktype(&mons[first], AT_BEAM))) num -= 5;
		if ((Role_if(PM_DQ_SLIME) && verysmall(&mons[first]))) num -= 5;
		if ((Role_if(PM_DRUID) && is_diablomonster(&mons[first]))) num -= 5;
		if ((Role_if(PM_ERDRICK) && is_multihued(&mons[first]))) num -= 10;
		if ((Role_if(PM_FAILED_EXISTENCE) && (mons[first].msound == MS_SHOE))) num -= 5;
		if ((Role_if(PM_FIREFIGHTER) && is_fire_resistant(&mons[first]))) num -= 2;
		if ((Role_if(PM_FLAME_MAGE) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_GLADIATOR) && is_animal(&mons[first]))) num -= 1;
		if ((Role_if(PM_GLADIATOR) && humanoid(&mons[first]))) num -= 1;
		if ((Role_if(PM_GOFF) && (mons[first].msound == MS_CUSS))) num -= 2;
		if ((Role_if(PM_HEALER) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_ICE_MAGE) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_JEDI) && is_cowmonster(&mons[first]))) num -= 2;
		if ((Role_if(PM_JEDI) && is_jokemonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_KNIGHT) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_KNIGHT) && (mons[first].msound == MS_NEIGH))) num -= 2;
		if ((Role_if(PM_LADIESMAN) && (mons[first].msound == MS_FART_NORMAL))) num -= 10;
		if ((Role_if(PM_LADIESMAN) && (mons[first].msound == MS_FART_QUIET))) num -= 10;
		if ((Role_if(PM_LADIESMAN) && (mons[first].msound == MS_FART_LOUD))) num -= 10;
		if ((Role_if(PM_LADIESMAN) && (mons[first].msound == MS_WHORE))) num -= 25;
		if ((Role_if(PM_MAHOU_SHOUJO) && is_animemonster(&mons[first]))) num -= 10;
		if ((Role_if(PM_MEDIUM) && dmgtype(&mons[first], AD_SPC2))) num -= 2;
		if ((Role_if(PM_MEDIUM) && is_mind_flayer(&mons[first]))) num -= 1;
		if ((Role_if(PM_MONK) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_HALF_BAKED) && is_vanillamonster(&mons[first]))) num -= 5;
		if ((Role_if(PM_MURDERER) && (mons[first].msound == MS_ARREST))) num -= 5;
		if ((Role_if(PM_NECROMANCER) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_NECROMANCER) && is_diablomonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_NECROMANCER) && is_undead(&mons[first]))) num -= 2;
		if ((Role_if(PM_NOBLEMAN) && is_dnethackmonster(&mons[first]))) num -= 5;
		if ((Role_if(PM_OCCULT_MASTER) && is_dlordsmonster(&mons[first]))) num -= 3;
		if ((Role_if(PM_OTAKU) && is_elonamonster(&mons[first]))) num -= 3;
		if ((uarm && uarm->oartifact == ART_ALPHA_TAURI && is_elonamonster(&mons[first]))) num -= 20;
		if ((Race_if(PM_WISP) && is_elonamonster(&mons[first]))) num -= 3;
		if ((Race_if(PM_MAZIN) && is_elonamonster(&mons[first]))) num -= 5;
		if ((Race_if(PM_MAZIN) && attacktype(&mons[first], AT_MAGC))) num -= 3;
		if ((Race_if(PM_HUNKAJUNK) && dmgtype(&mons[first], AD_TERR))) num -= 5;
		if ((Race_if(PM_HUNKAJUNK) && (mons[first].msound == MS_SOVIET))) num -= 10;
		if ((Race_if(PM_ELONA_SNAIL) && is_elonamonster(&mons[first]))) num -= 10;
		if ((Race_if(PM_WEAPONIZED_DINOSAUR) && is_elonamonster(&mons[first]))) num -= 2;
		if ((Role_if(PM_OFFICER) && always_hostile(&mons[first]))) num -= 2;
		if ((Role_if(PM_OTAKU) && is_animemonster(&mons[first]))) num -= 5;
		if ((Role_if(PM_PALADIN) && is_diablomonster(&mons[first]))) num -= 5;
		if ((Role_if(PM_PIRATE) && is_dnethackmonster(&mons[first]))) num -= 5;
		if ((Role_if(PM_POKEMON) && is_pokemon(&mons[first]))) num -= 10;
		if ((Role_if(PM_PRIEST) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_PSION) && extra_nasty(&mons[first]))) num -= 2;
		if ((Role_if(PM_PSION) && is_covetous(&mons[first]))) num -= 10;
		if ((Role_if(PM_PSION) && is_reviver(&mons[first]))) num -= 3;
		if ((Role_if(PM_PSION) && is_reflector(&mons[first]))) num -= 3;
		if ((Role_if(PM_PSION) && attacktype(&mons[first], AT_MAGC))) num -= 5;
		if ((Role_if(PM_PSION) && passes_walls(&mons[first]))) num -= 3;	
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_SPC2))) num -= 3;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_SSEX))) num -= 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_DETH))) num -= 1;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_FAMN))) num -= 1;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_PEST))) num -= 1;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_SLIM))) num -= 3;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_WTHR))) num -= 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_NPRO))) num -= 1;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_LETH))) num -= 2;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_CNCL))) num -= 3;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_BLAS))) num -= 3;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_BANI))) num -= 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_SUCK))) num -= 2;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_UVUU))) num -= 7;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_STTP))) num -= 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_WRAT))) num -= 2;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_DFOO))) num -= 2;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_NAST))) num -= 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_AMNE))) num -= 3;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_CURS))) num -= 20;
		if ((Role_if(PM_RANGER) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_ROCKER) && is_ston_resistant(&mons[first]))) num -= 2;
		if ((Role_if(PM_ROGUE) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_ROGUE) && has_head(&mons[first]))) num -= 1;
		if ((Role_if(PM_SAGE) && is_undead(&mons[first]))) num -= 1;
		if ((Role_if(PM_SAIYAN) && is_animemonster(&mons[first]))) num -= 2;
		if ((Role_if(PM_SAMURAI) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_SHAPESHIFTER) && extra_nasty(&mons[first]))) num -= 1;
		if ((Role_if(PM_SHAPESHIFTER) && is_covetous(&mons[first]))) num -= 3;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[first], AD_SLIM))) num -= 2;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[first], AD_CNCL))) num -= 1;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[first], AD_STTP))) num -= 2;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[first], AD_NAST))) num -= 20;
		if ((Role_if(PM_SLAVE_MASTER) && is_domestic(&mons[first]))) num -= 2;
		if ((Role_if(PM_SPACEWARS_FIGHTER) && is_cowmonster(&mons[first]))) num -= 5;
		if ((Role_if(PM_SPACEWARS_FIGHTER) && is_jokemonster(&mons[first]))) num -= 3;
		if ((Role_if(PM_SUPERMARKET_CASHIER) && likes_gold(&mons[first]))) num -= 5;
		if ((Role_if(PM_TOPMODEL) && (mons[first].msound == MS_SHOE))) num -= 5;
		if ((Role_if(PM_TOURIST) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_TOURIST) && haseyes(&mons[first]))) num -= 5;
		if ((Role_if(PM_TRANSSYLVANIAN) && (mons[first].msound == MS_SHOE))) num -= 5;
		if ((Role_if(PM_TRANSSYLVANIAN) && dmgtype(&mons[first], AD_NAST))) num -= 5;
		if ((Role_if(PM_TRANSVESTITE) && (mons[first].msound == MS_SHOE))) num -= 5;
		if ((Role_if(PM_PROSTITUTE) && (mons[first].msound == MS_SHOE))) num -= 5;
		if ((Role_if(PM_KURWA) && (mons[first].msound == MS_SHOE))) num -= 5;
		if ((Role_if(PM_PROSTITUTE) && attacktype(&mons[first], AT_CLAW) && (mons[first].msound == MS_SQEEK))) num -= 30;
		if ((Role_if(PM_KURWA) && attacktype(&mons[first], AT_CLAW) && (mons[first].msound == MS_SQEEK))) num -= 30;
		if ((FemtrapActiveDora && attacktype(&mons[first], AT_CLAW) && (mons[first].msound == MS_SQEEK))) num -= 30;
		if ((FemtrapActiveManuela && spawnswithblockheels(&mons[first]) )) num -= 100;
		if ((uarmf && uarmf->oartifact == ART_RUEA_S_FAILED_CONVERSION && attacktype(&mons[first], AT_CLAW) && (mons[first].msound == MS_SQEEK))) num -= 30;
		if ((Role_if(PM_PROSTITUTE) && dmgtype(&mons[first], AD_SSEX))) num -= 20;
		if ((Role_if(PM_KURWA) && dmgtype(&mons[first], AD_SSEX))) num -= 20;
		if ((Role_if(PM_UNBELIEVER) && is_angbandmonster(&mons[first]))) num -= 10;
		if ((Role_if(PM_UNBELIEVER) && is_steammonster(&mons[first]))) num -= 2;
		if ((Role_if(PM_UNDEAD_SLAYER) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_UNDEAD_SLAYER) && is_undead(&mons[first]))) num -= 10;
		if ((Role_if(PM_UNDERTAKER) && is_undead(&mons[first]))) num -= 20;
		if ((Role_if(PM_STAND_USER) && amorphous(&mons[first]))) num -= 5;
		if ((Role_if(PM_VALKYRIE) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_VANILLA_VALK) && is_vanillamonster(&mons[first]))) num -= 10;
		if ((Role_if(PM_WANDKEEPER) && is_poison_resistant(&mons[first]))) num -= 1;
		if ((Role_if(PM_WARRIOR) && is_dlordsmonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_WILD_TALENT) && is_angbandmonster(&mons[first]))) num -= 5;
		if ((Role_if(PM_WILD_TALENT) && is_steammonster(&mons[first]))) num -= 5;
		if ((Role_if(PM_WILD_TALENT) && is_animemonster(&mons[first]))) num -= 3;
		if ((Role_if(PM_WIZARD) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_YEOMAN) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_YEOMAN) && is_domestic(&mons[first]))) num -= 2;
		if ((Role_if(PM_ZOOKEEPER) && is_domestic(&mons[first]))) num -= 20;
		if ((Race_if(PM_AK_THIEF_IS_DEAD_) && is_cowmonster(&mons[first]))) num -= 10;
		if ((Race_if(PM_AK_THIEF_IS_DEAD_) && is_jokemonster(&mons[first]))) num -= 10;
		if ((Race_if(PM_ALCHEMIST) && is_covetous(&mons[first]))) num -= 5;
		if ((Race_if(PM_ALCHEMIST) && extra_nasty(&mons[first]))) num -= 5;
		if ((Race_if(PM_ANGBANDER) && is_angbandmonster(&mons[first]))) num -= 5;
		if ((Race_if(PM_ANGBANDER) && is_steammonster(&mons[first]))) num -= 3;
		if ((Race_if(PM_ANGBANDER) && is_animemonster(&mons[first]))) num -= 1;
		if ((Race_if(PM_HUMANOID_ANGEL) && is_demon(&mons[first]))) num -= 10;
		if ((Race_if(PM_HUMANOID_ANGEL) && always_hostile(&mons[first]))) num -= 4;
		if ((Race_if(PM_HUMANOID_ANGEL) && extra_nasty(&mons[first]))) num -= 1;
		if ((isaquarian && is_swimmer(&mons[first]))) num -= 5;
		if ((Race_if(PM_BATMAN) && is_neuter(&mons[first]))) num -= 20;
		if ((Race_if(PM_BATMAN) && is_animal(&mons[first]))) num -= 5;
		if ((Race_if(PM_CHIROPTERAN) && is_dnethackmonster(&mons[first]))) num -= 5;
		if ((Race_if(PM_ETHEREALOID) && is_dnethackmonster(&mons[first]))) num -= 10;
		if ((Race_if(PM_INCORPOREALOID) && is_dnethackmonster(&mons[first]))) num -= 10;
		if ((Race_if(PM_CLOCKWORK_AUTOMATON) && is_dnethackmonster(&mons[first]))) num -= 3;
		if ((Race_if(PM_CLOCKWORK_AUTOMATON) && always_peaceful(&mons[first]))) num -= 2;
		if ((Race_if(PM_CORTEX) && unsolid(&mons[first]))) num -= 2;
		if ((Race_if(PM_CORTEX) && nolimbs(&mons[first]))) num -= 5;
		if ((Race_if(PM_DEATHMOLD) && is_angbandmonster(&mons[first]))) num -= 1;
		if ((Race_if(PM_DEATHMOLD) && is_steammonster(&mons[first]))) num -= 1;
		if ((Race_if(PM_DEATHMOLD) && is_animemonster(&mons[first]))) num -= 1;
		if ((Race_if(PM_DOPPELGANGER) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Race_if(PM_BORG) && is_jokemonster(&mons[first]))) num -= 4;
		if ((Race_if(PM_DROW) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Race_if(PM_DWARF) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Race_if(PM_ELF) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Race_if(PM_GNOME) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Race_if(PM_PLAYER_GREMLIN) && dmgtype(&mons[first], AD_DARK))) num -= 3;
		if ((Race_if(PM_HERBALIST) && is_covetous(&mons[first]))) num -= 5;
		if ((Race_if(PM_HERBALIST) && extra_nasty(&mons[first]))) num -= 5;
		if ((Race_if(PM_BORG) && extra_nasty(&mons[first]))) num -= 3;
		if ((Race_if(PM_HOBBIT) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Race_if(PM_HUMAN) && is_vanillamonster(&mons[first]))) num -= 2;
		if ((Race_if(PM_IMMUNIZER) && dmgtype(&mons[first], AD_CURS))) num -= 7;
		if ((Race_if(PM_INCANTIFIER) && is_dnethackmonster(&mons[first]))) num -= 3;
		if ((Race_if(PM_INKA) && is_elf(&mons[first]))) num -= 3;
		if ((Race_if(PM_INSECTOID) && (mons[first].msound == MS_BUZZ))) num -= 4;
		if ((Race_if(PM_KOP) && always_tame(&mons[first]))) num -= 5;
		if ((Race_if(PM_HUMAN_WEREWOLF) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Race_if(PM_MISSINGNO) && is_pokemon(&mons[first]))) num -= 3;
		if ((Race_if(PM_NAVI) && (mons[first].msound == MS_SHOE))) num -= 2;
		if ((Race_if(PM_ORC) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Race_if(PM_PEACEMAKER) && always_hostile(&mons[first]))) num -= 3;
		if ((Race_if(PM_PEACEMAKER) && cannot_be_tamed(&mons[first]))) num -= 2;
		if ((isrougelike && is_vanillamonster(&mons[first]))) num -= 5;
		if ((Race_if(PM_SINNER) && dmgtype(&mons[first], AD_SSEX))) num -= 2;
		if ((Race_if(PM_SKILLOR) && dmgtype(&mons[first], AD_SKIL))) num -= 5;
		if ((issoviet && is_vanillamonster(&mons[first]))) num -= 20;
		if ((Race_if(PM_SPIRIT) && passes_walls(&mons[first]))) num -= 2;
		if ((Race_if(PM_WEAPON_TRAPPER) && dmgtype(&mons[first], AD_WEBS))) num -= 2;
		if ((Race_if(PM_UNALIGNMENT_THING) && is_dnethackmonster(&mons[first]))) num -= 1;
		if ((Race_if(PM_VAMPIRE) && is_vanillamonster(&mons[first]))) num -= 1;
		if ((Race_if(PM_VENTURE_CAPITALIST) && likes_gold(&mons[first]))) num -= 4;
		if ((Race_if(PM_VORTEX) && unsolid(&mons[first]))) num -= 5;
		if ((Race_if(PM_VORTEX) && nolimbs(&mons[first]))) num -= 12;
		if ((iswindinhabitant && is_cowmonster(&mons[first]))) num -= 5;
		if ((iswindinhabitant && is_jokemonster(&mons[first]))) num -= 2;
		if ((Race_if(PM_WORM_THAT_WALKS) && is_dnethackmonster(&mons[first]))) num -= 5;
		if ((Race_if(PM_YUKI_PLAYA) && is_dnethackmonster(&mons[first]))) num -= 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_VAPO))) num -= 2;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_EDGE))) num -= 2;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_NGEN))) num -= 3;
		if ((Race_if(PM_WEAPON_TRAPPER) && dmgtype(&mons[first], AD_TRAP))) num -= 1;
		if ((Role_if(PM_ALTMER) && (mons[first].msound == MS_STENCH))) num -= 1;
		if ((Role_if(PM_ALTMER) && dmgtype(&mons[first], AD_WGHT))) num -= 2;
		if ((Role_if(PM_CHAOS_SORCEROR) && dmgtype(&mons[first], AD_CHAO))) num -= 1;
		if ((Role_if(PM_FAILED_EXISTENCE) && (mons[first].msound == MS_STENCH))) num -= 2;
		if ((Role_if(PM_MAHOU_SHOUJO) && (mons[first].msound == MS_STENCH))) num -= 3;
		if ((Role_if(PM_MONK) && dmgtype(&mons[first], AD_CAST))) num -= 1;
		if ((Role_if(PM_MUSICIAN) && dmgtype(&mons[first], AD_MIDI))) num -= 2;
		if ((Role_if(PM_PSION) && (mons[first].msound == MS_STENCH))) num -= 4;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_RNG))) num -= 3;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[first], AD_RNG))) num -= 2;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[first], AD_MIDI))) num -= 2;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[first], AD_CAST))) num -= 2;
		if ((Role_if(PM_WILD_TALENT) && dmgtype(&mons[first], AD_RNG))) num -= 3;
		if ((Race_if(PM_ALCHEMIST) && (mons[first].msound == MS_STENCH))) num -= 3;
		if ((Race_if(PM_ALCHEMIST) && dmgtype(&mons[first], AD_RNG))) num -= 1;
		if ((Race_if(PM_ALCHEMIST) && dmgtype(&mons[first], AD_LITT))) num -= 2;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[first], AD_CAST))) num -= 4;
		if ((Race_if(PM_BORG) && dmgtype(&mons[first], AD_ICEB))) num -= 1;
		if ((Race_if(PM_BORG) && dmgtype(&mons[first], AD_VOMT))) num -= 2;
		if ((Race_if(PM_BORG) && dmgtype(&mons[first], AD_FREN))) num -= 5;
		if ((Race_if(PM_BORG) && dmgtype(&mons[first], AD_INSA))) num -= 2;
		if ((Race_if(PM_BORG) && dmgtype(&mons[first], AD_TRAP))) num -= 3;
		if ((Race_if(PM_BORG) && dmgtype(&mons[first], AD_NTHR))) num -= 2;
		if ((Race_if(PM_BORG) && dmgtype(&mons[first], AD_MIDI))) num -= 1;
		if ((Race_if(PM_DEATHMOLD) && dmgtype(&mons[first], AD_MIDI))) num -= 2;
		if ((Race_if(PM_DEATHMOLD) && dmgtype(&mons[first], AD_RNG))) num -= 3;
		if ((Race_if(PM_DESTABILIZER) && dmgtype(&mons[first], AD_VAPO))) num -= 4;
		if ((Race_if(PM_DESTABILIZER) && dmgtype(&mons[first], AD_EDGE))) num -= 2;
		if ((Race_if(PM_DESTABILIZER) && dmgtype(&mons[first], AD_LITT))) num -= 1;
		if ((Race_if(PM_DOPPELGANGER) && dmgtype(&mons[first], AD_RNG))) num -= 2;
		if ((Race_if(PM_HEMI_DOPPELGANGER) && dmgtype(&mons[first], AD_RNG))) num -= 1;
		if ((Race_if(PM_PLAYER_GOLEM) && dmgtype(&mons[first], AD_FAMN))) num -= 20;
		if ((Race_if(PM_PLAYER_JABBERWOCK) && bigmonst(&mons[first]))) num -= 1;
		if ((Race_if(PM_HERBALIST) && dmgtype(&mons[first], AD_LITT))) num -= 4;
		if ((Race_if(PM_HERBALIST) && (mons[first].msound == MS_STENCH))) num -= 5;
		if ((Race_if(PM_RODNEYAN) && (mons[first].msound == MS_STENCH))) num -= 4;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[first], AD_CAST))) num -= 10;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[first], AD_RNG))) num -= 4;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[first], AD_CONT))) num -= 10;
		if ((Role_if(PM_ALTMER) && dmgtype(&mons[first], AD_CONT) )) num -= 5;
		if ((Role_if(PM_ALTMER) && dmgtype(&mons[first], AD_MINA) )) num -= 2;
		if ((Role_if(PM_ALTMER) && dmgtype(&mons[first], AD_AGGR) )) num -= 2;
		if ((Role_if(PM_ASSASSIN) && dmgtype(&mons[first], AD_ALIN) )) num -= 1;
		if ((Role_if(PM_BINDER) && dmgtype(&mons[first], AD_SIN) )) num -= 5;
		if ((Role_if(PM_CONVICT) && dmgtype(&mons[first], AD_SIN) )) num -= 1;
		if ((Role_if(PM_MURDERER) && dmgtype(&mons[first], AD_SIN) )) num -= 1;
		if ((Role_if(PM_COURIER) && dmgtype(&mons[first], AD_AGGR) )) num -= 3;
		if ((Role_if(PM_DQ_SLIME) && dmgtype(&mons[first], AD_CONT) )) num -= 1;
		if ((Role_if(PM_FAILED_EXISTENCE) && dmgtype(&mons[first], AD_AGGR) )) num -= 2;
		if ((Role_if(PM_KURWA) && dmgtype(&mons[first], AD_MINA) )) num -= 2;
		if ((Role_if(PM_MAHOU_SHOUJO) && dmgtype(&mons[first], AD_AGGR) )) num -= 1;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_CONT) )) num -= 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_MINA) )) num -= 10;
		if ((Role_if(PM_SCIENTIST) && dmgtype(&mons[first], AD_CONT) )) num -= 4;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[first], AD_CONT) )) num -= 5;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[first], AD_MINA) )) num -= 3;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[first], AD_SIN) )) num -= 2;
		if ((Role_if(PM_UNBELIEVER) && dmgtype(&mons[first], AD_ALIN) )) num -= 2;
		if ((Role_if(PM_ZYBORG) && dmgtype(&mons[first], AD_CONT) )) num -= 1;
		if ((Race_if(PM_ALBAE) && dmgtype(&mons[first], AD_AGGR) )) num -= 5;
		if ((Race_if(PM_ALCHEMIST) && dmgtype(&mons[first], AD_CONT) )) num -= 5;
		if ((Race_if(PM_DOPPELGANGER) && dmgtype(&mons[first], AD_CONT) )) num -= 3;
		if ((Race_if(PM_DOPPELGANGER) && dmgtype(&mons[first], AD_AGGR) )) num -= 5;
		if ((Race_if(PM_HERBALIST) && dmgtype(&mons[first], AD_CONT) )) num -= 5;
		if ((Race_if(PM_IMMUNIZER) && dmgtype(&mons[first], AD_CONT) )) num -= 5;
		if ((Race_if(PM_IMMUNIZER) && dmgtype(&mons[first], AD_AGGR) )) num -= 5;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[first], AD_CONT) )) num -= 7;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[first], AD_MINA) )) num -= 6;
		if ((Race_if(PM_SINNER) && dmgtype(&mons[first], AD_SIN) )) num -= 2;
		if ((Race_if(PM_SPIRIT) && dmgtype(&mons[first], AD_AGGR) )) num -= 6;
		if ((Role_if(PM_FEMINIST) && is_male(&mons[first]) )) num -= 2;
		if ((Role_if(PM_FEMINIST) && attacktype(&mons[first], AT_LASH) )) num -= 3;
		if ((Role_if(PM_GANG_SCHOLAR) && (mons[first].msound == MS_FART_NORMAL) )) num -= 20;
		if ((Role_if(PM_GANG_SCHOLAR) && (mons[first].msound == MS_FART_QUIET) )) num -= 20;
		if ((Role_if(PM_GANG_SCHOLAR) && (mons[first].msound == MS_FART_LOUD) )) num -= 20;
		if ((Role_if(PM_GANG_SCHOLAR) && (mons[first].msound == MS_STENCH) )) num -= 50;
		if ((Role_if(PM_GANG_SCHOLAR) && is_jokemonster(&mons[first]) )) num -= 100;
		if ((Role_if(PM_GANG_SCHOLAR) && is_cowmonster(&mons[first]) )) num -= 20;
		if ((FemtrapActiveAriane && (mons[first].msound == MS_FART_NORMAL) )) num -= 20;
		if ((FemtrapActiveAriane && (mons[first].msound == MS_FART_QUIET) )) num -= 20;
		if ((FemtrapActiveAriane && (mons[first].msound == MS_FART_LOUD) )) num -= 20;
		if ((FemtrapActiveAriane && (mons[first].msound == MS_STENCH) )) num -= 50;
		if ((FemtrapActiveAriane && is_jokemonster(&mons[first]) )) num -= 100;
		if ((FemtrapActiveAriane && is_cowmonster(&mons[first]) )) num -= 20;

		if ((Role_if(PM_WALSCHOLAR) && is_jokemonster(&mons[first]) )) num -= 20;
		if ((Role_if(PM_WALSCHOLAR) && (mons[first].msound == MS_FART_NORMAL) )) num -= 5;
		if ((Role_if(PM_WALSCHOLAR) && (mons[first].msound == MS_FART_QUIET) )) num -= 5;
		if ((Role_if(PM_WALSCHOLAR) && (mons[first].msound == MS_FART_LOUD) )) num -= 5;
		if ((Role_if(PM_WALSCHOLAR) && (mons[first].msound == MS_STENCH) )) num -= 20;
		if ((Role_if(PM_WALSCHOLAR) && (mons[first].msound == MS_CONVERT) )) num -= 5;
		if ((Role_if(PM_WALSCHOLAR) && (mons[first].msound == MS_HCALIEN) )) num -= 5;
		if ((Role_if(PM_SINGSLAVE) && (mons[first].msound == MS_SING) )) num -= 25;
		if ((Role_if(PM_CELLAR_CHILD) && is_angbandmonster(&mons[first]) )) num -= 20;
		if ((uamul && uamul->oartifact == ART_WALT_VERSUS_ANNA && (mons[first].msound == MS_FART_NORMAL) )) num -= 5;
		if ((uamul && uamul->oartifact == ART_WALT_VERSUS_ANNA && (mons[first].msound == MS_FART_QUIET) )) num -= 5;
		if ((uamul && uamul->oartifact == ART_WALT_VERSUS_ANNA && (mons[first].msound == MS_FART_LOUD) )) num -= 5;
		if ((uamul && uamul->oartifact == ART_WALT_VERSUS_ANNA && (mons[first].msound == MS_STENCH) )) num -= 20;
		if ((Role_if(PM_DEMAGOGUE) && (mons[first].mresists & MR_PLUSFOUR))) num -= 1;
		if ((Role_if(PM_SOCIAL_JUSTICE_WARRIOR) && (mons[first].mflags2 & M2_DEMON) )) num -= 5;
		if ((Role_if(PM_DEMAGOGUE) && (mons[first].mflags3 & M3_NOTAME) )) num -= 2;
		if ((Race_if(PM_DEMAGOGUE) && dmgtype(&mons[first], AD_WTHR) )) num -= 2;
		if ((Race_if(PM_DEMAGOGUE) && dmgtype(&mons[first], AD_LETH) )) num -= 1;
		if ((Race_if(PM_DEMAGOGUE) && dmgtype(&mons[first], AD_CNCL) )) num -= 2;
		if ((Race_if(PM_DEMAGOGUE) && dmgtype(&mons[first], AD_SIN) )) num -= 2;
		if ((Race_if(PM_DEMAGOGUE) && dmgtype(&mons[first], AD_DEST) )) num -= 2;
		if ((Race_if(PM_DEMAGOGUE) && dmgtype(&mons[first], AD_AGGR) )) num -= 5;
		if ((Race_if(PM_CELLAR_CHILD) && dmgtype(&mons[first], AD_SANI) )) num -= 5;
		if ((Race_if(PM_SOCIAL_JUSTICE_WARRIOR) && dmgtype(&mons[first], AD_BANI) )) num -= 1;
		if ((Race_if(PM_SOCIAL_JUSTICE_WARRIOR) && dmgtype(&mons[first], AD_DFOO) )) num -= 2;

		if ((Race_if(PM_HUMANOID_ANGEL) && is_evilpatchmonster(&mons[first]))) num -= 5;
		if ((Role_if(PM_PSION) && is_evilpatchmonster(&mons[first]))) num -= 10;
		if ((Race_if(PM_DOPPELGANGER) && is_evilpatchmonster(&mons[first]))) num -= 2;
		if ((Role_if(PM_ALTMER) && is_evilpatchmonster(&mons[first]))) num -= 1;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_DATA) )) num -= 1;
		if ((uwep && uwep->oartifact == ART_RAFSCHAR_S_SUPERWEAPON && dmgtype(&mons[first], AD_DATA) )) num -= 1000;
		if ((uswapwep && uswapwep->oartifact == ART_RAFSCHAR_S_SUPERWEAPON && dmgtype(&mons[first], AD_DATA) )) num -= 1000;
		if ((Role_if(PM_SHAPESHIFTER) && is_evilpatchmonster(&mons[first]))) num -= 5;
		if ((Race_if(PM_RODNEYAN) && is_evilpatchmonster(&mons[first]))) num -= 5;

		if ((Role_if(PM_SOFTWARE_ENGINEER) && is_evilpatchmonster(&mons[first]))) num -= 3;
		if ((Role_if(PM_CRACKER) && is_evilpatchmonster(&mons[first]))) num -= 5;
		if ((Role_if(PM_JANITOR) && is_evilpatchmonster(&mons[first]))) num -= 5;
		if ((Role_if(PM_SPACE_MARINE) && is_evilpatchmonster(&mons[first]))) num -= 10;
		if ((Role_if(PM_QUARTERBACK) && is_evilpatchmonster(&mons[first]))) num -= 2;
		if ((Role_if(PM_PSYKER) && is_evilpatchmonster(&mons[first]))) num -= 10;
		if ((Role_if(PM_EMPATH) && is_evilpatchmonster(&mons[first]))) num -= 2;
		if ((Role_if(PM_MASTERMIND) && is_evilpatchmonster(&mons[first]))) num -= 3;
		if ((Role_if(PM_ASTRONAUT) && is_evilpatchmonster(&mons[first]))) num -= 2;
		if ((Role_if(PM_CYBERNINJA) && is_evilpatchmonster(&mons[first]))) num -= 3;
		if ((Role_if(PM_CRACKER) && (mons[first].maligntyp < 0))) num -= 4;
		if ((Role_if(PM_JANITOR) && !(mons[first].mflags1 & M1_METALLIVORE) && !(mons[first].mflags3 & M3_LITHIVORE) && !(mons[first].mflags4 & M4_ORGANIVORE) )) num -= 5;
		if ((Role_if(PM_JANITOR) && dmgtype(&mons[first], AD_TRAP))) num -= 5;
		if ((Role_if(PM_JANITOR) && dmgtype(&mons[first], AD_WEBS))) num -= 3;
		if ((Role_if(PM_STORMBOY) && is_swimmer(&mons[first]))) num -= 4;
		if ((Role_if(PM_STORMBOY) && breathless(&mons[first]))) num -= 2;
		if ((Role_if(PM_STORMBOY) && amphibious(&mons[first]))) num -= 5;
		if ((Role_if(PM_STORMBOY) && is_elf(&mons[first]))) num -= 10;
		if ((Role_if(PM_STORMBOY) && (mons[first].maligntyp > 0) )) num -= 7;
		if ((Role_if(PM_YAUTJA) && is_animal(&mons[first]))) num -= 5;
		if ((Role_if(PM_YAUTJA) && extra_nasty(&mons[first]))) num -= 5;
		if ((Role_if(PM_YAUTJA) && dmgtype(&mons[first], AD_DGST))) num -= 4;
		if ((Role_if(PM_QUARTERBACK) && attacktype(&mons[first], AT_WEAP))) num -= 7;
		if ((Role_if(PM_QUARTERBACK) && dmgtype(&mons[first], AD_PAIN))) num -= 2;
		if ((Role_if(PM_PSYKER) && does_need_four(&mons[first]))) num -= 1;
		if ((Role_if(PM_PSYKER) && does_hit_as_four(&mons[first]))) num -= 1;
		if ((Role_if(PM_PSYKER) && passes_walls(&mons[first]))) num -= 2;
		if ((Role_if(PM_PSYKER) && strongmonst(&mons[first]))) num -= 3;
		if ((Role_if(PM_PSYKER) && extra_nasty(&mons[first]))) num -= 5;
		if ((Role_if(PM_PSYKER) && is_covetous(&mons[first]))) num -= 3;
		if ((Role_if(PM_PSYKER) && is_shade(&mons[first]))) num -= 2;
		if ((Role_if(PM_PSYKER) && (mons[first].msound == MS_SHRIEK))) num -= 1;
		if ((Role_if(PM_PSYKER) && attacktype(&mons[first], AT_MAGC))) num -= 3;
		if ((Role_if(PM_PSYKER) && dmgtype(&mons[first], AD_POLY))) num -= 1;
		if ((Role_if(PM_PSYKER) && dmgtype(&mons[first], AD_DREA))) num -= 2;
		if ((Role_if(PM_PSYKER) && dmgtype(&mons[first], AD_BADE))) num -= 2;
		if ((Role_if(PM_PSYKER) && dmgtype(&mons[first], AD_WISD))) num -= 2;
		if ((Role_if(PM_PSYKER) && dmgtype(&mons[first], AD_SIN))) num -= 2;
		if ((Role_if(PM_EMPATH) && (mons[first].mflags2 & M2_PEACEFUL) )) num -= 4;
		if ((Role_if(PM_EMPATH) && dmgtype(&mons[first], AD_HEAL))) num -= 2;
		if ((Role_if(PM_MASTERMIND) && dmgtype(&mons[first], AD_DRIN))) num -= 3;
		if ((Role_if(PM_MASTERMIND) && dmgtype(&mons[first], AD_NAST))) num -= 2;
		if ((Role_if(PM_MASTERMIND) && dmgtype(&mons[first], AD_MINA))) num -= 2;
		if ((Role_if(PM_MASTERMIND) && dmgtype(&mons[first], AD_RUNS))) num -= 2;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_SPC2) )) num -= 15;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_STUN) )) num -= 7;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_DRIN) )) num -= 5;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_HALU) )) num -= 8;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_DARK) )) num -= 5;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_FEAR) )) num -= 4;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_FAKE) )) num -= 7;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_LETH) )) num -= 2;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_CNCL) )) num -= 1;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_BLAS) )) num -= 1;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_BANI) )) num -= 2;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_WISD) )) num -= 3;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_HODS) )) num -= 3;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_CHRN) )) num -= 7;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_WEEP) )) num -= 2;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_STTP) )) num -= 1;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_DEPR) )) num -= 5;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_LAZY) )) num -= 5;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_INER) )) num -= 3;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_VULN) )) num -= 4;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_AMNE) )) num -= 10;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_INSA) )) num -= 10;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_SANI) )) num -= 10;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_TRAP) )) num -= 8;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_SHAN) )) num -= 8;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_TERR) )) num -= 10;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_FEMI) )) num -= 4;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_LEVI) )) num -= 7;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_MCRE) )) num -= 5;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_DEBU) )) num -= 5;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_UNPR) )) num -= 10;
		if ((Role_if(PM_WEIRDBOY) && dmgtype(&mons[first], AD_ILLU) )) num -= 20;
		if ((Role_if(PM_WEIRDBOY) && shapechanger(&mons[first]) )) num -= 5;
		if ((Role_if(PM_WEIRDBOY) && is_angbandmonster(&mons[first]) )) num -= 3;
		if ((Role_if(PM_WEIRDBOY) && is_animemonster(&mons[first]) )) num -= 1;
		if ((Role_if(PM_WEIRDBOY) && is_steammonster(&mons[first]) )) num -= 1;
		if ((Role_if(PM_ASTRONAUT) && is_flyer(&mons[first]))) num -= 5;
		if ((Role_if(PM_ASTRONAUT) && bigmonst(&mons[first]))) num -= 3;
		if ((Role_if(PM_ASTRONAUT) && hugemonst(&mons[first]))) num -= 4;
		if ((Role_if(PM_ASTRONAUT) && strongmonst(&mons[first]))) num -= 5;
		if ((Role_if(PM_CYBERNINJA) && (mons[first].mflags2 & M2_STALK))) num -= 4;
		if ((Role_if(PM_DISSIDENT) && is_lord(&mons[first]))) num -= 5;
		if ((Role_if(PM_DISSIDENT) && is_prince(&mons[first]))) num -= 15;
		if ((Role_if(PM_DISSIDENT) && type_is_pname(&mons[first]))) num -= 5;
		if ((Role_if(PM_XELNAGA) && is_death_resistant(&mons[first]))) num -= 3;
		if ((Role_if(PM_XELNAGA) && amorphous(&mons[first]))) num -= 2;
		if ((Role_if(PM_XELNAGA) && is_silent(&mons[first]))) num -= 2;
		if ((Role_if(PM_XELNAGA) && thick_skinned(&mons[first]))) num -= 2;
		if ((Role_if(PM_XELNAGA) && shapechanger(&mons[first]))) num -= 4;
		if ((Role_if(PM_XELNAGA) && your_race(&mons[first]))) num -= 4;
		if ((Role_if(PM_XELNAGA) && always_hostile(&mons[first]))) num -= 7;
		if ((Role_if(PM_XELNAGA) && extra_nasty(&mons[first]))) num -= 10;
		if ((Role_if(PM_XELNAGA) && strongmonst(&mons[first]))) num -= 5;
		if ((Role_if(PM_XELNAGA) && cannot_be_tamed(&mons[first]))) num -= 4;
		if ((Role_if(PM_XELNAGA) && is_mplayer(&mons[first]))) num -= 3;
		if ((Role_if(PM_XELNAGA) && is_umplayer(&mons[first]))) num -= 2;
		if ((Role_if(PM_XELNAGA) && slime_on_touch(&mons[first]))) num -= 2;
		if ((Role_if(PM_XELNAGA) && uncommon2(&mons[first]))) num -= 1;
		if ((Role_if(PM_XELNAGA) && uncommon3(&mons[first]))) num -= 2;
		if ((Role_if(PM_XELNAGA) && uncommon5(&mons[first]))) num -= 3;
		if ((Role_if(PM_XELNAGA) && uncommon7(&mons[first]))) num -= 4;
		if ((Role_if(PM_XELNAGA) && uncommon10(&mons[first]))) num -= 5;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[first], AD_DISN))) num -= 1;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[first], AD_LUCK))) num -= 2;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[first], AD_INER))) num -= 2;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[first], AD_NEXU))) num -= 2;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[first], AD_LETH))) num -= 1;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[first], AD_UVUU))) num -= 1;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[first], AD_IDAM))) num -= 1;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[first], AD_TRAI))) num -= 1;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[first], AD_SANI))) num -= 3;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[first], AD_SAMU))) num -= 3;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[first], AD_CHAO))) num -= 2;

		if (flags.friday13 && is_evilpatchmonster(&mons[first])) num -= 25;
		if (flags.friday13 && dmgtype(&mons[first], AD_STAT) ) num -= 2;
		if (flags.friday13 && dmgtype(&mons[first], AD_DAMA) ) num -= 2;
		if (flags.friday13 && dmgtype(&mons[first], AD_THIE) ) num -= 2;
		if (flags.friday13 && dmgtype(&mons[first], AD_DATA) ) num -= 1;
		if (flags.friday13 && dmgtype(&mons[first], AD_RAGN) ) num -= 20;
		if (flags.friday13 && dmgtype(&mons[first], AD_DEST) ) num -= 2;
		if (flags.elmstreet && is_evilpatchmonster(&mons[first])) num -= 25;
		if (flags.elmstreet && dmgtype(&mons[first], AD_STAT) ) num -= 2;
		if (flags.elmstreet && dmgtype(&mons[first], AD_DAMA) ) num -= 2;
		if (flags.elmstreet && dmgtype(&mons[first], AD_THIE) ) num -= 2;
		if (flags.elmstreet && dmgtype(&mons[first], AD_DATA) ) num -= 1;
		if (flags.elmstreet && dmgtype(&mons[first], AD_RAGN) ) num -= 20;
		if (flags.elmstreet && dmgtype(&mons[first], AD_DEST) ) num -= 2;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[first], AD_DATA) )) num -= 1;
		if ((isevilvariant && dmgtype(&mons[first], AD_DATA) )) num -= 20;
		if ((isevilvariant && is_evilpatchmonster(&mons[first]) )) num -= 100;
		if ((isevilvariant && dmgtype(&mons[first], AD_RAGN) )) num -= 20;
		if ((isevilvariant && dmgtype(&mons[first], AD_DEST) )) num -= 5;
		if ((Role_if(PM_HUSSY) && is_demon(&mons[first]) )) num -= 30;
		if ((Role_if(PM_HUSSY) && is_demon(&mons[first]) && (mons[first].geno & G_UNIQ) )) num -= 100;
		if ((Role_if(PM_COURIER) && dmgtype(&mons[first], AD_IDAM) )) num -= 1;
		if ((Role_if(PM_MURDERER) && dmgtype(&mons[first], AD_STAT) )) num -= 2;
		if ((Role_if(PM_NUCLEAR_PHYSICIST) && dmgtype(&mons[first], AD_PAIN) )) num -= 1;
		if ((uarmf && itemhasappearance(uarmf, APP_PRINCESS_PUMPS) && attacktype(&mons[first], AT_SCRA) )) num -= 2;
		if ((uarmf && itemhasappearance(uarmf, APP_PRINCESS_PUMPS) && attacktype(&mons[first], AT_LASH) )) num -= 2;
		if ((uarmf && itemhasappearance(uarmf, APP_PRINCESS_PUMPS) && attacktype(&mons[first], AT_STNG) )) num -= 2;
		if (uarmh && itemhasappearance(uarmh, APP_GRUNTER_HELMET) && dmgtype(&mons[first], AD_DISE) ) num -= 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_IDAM) )) num -= 2;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_ANTI) )) num -= 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_TECH) )) num -= 2;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_MEMO) )) num -= 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_TRAI) )) num -= 10;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_STAT) )) num -= 10;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_DAMA) )) num -= 5;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_THIE) )) num -= 5;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[first], AD_IDAM) )) num -= 2;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[first], AD_STAT) )) num -= 3;
		if ((Race_if(PM_AK_THIEF_IS_DEAD_) && dmgtype(&mons[first], AD_DAMA) )) num -= 2;
		if ((Race_if(PM_AK_THIEF_IS_DEAD_) && dmgtype(&mons[first], AD_THIE) )) num -= 2;
		if ((Race_if(PM_ALBAE) && dmgtype(&mons[first], AD_ANTI) )) num -= 1;
		if ((Race_if(PM_ALBAE) && dmgtype(&mons[first], AD_STAT) )) num -= 3;
		if ((Race_if(PM_ALCHEMIST) && dmgtype(&mons[first], AD_IDAM) )) num -= 2;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[first], AD_PAIN) )) num -= 3;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[first], AD_MEMO) )) num -= 10;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[first], AD_TRAI) )) num -= 5;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[first], AD_STAT) )) num -= 2;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[first], AD_DAMA) )) num -= 1;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[first], AD_THIE) )) num -= 2;
		if ((Race_if(PM_DEATHMOLD) && dmgtype(&mons[first], AD_ANTI) )) num -= 1;
		if ((Race_if(PM_DOPPELGANGER) && dmgtype(&mons[first], AD_TRAI) )) num -= 2;
		if ((isevilvariant && dmgtype(&mons[first], AD_STAT) )) num -= 5;
		if ((isevilvariant && dmgtype(&mons[first], AD_DAMA) )) num -= 3;
		if ((isevilvariant && dmgtype(&mons[first], AD_THIE) )) num -= 3;
		if ((Race_if(PM_HERBALIST) && dmgtype(&mons[first], AD_MEMO) )) num -= 5;
		if ((Race_if(PM_HERBALIST) && dmgtype(&mons[first], AD_TRAI) )) num -= 3;
		if ((Race_if(PM_PEACEMAKER) && dmgtype(&mons[first], AD_DAMA) )) num -= 4;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[first], AD_ANTI) )) num -= 2;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[first], AD_MEMO) )) num -= 5;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[first], AD_STAT) )) num -= 4;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[first], AD_DAMA) )) num -= 3;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[first], AD_THIE) )) num -= 7;
		if ((Race_if(PM_SPIRIT) && dmgtype(&mons[first], AD_MEMO) )) num -= 6;
		if ((Race_if(PM_SPIRIT) && dmgtype(&mons[first], AD_TRAI) )) num -= 3;
		if ((Race_if(PM_SPIRIT) && dmgtype(&mons[first], AD_THIE) )) num -= 3;
		if ((Race_if(PM_WEAPON_XORN) && dmgtype(&mons[first], AD_IDAM) )) num -= 4;
		if ((Race_if(PM_WEAPON_XORN) && dmgtype(&mons[first], AD_ANTI) )) num -= 3;
		if ((Race_if(PM_WEAPON_XORN) && dmgtype(&mons[first], AD_TECH) )) num -= 1;
		if ((Race_if(PM_WEAPON_XORN) && dmgtype(&mons[first], AD_DAMA) )) num -= 2;

		if ((Role_if(PM_ALTMER) && dmgtype(&mons[first], AD_RBAD) )) num -= 1;
		if ((Role_if(PM_ANACHRONIST) && dmgtype(&mons[first], AD_TERR) )) num -= 1;
		if ((Role_if(PM_ANACHRONOUNBINDER) && dmgtype(&mons[first], AD_ILLU) )) num -= 2;
		if ((Role_if(PM_ASTRONAUT) && dmgtype(&mons[first], AD_LEVI) )) num -= 1;
		if ((Role_if(PM_BLEEDER) && dmgtype(&mons[first], AD_BLEE) )) num -= 5;
		if ((Role_if(PM_CELLAR_CHILD) && dmgtype(&mons[first], AD_RBAD) )) num -= 2;
		if ((Role_if(PM_CHAOS_SORCEROR) && dmgtype(&mons[first], AD_TERR) )) num -= 1;
		if ((Role_if(PM_CRACKER) && dmgtype(&mons[first], AD_SHAN) )) num -= 2;
		if ((Role_if(PM_CRUEL_ABUSER) && dmgtype(&mons[first], AD_FEMI) )) num -= 3;
		if ((Role_if(PM_GAMER) && dmgtype(&mons[first], AD_SCOR) )) num -= 3;
		if ((Role_if(PM_GOFF) && dmgtype(&mons[first], AD_ILLU) )) num -= 2;
		if ((Role_if(PM_GOFF) && dmgtype(&mons[first], AD_BLEE) )) num -= 3;
		if ((Role_if(PM_GRENADONIN) && dmgtype(&mons[first], AD_RBAD) )) num -= 1;
		if ((isevilvariant && dmgtype(&mons[first], AD_NACU) )) num -= 10;
		if ((Role_if(PM_LUNATIC) && dmgtype(&mons[first], AD_ILLU) )) num -= 2;
		if ((Role_if(PM_MAHOU_SHOUJO) && dmgtype(&mons[first], AD_SHAN) )) num -= 2;
		if ((Role_if(PM_MEDIUM) && dmgtype(&mons[first], AD_LEVI) )) num -= 1;
		if ((Role_if(PM_OCCULT_MASTER) && dmgtype(&mons[first], AD_ILLU) )) num -= 2;
		if ((Role_if(PM_POLITICIAN) && dmgtype(&mons[first], AD_FEMI) )) num -= 3;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_RBAD) )) num -= 1;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_ILLU) )) num -= 3;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_SHAN) )) num -= 1;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_LEVI) )) num -= 1;
		if ((Role_if(PM_ROCKER) && dmgtype(&mons[first], AD_TERR) )) num -= 2;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[first], AD_RBAD) )) num -= 4;
		if ((Role_if(PM_SOCIAL_JUSTICE_WARRIOR) && dmgtype(&mons[first], AD_BLEE) )) num -= 3;
		if ((Role_if(PM_TRANSSYLVANIAN) && dmgtype(&mons[first], AD_FEMI) )) num -= 4;
		if ((Role_if(PM_TRANSVESTITE) && dmgtype(&mons[first], AD_FEMI) )) num -= 4;
		if ((Role_if(PM_STAND_USER) && dmgtype(&mons[first], AD_TERR) )) num -= 3;
		if ((Role_if(PM_STAND_USER) && dmgtype(&mons[first], AD_LEVI) )) num -= 1;
		if ((Role_if(PM_WALSCHOLAR) && dmgtype(&mons[first], AD_FEMI) )) num -= 6;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[first], AD_ILLU) )) num -= 3;
		if ((Role_if(PM_XELNAGA) && dmgtype(&mons[first], AD_FEMI) )) num -= 1;
		if ((Role_if(PM_YAUTJA) && dmgtype(&mons[first], AD_SHAN) )) num -= 3;
		if ((Race_if(PM_ALBAE) && dmgtype(&mons[first], AD_RBAD) )) num -= 1;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[first], AD_LEVI) )) num -= 5;
		if ((Race_if(PM_ASURA) && is_elonamonster(&mons[first]) )) num -= 1;
		if ((Race_if(PM_PLAYER_FAIRY) && is_elonamonster(&mons[first]) )) num -= 3;
		if ((Race_if(PM_BASTARD) && dmgtype(&mons[first], AD_SHAN) )) num -= 1;
		if ((Race_if(PM_BATMAN) && dmgtype(&mons[first], AD_FEMI) )) num -= 2;
		if ((Race_if(PM_BATMAN) && dmgtype(&mons[first], AD_TERR) )) num -= 1;
		if ((Race_if(PM_BORG) && dmgtype(&mons[first], AD_ILLU) )) num -= 2;
		if ((Race_if(PM_BURNINATOR) && dmgtype(&mons[first], AD_BLEE) )) num -= 2;
		if ((Race_if(PM_DOPPELGANGER) && dmgtype(&mons[first], AD_RBAD) )) num -= 1;
		if ((Race_if(PM_HERBALIST) && dmgtype(&mons[first], AD_BLEE) )) num -= 5;
		if ((Race_if(PM_PLAYER_JABBERWOCK) && dmgtype(&mons[first], AD_RBAD) )) num -= 2;
		if ((Race_if(PM_LOLI) && dmgtype(&mons[first], AD_FEMI) )) num -= 5;
		if ((Race_if(PM_METAL) && is_elonamonster(&mons[first]) )) num -= 20;
		if ((Race_if(PM_PLAYER_MIMIC) && dmgtype(&mons[first], AD_ILLU) )) num -= 4;
		if ((Race_if(PM_PLAYER_MUSHROOM) && is_elonamonster(&mons[first]) )) num -= 5;
		if ((Race_if(PM_PEACEMAKER) && dmgtype(&mons[first], AD_SHAN) )) num -= 3;
		if ((Race_if(PM_RODNEYAN) && dmgtype(&mons[first], AD_ILLU) )) num -= 3;
		if ((Race_if(PM_SCURRIER) && dmgtype(&mons[first], AD_SHAN) )) num -= 2;
		if ((Race_if(PM_SHELL) && is_elonamonster(&mons[first]) )) num -= 8;
		if ((Race_if(PM_SPIRIT) && dmgtype(&mons[first], AD_LEVI) )) num -= 2;

		if ((Race_if(PM_INHERITOR) && is_dnethackmonster(&mons[first]) )) num -= 10;
		if ((Race_if(PM_PLAYER_MYRKALFR) && is_dnethackmonster(&mons[first]))) num -= 10;
		if ((Race_if(PM_PLAYER_MYRKALFR) && attacktype(&mons[first], AT_MAGC))) num -= 5;
		if ((Race_if(PM_PLAYER_ANDROID) && is_dnethackmonster(&mons[first]))) num -= 15;
		if ((Race_if(PM_PLAYER_ANDROID) && dmgtype(&mons[first], AD_TERR) )) num -= 1;
		if ((Race_if(PM_PLAYER_ANDROID) && (mons[first].geno & G_NOCORPSE) )) num -= 5;
		if ((Race_if(PM_RETICULAN) && is_evilpatchmonster(&mons[first]))) num -= 7;
		if ((Race_if(PM_RETICULAN) && dmgtype(&mons[first], AD_DRIN))) num -= 2;
		if ((Race_if(PM_RETICULAN) && dmgtype(&mons[first], AD_NAST))) num -= 1;
		if ((Race_if(PM_RETICULAN) && dmgtype(&mons[first], AD_MINA))) num -= 1;
		if ((Race_if(PM_RETICULAN) && dmgtype(&mons[first], AD_RUNS))) num -= 1;
		if ((Race_if(PM_RETICULAN) && dmgtype(&mons[first], AD_INSA))) num -= 4;
		if ((Race_if(PM_RETICULAN) && dmgtype(&mons[first], AD_SANI))) num -= 6;
		if ((Race_if(PM_OUTSIDER) && is_evilpatchmonster(&mons[first]))) num -= 5;
		if ((Race_if(PM_OUTSIDER) && is_death_resistant(&mons[first]))) num -= 1;
		if ((Race_if(PM_OUTSIDER) && amorphous(&mons[first]))) num -= 1;
		if ((Race_if(PM_OUTSIDER) && thick_skinned(&mons[first]))) num -= 1;
		if ((Race_if(PM_OUTSIDER) && shapechanger(&mons[first]))) num -= 2;
		if ((Race_if(PM_OUTSIDER) && always_hostile(&mons[first]))) num -= 4;
		if ((Race_if(PM_OUTSIDER) && extra_nasty(&mons[first]))) num -= 5;
		if ((Race_if(PM_OUTSIDER) && strongmonst(&mons[first]))) num -= 3;
		if ((Race_if(PM_OUTSIDER) && cannot_be_tamed(&mons[first]))) num -= 3;
		if ((Race_if(PM_OUTSIDER) && is_mplayer(&mons[first]))) num -= 1;
		if ((Race_if(PM_OUTSIDER) && is_umplayer(&mons[first]))) num -= 1;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[first], AD_DISN))) num -= 1;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[first], AD_LUCK))) num -= 2;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[first], AD_INER))) num -= 2;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[first], AD_NEXU))) num -= 2;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[first], AD_LETH))) num -= 1;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[first], AD_UVUU))) num -= 1;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[first], AD_IDAM))) num -= 1;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[first], AD_TRAI))) num -= 1;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[first], AD_SANI))) num -= 2;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[first], AD_SAMU))) num -= 2;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[first], AD_CHAO))) num -= 2;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[first], AD_ILLU) )) num -= 2;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[first], AD_FEMI) )) num -= 1;
		if ((Race_if(PM_PLAYER_DYNAMO) && (mons[first].msound == MS_ARREST) )) num -= 5;
		if ((Race_if(PM_NEMESIS) && always_hostile(&mons[first]) )) num -= 10;
		if ((Race_if(PM_UNMAGIC_FISH) && dmgtype(&mons[first], AD_MCRE) )) num -= 3;
		if ((Race_if(PM_RETICULAN) && dmgtype(&mons[first], AD_MCRE) )) num -= 5;
		if ((Race_if(PM_OUTSIDER) && dmgtype(&mons[first], AD_MCRE) )) num -= 2;
		if ((Race_if(PM_PLAYER_MYRKALFR) && dmgtype(&mons[first], AD_MCRE) )) num -= 1;
		if ((Race_if(PM_PLAYER_DYNAMO) && dmgtype(&mons[first], AD_MCRE) )) num -= 3;
		if ((Race_if(PM_CLOCKWORK_AUTOMATON) && dmgtype(&mons[first], AD_MCRE) )) num -= 1;
		if ((Role_if(PM_ALTMER) && dmgtype(&mons[first], AD_MCRE) )) num -= 1;
		if ((Role_if(PM_CELLAR_CHILD) && dmgtype(&mons[first], AD_MCRE) )) num -= 2;
		if ((Role_if(PM_MAHOU_SHOUJO) && dmgtype(&mons[first], AD_MCRE) )) num -= 1;
		if ((Role_if(PM_PSION) && dmgtype(&mons[first], AD_MCRE) )) num -= 2;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[first], AD_MCRE) )) num -= 4;
		if ((Role_if(PM_TRACER) && dmgtype(&mons[first], AD_MCRE) )) num -= 1;
		if ((Role_if(PM_UNBELIEVER) && dmgtype(&mons[first], AD_MCRE) )) num -= 5;
		if ((Race_if(PM_CUPID) && is_elonamonster(&mons[first]) )) num -= 2;
		if ((Race_if(PM_BACTERIA) && is_elonamonster(&mons[first]) )) num -= 10;
		if ((Race_if(PM_PIECE) && is_elonamonster(&mons[first]) )) num -= 5;
		if ((Race_if(PM_PLAYER_SHEEP) && is_elonamonster(&mons[first]) )) num -= 1;
		if ((Race_if(PM_PLAYER_HOUND) && is_elonamonster(&mons[first]) )) num -= 3;
		if ((Race_if(PM_PLAYER_CERBERUS) && is_elonamonster(&mons[first]) )) num -= 5;
		if ((Race_if(PM_BOVER) && dmgtype(&mons[first], AD_DISE) )) num -= 5;
		if ((Race_if(PM_BOVER) && dmgtype(&mons[first], AD_POIS) )) num -= 5;

		if ((Role_if(PM_DRAGONMASTER) && attacktype(&mons[first], AT_BREA) )) num -= 2;
		if ((Role_if(PM_FJORDE) && amphibious(&mons[first]) )) num -= 5;
		if ((Role_if(PM_PRACTICANT) && is_lord(&mons[first]) )) num -= 4;
		if ((Role_if(PM_PRACTICANT) && is_prince(&mons[first]) )) num -= 12;
		if ((Role_if(PM_PRACTICANT) && attacktype(&mons[first], AT_LASH) )) num -= 2;
		if ((Role_if(PM_PRACTICANT) && dmgtype(&mons[first], AD_DEPR) )) num -= 4;
		if ((Role_if(PM_PRACTICANT) && dmgtype(&mons[first], AD_WRAT) )) num -= 10;
		if ((Role_if(PM_PRACTICANT) && dmgtype(&mons[first], AD_DFOO) )) num -= 5;
		if ((Role_if(PM_PRACTICANT) && dmgtype(&mons[first], AD_SLUD) )) num -= 1;
		if ((Role_if(PM_PRACTICANT) && dmgtype(&mons[first], AD_DEST) )) num -= 1;
		if ((Role_if(PM_PRACTICANT) && dmgtype(&mons[first], AD_PAIN) )) num -= 5;
		if ((Role_if(PM_PRACTICANT) && always_hostile(&mons[first]) )) num -= 3;
		if ((Role_if(PM_EMERA) && is_female(&mons[first]) )) num -= 2;
		if ((Role_if(PM_EMERA) && (mons[first].msound == MS_STENCH))) num -= 10;
		if ((Role_if(PM_EMERA) && (mons[first].msound == MS_SHOE))) num -= 10;
		if ((Role_if(PM_EMERA) && (mons[first].msound == MS_FART_NORMAL))) num -= 10;
		if ((Role_if(PM_EMERA) && (mons[first].msound == MS_FART_LOUD))) num -= 10;
		if ((Role_if(PM_EMERA) && (mons[first].msound == MS_FART_QUIET))) num -= 10;
		if ((Role_if(PM_EMERA) && always_hostile(&mons[first]) )) num -= 1;
		if ((Role_if(PM_MILL_SWALLOWER) && always_peaceful(&mons[first]) )) num -= 3;
		if ((Role_if(PM_MILL_SWALLOWER) && is_nonmoving(&mons[first]) )) num -= 4;
		if ((Role_if(PM_MILL_SWALLOWER) && nocorpsedecay(&mons[first]) )) num -= 2;
		if ((Role_if(PM_SYMBIANT) && is_angbandmonster(&mons[first]) )) num -= 5;
		if ((Role_if(PM_SYMBIANT) && is_animemonster(&mons[first]) )) num -= 2;
		if ((Role_if(PM_SYMBIANT) && is_steammonster(&mons[first]) )) num -= 2;
		if ((Role_if(PM_GENDERSTARIST) && is_neuter(&mons[first]) )) num -= 10;
		if ((Role_if(PM_GENDERSTARIST) && dmgtype(&mons[first], AD_SSEX) )) num -= 3;
		if ((Role_if(PM_GENDERSTARIST) && (mons[first].msound == MS_CUSS))) num -= 5;
		if ((Race_if(PM_GOAULD) && is_dnethackmonster(&mons[first]))) num -= 10;
		if ((Role_if(PM_CELLAR_CHILD) && dmgtype(&mons[first], AD_DEBU) )) num -= 5;
		if ((Role_if(PM_GENDERSTARIST) && dmgtype(&mons[first], AD_DEBU) )) num -= 5;
		if ((Role_if(PM_ICE_MAGE) && dmgtype(&mons[first], AD_FLAM) )) num -= 1;
		if ((Role_if(PM_PRACTICANT) && dmgtype(&mons[first], AD_DEBU) )) num -= 3;
		if ((Role_if(PM_SOCIAL_JUSTICE_WARRIOR) && dmgtype(&mons[first], AD_DEBU) )) num -= 5;
		if ((Race_if(PM_LOWER_ENT) && dmgtype(&mons[first], AD_FLAM) )) num -= 2;
		if ((Race_if(PM_LOLI) && dmgtype(&mons[first], AD_DEBU) )) num -= 2;
		if ((Race_if(PM_SEA_ELF) && dmgtype(&mons[first], AD_FLAM) )) num -= 4;
		if ((Race_if(PM_SPRIGGAN) && dmgtype(&mons[first], AD_FLAM) )) num -= 2;
		if ((Role_if(PM_ALTMER) && dmgtype(&mons[first], AD_NIVE) )) num -= 2;
		if ((Role_if(PM_CELLAR_CHILD) && dmgtype(&mons[first], AD_UNPR) )) num -= 1;
		if ((Role_if(PM_FJORDE) && dmgtype(&mons[first], AD_UNPR) )) num -= 3;
		if ((Role_if(PM_MYSTIC) && dmgtype(&mons[first], AD_NIVE) )) num -= 10;
		if ((Role_if(PM_SOCIAL_JUSTICE_WARRIOR) && dmgtype(&mons[first], AD_UNPR) )) num -= 3;
		if ((iserosator && dmgtype(&mons[first], AD_UNPR) )) num -= 10;
		if ((Race_if(PM_INCANTIFIER) && dmgtype(&mons[first], AD_NIVE) )) num -= 1;
		if ((Race_if(PM_MONGUNG) && dmgtype(&mons[first], AD_NIVE) )) num -= 2;
		if ((isfeminizer && dmgtype(&mons[first], AD_FEMI) )) num -= 10;
		if ((Race_if(PM_IRAHA) && (mons[first].maligntyp > 0) )) num -= 10;
		if ((Race_if(PM_PLAYER_NIBELUNG) && is_angbandmonster(&mons[first]) )) num -= 5;
		if ((Race_if(PM_KLACKON) && humanoid(&mons[first]) )) num -= 3;
		if ((Race_if(PM_KLACKON) && is_angbandmonster(&mons[first]) )) num -= 4;
		if ((Race_if(PM_KLACKON) && is_animemonster(&mons[first]) )) num -= 2;
		if ((Race_if(PM_KUTAR) && is_angbandmonster(&mons[first]) )) num -= 3;
		if ((Race_if(PM_KUTAR) && is_animemonster(&mons[first]) )) num -= 7;
		if ((Race_if(PM_KUTAR) && is_steammonster(&mons[first]) )) num -= 3;
		if ((Race_if(PM_TONBERRY) && is_angbandmonster(&mons[first]) )) num -= 10;
		if ((Race_if(PM_TONBERRY) && is_animemonster(&mons[first]) )) num -= 10;
		if ((Race_if(PM_TONBERRY) && is_steammonster(&mons[first]) )) num -= 10;
		if ((Race_if(PM_TONBERRY) && is_jokemonster(&mons[first]) )) num -= 2;
		if ((Race_if(PM_PLAYER_GLORKUM) && is_randomizedmonster(&mons[first]) )) num -= 50;
		if ((Race_if(PM_RACE_THAT_DOESN_T_EXIST) && always_peaceful(&mons[first]) )) num -= 10;
		if ((Race_if(PM_HYBRIDRAGON) && is_dnethackmonster(&mons[first]) )) num -= 12;
		if ((ischallenger && (mons[first].msound == MS_STENCH) )) num -= ((mons[first].geno & G_FREQ) * 4);
		if ((ischallenger && (mons[first].msound == MS_WHORE) )) num -= ((mons[first].geno & G_FREQ) * 4);
		if ((ischallenger && (mons[first].msound == MS_FART_QUIET) )) num -= ((mons[first].geno & G_FREQ) * 4);
		if ((ischallenger && (mons[first].msound == MS_FART_LOUD) )) num -= ((mons[first].geno & G_FREQ) * 4);
		if ((ischallenger && (mons[first].msound == MS_FART_NORMAL) )) num -= ((mons[first].geno & G_FREQ) * 4);
		if ((ischallenger && (mons[first].msound == MS_SHOE) )) num -= ((mons[first].geno & G_FREQ) * 4);
		if ((ischallenger && (mons[first].msound == MS_SOCKS) )) num -= ((mons[first].geno & G_FREQ) * 4);
		if ((ischallenger && (mons[first].msound == MS_PANTS) )) num -= ((mons[first].geno & G_FREQ) * 4);
		if ((ischallenger && (mons[first].msound == MS_CONVERT) )) num -= ((mons[first].geno & G_FREQ) * 4);
		if ((ischallenger && (mons[first].msound == MS_HCALIEN) )) num -= ((mons[first].geno & G_FREQ) * 4);
		if ((uarmf && uarmf->oartifact == ART_STRONG_GETAWAY_DESIRE && dmgtype(&mons[first], AD_WEEP) )) num -= 20;
		if ((Role_if(PM_ANACHRONIST) && dmgtype(&mons[first], AD_TDRA) )) num -= 3;
		if ((Role_if(PM_SHAPESHIFTER) && dmgtype(&mons[first], AD_BLAS) )) num -= 5;
		if ((Race_if(PM_HUMANOID_ANGEL) && dmgtype(&mons[first], AD_BLAS) )) num -= 1;
		if ((Race_if(PM_HUMANOID_DEVIL) && dmgtype(&mons[first], AD_BLAS) )) num -= 2;
		if ((Race_if(PM_DEVELOPER) && dmgtype(&mons[first], AD_BLAS) )) num -= 2;
		if ((Race_if(PM_PLAYER_DYNAMO) && dmgtype(&mons[first], AD_TDRA) )) num -= 1;
		if ((Race_if(PM_GAVIL) && dmgtype(&mons[first], AD_BLAS) )) num -= 1;
		if ((Race_if(PM_HC_ALIEN) && dmgtype(&mons[first], AD_BLAS) )) num -= 1;
		if ((isheretic && dmgtype(&mons[first], AD_BLAS) )) num -= 3;
		if ((Race_if(PM_IMPERIAL) && dmgtype(&mons[first], AD_BLAS) )) num -= 5;
		if ((Race_if(PM_SINNER) && dmgtype(&mons[first], AD_BLAS) )) num -= 1;
		if ((Race_if(PM_SPIRIT) && dmgtype(&mons[first], AD_TDRA) )) num -= 3;
		if ((Role_if(PM_BUTT_LOVER) && (mons[first].msound == MS_FART_NORMAL) )) num -= 50;
		if ((Role_if(PM_BUTT_LOVER) && (mons[first].msound == MS_FART_LOUD) )) num -= 50;
		if ((Role_if(PM_BUTT_LOVER) && (mons[first].msound == MS_FART_QUIET) )) num -= 50;
		if ((Role_if(PM_DIABLIST) && is_diablomonster(&mons[first]))) num -= 20;
		if ((Role_if(PM_PREVERSIONER) && is_cowmonster(&mons[first]) )) num -= 50;
		if ((Role_if(PM_PREVERSIONER) && is_jokemonster(&mons[first]) )) num -= 5;
		if ((Role_if(PM_SHOE_FETISHIST) && (mons[first].msound == MS_SHOE) )) num -= 100;
		if ((FemtrapActiveJohanna && (mons[first].msound == MS_SHOE) )) num -= 100;
		if ((Role_if(PM_SECRET_ADVICE_MEMBER) && (mons[first].msound == MS_ARREST) )) num -= 4;
		if ((Role_if(PM_SECRET_ADVICE_MEMBER) && (mons[first].msound == MS_SOLDIER) )) num -= 2;
		if ((Role_if(PM_SECRET_ADVICE_MEMBER) && strongmonst(&mons[first]) )) num -= 2;
		if ((Role_if(PM_SECRET_ADVICE_MEMBER) && extra_nasty(&mons[first]) )) num -= 3;
		if ((Role_if(PM_SECRET_ADVICE_MEMBER) && dmgtype(&mons[first], AD_TDRA) )) num -= 5;
		if ((Role_if(PM_SECRET_ADVICE_MEMBER) && dmgtype(&mons[first], AD_TECH) )) num -= 5;
		if ((Role_if(PM_SECRET_ADVICE_MEMBER) && is_cowmonster(&mons[first]) )) num -= 5;
		if ((Role_if(PM_SECRET_ADVICE_MEMBER) && is_jokemonster(&mons[first]) )) num -= 2;
		if ((PlayerInConeHeels && (P_MAX_SKILL(P_HIGH_HEELS) == P_ISRESTRICTED) && dmgtype(&mons[first], AD_DROP) )) num -= 5;
		if ((Role_if(PM_BARD) && dmgtype(&mons[first], AD_DROP) )) num -= 1;
		if ((Role_if(PM_BUTT_LOVER) && dmgtype(&mons[first], AD_DROP) )) num -= 10;
		if ((Role_if(PM_CONVICT) && dmgtype(&mons[first], AD_DROP) )) num -= 1;
		if ((Role_if(PM_MURDERER) && dmgtype(&mons[first], AD_DROP) )) num -= 1;
		if ((Role_if(PM_DOLL_MISTRESS) && dmgtype(&mons[first], AD_DROP) )) num -= 2;
		if ((Role_if(PM_DRUNK) && dmgtype(&mons[first], AD_DROP) )) num -= 3;
		if ((Role_if(PM_GENDERSTARIST) && dmgtype(&mons[first], AD_DROP) )) num -= 2;
		if ((Role_if(PM_JESTER) && dmgtype(&mons[first], AD_DROP) )) num -= 5;
		if ((Role_if(PM_POLITICIAN) && dmgtype(&mons[first], AD_DROP) )) num -= 2;
		if ((Role_if(PM_PRACTICANT) && dmgtype(&mons[first], AD_DROP) )) num -= 1;
		if ((Race_if(PM_ALCHEMIST) && dmgtype(&mons[first], AD_DROP) )) num -= 2;
		if ((Race_if(PM_DUFFLEPUD) && dmgtype(&mons[first], AD_DROP) )) num -= 2;
		if ((Race_if(PM_PERVERT) && dmgtype(&mons[first], AD_DROP) )) num -= 2;
		if ((Race_if(PM_TUMBLRER) && dmgtype(&mons[first], AD_DROP) )) num -= 10;
		if ((Race_if(PM_WOOKIE) && dmgtype(&mons[first], AD_DROP) )) num -= 2;
		if ((Race_if(PM_CLIMACTERIAL) && dmgtype(&mons[first], AD_FEMI) )) num -= 50;
		if ((Role_if(PM_WOMANIZER) && is_female(&mons[first]) )) num -= 1;
		if ((uwep && uwep->oartifact == ART_SLEXCALIBUR && !is_dlordsmonster(&mons[first]) && !is_dnethackmonster(&mons[first]) && !is_jokemonster(&mons[first]) && !is_diablomonster(&mons[first]) && !is_jonadabmonster(&mons[first]) && !is_evilpatchmonster(&mons[first]) && !is_randomizedmonster(&mons[first]) && !is_elonamonster(&mons[first]) && !is_aoemonster(&mons[first]) && !is_elderscrollsmonster(&mons[first]) )) num -= 5;
		if ((u.twoweap && uswapwep && uswapwep->oartifact == ART_SLEXCALIBUR && !is_dlordsmonster(&mons[first]) && !is_dnethackmonster(&mons[first]) && !is_jokemonster(&mons[first]) && !is_diablomonster(&mons[first]) && !is_jonadabmonster(&mons[first]) && !is_evilpatchmonster(&mons[first]) && !is_randomizedmonster(&mons[first]) && !is_elonamonster(&mons[first]) && !is_aoemonster(&mons[first]) && !is_elderscrollsmonster(&mons[first]) )) num -= 5;

		if ((Role_if(PM_ACID_MAGE) && (mons[first].msound == MS_DRUGS) )) num -= 1;
		if ((Role_if(PM_ANACHRONIST) && (mons[first].msound == MS_BOT) )) num -= 7;
		if ((Role_if(PM_ANACHRONOUNBINDER) && (mons[first].msound == MS_GLYPHS) )) num -= 1;
		if ((Role_if(PM_BOSMER) && monsterflees(&mons[first]))) num -= 2;
		if ((Role_if(PM_BULLY) && (mons[first].msound == MS_BRAG) )) num -= 1;
		if ((Role_if(PM_BULLY) && (mons[first].msound == MS_SISSY) )) num -= 2;
		if ((Role_if(PM_CARTOMANCER) && (mons[first].msound == MS_CASINO) )) num -= 3;
		if ((Role_if(PM_COMBATANT) && (mons[first].msound == MS_COMBAT) )) num -= 5;
		if ((Role_if(PM_COURIER) && (mons[first].msound == MS_GIBBERISH) )) num -= 2;
		if ((Role_if(PM_CRACKER) && (mons[first].msound == MS_BOT) )) num -= 2;
		if ((Role_if(PM_CRUEL_ABUSER) && (mons[first].msound == MS_SISSY) )) num -= 5;
		if ((Role_if(PM_CYBERNINJA) && (mons[first].msound == MS_JAPANESE) )) num -= 1;
		if ((Role_if(PM_DANCER) && (mons[first].msound == MS_SING) )) num -= 1;
		if ((Role_if(PM_DANCER) && (mons[first].msound == MS_PRINCESSLEIA) )) num -= 1;
		if ((Role_if(PM_DEMAGOGUE) && (mons[first].msound == MS_CORONA) )) num -= 5;
		if ((Role_if(PM_DOLL_MISTRESS) && (mons[first].msound == MS_POKEDEX) )) num -= 2;
		if ((Role_if(PM_DOOM_MARINE) && (mons[first].msound == MS_BOT) )) num -= 1;
		if ((Role_if(PM_DQ_SLIME) && (mons[first].msound == MS_COMBAT) )) num -= 1;
		if ((Role_if(PM_DRUNK) && (mons[first].msound == MS_DRUGS) )) num -= 10;
		if ((Role_if(PM_EMERA) && (mons[first].msound == MS_SING) )) num -= 1;
		if ((Role_if(PM_EMERA) && (mons[first].msound == MS_SOCKS) )) num -= 3;
		if ((Role_if(PM_EMERA) && (mons[first].msound == MS_PANTS) )) num -= 3;
		if ((Role_if(PM_EMPATH) && (mons[first].msound == MS_PAIN) )) num -= 3;
		if ((Role_if(PM_FEAT_MASTER) && (mons[first].msound == MS_PHOTO) )) num -= 5;
		if ((Role_if(PM_FENCER) && (mons[first].msound == MS_COMBAT) )) num -= 1;
		if ((Role_if(PM_FIGHTER) && (mons[first].msound == MS_COMBAT) )) num -= 2;
		if ((Role_if(PM_FIREFIGHTER) && (mons[first].msound == MS_CAR) )) num -= 1;
		if ((Role_if(PM_GANGSTER) && (mons[first].msound == MS_CASINO) )) num -= 3;
		if ((Role_if(PM_GEEK) && (mons[first].msound == MS_BOT) )) num -= 1;
		if ((Role_if(PM_GRENADONIN) && (mons[first].msound == MS_JAPANESE) )) num -= 5;
		if ((Role_if(PM_SAMURAI) && (mons[first].msound == MS_JAPANESE) )) num -= 1;
		if ((Role_if(PM_HEALER) && (mons[first].msound == MS_PAIN) )) num -= 1;
		if ((Role_if(PM_HUSSY) && (mons[first].msound == MS_SISSY) )) num -= 4;
		if ((Role_if(PM_JEDI) && (mons[first].msound == MS_PRINCESSLEIA) )) num -= 10;
		if ((Role_if(PM_SHADOW_JEDI) && (mons[first].msound == MS_PRINCESSLEIA) )) num -= 5;
		if ((Role_if(PM_HEDDERJEDI) && (mons[first].msound == MS_PRINCESSLEIA) )) num -= 20;
		if ((Role_if(PM_JESTER) && (mons[first].msound == MS_SING) )) num -= 3;
		if ((Role_if(PM_JUSTICE_KEEPER) && (mons[first].msound == MS_APOC) )) num -= 1;
		if ((Role_if(PM_LADIESMAN) && (mons[first].msound == MS_PHOTO) )) num -= 10;
		if ((Role_if(PM_MAHOU_SHOUJO) && (mons[first].msound == MS_JAPANESE) )) num -= 2;
		if ((Role_if(PM_MAHOU_SHOUJO) && (mons[first].msound == MS_BRAG) )) num -= 1;
		if ((Role_if(PM_NINJA) && (mons[first].msound == MS_JAPANESE) )) num -= 2;
		if ((Role_if(PM_NOBLEMAN) && (mons[first].msound == MS_PRINCESSLEIA) )) num -= 2;
		if ((Role_if(PM_OTAKU) && (mons[first].msound == MS_JAPANESE) )) num -= 10;
		if ((Role_if(PM_PICKPOCKET) && (mons[first].msound == MS_SISSY) )) num -= 1;
		if ((Role_if(PM_POKEMON) && (mons[first].msound == MS_POKEDEX) )) num -= 2;
		if ((Role_if(PM_POLITICIAN) && (mons[first].msound == MS_APOC) )) num -= 4;
		if ((Role_if(PM_PSION) && (mons[first].msound == MS_ALLA) )) num -= 8;
		if ((Role_if(PM_RANGER) && monsterrandomwalk(&mons[first]))) num -= 5;
		if ((Role_if(PM_RANGER) && monsterflees(&mons[first]))) num -= 1;
		if ((Role_if(PM_ROCKER) && (mons[first].msound == MS_CAR) )) num -= 3;
		if ((Role_if(PM_SAIYAN) && (mons[first].msound == MS_JAPANESE) )) num -= 2;
		if ((Role_if(PM_SAIYAN) && (mons[first].msound == MS_COMBAT) )) num -= 2;
		if ((Role_if(PM_SHOE_FETISHIST) && (mons[first].msound == MS_SOCKS) )) num -= 1;
		if ((Role_if(PM_SHOE_FETISHIST) && (mons[first].msound == MS_SING) )) num -= 2;
		if ((Role_if(PM_SOFTWARE_ENGINEER) && (mons[first].msound == MS_BOT) )) num -= 2;
		if ((Role_if(PM_ZOOKEEPER) && monsterrandomwalk(&mons[first]))) num -= 4;

		if ((Race_if(PM_ADDICT) && (mons[first].msound == MS_DRUGS) )) num -= 1;
		if ((Race_if(PM_PLAYER_ANDROID) && (mons[first].msound == MS_BOT) )) num -= 4;
		if ((Race_if(PM_CHIQUAI) && (mons[first].msound == MS_JAPANESE) )) num -= 3;
		if ((Race_if(PM_JAPURA) && (mons[first].msound == MS_JAPANESE) )) num -= 6;
		if ((Race_if(PM_JAVA) && monsterrandomwalk(&mons[first]))) num -= 2;
		if ((Race_if(PM_NAVI) && monsterrandomwalk(&mons[first]))) num -= 1;
		if ((Race_if(PM_NAVI) && monsterflees(&mons[first]))) num -= 1;
		if ((Race_if(PM_RUSMOT) && (mons[first].msound == MS_SOVIET) )) num -= 5;
		if ((issoviet && (mons[first].msound == MS_SOVIET) )) num -= 10;
		if ((Race_if(PM_SPAMMER) && (mons[first].msound == MS_GIBBERISH) )) num -= 1;
		if ((Race_if(PM_VIETIS) && (mons[first].msound == MS_JAPANESE) )) num -= 1;
		if ((Race_if(PM_WOOKIE) && (mons[first].msound == MS_BOT) )) num -= 1;

		if ((Role_if(PM_BOSMER) && (mons[first].msound == MS_TREESQUAD) )) num -= 10;
		if ((Role_if(PM_AMAZON) && (mons[first].msound == MS_TREESQUAD) )) num -= 1;
		if ((Role_if(PM_ANACHRONOUNBINDER) && (mons[first].msound == MS_SPOILER) )) num -= 1;
		if ((Role_if(PM_ARCHEOLOGIST) && (mons[first].msound == MS_DEAD) )) num -= 2;
		if ((Role_if(PM_ASTRONAUT) && (mons[first].msound == MS_CODE) )) num -= 2;
		if ((Role_if(PM_ASTRONAUT) && (mons[first].msound == MS_STABILIZE) )) num -= 3;
		if ((Role_if(PM_BLOODSEEKER) && (mons[first].msound == MS_SELFHARM) )) num -= 1;
		if ((Role_if(PM_BULLY) && (mons[first].msound == MS_WOLLOH) )) num -= 5;
		if ((Role_if(PM_CONVICT) && (mons[first].msound == MS_METALMAFIA) )) num -= 3;
		if ((Role_if(PM_MURDERER) && (mons[first].msound == MS_METALMAFIA) )) num -= 5;
		if ((Role_if(PM_CRACKER) && (mons[first].msound == MS_CODE) )) num -= 5;
		if ((Role_if(PM_DANCER) && (mons[first].msound == MS_AREOLA) )) num -= 1;
		if ((Role_if(PM_DEMAGOGUE) && (mons[first].msound == MS_DEEPSTATE) )) num -= 5;
		if ((Role_if(PM_DISSIDENT) && (mons[first].msound == MS_DEEPSTATE) )) num -= 10;
		if ((Role_if(PM_DQ_SLIME) && (mons[first].msound == MS_LIEDER) )) num -= 1;
		if ((Role_if(PM_DQ_SLIME) && (mons[first].msound == MS_GAARDIEN) )) num -= 5;
		if ((Role_if(PM_DRUID) && (mons[first].msound == MS_TREESQUAD) )) num -= 2;
		if ((Role_if(PM_DRUNK) && (mons[first].msound == MS_WOLLOH) )) num -= 1;
		if ((Role_if(PM_ELPH) && (mons[first].msound == MS_TREESQUAD) )) num -= 3;
		if ((Role_if(PM_EMPATH) && (mons[first].msound == MS_AREOLA) )) num -= 1;
		if ((Role_if(PM_ERDRICK) && (mons[first].msound == MS_LIEDER) )) num -= 3;
		if ((Role_if(PM_ERDRICK) && (mons[first].msound == MS_GAARDIEN) )) num -= 3;
		if ((Role_if(PM_FOXHOUND_AGENT) && (mons[first].msound == MS_ESCAPE) )) num -= 2;
		if ((Role_if(PM_GAMER) && (mons[first].msound == MS_CODE) )) num -= 2;
		if ((Role_if(PM_GANGSTER) && (mons[first].msound == MS_METALMAFIA) )) num -= 1;
		if ((Role_if(PM_GEEK) && (mons[first].msound == MS_CODE) )) num -= 3;
		if ((Role_if(PM_GRADUATE) && (mons[first].msound == MS_CODE) )) num -= 3;
		if ((Role_if(PM_GOFF) && (mons[first].msound == MS_AREOLA) )) num -= 6;
		if ((Role_if(PM_JANITOR) && (mons[first].msound == MS_DEAD) )) num -= 1;
		if ((Role_if(PM_LADIESMAN) && (mons[first].msound == MS_BARBER) )) num -= 3;
		if ((Role_if(PM_LOCKSMITH) && (mons[first].msound == MS_CODE) )) num -= 2;
		if ((Role_if(PM_MASTERMIND) && (mons[first].msound == MS_CODE) )) num -= 10;
		if ((Role_if(PM_NECROMANCER) && (mons[first].msound == MS_DEAD) )) num -= 1;
		if ((Role_if(PM_NUCLEAR_PHYSICIST) && (mons[first].msound == MS_STABILIZE) )) num -= 1;
		if ((Role_if(PM_OFFICER) && (mons[first].msound == MS_METALMAFIA) )) num -= 3;
		if ((Role_if(PM_POKEMON) && (mons[first].msound == MS_MISSING) )) num -= 2;
		if ((Role_if(PM_POLITICIAN) && (mons[first].msound == MS_DEEPSTATE) )) num -= 5;
		if ((Role_if(PM_PREVERSIONER) && (mons[first].msound == MS_MISSING) )) num -= 3;
		if ((Role_if(PM_QUARTERBACK) && (mons[first].msound == MS_BARBER) )) num -= 1;
		if ((Role_if(PM_RANGER) && (mons[first].msound == MS_TREESQUAD) )) num -= 2;
		if ((Role_if(PM_RANGER) && (mons[first].msound == MS_FEARHARE) )) num -= 1;
		if ((Role_if(PM_SLAVE_MASTER) && (mons[first].msound == MS_FEARHARE) )) num -= 4;
		if ((Role_if(PM_SOFTWARE_ENGINEER) && (mons[first].msound == MS_CODE) )) num -= 1;
		if ((Role_if(PM_SUPERMARKET_CASHIER) && (mons[first].msound == MS_WOLLOH) )) num -= 1;
		if ((Role_if(PM_UNDERTAKER) && (mons[first].msound == MS_DEAD) )) num -= 5;
		if ((Role_if(PM_STAND_USER) && (mons[first].msound == MS_OHGOD) )) num -= 5;
		if ((Role_if(PM_WOMANIZER) && (mons[first].msound == MS_BARBER) )) num -= 1;
		if ((Role_if(PM_SEXYMATE) && (mons[first].msound == MS_BARBER) )) num -= 2;

		if ((Race_if(PM_AK_THIEF_IS_DEAD_) && (mons[first].msound == MS_SPOILER) )) num -= 2;
		if ((Race_if(PM_BULDOZGAR) && (mons[first].msound == MS_METALMAFIA) )) num -= 1;
		if ((Race_if(PM_DESTABILIZER) && (mons[first].msound == MS_STABILIZE) )) num -= 2;
		if ((Race_if(PM_DRYAD) && (mons[first].msound == MS_TREESQUAD) )) num -= 1;
		if ((Race_if(PM_DYNAMO) && (mons[first].msound == MS_METALMAFIA) )) num -= 2;
		if ((Race_if(PM_ELF) && (mons[first].msound == MS_TREESQUAD) )) num -= 1;
		if ((Race_if(PM_LOWER_ENT) && (mons[first].msound == MS_TREESQUAD) )) num -= 10;
		if ((Race_if(PM_EROSATOR) && (mons[first].msound == MS_AREOLA) )) num -= 4;
		if ((Race_if(PM_PLAYER_FAIRY) && (mons[first].msound == MS_STABILIZE) )) num -= 1;
		if ((Race_if(PM_PLAYER_GLORKUM) && (mons[first].msound == MS_MISSING) )) num -= 2;
		if ((Race_if(PM_PLAYER_GLORKUM) && (mons[first].msound == MS_SPOILER) )) num -= 1;
		if ((Race_if(PM_HC_ALIEN) && (mons[first].msound == MS_BARBER) )) num -= 1;
		if ((Race_if(PM_HC_ALIEN) && (mons[first].msound == MS_WOLLOH) )) num -= 4;
		if ((Race_if(PM_KOP) && (mons[first].msound == MS_METALMAFIA) )) num -= 6;
		if ((Race_if(PM_LIZARDMAN) && (mons[first].msound == MS_STABILIZE) )) num -= 3;
		if ((Race_if(PM_LOLI) && (mons[first].msound == MS_AREOLA) )) num -= 2;
		if ((Race_if(PM_METAL) && (mons[first].msound == MS_ESCAPE) )) num -= 2;
		if ((Race_if(PM_MISSINGNO) && (mons[first].msound == MS_MISSING) )) num -= 20;
		if ((Race_if(PM_MONGUNG) && (mons[first].msound == MS_FEARHARE) )) num -= 5;
		if ((Race_if(PM_NAVI) && (mons[first].msound == MS_FEARHARE) )) num -= 1;
		if ((Race_if(PM_NEMESIS) && (mons[first].msound == MS_LIEDER) )) num -= 1;
		if ((Race_if(PM_OUTSIDER) && (mons[first].msound == MS_DEEPSTATE) )) num -= 2;
		if ((Race_if(PM_PERVERT) && (mons[first].msound == MS_AREOLA) )) num -= 2;
		if ((Race_if(PM_PIECE) && (mons[first].msound == MS_STABILIZE) )) num -= 1;
		if ((Race_if(PM_RACE_THAT_DOESN_T_EXIST) && (mons[first].msound == MS_MISSING) )) num -= 5;
		if ((Race_if(PM_SHEEP) && (mons[first].msound == MS_ESCAPE) )) num -= 1;
		if ((Race_if(PM_SPRIGGAN) && (mons[first].msound == MS_TREESQUAD) )) num -= 3;
		if ((Race_if(PM_SUSTAINER) && (mons[first].msound == MS_TREESQUAD) )) num -= 1;
		if ((Race_if(PM_SYLPH) && (mons[first].msound == MS_TREESQUAD) )) num -= 2;
		if ((Race_if(PM_TURMENE) && (mons[first].msound == MS_WOLLOH) )) num -= 5;
		if ((Race_if(PM_VENTURE_CAPITALIST) && (mons[first].msound == MS_DEEPSTATE) )) num -= 1;
		if ((Race_if(PM_WORM_THAT_WALKS) && (mons[first].msound == MS_DEAD) )) num -= 3;

		if ((uarmc && uarmc->oartifact == ART_PHEROMONE_CASE && (mons[first].msound == MS_STENCH))) num -= 10;
		if ((FemtrapActiveAnna && (mons[first].msound == MS_STENCH))) num -= 50;
		if ((FemtrapActiveLydia && (spawnswithpumps(&mons[first])) )) num -= 1000;
		if ((FemtrapActiveMarike && (mons[first].msound == MS_FART_NORMAL))) num -= 10;
		if ((FemtrapActiveVictoria && is_female(&mons[first]) && attacktype(&mons[first], AT_KICK) )) num -= 20;
		if ((FemtrapActiveJil && (mons[first].msound == MS_SOCKS))) num -= 25;
		if ((FemtrapActiveLaura && (mons[first].msound == MS_SOCKS))) num -= 50;
		if ((FemtrapActiveLaura && (mons[first].msound == MS_PANTS))) num -= 50;
		if ((FemtrapActiveLaura && (mons[first].msound == MS_SHOE))) num -= 50;
		if (u.pompejiwantedlevel && (mons[first].msound == MS_POMPEJI)) num -= min(1000, u.pompejiwantedlevel);

		if (monster_with_trait(&mons[first], u.frequenttrait1)) num -= u.freqtraitbonus1;
		if (u.frequenttrait2 && monster_with_trait(&mons[first], u.frequenttrait2)) num -= u.freqtraitbonus2;
		if (u.frequenttrait3 && monster_with_trait(&mons[first], u.frequenttrait3)) num -= u.freqtraitbonus3;
		if (u.frequenttrait4 && monster_with_trait(&mons[first], u.frequenttrait4)) num -= u.freqtraitbonus4;
		if (u.frequenttrait5 && monster_with_trait(&mons[first], u.frequenttrait5)) num -= u.freqtraitbonus5;
		if (u.frequenttrait6 && monster_with_trait(&mons[first], u.frequenttrait6)) num -= u.freqtraitbonus6;
		if (u.frequenttrait7 && monster_with_trait(&mons[first], u.frequenttrait7)) num -= u.freqtraitbonus7;
		if (u.frequenttrait8 && monster_with_trait(&mons[first], u.frequenttrait8)) num -= u.freqtraitbonus8;
		if (u.frequenttrait9 && monster_with_trait(&mons[first], u.frequenttrait9)) num -= u.freqtraitbonus9;
		if (u.frequenttrait10 && monster_with_trait(&mons[first], u.frequenttrait10)) num -= u.freqtraitbonus10;

		if ((FrequentationSpawns || u.uprops[FREQUENTATION_SPAWNS].extrinsic || have_frequentationspawnstone()) && u.frequentationtrait && monster_with_trait(&mons[first], u.frequentationtrait) ) num -= 10;

		if (RngeExtinction && mvitals[first].born) num -= mvitals[first].born;

		if (first == urole.nemesnum) num -= (Qstats(killed_nemesis) ? 500 : 100);

		if ((urole.enemy1num != NON_PM) && (first == urole.enemy1num)) num -= 125;
		if ((urole.enemy2num != NON_PM) && (first == urole.enemy2num)) num -= 25;

		/* skew towards lower value monsters at lower exp. levels */
		/* or not, because seriously... what the heck??? --Amy */
		/* if (num && adj_lev(&mons[first]) > (u.ulevel*2)) { */
		    /* but not when multiple monsters are same level */
		    /* if (mons[first].mlevel != mons[first+1].mlevel)
			num--;
		} */
	    }
	first--; /* correct an off-by-one error */

	return(first);
}

int
adj_lev(ptr)	/* adjust strength of monsters based on u.uz and u.ulevel */
register struct permonst *ptr;
{
	int	tmp, tmp2;

	if (ptr == &mons[PM_WIZARD_OF_YENDOR]) {
		/* does not depend on other strengths, but does get stronger
		 * every time he is killed
		 */
		tmp = ptr->mlevel + mvitals[PM_WIZARD_OF_YENDOR].died;
		if (tmp > 49) tmp = 49;
		return tmp;
	}

	if (ptr == &mons[PM_THE_ZRUTINATOR]) {
		/* like Rodney, he's Rodney's pet after all */
		tmp = ptr->mlevel + mvitals[PM_THE_ZRUTINATOR].died;
		if (tmp > 49) tmp = 49;
		return tmp;
	}

	if((tmp = ptr->mlevel) > 49) return(50); /* "special" demons/devils */
	tmp2 = (level_difficulty() - tmp);
	if(tmp2 < 0) tmp--;		/* if mlevel > u.uz decrement tmp */
	else tmp += (tmp2 / 5);		/* else increment 1 per five diff */

	tmp2 = (u.ulevel - ptr->mlevel);	/* adjust vs. the player */
	if(tmp2 > 0) tmp += (tmp2 / 4);		/* level as well */

	tmp2 = (3 * ((int) ptr->mlevel))/ 2;	/* crude upper limit */

	/* adjustments by Amy */
	/* jonadab wants monsters to spawn with up to 8x their base level, but that's really excessive. */

	if (rn2(2)) {
		if (!rn2(2) && (tmp2 < 6) && (level_difficulty() > 9)) { if (rn2(3)) tmp++; if (rn2(3)) tmp2++; }
		if (!rn2(2) && (tmp2 < 6) && (level_difficulty() > 19)) { if (rn2(3)) tmp++; if (rn2(3)) tmp2++; }
		if (!rn2(3) && (tmp2 < 11) && (level_difficulty() > 19)) { if (rn2(3)) tmp++; if (rn2(3)) tmp2++; }
		if (!rn2(2) && (tmp2 < 8) && (level_difficulty() > 29)) { if (rn2(3)) tmp++; if (rn2(3)) tmp2++; }
		if (!rn2(3) && (tmp2 < 16) && (level_difficulty() > 29)) { if (rn2(3)) tmp++; if (rn2(3)) tmp2++; }
		if (!rn2(2) && (tmp2 < 10) && (level_difficulty() > 39)) { if (rn2(3)) tmp++; if (rn2(3)) tmp2++; }
		if (!rn2(3) && (tmp2 < 21) && (level_difficulty() > 39)) { if (rn2(3)) tmp++; if (rn2(3)) tmp2++; }
		if (!rn2(2) && (tmp2 < 12) && (level_difficulty() > 49)) { if (rn2(3)) tmp++; if (rn2(3)) tmp2++; }
		if (!rn2(3) && (tmp2 < 24) && (level_difficulty() > 49)) { if (rn2(3)) tmp++; if (rn2(3)) tmp2++; }
		if (!rn2(2) && (tmp2 < 14) && (level_difficulty() > 74)) { if (rn2(3)) tmp++; if (rn2(3)) tmp2++; }
		if (!rn2(3) && (tmp2 < 27) && (level_difficulty() > 74)) { if (rn2(3)) tmp++; if (rn2(3)) tmp2++; }
		if (!rn2(2) && (tmp2 < 16) && (level_difficulty() > 99)) { if (rn2(3)) tmp++; if (rn2(3)) tmp2++; }
		if (!rn2(3) && (tmp2 < 30) && (level_difficulty() > 99)) { if (rn2(3)) tmp++; if (rn2(3)) tmp2++; }
	}

	/* Another adjustment for rodneyans, because they're too strong. Junethack 2016 showed how much too strong, so let's
	 * give higher levels to monsters which will hopefully enable them to sometimes survive the rodneyan's stronger
	 * melee attacks! Although I'm fairly sure the rodneyan is still too powerful even with this change. --Amy */
	if (Race_if(PM_RODNEYAN)) {

		if (!rn2(2) && (tmp2 < 6) && (level_difficulty() > 9)) { tmp++; tmp2++;}
		if (!rn2(2) && (tmp2 < 6) && (level_difficulty() > 19)) { tmp++; tmp2++;}
		if (!rn2(3) && (tmp2 < 11) && (level_difficulty() > 19)) { tmp++; tmp2++;}
		if (!rn2(2) && (tmp2 < 8) && (level_difficulty() > 29)) { tmp++; tmp2++;}
		if (!rn2(3) && (tmp2 < 16) && (level_difficulty() > 29)) { tmp++; tmp2++;}
		if (!rn2(2) && (tmp2 < 10) && (level_difficulty() > 39)) { tmp++; tmp2++;}
		if (!rn2(3) && (tmp2 < 21) && (level_difficulty() > 39)) { tmp++; tmp2++;}
		if (!rn2(2) && (tmp2 < 12) && (level_difficulty() > 49)) { tmp++; tmp2++;}
		if (!rn2(3) && (tmp2 < 24) && (level_difficulty() > 49)) { tmp++; tmp2++;}
		if (!rn2(2) && (tmp2 < 14) && (level_difficulty() > 74)) { tmp++; tmp2++;}
		if (!rn2(3) && (tmp2 < 27) && (level_difficulty() > 74)) { tmp++; tmp2++;}
		if (!rn2(2) && (tmp2 < 16) && (level_difficulty() > 99)) { tmp++; tmp2++;}
		if (!rn2(3) && (tmp2 < 30) && (level_difficulty() > 99)) { tmp++; tmp2++;}
		if (!rn2(10)) {
			tmp += rnd(10);
			tmp2 += rnd(10);
		}

	}

	if (tmp2 > 49) tmp2 = 49;		/* hard upper limit */
	return((tmp > tmp2) ? tmp2 : (tmp > 0 ? tmp : 0)); /* 0 lower limit */
}

#endif /* OVL1 */
#ifdef OVLB

struct permonst *
grow_up(mtmp, victim)	/* `mtmp' might "grow up" into a bigger version */
struct monst *mtmp, *victim;
{
	int oldtype, newtype, max_increase, cur_increase,
	    lev_limit, hp_threshold;
	struct permonst *ptr = mtmp->data;

	/* monster died after killing enemy but before calling this function */
	/* currently possible if killing a gas spore */
	if (mtmp->mhp <= 0)
	    return ((struct permonst *)0);

	if (mtmp->oldmonnm != monsndx(ptr))
	    return ptr;		/* No effect if polymorphed */

	/* note:  none of the monsters with special hit point calculations
	   have both little and big forms */
	oldtype = monsndx(ptr);
	newtype = little_to_big(oldtype);
	if (newtype == PM_PRIEST && mtmp->female) newtype = PM_PRIESTESS;

	/* growth limits differ depending on method of advancement */
	if (victim) {		/* killed a monster */
	    /*
	     * The HP threshold is the maximum number of hit points for the
	     * current level; once exceeded, a level will be gained.
	     * Possible bug: if somehow the hit points are already higher
	     * than that, monster will gain a level without any increase in HP.
	     */
	    hp_threshold = mtmp->m_lev * 8;		/* normal limit */
	    if (!mtmp->m_lev)
		hp_threshold = 4;
	    else if (is_golem(ptr))	/* strange creatures */
		hp_threshold = ((mtmp->mhpmax / 10) + 1) * 10 - 1;
	    else if (is_home_elemental(ptr))
		hp_threshold *= 3;
	    lev_limit = /*3 * (int)ptr->mlevel / 2*/50;	/* same as adj_lev() */
	    /* If they can grow up, be sure the level is high enough for that */
	    if (oldtype != newtype && mons[newtype].mlevel > lev_limit)
		lev_limit = (int)mons[newtype].mlevel;
	    /* number of hit points to gain; unlike for the player, we put
	       the limit at the bottom of the next level rather than the top */
	    max_increase = rnd((int)victim->m_lev + 1);
	    if (mtmp->mhpmax + max_increase > hp_threshold + 1)
		max_increase = max((hp_threshold + 1) - mtmp->mhpmax, 0);
		if (max_increase > 1) max_increase = rnd(max_increase); /* nerf by Amy, since it was going way too fast */
		if (mtmp->m_lev > 14) {
		if (rnd(mtmp->m_lev) > 14) max_increase = 0;
		if (rnd(mtmp->m_lev) > 24) max_increase = 0;
		if (rnd(mtmp->m_lev) > 34) max_increase = 0;
		if (rnd(mtmp->m_lev) > 39) max_increase = 0;
		if (rnd(mtmp->m_lev) > 43) max_increase = 0;
		if (rnd(mtmp->m_lev) > 46) max_increase = 0;
		if (rnd(mtmp->m_lev) > 48) max_increase = 0;
		}
	    cur_increase = (max_increase > 1) ? rn2(max_increase) : 0;

	} else {
	    /* a gain level potion or wraith corpse; always go up a level
	       unless already at maximum (49 is hard upper limit except
	       for demon lords, who start at 50 and can't go any higher) */
	    max_increase = cur_increase = rnd(8) + rnd(2);
	    hp_threshold = 0;	/* smaller than `mhpmax + max_increase' */
	    lev_limit = 50;		/* recalc below */
	}

	mtmp->mhpmax += max_increase;
	mtmp->mhp += cur_increase;

	mtmp->m_enmax += max_increase;
	mtmp->m_en += cur_increase;

	if (ishaxor) {
	mtmp->mhpmax += max_increase;
	mtmp->mhp += cur_increase;

	mtmp->m_enmax += max_increase;
	mtmp->m_en += cur_increase;
	}
	
	if (mtmp->mhpmax <= hp_threshold)
	    return ptr;		/* doesn't gain a level */

	/* Allow to grow up even if grown up form would normally be
	 * out of range */
	if (lev_limit < mons[newtype].mlevel)
	    lev_limit = mons[newtype].mlevel;

	if (is_mplayer(ptr)) lev_limit = 30;    /* same as player */
	else if (lev_limit < 5) lev_limit = 5;  /* arbitrary */
	else if (lev_limit > 49) lev_limit = (ptr->mlevel > 49 ? 50 : 49);

	if ((int)++mtmp->m_lev >= mons[newtype].mlevel && newtype != oldtype) {
	    ptr = &mons[newtype];

		/* stupid sensemon function! Screw it, evolving messages will always be displayed now. --Amy */

		/*if (sensemon(mtmp)) {*/
			pline("What? %s is evolving!", mon_nam(mtmp) );
			pline("%s evolved into %s!", mon_nam(mtmp), an(ptr->mname) );
		/*}*/

	    if (mvitals[newtype].mvflags & G_GENOD) {	/* allow G_EXTINCT */
		if (sensemon(mtmp))
		    pline("As %s grows up into %s, %s %s!", mon_nam(mtmp),
			an(ptr->mname), mhe(mtmp),
			nonliving(ptr) ? "expires" : "dies");
		set_mon_data(mtmp, ptr, -1);	/* keep mvitals[] accurate */
		mondied(mtmp);
		return (struct permonst *)0;
	    }
	    set_mon_data(mtmp, ptr, 1);		/* preserve intrinsics */
	    newsym(mtmp->mx, mtmp->my);		/* color may change */
	    lev_limit = (int)mtmp->m_lev;	/* never undo increment */
	}
	/* sanity checks */
	if ((int)mtmp->m_lev > lev_limit) {
	    mtmp->m_lev--;	/* undo increment */
	    /* HP might have been allowed to grow when it shouldn't */
	    if (mtmp->mhpmax == hp_threshold + 1) mtmp->mhpmax--;
	}

	/* Dark Goku is supposed to have over 9000 HP (idea by Bug Sniper). Don't make him lose it from quaffing gain level. --Amy */
	if (mtmp->mhpmax > 5000*8) mtmp->mhpmax = 5000*8;	  /* absolute limit */
	if (mtmp->mhp > mtmp->mhpmax) mtmp->mhp = mtmp->mhpmax;

	if (mtmp->m_enmax > 5000*8) mtmp->m_enmax = 5000*8;     /* absolute limit */
	if (mtmp->m_en > mtmp->m_enmax) mtmp->m_en = mtmp->m_enmax;

	if (mtmp->oldmonnm != monsndx(ptr)) mtmp->oldmonnm = monsndx(ptr);
	return ptr;
}

#endif /* OVLB */
#ifdef OVL1

int
mongets(mtmp, otyp)
register struct monst *mtmp;
register int otyp;
{
	register struct obj *otmp;
	int spe;

	if (!otyp) return 0;
	otmp = mksobj(otyp, TRUE, rn2(50) ? FALSE : TRUE, FALSE);
	if (otmp) {
	    if (mtmp->data->mlet == S_DEMON) {
		/* demons never get blessed objects */
		if (otmp->blessed) curse(otmp);
	    } else if(is_lminion(mtmp)) {
		/* lawful minions don't get cursed, bad, or rusting objects */
		otmp->cursed = otmp->hvycurse = otmp->prmcurse = otmp->morgcurse = otmp->evilcurse = otmp->bbrcurse = otmp->stckcurse = FALSE;
		if(otmp->spe < 0) otmp->spe = 0;
		otmp->oerodeproof = TRUE;
	    } else if(In_endgame(&u.uz) && is_mplayer(mtmp->data) && is_sword(otmp)) {
		otmp->spe = (3 + rn2(3));
	    }
/*
 *      This seems to be covered under mkobj.c ...
 *
 *          * STEPHEN WHITE'S NEW CODE *
 *
 *          if ((otmp->otyp == ORCISH_DAGGER      && !rn2(8))  ||
 *              (otmp->otyp == ORCISH_SPEAR       && !rn2(10)) ||
 *              (otmp->otyp == ORCISH_SHORT_SWORD && !rn2(12)))
 *                      otmp->opoisoned = TRUE;
 *
 *           * It could be alread immune to rust ... *
 *          if (!otmp->oerodeproof && !is_rustprone(otmp) &&
 *              ((otmp->otyp >= SPEAR && otmp->otyp <= BULLWHIP) ||
 *               (otmp->otyp >= ELVEN_LEATHER_HELM &&
 *                otmp->otyp <= LEVITATION_BOOTS))) {
 *                   if (!rn2(10-otmp->spe)) otmp->oerodeproof = TRUE;
 *              else if (!rn2(10+otmp->spe)) otmp->oeroded = rn2(3);
 *          }
 */

	    if(otmp->otyp == CANDELABRUM_OF_INVOCATION) {
		otmp->spe = 0;
		otmp->age = 0L;
		otmp->lamplit = FALSE;
		otmp->blessed = otmp->cursed = otmp->hvycurse = otmp->prmcurse = otmp->morgcurse = otmp->evilcurse = otmp->bbrcurse = otmp->stckcurse = FALSE;
	    } else if (otmp->otyp == BELL_OF_OPENING) {
		otmp->blessed = otmp->cursed = otmp->hvycurse = otmp->prmcurse = otmp->morgcurse = otmp->evilcurse = otmp->bbrcurse = otmp->stckcurse = FALSE;
	    } else if (otmp->otyp == SPE_BOOK_OF_THE_DEAD) {
		otmp->blessed = FALSE;
		otmp->cursed = TRUE;
	    }

	    /* leaders don't tolerate inferior quality battle gear */
	    if (is_prince(mtmp->data)) {
		if (otmp->oclass == WEAPON_CLASS && otmp->spe < 1)
		    otmp->spe = 1;
		else if (otmp->oclass == ARMOR_CLASS && otmp->spe < 0)
		    otmp->spe = 0;
	    }

	    spe = otmp->spe;
	    if (is_musable(otmp)) otmp->mstartinvent = 1;
	    if (otmp->oclass == WEAPON_CLASS || otmp->oclass == ARMOR_CLASS) otmp->mstartinventB = 1;
	    if (otmp->oclass == GEM_CLASS && !objects[otmp->otyp].oc_magic) otmp->mstartinventB = 1;
	    if (is_weptool(otmp)) otmp->mstartinventB = 1;
	    if (otmp->otyp == MUMMY_WRAPPING && mtmp->data->mlet == S_MUMMY) otmp->mstartinventC = 1;
	    if (otmp->otyp == LONG_SWORD && mtmp->data->mlet == S_ANGEL) otmp->mstartinventC = 1;
	    if (otmp->otyp == LARGE_SHIELD && mtmp->data->mlet == S_ANGEL) otmp->mstartinventC = 1;
	    if (otmp->otyp == SHIELD_OF_REFLECTION && mtmp->data->mlet == S_ANGEL) otmp->mstartinventC = 1;
	    if (otmp->otyp == ROBE && mtmp->data->mlet == S_WRAITH) otmp->mstartinventC = 1;
	    if (otmp->otyp == RUBY && mtmp->data == &mons[PM_RUBY_BOSS]) otmp->mstartinventC = 1;
	    if (otmp->otyp == LANCE && mtmp->data->msound == MS_TREESQUAD) otmp->mstartinventE = 1;
	    if (otmp->otyp == PITCHFORK && mtmp->data->msound == MS_TREESQUAD) otmp->mstartinventE = 1;
	    if ((otmp->otyp >= WEDGED_LITTLE_GIRL_SANDAL) && (otmp->otyp <= PROSTITUTE_SHOE) && !Role_if(PM_TRANSVESTITE) && !Role_if(PM_TRANSSYLVANIAN)) {
			otmp->mstartinventD = 1;
		}
	    if ((otmp->otyp >= WEDGE_SANDALS) && (otmp->otyp <= ITALIAN_HEELS) && !Role_if(PM_TOPMODEL)) {
			otmp->mstartinventD = 1;
		}
	    if ((otmp->otyp >= WEDGE_SANDALS) && (otmp->otyp <= ITALIAN_HEELS) && Role_if(PM_FAILED_EXISTENCE)) otmp->mstartinventC = 1;
	    (void) mpickobj(mtmp, otmp, TRUE);	/* might free otmp */
	    return(spe);
	} else return(0);
}

#endif /* OVL1 */
#ifdef OVLB

int
golemhp(type)
int type;
{
	switch(type) {

		case PM_CARDBOARD_GOLEM: return 5;
		case PM_FAN_GOLEM: return 5;
		case PM_SPIT_GOLEM: return 8;
		case PM_HUS_GOLEM: return 9;
		case PM_FISH_GOLEM: return 12;
		case PM_GRAVEL_GOLEM: return 12;
		case PM_WARM_BLOODED_GOLEM: return 15;
		case PM_PART_GOLEM: return 10;
		case PM_EDGOLEM: return 10;
		case PM_LEDGOLEM: return 20;
		case PM_CEREAL_FLANGE: return 20;
		case PM_WOGOLEM: return 30;
		case PM_METGOLEM: return 35;
		case PM_SCRAP_METAL_GOLEM: return 90;
		case PM_FOOD_GOLEM: return 50;
		case PM_SPIDER_SILK_GOLEM: return 70;
		case PM_SCHOOL_FOOD_GOLEM: return 150;
		case PM_OCTIRON_GOLEM: return 400;
		case PM_CASA_GOLEM: return 10;
		case PM_HOUSE_GOLEM: return 10;
		case PM_SCISSOR_GOLEM: return 15;
		case PM_LAMP_GOLEM: return 20;
		case PM_WREH_GOLEM: return 16;
		case PM_SCRAP_GOLEM: return 20;
		case PM_CREDIT_GOLEM: return 20;
		case PM_CLIMB_GOLEM: return 16;
		case PM_ALUMINIUM_GOLEM: return 20;
		case PM_SEMEN_GOLEM: return 300;
		case PM_OVARY_GOLEM: return 500;
		case PM_AREOLA_GOLEM: return 800;
		case PM_FRAGMENT_GOLEM: return 60;
		case PM_CLUMPED_GOLEM: return 120;
		case PM_ROCKSHOT_GOLEM: return 200;
		case PM_BOOT_GOLEM: return 100;
		case PM_HARDFOUGHT_ASS_VIOLIN: return 150;
		case PM_SHOE_GOLEM: return 80;
		case PM_LINGERIE_GOLEM: return 60;
		case PM_CARYATID: return 100;
		case PM_GREEN_STEEL_GOLEM: return 190;
		case PM_KNIGHT_OF_EMPTY_REFLECTIONS: return 300;
		case PM_SANDAL_GOLEM: return 150;
		case PM_MOUNTAIN_GOLEM: return 200;
		case PM_BIG_DADDY: return 500;
		case PM_CRAMP_CART_TO_THE_WALL_DRIVER: return 200;
		case PM_PHASING_MOUNTAIN_GOLEM: return 200;
		case PM_SENTINEL_OF_MITHARDIR: return 150;
		case PM_ITALIAN_GOLEM: return 150;
		case PM_PEARL_GOLEM: return 12;
		case PM_OXYGEN_GOLEM: return 16;
		case PM_SULFUR_GOLEM: return 24;
		case PM_JELLY_GOLEM: return 24;
		case PM_JEANS_GOLEM: return 25;
		case PM_HIDE_GOLEM: return 30;
		case PM_BRASS_SOLDIER: return 30;
		case PM_TEAK_GOLEM: return 40;
		case PM_BROKE_BROGUE: return 40;
		case PM_ANIMATED_HEAVY_STATUE: return 36;
		case PM_ROCK_SOLDIER: return 40;
		case PM_SOFT_GOLEM: return 45;
		case PM_DEFF_GOLEM: return 50;
		case PM_MUD_GOLEM: return 50;
		case PM_FLUFF_GOLEM: return 60;
		case PM_DOGOLEM: return 60;
		case PM_LITTLE_PINOCCHIO: return 70;
		case PM_ROOT_GOLEM: return 65;
		case PM_SAND_GOLEM: return 40;
		case PM_WALL_GOLEM: return 75;
		case PM_IMPISH_GOLEM: return 80;
		case PM_REAGENT_GOLEM: return 80;
		case PM_OTTED_GOLEM: return 90;
		case PM_DEAD_GOLEM: return 100;
		case PM_RIM_GOLEM: return 100;
		case PM_WATER_GOLEM: return 110;
		case PM_BLADE_GOLEM: return 105;
		case PM_ROLLER_GOLEM: return 110;
		case PM_BOMB_CRAG: return 250;
		case PM_DSCH_GOLEM: return 120;
		case PM_NUT_GOLEM: return 125;
		case PM_MOLTEN_GOLEM: return 130;
		case PM_SHINING_GOLEM: return 135;
		case PM_KUNG_FU_GOLEM: return 150;
		case PM_EVERYTHING_PROOF_GOLEM: return 175;
		case PM_TIMELESS_GOLEM: return 200;
		case PM_OILY_GOLEM: return 200;
		case PM_FANTASTIC_GOLEM: return 300;
		case PM_BLUEBEAM_GOLEM: return 500;
		case PM_MEGACLASH_GOLEM: return 800;
		case PM_LIVING_DOLL: return 150;
		case PM_LEVEL_ONE_GOLEM: return 60;
		case PM_VALUABLE_GOLEM: return 180;
		case PM_VOLCANIC_GOLEM: return 250;
		case PM_LOVEHEEL_SHOE: return 300;

		case PM_BABY_SHOE: return 10;
		case PM_KARAKASA: return 30;
		case PM_RETARDED_GOLEM: return 30;
		case PM_FLEECY_LEATHER_GOLEM: return 80;
		case PM_FLYING_UMBRELLA: return 30;
		case PM_DENT_GOLEM: return 100;
		case PM_ANIMATED_LADY_BOOT: return 150;
		case PM_GAUNTPEEKER: return 10;
		case PM_ANIMATED_PRETTY_SANDAL: return 220;
		case PM_ELOBLOOD_GOLEM: return 500;
		case PM_MUSCLE_GOLEM: return 600;
		case PM_ELOWOODEN_GOLEM: return 100;
		case PM_SKY_GOLEM: return 250;
		case PM_ULTIMATE_GOLEM: return 750;
		case PM_MAD_MUD_GOLEM: return 850;
		case PM_ELOLAVA_GOLEM: return 1000;
		case PM_ELOMITHRIL_GOLEM: return 200;
		case PM_ELOADAMANTIUM_GOLEM: return 300;
		case PM_PETTY_ELOADAMANTIUM_GOLEM: return 300;
		case PM_SHERINE: return 800;
		case PM_TAMMY: return 200;
		case PM_GOLDEN_GOLEM: return 180;
		case PM_ELOSTONE_GOLEM: return 125;
		case PM_ELOSTEEL_GOLEM: return 150;
		case PM_PIX_GOLEM: return 80;
		case PM_LANCE_GOLEM: return 100;
		case PM_HC_DENTER: return 100;
		case PM_ANIMATED_LIMB: return 30;
		case PM_DARK_FEMALE_ANDROID: return 30;
		case PM_LIVING_IRON_CHAIN: return 30;
		case PM_BLACK_CHAMELEON: return 35;
		case PM_UGLY_STICK: return 35;
		case PM_PAPER_GOLEM: return 36;
		case PM_WHIFF_GOLEM: return 36;
		case PM_GREY_CYBORG: return 36;
		case PM_STRAW_GOLEM: return 40;
		case PM_HAY_GOLEM: return 40;
		case PM_WTF_STRAW_GOLEM: return 40;
		case PM_UAAH_STRAW_GOLEM: return 40;
		case PM_GARGOYLE: return 46;
		case PM_FLYING_SCIMITAR: return 50;
		case PM_CLOTH_GOLEM: return 50;
		case PM_ANIMATED_TORCH: return 50;
		case PM_BURNING_TORCH: return 50;
		case PM_PLUSH_BEAR_GOLEM: return 50;
		case PM_INTERCEPTOR_DOLL: return 50;
		case PM_DILDO_GOLEM: return 100;
		case PM_CHEMISTRY_GOLEM: return 180;
		case PM_ALCHEMY_GOLEM: return 500;
		case PM_GIANT_PENIS_GOLEM: return 800;
		case PM_POTION_GOLEM: return 100;
		case PM_SCROLL_GOLEM: return 100;
		case PM_READER_GOLEM: return 190;
		case PM_SA_BRINE: return 250;
		case PM_GL_GOLEM: return 250;
		case PM_DANI_JELLE: return 200;
		case PM_BUNELY: return 600;
		case PM_MANOCTATOR: return 700;

		case PM_GERMAN_CHANCELLOR: return 7500;

		case PM_WEAPON_GOLEM: return 50;
		case PM_FLYING_GOLEM: return 50;
		case PM_WEAK_GOLEM: return 60;
		case PM_ARMOR_GOLEM: return 50;
		case PM_FIGHTER_GOLEM: return 120;
		case PM_SUCK_GOLEM: return 100;
		case PM_PROTECTER_GOLEM: return 120;
		case PM_DOZE_GOLEM: return 160;
		case PM_SWINGER_GOLEM: return 220;
		case PM_TANKER_GOLEM: return 220;
		case PM_LIME_GOLEM: return 240;
		case PM_HEAVILY_ARMED_GOLEM: return 400;
		case PM_TANK_GOLEM: return 400;
		case PM_MILITARY_GOLEM: return 800;
		case PM_INDUSTRY_GOLEM: return 800;

		case PM_WAND_GOLEM: return 120;
		case PM_WAND_OF_WISHING_GOLEM: return 500;

		case PM_ZAP_GOLEM: return 250;

		case PM_FLAME_ATRONACH: return 50;
		case PM_FROST_ATRONACH: return 100;
		case PM_STORM_ATRONACH: return 150;
		case PM_VENOM_ATRONACH: return 200;

		case PM_SPROOK: return 90;
		case PM_BOEH_BABY: return 10;
		case PM_PINK_BABY: return 10;
		case PM_BLOWSTREAM_BABY: return 1000;
		case PM_GOOGLEM: return 1111;
		case PM_GEMSTONE_GOLEM: return 250;

		case PM_HULL_ALIEN: return 255;
		case PM_UNICORN_GOLEM: return 400;

		case PM_CURSED_SWORD: return 100;
		case PM_LURKER_GOLEM: return 100;
		case PM_WAITER_GOLEM: return 100;
		case PM_ANIMATED_DAGGER: return 100;
		case PM_SWORD_FAMILIAR: return 150;
		case PM_IMPLANT_GOLEM: return 150;
		case PM_ROPE_GOLEM: return 60;
		case PM_LHAW_ROPE_GOLEM: return 60;
		case PM_TUDAK_ROPE_GOLEM: return 60;
		case PM_ANIMATED_STATUE: return 30;
		case PM_SLUDGE_GOLEM: return 150;
		case PM_CORROSLUDGE_GOLEM: return 150;
		case PM_BUNDLE_MONSTER: return 60;
		case PM_CUDDLE_MONSTER: return 80;
		case PM_FLEECE_MONSTER: return 100;
		case PM_FELEECHY: return 100;
		case PM_TIN_SOLDIER: return 60;
		case PM_CLAY_SOLDIER: return 60;
		case PM_LEATHER_GOLEM: return 80;
		case PM_SWORDPRESENT_GOLEM: return 80;
		case PM_LULTHER_GOLEM: return 80;
		case PM_STUDDED_GOLEM: return 100;
		case PM_RING_GOLEM: return 120;
		case PM_SCALE_GOLEM: return 150;
		case PM_CHAIN_GOLEM: return 180;
		case PM_BANDED_GOLEM: return 200;
		case PM_VOLUME_GOLEM: return 200;
		case PM_LAMEL_GOLEM: return 200;
		case PM_BRATE_GOLEM: return 250;
		case PM_PARTIAL_GOLEM: return 300;
		case PM_RIB_GOLEM: return 300;
		case PM_PLATE_GOLEM: return 350;
		case PM_CRYLEM: return 400;
		case PM_FULL_PLATE_GOLEM: return 600;
		case PM_GOLD_GOLEM: return 80;
		case PM_SILK_GOLEM: return 70;
		case PM_BAMBOO_GOLEM: return 80;
		case PM_EEL_GOLEM: return 80;
		case PM_STONE_SOLDIER: return 80;
		case PM_BRONZE_GOLEM: return 80;
		case PM_RUST_GOLEM: return 80;
		case PM_BANANA_PEEL_GOLEM: return 80;
		case PM_WOOD_GOLEM: return 100;
		case PM_INKA_GOLEM: return 100;
		case PM_VIVA_GOLEM: return 400;
		case PM_WOODEN_GOLEM: return 100;
		case PM_SECRETION_GOLEM: return 100;
		case PM_ARCANIUM_GOLEM: return 150;
		case PM_AXLEM: return 150;
		case PM_LIQUID_GOLEM: return 150;
		case PM_SINK_GOLEM: return 200;
		case PM_TAR_GOLEM: return 150;
		case PM_SCARECROW: return 100;
		case PM_MINTERM_GOLEM: return 100;
		case PM_PAGER_GOLEM: return 70;
		case PM_PETTY_SCARECROW: return 100;
		case PM_WOODEN_FIGURINE: return 110;
		case PM_BARNACLE_COVERED_GOLEM: return 120;
		case PM_BARNACLE_ARMORED_GOLEM: return 120;
		case PM_CLANKING_CHAINS: return 120;
		case PM_SOOTBALL: return 140;
		case PM_BLACK_SOOTBALL: return 140;
		case PM_PETTY_SOOTBALL: return 140;
		case PM_SPOOKY_PORTRAIT: return 150;
		case PM_HAUNTED_TEAPOT: return 200;
		case PM_ANIMATED_HOURGLASS: return 225;
		case PM_GRINDER: return 300;
		case PM_MINI_ROBO_KY: return 300;
		case PM_MORBID_MIRROR: return 310;
		case PM_STAINED_GLASS_GOLEM: return 100;
		case PM_LIVING_LECTURN: return 100;
		case PM_ANIMATED_WOODEN_STATUE: return 72;
		case PM_PROTECTOR_OF_THE_POOR: return 72;
		case PM_BURNINATOR: return 80;
		case PM_SOW_STUPID_GUY: return 72;
		case PM_MICKEY_MOUSE: return 72;
		case PM_CAMEROONIE: return 72;
		case PM_TOWER_STATUE: return 72;
		case PM_SUPER_WOODEN_STATUE: return 360; /* quite unbalanced; players who can't handle them should run away */
		case PM_VANISHING_POINT: return 72;
		case PM_LEVEL____ENEMY: return 72;
		case PM_GEODUDE: return 100;
		case PM_CHROME_GOLEM: return 100;
		case PM_RUBBER_GOLEM: return 150;
		case PM_BRASS_GOLEM: return 170;
		case PM_ALLOY_GOLEM: return 180;
		case PM_HOLY_WATER_GOLEM: return 200;
		case PM_UNHOLY_WATER_GOLEM: return 200;
		case PM_DOOMED_WATER_GOLEM: return 200;
		case PM_MIRROR_GOLEM: return 210;
		case PM_ONIJI_TANKOBO: return 420;
		case PM_TITANIUM_GOLEM: return 230;
		case PM_DANCING_BLADE: return 230;
		case PM_BRONZE_COLOSSUS: return 270;
		case PM_SILVER_GOLEM: return 290;
		case PM_MIEP_SILVER_GOLEM: return 290;
		case PM_BANPEI_KUN: return 290;
		case PM_PLATINUM_GOLEM: return 310;
		case PM_ANIMATED_ARMOR: return 100;
		case PM_ANIMATED_BRONZE_STATUE: return 103;
		case PM_COOL_GUY: return 103;
		case PM_MAIN_SCHOOL_GRADUATE: return 103;
		case PM_AKKAD: return 103;
		case PM_DARK_SAILOR: return 103;
		case PM_HYPERTYPE: return 103;
		case PM_ANIMATED_WEDGE_SANDAL: return 100;
		case PM_ANIMATED_PAVEMENT_HEEL: return 100;
		case PM_SHOE: return 100;
		case PM_STICKSHOE: return 100;
		case PM_FUCK_SHOE: return 100;
		case PM_SCIM_GOLEM: return 70;
		case PM_WULSCHLEM: return 90;
		case PM_RANSOEM: return 120;
		case PM_BARDIIM: return 160;
		case PM_FORKLEM: return 240;
		case PM_GISLEM: return 300;
		case PM_BEARD_GOLEM: return 500;
		case PM_RAPIER_GOLEM: return 50;
		case PM_SLASH_GOLEM: return 70;
		case PM_TIMBER_GOLEM: return 100;
		case PM_FLY_GOLEM: return 30;
		case PM_MAYLEM: return 60;
		case PM_STAR_GOLEM: return 400;
		case PM_WEREWEDGESANDAL: return 100;
		case PM_FLATOLEM: return 150;
		case PM_ANIMATED_IRON_STATUE: return 137;
		case PM_ELTRA_VANISHING_POINT: return 137;
		case PM_MEGA_VANISHING_POINT: return 137;
		case PM_BEST_TEACHER_EVER: return 137;
		case PM_TGWTG: return 137;
		case PM_THE_FOREVER_TRAIN: return 137;
		case PM_TRUCK_OF_PEACE: return 200;
		case PM_AMUSING_THIRTEEN_GRADER: return 137;
		case PM_SECURITY_BOT: return 137;
		case PM_DELETION_BOT: return 137;
		case PM_ANIMATED_MARBLE_STATUE: return 199;
		case PM_SUPER_VANISHING_POINT: return 199;
		case PM_SCHOOL_DIRECTOR: return 199;
		case PM_EARTH_GAS_PRINCIPAL: return 199;
		case PM_CASTOR_TRANSPORT: return 199;
		case PM_ULTRA_STATUE: return 199;

		case PM_DEATH_SWORD: return 250;
		case PM_KILLER_KATANA: return 1000;
		case PM_HAMLEM: return 250;
		case PM_CLOCK_GOLEM: return 250;
		case PM_NEXUS_GOLEM: return 250;
		case PM_WHIRLING_HATCHET: return 250;
		case PM_HELLBLADE: return 320;
		case PM_BLADE_BARRIER: return 550;
		case PM_BLADE_OF_CHAOS: return 550;
		case PM_CELESTIAL_CLARION: return 400;
		case PM_CANNON_GOLEM: return 400;
		case PM_MISHAPEN_GOLEM: return 400;
		case PM_FROST_GOLEM: return 400;
		case PM_AQUA_REGIA_GOLEM: return 350;
		case PM_PURPLE_CRYSTAL_GOLEM: return 750;

		case PM_ANIMATED_COPPER_STATUE: return 237;
		case PM_GREAT_PROJECTION_STATUE: return 237;
		case PM_LEAD_STATUE: return 237;
		case PM_ANIMATED_SILVER_STATUE: return 273;
		case PM_FLYER_STATUE: return 273;
		case PM_ANIMAYION_STATUE: return 273;
		case PM_ANIMATED_GOLDEN_STATUE: return 324;
		case PM_STEELHAMMER: return 324;
		case PM_THUNDER_HAMMER: return 324;
		case PM_ANIMATED_PLATINUM_STATUE: return 388;
		case PM_SUPERCASH_ROAD_STATUE: return 388;
		case PM_THE_ULTIMATE_TANK: return 388;

		case PM_ATHENA_BLOCKER: return 1000;
		case PM_ATHENA_BASHER: return 300;
		case PM_ATHENA_CHESSMAN: return 400;
		case PM_ATHENA_GUARDIAN: return 500;
		case PM_ATHENA_PROTECTOR: return 500;
		case PM_ATHENA_GIANT: return 750;

		case PM_SPACE_TRANSPORT: return 199;
		case PM_WEATWIND: return 199;
		case PM_FLESH_GOLEM: return 120;
		case PM_FLESHY_GOLEM: return 120;
		case PM_MYSTERIOUS_GOLEM: return 240;
		case PM_HUMAN_FLESH_GOLEM: return 120;
		case PM_ANIMATED_SYNTHETIC_SANDAL: return 120;
		case PM_BRAIN_GOLEM: return 120;
		case PM_PETTY_BRAIN_GOLEM: return 120;
		case PM_SPELL_GOLEM: return 130;
		case PM_GROVE_GUARDIAN: return 170;
		case PM_FORD_GUARDIAN: return 170;
		case PM_UBER_FORD_GUARDIAN: return 170;
		case PM_STATUE_GARGOYLE: return 140;
		case PM_STATUE_GOLEM: return 140;
		case PM_CLAY_GOLEM: return 150;
		case PM_FUCK_THIS_CLAY_GOLEM: return 150;
		case PM_UNNECESSARY_CLAY_GOLEM: return 150;
		case PM_SEMBLANCE: return 150;
		case PM_COMPOST_GOLEM: return 100;
		case PM_SANDMAN: return 150;
		case PM_TONE_GOLEM: return 150;
		case PM_VERINA: return 160;
		case PM_BLOOD_GOLEM: return 200;
		case PM_HAUNTED_HELMET: return 200;
		case PM_KNOBBLE_STICK: return 200;
		case PM_GUTS_GOLEM: return 200;
		case PM_SMOKE_GOLEM: return 200;
		case PM_CLAY_STATUE: return 150;
		case PM_TREASURY_GOLEM: return 160;
		case PM_BATTLE_SPAM_GOLEM: return 160;
		case PM_ANIMATED_HUGGING_BOOT: return 160;
		case PM_WEREHUGGINGBOOT: return 160;
		case PM_SNOW_GOLEM: return 160;
		case PM_STONE_GOLEM: return 180;
		case PM_CERAMIC_GOLEM: return 90;
		case PM_GRAY_STONE_GOLEM: return 180;
		case PM_STONE_STATUE: return 180;
		case PM_GLASS_GOLEM: return 140;
		case PM_OBSIDIAN_GOLEM: return 160;
		case PM_BRONZE_GLASS_GOLEM: return 140;
		case PM_FIBERGLASS_INSULATION_GOLEM: return 140;
		case PM_SERVANT_OF_THE_UNKNOWN_GOD: return 140;
		case PM_HEAD_OF_THE_UNKNOWN_GOD: return 140;
		case PM_BODY_OF_THE_UNKNOWN_GOD: return 140;
		case PM_LEGS_OF_THE_UNKNOWN_GOD: return 140;
		case PM_EYE_OF_THE_UNKNOWN_GOD: return 100;
		case PM_SCOURGE_OF_THE_UNKNOWN_GOD: return 180;
		case PM_AQUATIC_GOLEM: return 190;
		case PM_BONE_GOLEM: return 200;
		case PM_DRAGONHIDE_GOLEM: return 400;
		case PM_ANIMATED_BLOCK_HEELED_COMBAT_BOOT: return 200;
		case PM_SLAP_HEELED_SANDAL_BOOT: return 200;
		case PM_BRITISH_ARMY_SURPLUS_BOOT: return 160;
		case PM_WEREBLOCKHEELEDCOMBATBOOT: return 200;
		case PM_ANIMATED_IRREGULAR_HEEL: return 233;
		case PM_SAURON_THE_IMPRISONED: return 200;
		case PM_ANIMATED_LEATHER_PEEP_TOE: return 250;
		case PM_WEREPEEPTOE: return 250;
		case PM_ANIMATED_ROLLER_BLADE: return 260;
		case PM_IRONMAN: return 240;
		case PM_IRON_GOLEM: return 240;
		case PM_PYRITE_GOLEM: return 240;
		case PM_FOOL_S_GOLD_GOLEM: return 240;
		case PM_ETHEREAL_IRON_GOLEM: return 240;
		case PM_CONSEQUENCE_OF_YOUR_INSOUCIANCE: return 240;
		case PM_LONG_GOLEM: return 240;
		case PM_BALL_GOLEM: return 240;
		case PM_PURPUR_GOLEM: return 240;
		case PM_TIN_MAN: return 240;
		case PM_THE_BORSHIN: return 240;
		case PM_IRON_MAN: return 240;
		case PM_ARGENTUM_GOLEM: return 240;
		case PM_ICE_GOLEM: return 240;
		case PM_ICE_STATUE: return 240;
		case PM_MIST_GOLEM: return 240;
		case PM_GRAVELER: return 250;
		case PM_CFOUR: return 250;
		case PM_THUY_HAN: return 250;
		case PM_RETRIEVER: return 250;
		case PM_ANIMATED_BEAUTIFUL_SANDAL: return 250;
		case PM_TELERETRIEVER: return 250;
		case PM_RUBY_GOLEM: return 250;
		case PM_FIRE_GOLEM: return 250;
		case PM_ASH_GOLEM: return 250;
		case PM_SUMMONED_FIRE_GOLEM: return 250;
		case PM_LAVA_GOLEM: return 250;
		case PM_AUTO_ROLLER: return 250;
		case PM_BURNING_BRUTE: return 250;
		case PM_PUKELMAN: return 250;
		case PM_COLBRAN: return 270;
		case PM_MITHRIL_GOLEM: return 300;
		case PM_TILL: return 300;
		case PM_ARSENAL: return 300;
		case PM_ANIMATED_ATSUZOKO_BOOT: return 320;
		case PM_EOG_GOLEM: return 340;
		case PM_SILENT_WATCHER: return 350;
		case PM_ANIMATED_STILETTO_SANDAL: return 350;
		case PM_WERESTILETTOSANDAL: return 350;
		case PM_COLOSSUS: return 360;
		case PM_DROLEM: return 440;
		case PM_JNR: return 400;
		case PM_COAL_GOLEM: return 400;
		case PM_NANO_GOLEM: return 400;
		case PM_SHADOW_GOLEM: return 400;
		case PM_COPPER_GOLEM: return 400;
		case PM_LEAD_GOLEM: return 400;
		case PM_LUSTER_GOLEM: return 400;
		case PM_BLADE_OF_SLAUGHTER: return 450;
		case PM_DIFFICULT_LEAD_GOLEM: return 400;
		case PM_ANIMATED_PROSTITUTE_SHOE: return 400;
		case PM_WEREPROSTITUTESHOE: return 400;
		case PM_JUGGERNAUT_OF_KHORNE: return 450;
		case PM_BURNING_MONSTER: return 250;
		case PM_ANIMATED_SEXY_LEATHER_PUMP: return 250;
		case PM_WERESEXYLEATHERPUMP: return 250;
		case PM_ANIMATED_SKY_HIGH_HEEL: return 300;
		case PM_ANIMATED_UNFAIR_STILETTO: return 350;
		case PM_WEREUNFAIRSTILETTO: return 350;
		case PM_ANIMATED_BEAUTIFUL_FUNNEL_HEELED_PUMP: return 350;
		case PM_WEREBEAUTIFULFUNNELHEELEDPUMP: return 350;
		case PM_DIAMOND_GOLEM: return 270;
		case PM_SAPPHIRE_GOLEM: return 280;
		case PM_EMERALD_GOLEM: return 300;
		case PM_TOPAZ_GOLEM: return 320;
		case PM_AMETHYST_GOLEM: return 250;
		case PM_STEEL_GOLEM: return 290;
		case PM_CRYSTAL_GOLEM: return 300;
		case PM_CRYSTAL_STATUE: return 300;
		case PM_CRYSTAL_ICE_GOLEM: return 300;
		case PM_KASA_OBAKE: return 15;
		case PM_MARIONETTE: return 400;
		case PM_ANIMATED_COMBAT_STILETTO: return 300;
		case PM_WERECOMBATSTILETTO: return 300;
		case PM_ETERNIUM_GOLEM: return 350;
		case PM_ETHER_GOLEM: return 350;
		case PM_THE_DISGUSTING_SMOKER_FRIEND_OF_MARIE: return 350;
		case PM_EBONY_GOLEM: return 400;
		case PM_BRICK_GOLEM: return 500;
		case PM_CONUNDRUM_GOLEM: return 400;
		case PM_PWN_BUBBLE_GOLEM: return 250;
		case PM_CELESTIUM_GOLEM: return 250;
		case PM_CENTER_OF_ALL: return 400;
		case PM_TIME_GOLEM: return 400;
		case PM_LION_SHAPED_GOLEM: return 450;
		case PM_DAZZLING_GOLEM: return 450;
		case PM_FINNISH_EXPLORER: return 400;
		case PM_ARCTIC_WONDERER: return 400;
		case PM_FRANKENSTEIN_S_MONSTER: return 400;
		case PM_M_LING__MONTGOMERY_S_ATTENDANT: return 400;
		case PM_PINOCCHIO: return 400;
		case PM_GOLEM: return 400;
		case PM_BLOODY_BEAUTIES: return 500;
		case PM_KASTORTRANSPORT: return 500;
		case PM_METEOSTEEL_GOLEM: return 500;
		case PM_ANIMATED_WINTER_STILETTO: return 500;
		case PM_WEREWINTERSTILETTO: return 500;
		case PM_ROBO_KY: return 750;
		case PM_IRIS_S_SILVER_PUMP: return 750;
		case PM_INVULNERABLE_GOLEM: return 2000;
		case PM_MIKRAANESIS: return 2000;
		case PM_HAMMER_OF_THE_UNDERWORLD: return 1000;
		case PM_WAX_GOLEM: return 40;
		case PM_WRAP_GOLEM: return 40;
		case PM_TIN_GOLEM: return 40;
		case PM_RESIN_GOLEM: return 40;
		case PM_PLASTIC_GOLEM: return 60;
		case PM_PLASTIC_EXPLOSIVES_GOLEM: return 180;
		case PM_MOTHERFUCKER_GLASS_GOLEM: return 1000;
		default: return (mons[type].mlevel * 10); /* failsafe so undefined golems don't start with zero hp! --Amy */
	}
}

#endif /* OVLB */
#ifdef OVL1

/*
 *	Alignment vs. yours determines monster's attitude to you.
 *	( some "animal" types are co-aligned, but also hungry )
 */

boolean
peace_minded(ptr)
register struct permonst *ptr;
{

	if (Race_if(PM_RODNEYAN) && monsndx(ptr) == PM_RODNEY_S_SISTER) return TRUE;

	if (EnmityBug || u.uprops[ENMITY_BUG].extrinsic || have_inimicalstone() || (uarmf && uarmf->oartifact == ART_HERSAY_PRICE) || (uwep && uwep->oartifact == ART_DRAMA_STAFF) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_DRAMA_STAFF) || (uwep && uwep->oartifact == ART_TOMMY_S_DEFERRED_HEEL) || (u.twoweap && uswapwep && uswapwep->oartifact == ART_TOMMY_S_DEFERRED_HEEL)) return FALSE;

	if (Race_if(PM_DUTHOL) && !rn2(2)) return FALSE;

	if (Race_if(PM_ALBAE) || Race_if(PM_IRAHA) || Race_if(PM_NEMESIS) || Race_if(PM_RODNEYAN) || issoviet || Role_if(PM_MURDERER) || Role_if(PM_FAILED_EXISTENCE) ) return FALSE; /* albae are hated by all other races --Amy */
	if (Role_if(PM_CRUEL_ABUSER) && Qstats(killed_nemesis) ) return FALSE; /* you murderer! */
	if (uarmf && uarmf->oartifact == ART_HERMES__UNFAIRNESS) return FALSE;
	if (uarmf && uarmf->oartifact == ART_HADES_THE_MEANIE) return FALSE;
	if (uarmf && uarmf->oartifact == ART_HENRIETTA_S_DOGSHIT_BOOTS) return FALSE;
	if (uarmf && uarmf->oartifact == ART_TOTALLY_THE_SEXY_BITCH) return FALSE;
	if (uarmf && uarmf->oartifact == ART_NOW_YOU_ARE_HOWEVER_TO) return FALSE;
	if (ptr->msound == MS_NEMESIS)	return FALSE;
	if (u.kyliemode) return FALSE;
	if (RngeUnlikability) return FALSE;
	if (RngeBloodlust) return FALSE;
	if (Aggravate_monster && !rn2(10)) return FALSE;
	if (uwep && uwep->oartifact == ART_MANUELA_S_PRACTICANT_TERRO) return FALSE;
	if (u.twoweap && uswapwep && uswapwep->oartifact == ART_MANUELA_S_PRACTICANT_TERRO) return FALSE;
	if (uarmg && uarmg->oartifact == ART_MARY_INSCRIPTION) return FALSE;

	if (uarmf && uarmf->oartifact == ART_LOVELY_GIRL_PLATEAUS) return FALSE;

	if (uarmc && itemhasappearance(uarmc, APP_POLITICIAN_CLOAK) ) return FALSE;

	if (always_tame(ptr) && (!always_hostile(ptr) || !rn2(3))) return TRUE;

	aligntyp mal = ptr->maligntyp, ual = u.ualign.type;

	if (always_peaceful(ptr)) return TRUE;

	if (uarmf && uarmf->oartifact == ART_VERY_NICE_PERSON && !rn2(5)) return TRUE;

	if (!rn2(Aggravate_monster ? 500 : 100)) return TRUE; /* low chance of getting random peaceful monsters --Amy */

	/* chaotic alignment is too easy and lawful is too hard. Make it easier for neutral and especially lawful by having monsters generate peaceful more often. --Amy */
	if ( (sgn(u.ualign.type) == sgn(ptr->maligntyp) ) && !rn2(20) && !Role_if(PM_CONVICT) && u.ualign.type == A_LAWFUL) return TRUE;
	if ( (sgn(u.ualign.type) == sgn(ptr->maligntyp) ) && !rn2(50) && !Role_if(PM_CONVICT) && u.ualign.type == A_NEUTRAL) return TRUE;

	if (is_pokemon(ptr) && rn2(5) && uarmc && itemhasappearance(uarmc, APP_POKE_MONGO_CLOAK) ) return TRUE;

	if (!rn2(5) && ptr->mlet == S_BAD_FOOD && uarmg && itemhasappearance(uarmg, APP_FLOWER_GLOVES) ) return TRUE;

	if (ptr->mlet == S_LICH && uarmg && uarmg->oartifact == ART_BLACKY_S_BACK_WITHOUT_L) return TRUE;

	if (uarmh && uarmh->oartifact == ART_DOGGO_FRIENDSHIP && ptr->mlet == S_DOG && rn2(10)) return TRUE;
	if (uwep && uwep->oartifact == ART_MAGICBONE && (ptr->mlet == S_DOG || ptr->mlet == S_FELINE) && rn2(2)) return TRUE;

	if (ptr->mlet == S_KOP && Race_if(PM_KOP) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_ANGEL && Race_if(PM_HUMANOID_ANGEL) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if ((ptr->mlet == S_DEMON || is_demon(ptr)) && Race_if(PM_HUMANOID_DEVIL) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;

	if (rn2(10) && RngePolarOpposites && (is_elec_resistant(ptr) || is_acid_resistant(ptr)) && !(is_elec_resistant(ptr) && is_acid_resistant(ptr)) ) return TRUE;
	if (rn2(10) && uarmf && uarmf->oartifact == ART_SPEAK_TO_OJ && (ptr->msound == MS_FART_NORMAL || ptr->msound == MS_FART_QUIET || ptr->msound == MS_FART_LOUD)) return TRUE;

	if (ptr->mlet == S_KOBOLD && Race_if(PM_KOBOLT) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_OGRE && Race_if(PM_OGRO) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_GIANT && Race_if(PM_GIGANT) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_TROLL && Race_if(PM_TROLLOR) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_ANT && Race_if(PM_INSECTOID) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE; /* Go Team Ant! --Amy */
	if (ptr->mlet == S_SNAKE && Race_if(PM_SNAKEMAN) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_SPIDER && Race_if(PM_SPIDERMAN) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_LIZARD && Race_if(PM_ARGONIAN) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_NYMPH && Race_if(PM_NYMPH) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_NYMPH && Role_if(PM_DRUID) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_BAD_FOOD && Role_if(PM_DRUID) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_LEPRECHAUN && Race_if(PM_HUMANOID_LEPRECHAUN) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_HUMANOID && Race_if(PM_ILLITHID) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_VORTEX && Race_if(PM_VORTEX) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_VORTEX && Race_if(PM_CORTEX) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_BAT && Race_if(PM_BATMAN) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_HUMAN && Race_if(PM_VEELA) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_CENTAUR && Race_if(PM_HUMANOID_CENTAUR) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_DRAGON && Race_if(PM_HUMANLIKE_DRAGON) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_NAGA && Race_if(PM_HUMANLIKE_NAGA) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (ptr->mlet == S_QUADRUPED && Race_if(PM_ENGCHIP) && !Role_if(PM_CONVICT) && !rn2(10)) return TRUE;
	if (ptr->mlet == S_TURRET && Race_if(PM_BABYLONIAN) && !Role_if(PM_CONVICT) && !rn2(2)) return TRUE;

	if (uleft && uleft->oartifact == ART_NENYA && is_elf(ptr)) return TRUE;
	if (uright && uright->oartifact == ART_NENYA && is_elf(ptr)) return TRUE;
	if (uarmh && uarmh->oartifact == ART_CLAUDIA_S_SEXY_SCENT && ptr->msound == MS_STENCH && rn2(100)) return TRUE;
	if (uarmf && uarmf->oartifact == ART_FLYSKYHGH && ptr->msound == MS_SHOE && rn2(2)) return TRUE;

	if (ptr->mlet == S_UNICORN && uarmc && uarmc->oartifact == ART_KYS_YOURSELF && !rn2(4)) return TRUE;
	if (uarmc && uarmc->oartifact == ART_KYS_YOURSELF && is_female(ptr) && humanoid(ptr) && rn2(10)) return TRUE;

	if (uarmf && uarmf->oartifact == ART_CRUEL_GODDESS_ANA && !rn2(100)) return TRUE;

	if (ptr->msound == MS_SHOE && Race_if(PM_SHOE) && rn2(100) ) return TRUE;

	if (is_mercenary(ptr) && Role_if(PM_DOOM_MARINE) && rn2(100) ) return TRUE;

	if (ptr->mlet == S_EEL && Race_if(PM_AQUATIC_MONSTER) && !Role_if(PM_CONVICT) && rn2(50)) return TRUE;
	if (ptr->mlet == S_FLYFISH && Race_if(PM_AQUATIC_MONSTER) && !Role_if(PM_CONVICT) && rn2(50)) return TRUE;
	if (ptr->mlet == S_RUSTMONST && Race_if(PM_AQUATIC_MONSTER) && !Role_if(PM_CONVICT) && rn2(50)) return TRUE;
	if ((is_swimmer(ptr) || (ptr)->mflags1 & M1_AMPHIBIOUS) && Race_if(PM_AQUATIC_MONSTER) && !Role_if(PM_CONVICT) && rn2(2)) return TRUE;

	if (ptr->mlet == S_ANGEL && (uarmc && itemhasappearance(uarmc, APP_ANGELIC_CLOAK) ) && rn2(100)) return TRUE;
	if (ptr->mlet == S_DEMON && (uarmc && itemhasappearance(uarmc, APP_DEMONIC_CLOAK) ) && rn2(2)) return TRUE;
	if (ptr->mlet == S_DEMON && (uarmg && uarmg->oartifact == ART_IRIS_S_PRECIOUS_METAL) && rn2(10)) return TRUE;
	if (ptr->mlet == S_DEMON && (uarmf && uarmf->oartifact == ART_PRADA_S_DEVIL_WEAR) && rn2(10)) return TRUE;
	if (ptr->mlet == S_DEMON && (uarmc && uarmc->oartifact == ART_WATERS_OF_OBLIVION) && rn2(20)) return TRUE;

	if (!always_hostile(ptr) && Race_if(PM_ANGBANDER) && !Role_if(PM_CONVICT) && rn2(2)) return TRUE;

	if (telepathic(ptr) && Race_if(PM_LEVITATOR) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;

	if (is_undead(ptr) && !mindless(ptr) && Race_if(PM_HUMAN_WRAITH) && !Role_if(PM_CONVICT) && rn2(100)) return TRUE;
	if (is_undead(ptr) && mindless(ptr) && Race_if(PM_HUMAN_WRAITH) && !Role_if(PM_CONVICT) && rn2(4)) return TRUE;
	if (is_animal(ptr) && rn2(10) && uarm && uarm->oartifact == ART_BEASTMASTER_S_DUSTER) return TRUE;
	if (ptr->mlet == S_NYMPH && uarmg && uarmg->oartifact == ART_WHAT_S_UP_BITCHES && rn2(10)) return TRUE;
	if (uwep && uwep->oartifact == ART_ORANGERY && rn2(10) && (ptr->mcolor == CLR_ORANGE) ) return TRUE;
	if (uarmc && uarmc->oartifact == ART_LIGHT_OF_DECEPTION && !rn2(10)) return TRUE;

	if ((uarmg && itemhasappearance(uarmg, APP_PRINCESS_GLOVES)) && (is_lord(ptr) && !rn2(5)) ) return TRUE;
	if ((uarmg && itemhasappearance(uarmg, APP_PRINCESS_GLOVES)) && (is_prince(ptr) && !rn2(2)) ) return TRUE;

	if ((uarmf && itemhasappearance(uarmf, APP_PRINCESS_PUMPS) ) && (is_lord(ptr) && rn2(2)) ) return TRUE;
	if ((uarmf && itemhasappearance(uarmf, APP_PRINCESS_PUMPS) ) && (is_prince(ptr) && rn2(5)) ) return TRUE;

	if (always_hostile(ptr)) return FALSE;
	if (ptr->msound == MS_LEADER || ptr->msound == MS_GUARDIAN)
		return TRUE;

	if (ptr->mlet == S_ANGEL && Race_if(PM_HUMANOID_DEVIL)) return FALSE;
	if (ptr->mlet == S_DEMON && Race_if(PM_HUMANOID_ANGEL)) return FALSE;
	if (is_demon(ptr) && Race_if(PM_HUMANOID_ANGEL)) return FALSE;

	if (is_elf(ptr) && is_elf(youmonst.data)) {
		/* Light and dark elves are always hostile to each other.
		 * Suggested by Dr. Eva R. Myers.
		 */
		 if ((ual > A_NEUTRAL && mal < A_NEUTRAL) ||
		   (ual < A_NEUTRAL && mal > A_NEUTRAL))
			return FALSE;
	}

	if (race_peaceful(ptr)) return TRUE;
	if (race_hostile(ptr)) return FALSE;

	/* the monster is hostile if its alignment is different from the
	 * player's */
	if (sgn(mal) != sgn(ual)) return FALSE;

	/* Negative monster hostile to player with Amulet. */
	if (mal < A_NEUTRAL && u.uhave.amulet && !u.freeplaymode && (u.amuletcompletelyimbued || !rn2(5)) ) return FALSE;

	/* minions are hostile to players that have strayed at all */
	/* and they can also be hostile to players with good alignment --Amy */
	if (is_minion(ptr) && u.ualign.record < 0 && !issoviet) return FALSE; /*return((boolean)(u.ualign.record >= 0));*/ 

	/* Last case:  a chance of a co-aligned monster being
	 * hostile.  This chance is greater if the player has strayed
	 * (u.ualign.record negative) or the monster is not strongly aligned.
	 * Edit by Amy - much higher chance of the monster being hostile.
	 */
	/*return((boolean)(!!rn2(16 + (u.ualign.record < -15 ? -15 : u.ualign.record)) &&
		!!rn2(2 + abs(mal))));*/

	/* "Coaligned minions/mons shouldn't be hostile often. Reverted the chances of coaligned minions and creatures being hostile back to their original values. - makemon.c" In Soviet Russia, people got annoyed about the fact they still occasionally had to battle archons as a lawful character. They thought that this was making the game too hard, even though the vanilla behavior basically gives lawful characters a free pass to most non-predetermined angel encounters, which IMHO borders on the other extreme: too easy! What's the use of peaceful monsters, anyway? They just serve to get in your way and reduce the amount of monsters that you can fight. --Amy */

	if (u.ualign.record < 0 && rn2(100) && !issoviet) return FALSE;
	if (u.ualign.record == 0 && rn2(50) && !issoviet) return FALSE;
	if (u.ualign.record >= 1 && rnd(u.ualign.record) < (5 + rnd(20)) && rn2(33) && !issoviet ) return FALSE;
	if (!rn2(5 + abs(mal))) return FALSE;
	else return TRUE;
}

/* Set malign to have the proper effect on player alignment if monster is
 * killed.  Negative numbers mean it's bad to kill this monster; positive
 * numbers mean it's good.  Since there are more hostile monsters than
 * peaceful monsters, the penalty for killing a peaceful monster should be
 * greater than the bonus for killing a hostile monster to maintain balance.
 * Rules:
 *   it's bad to kill peaceful monsters, potentially worse to kill always-
 *	peaceful monsters
 *   it's never bad to kill a hostile monster, although it may not be good
 */
void
set_malign(mtmp)
struct monst *mtmp;
{
	schar mal = mtmp->data->maligntyp;
	boolean coaligned;

	if (mtmp->ispriest || mtmp->isminion) {
		/* some monsters have individual alignments; check them */
		if (mtmp->ispriest)
			mal = EPRI(mtmp)->shralign;
		else if (mtmp->isminion)
			mal = EMIN(mtmp)->min_align;
		/* unless alignment is none, set mal to -5,0,5 */
		/* (see align.h for valid aligntyp values)     */
		if(mal != A_NONE)
			mal *= 5;
		/* make priests of Moloch hostile */
		if (mal == A_NONE) mtmp->mpeaceful = 0;
	}


	coaligned = (sgn(mal) == sgn(u.ualign.type));
	if (mtmp->data->msound == MS_LEADER) {
		mtmp->malign = -20;
	} else if (mal == A_NONE) {
		if (mtmp->mpeaceful)
			mtmp->malign = 0;
		else
			mtmp->malign = 20;	/* really hostile */
	} else if (always_peaceful(mtmp->data)) {
		int absmal = abs(mal);
		if (mtmp->mpeaceful)
			mtmp->malign = -3*max(5,absmal);
		else
			mtmp->malign = 3*max(5,absmal); /* renegade */
	} else if (always_hostile(mtmp->data)) {
		int absmal = abs(mal);
		if (coaligned)
			mtmp->malign = 0;
		else
			mtmp->malign = max(5,absmal);
	} else if (coaligned) {
		int absmal = abs(mal);
		if (mtmp->mpeaceful)
			mtmp->malign = -3*max(3,absmal);
		else	/* renegade */
			mtmp->malign = max(3,absmal);
	} else	/* not coaligned and therefore hostile */
		mtmp->malign = abs(mal);
	if (mtmp->malign >= 1 && rn2(5))  mtmp->malign /= 3; /*rebuilding alignment should be harder --Amy*/

	if (mtmp->malign >= 1 && Role_if(PM_POLITICIAN)) mtmp->malign = 0; /* politicians don't like getting their hands dirty */
	if (mtmp->malign >= 1 && evilfriday) mtmp->malign = 0; /* Nethack Fourk did this INGENIOUS change :P */

}

#endif /* OVL1 */
#ifdef OVLB

static NEARDATA char syms[] = {
	MAXOCLASSES, MAXOCLASSES+1, RING_CLASS, WAND_CLASS, WEAPON_CLASS,
	FOOD_CLASS, COIN_CLASS, SCROLL_CLASS, POTION_CLASS, ARMOR_CLASS,
	AMULET_CLASS, IMPLANT_CLASS, TOOL_CLASS, ROCK_CLASS, GEM_CLASS, SPBOOK_CLASS,
	S_MIMIC_DEF, S_MIMIC_DEF, S_MIMIC_DEF,
};

void
set_mimic_sym(mtmp)		/* KAA, modified by ERS */
register struct monst *mtmp;
{
	int typ, roomno, rt;
	unsigned appear, ap_type;
	int s_sym;
	struct obj *otmp;
	int mx, my;

	if (!mtmp) return;
	mx = mtmp->mx; my = mtmp->my;
	typ = levl[mx][my].typ;
					/* only valid for INSIDE of room */
	roomno = levl[mx][my].roomno - ROOMOFFSET;
	if (roomno >= 0)
		rt = rooms[roomno].rtype;
#ifdef SPECIALIZATION
	else if (IS_ROOM(typ))
		rt = OROOM,  roomno = 0;
#endif
	else	rt = 0;	/* roomno < 0 case for GCC_WARN */

	if (OBJ_AT(mx, my)) {
		ap_type = M_AP_OBJECT;
		appear = level.objects[mx][my]->otyp;
	} else if (IS_DOOR(typ) || IS_WALL(typ) ||
		   typ == SDOOR || typ == SCORR) {
		ap_type = M_AP_FURNITURE;
		/*
		 *  If there is a wall to the left that connects to this
		 *  location, then the mimic mimics a horizontal closed door.
		 *  This does not allow doors to be in corners of rooms.
		 */
		if (mx != 0 &&
			(levl[mx-1][my].typ == HWALL    ||
			 levl[mx-1][my].typ == TLCORNER ||
			 levl[mx-1][my].typ == TRWALL   ||
			 levl[mx-1][my].typ == BLCORNER ||
			 levl[mx-1][my].typ == TDWALL   ||
			 levl[mx-1][my].typ == CROSSWALL||
			 levl[mx-1][my].typ == TUWALL    ))
		    appear = S_hcdoor;
		else
		    appear = S_vcdoor;

		if(!mtmp->minvis || See_invisible)
		    block_point(mx,my);	/* vision */
	} else if (level.flags.is_maze_lev && rn2(2)) {
		ap_type = M_AP_OBJECT;
		appear = BOULDER;
	} else if (roomno < 0) {
		ap_type = M_AP_OBJECT;

		if (!rn2(5)) {

			ap_type = M_AP_FURNITURE;

			switch (rnd(50)) {

				case 1:		appear = S_stone; break;
				case 2:		appear = S_bars; break;
				case 3:		appear = S_tree; break;
				case 4:		appear = S_room; break;
				case 5:		appear = S_darkroom; break;
				case 6:		appear = S_corr; break;
				case 7:		appear = S_litcorr; break;
				case 8:		appear = S_altar; break;
				case 9:		appear = S_grave; break;
				case 10:		appear = S_throne; break;
				case 11:		appear = S_sink; break;
				case 12:		appear = S_fountain; break;
				case 13:		appear = S_toilet; break;
				case 14:		appear = S_pool; break;
				case 15:		appear = S_ice; break;
				case 16:		appear = S_lava; break;
				case 17:		appear = S_air; break;
				case 18:		appear = S_cloud; break;
				case 19:		appear = S_water; break;
				case 20:		appear = S_gravewall; break;
				case 21:		appear = S_rockwall; break;
				case 22:		appear = S_tunnelwall; break;
				case 23:		appear = S_farmland; break;
				case 24:		appear = S_mountain; break;
				case 25:		appear = S_watertunnel; break;
				case 26:		appear = S_crystalwater; break;
				case 27:		appear = S_moorland; break;
				case 28:		appear = S_urinelake; break;
				case 29:		appear = S_shiftingsand; break;
				case 30:		appear = S_styxriver; break;
				case 31:		appear = S_well; break;
				case 32:		appear = S_poisonedwell; break;
				case 33:		appear = S_wagon; break;
				case 34:		appear = S_burningwagon; break;
				case 35:		appear = S_woodentable; break;
				case 36:		appear = S_strawmattress; break;
				case 37:		appear = S_snow; break;
				case 38:		appear = S_ash; break;
				case 39:		appear = S_sand; break;
				case 40:		appear = S_pavedfloor; break;
				case 41:		appear = S_highway; break;
				case 42:		appear = S_grassland; break;
				case 43:		appear = S_nethermist; break;
				case 44:		appear = S_stalactite; break;
				case 45:		appear = S_cryptfloor; break;
				case 46:		appear = S_bubbles; break;
				case 47:		appear = S_raincloud; break;
				case 48:		appear = S_pentagram; break;
				case 49:		appear = S_carvedbed; break;
				case 50:		appear = S_grayglyph; break;
				default:		appear = S_stone; break;

			}

		}

		else if (rn2(10)) {

		s_sym = syms[rn2((int)sizeof(syms))];
		if (s_sym >= MAXOCLASSES) {
			ap_type = M_AP_FURNITURE;
			appear = s_sym == MAXOCLASSES ? S_upstair : S_dnstair;
		} else if (s_sym == COIN_CLASS) {
			ap_type = M_AP_OBJECT;
			appear = GOLD_PIECE;
		} else {
			ap_type = M_AP_OBJECT;
			if (s_sym == S_MIMIC_DEF) {
				appear = STRANGE_OBJECT;
			} else {
				otmp = mkobj( (char) s_sym, FALSE, FALSE );
				if (otmp) {
					appear = otmp->otyp;
					/* make sure container contents are free'ed */
					if (Has_contents(otmp))
						delete_contents(otmp);
					obfree(otmp, (struct obj *) 0);
				} else appear = STRANGE_OBJECT;
			}
		}

		}
		else
		appear = BOULDER;
		if(!mtmp->minvis || See_invisible)
		    block_point(mx,my);	/* vision */
	} else if (rt == ZOO || rt == VAULT) {
		ap_type = M_AP_OBJECT;
		appear = GOLD_PIECE;
	} else if (rt == DELPHI) {
		if (rn2(2)) {
			ap_type = M_AP_OBJECT;
			appear = BOULDER;
		} else {
			ap_type = M_AP_FURNITURE;
			appear = S_fountain;
		}
	} else if (rt == TEMPLE) {
		ap_type = M_AP_FURNITURE;
		appear = S_altar;
	/*
	 * We won't bother with beehives, morgues, barracks, throne rooms
	 * since they shouldn't contain too many mimics anyway...
	 */
	} else if (rt >= SHOPBASE) {
		s_sym = get_shop_item(rt - SHOPBASE);
		if (s_sym < 0) {
			ap_type = M_AP_OBJECT;
			appear = -s_sym;
		} else {
			if (s_sym == RANDOM_CLASS)
				s_sym = syms[rn2((int)sizeof(syms)-2) + 2];
			goto assign_sym;
		}
	} else {
		s_sym = syms[rn2((int)sizeof(syms))];
assign_sym:

		if (!rn2(5)) {

			ap_type = M_AP_FURNITURE;

			switch (rnd(50)) {

				case 1:		appear = S_stone; break;
				case 2:		appear = S_bars; break;
				case 3:		appear = S_tree; break;
				case 4:		appear = S_room; break;
				case 5:		appear = S_darkroom; break;
				case 6:		appear = S_corr; break;
				case 7:		appear = S_litcorr; break;
				case 8:		appear = S_altar; break;
				case 9:		appear = S_grave; break;
				case 10:		appear = S_throne; break;
				case 11:		appear = S_sink; break;
				case 12:		appear = S_fountain; break;
				case 13:		appear = S_toilet; break;
				case 14:		appear = S_pool; break;
				case 15:		appear = S_ice; break;
				case 16:		appear = S_lava; break;
				case 17:		appear = S_air; break;
				case 18:		appear = S_cloud; break;
				case 19:		appear = S_water; break;
				case 20:		appear = S_gravewall; break;
				case 21:		appear = S_rockwall; break;
				case 22:		appear = S_tunnelwall; break;
				case 23:		appear = S_farmland; break;
				case 24:		appear = S_mountain; break;
				case 25:		appear = S_watertunnel; break;
				case 26:		appear = S_crystalwater; break;
				case 27:		appear = S_moorland; break;
				case 28:		appear = S_urinelake; break;
				case 29:		appear = S_shiftingsand; break;
				case 30:		appear = S_styxriver; break;
				case 31:		appear = S_well; break;
				case 32:		appear = S_poisonedwell; break;
				case 33:		appear = S_wagon; break;
				case 34:		appear = S_burningwagon; break;
				case 35:		appear = S_woodentable; break;
				case 36:		appear = S_strawmattress; break;
				case 37:		appear = S_snow; break;
				case 38:		appear = S_ash; break;
				case 39:		appear = S_sand; break;
				case 40:		appear = S_pavedfloor; break;
				case 41:		appear = S_highway; break;
				case 42:		appear = S_grassland; break;
				case 43:		appear = S_nethermist; break;
				case 44:		appear = S_stalactite; break;
				case 45:		appear = S_cryptfloor; break;
				case 46:		appear = S_bubbles; break;
				case 47:		appear = S_raincloud; break;
				case 48:		appear = S_pentagram; break;
				case 49:		appear = S_carvedbed; break;
				case 50:		appear = S_grayglyph; break;
				default:		appear = S_stone; break;

			}

		}

		else if (s_sym >= MAXOCLASSES) {
			ap_type = M_AP_FURNITURE;
			appear = s_sym == MAXOCLASSES ? S_upstair : S_dnstair;
		} else if (s_sym == COIN_CLASS) {
			ap_type = M_AP_OBJECT;
			appear = GOLD_PIECE;
		} else {
			ap_type = M_AP_OBJECT;
			if (s_sym == S_MIMIC_DEF) {
				appear = STRANGE_OBJECT;
			} else {
				otmp = mkobj( (char) s_sym, FALSE, FALSE );
				if (otmp) {
					appear = otmp->otyp;
					/* make sure container contents are free'ed */
					if (Has_contents(otmp))
						delete_contents(otmp);
					obfree(otmp, (struct obj *) 0);
				} else appear = STRANGE_OBJECT;
			}
		}
	}

	if (mtmp->data == &mons[PM_CLOAKER] || mtmp->data == &mons[PM_PERMACLOAKER] || mtmp->data == &mons[PM_CLOAK_MIMIC] || mtmp->data == &mons[PM_CLOAK_PERMAMIMIC]) {
		s_sym = ARMOR_CLASS;
		ap_type = M_AP_OBJECT;
		appear = rnd_class(MUMMY_WRAPPING, CLOAK_OF_DISPLACEMENT);
	}

	if (mtmp->data == &mons[PM_IMPLANT_MIMIC] || mtmp->data == &mons[PM_IMPLANT_PERMAMIMIC]) {
		s_sym = IMPLANT_CLASS;
		ap_type = M_AP_OBJECT;
		appear = rnd_class(IMPLANT_OF_ABSORPTION, IMPLANT_OF_ENFORCING);
	}

	if (mtmp->data == &mons[PM_PARENTHESIS]) {
		if (rn2(2)) {
			s_sym = WEAPON_CLASS;
			ap_type = M_AP_OBJECT;
			appear = GREAT_POLLAX;
		} else {
			s_sym = TOOL_CLASS;
			ap_type = M_AP_OBJECT;
			appear = DARK_HORN;
		}
	}
	if (mtmp->data == &mons[PM_HAT_MIMIC] || mtmp->data == &mons[PM_HAT_PERMAMIMIC]) {
		s_sym = ARMOR_CLASS;
		ap_type = M_AP_OBJECT;
		appear = FEDORA;
	}
	if (mtmp->data == &mons[PM_FOODSTUFFS_MIMIC] || mtmp->data == &mons[PM_FOODSTUFFS_PERMAMIMIC]) {
		s_sym = FOOD_CLASS;
		ap_type = M_AP_OBJECT;
		appear = FOOD_RATION;
	}
	if (mtmp->data == &mons[PM_ZOMBIE_BOULDER]) {
		s_sym = ROCK_CLASS;
		ap_type = M_AP_OBJECT;
		appear = BOULDER;
	}
	if (mtmp->data == &mons[PM_OIL_BEETLE]) {
		s_sym = FOOD_CLASS;
		ap_type = M_AP_OBJECT;
		appear = CORPSE;
	}
	if (mtmp->data == &mons[PM_BELT_MOUNTAIN]) {
		ap_type = M_AP_FURNITURE;
		appear = S_mountain;
	}
	if (mtmp->data == &mons[PM_TREEENT]) {
		ap_type = M_AP_FURNITURE;
		appear = S_tree;
	}
	if (mtmp->data == &mons[PM_SEEMINGLY_INNOCUOUS_CLOUD]) {
		ap_type = M_AP_FURNITURE;
		appear = S_cloud;
	}
	if (mtmp->data == &mons[PM_NOT_JUST_A_CLOUD_GRAPHIC]) {
		ap_type = M_AP_FURNITURE;
		appear = S_cloud;
	}
	if (mtmp->data == &mons[PM_STAIRWOLF]) {
		ap_type = M_AP_FURNITURE;
		appear = rn2(2) ? S_upstair : S_dnstair;
	}
	if (mtmp->data == &mons[PM_FAKE_STAIRWOLF]) {
		ap_type = M_AP_FURNITURE;
		appear = rn2(2) ? S_upstair : S_dnstair;
	}
	if (mtmp->data == &mons[PM_TREE_ENT]) {
		ap_type = M_AP_FURNITURE;
		appear = S_tree;
	}
	if (mtmp->data == &mons[PM_ROCK_NYMPH]) {
		ap_type = M_AP_FURNITURE;
		appear = S_rockwall;
	}

	if (mtmp->data == &mons[PM_POTION_MIMIC] || mtmp->data == &mons[PM_POTION_PERMAMIMIC] || mtmp->data == &mons[PM_POTION_HUMANOID_SINK_MONEY_FOOD_TRAP_DEMON_STONE_PORTAL]) {
		s_sym = POTION_CLASS;
		ap_type = M_AP_OBJECT;
		appear = rnd_class(POT_BOOZE, POT_PAN_GALACTIC_GARGLE_BLASTE);
	}

	if (mtmp->data == &mons[PM_RUNESTONE_MIMIC] || mtmp->data == &mons[PM_RUNESTONE_PERMAMIMIC]) {
		s_sym = GEM_CLASS;
		ap_type = M_AP_OBJECT;
		appear = rnd_class(DILITHIUM_CRYSTAL, JADE);
	}

	if (mtmp->data == &mons[PM_SCROLL_MIMIC] || mtmp->data == &mons[PM_SCROLL_PERMAMIMIC] || mtmp->data == &mons[PM_MAP_MIMIC] || mtmp->data == &mons[PM_MAP_PERMAMIMIC]) {
		s_sym = SCROLL_CLASS;
		ap_type = M_AP_OBJECT;
		appear = rnd_class(SCR_CREATE_MONSTER, SCR_GIRLINESS);
	}

	if (mtmp->data == &mons[PM_STAFF_MIMIC] || mtmp->data == &mons[PM_STAFF_PERMAMIMIC]) {
		s_sym = WEAPON_CLASS;
		ap_type = M_AP_OBJECT;
		appear = QUARTERSTAFF;
	}

	if (mtmp->data == &mons[PM_MAGIC_BOOK_MIMIC] || mtmp->data == &mons[PM_MAGIC_BOOK_PERMAMIMIC] || mtmp->data == &mons[PM_PRAYER_BOOK_MIMIC] || mtmp->data == &mons[PM_PRAYER_BOOK_PERMAMIMIC] || mtmp->data == &mons[PM_SONG_BOOK_MIMIC] || mtmp->data == &mons[PM_SONG_BOOK_PERMAMIMIC]) {
		s_sym = SPBOOK_CLASS;
		ap_type = M_AP_OBJECT;
		appear = rnd_class(SPE_FORCE_BOLT, SPE_PSYBEAM);
	}

	if (mtmp->data == &mons[PM_ROD_MIMIC] || mtmp->data == &mons[PM_ROD_PERMAMIMIC]) {
		s_sym = WEAPON_CLASS;
		ap_type = M_AP_OBJECT;
		appear = STAR_ROD;
	}

	if (mtmp->data == &mons[PM_WAND_MIMIC] || mtmp->data == &mons[PM_WAND_PERMAMIMIC]) {
		s_sym = WAND_CLASS;
		ap_type = M_AP_OBJECT;
		appear = rnd_class(WAN_LIGHT, WAN_PSYBEAM);
	}

	if (mtmp->data == &mons[PM_RING_MIMIC] || mtmp->data == &mons[PM_RING_PERMAMIMIC]) {
		s_sym = RING_CLASS;
		ap_type = M_AP_OBJECT;
		appear = rnd_class(RIN_ADORNMENT, RIN_TELEPORT_CONTROL);
	}

	if (mtmp->data == &mons[PM_CHEST_MIMIC] || mtmp->data == &mons[PM_CHEST_PERMAMIMIC]) {
		s_sym = TOOL_CLASS;
		ap_type = M_AP_OBJECT;
		appear = CHEST;
	}

	if (mtmp->data == &mons[PM_DOOR_MIMIC] || mtmp->data == &mons[PM_DOOR_PERMAMIMIC] || mtmp->data == &mons[PM_SMALL_DOOR_MIMIC] || mtmp->data == &mons[PM_SMALL_DOOR_PERMAMIMIC]) {
		s_sym = MAXOCLASSES;
		ap_type = M_AP_FURNITURE;
		appear = S_hcdoor;
	}

	if (mtmp->data == &mons[PM_DEMONIC_DOOR] || mtmp->data == &mons[PM_SATANIC_DOOR]) {
		s_sym = MAXOCLASSES;
		ap_type = M_AP_FURNITURE;
		appear = S_hcdoor;
	}

	if (mtmp->data == &mons[PM_BLACK_SPACE_GHOST]) {
		s_sym = MAXOCLASSES;
		ap_type = M_AP_FURNITURE;
		appear = S_stone;
	}
	if (mtmp->data == &mons[PM_LOL_OWNED]) {
		s_sym = MAXOCLASSES;
		ap_type = M_AP_FURNITURE;
		appear = S_stone;
	}
	if (mtmp->data == &mons[PM_U_HAVE_BEEN_PWNZ_RED]) {
		s_sym = MAXOCLASSES;
		ap_type = M_AP_FURNITURE;
		appear = S_stone;
	}

	if (mtmp->data == &mons[PM_REAL_OCTOTHORPE] || mtmp->data == &mons[PM_REAL_GIANT_OCTOTHORPE]) {
		s_sym = MAXOCLASSES;
		ap_type = M_AP_FURNITURE;
		appear = S_grayglyph;
	}



	mtmp->m_ap_type = ap_type;
	mtmp->mappearance = appear;
}

/* release a monster from a bag of tricks */
void
bagotricks(bag)
struct obj *bag;
{
    if (!bag || bag->otyp != BAG_OF_TRICKS) {
	impossible("bad bag o' tricks");
    } else if (bag->spe < 1) {
	pline("%s", nothing_happens);
	if (FailureEffects || u.uprops[FAILURE_EFFECTS].extrinsic || have_failurestone()) {
		pline("Oh wait, actually something bad happens...");
		badeffect();
	}
    } else {
	boolean gotone = FALSE;
	int cnt = 1;

	int nochargechange = 10;
	if (!(PlayerCannotUseSkills)) {
		switch (P_SKILL(P_DEVICES)) {
			default: break;
			case P_BASIC: nochargechange = 9; break;
			case P_SKILLED: nochargechange = 8; break;
			case P_EXPERT: nochargechange = 7; break;
			case P_MASTER: nochargechange = 6; break;
			case P_GRAND_MASTER: nochargechange = 5; break;
			case P_SUPREME_MASTER: nochargechange = 4; break;
		}
	}
	if (nochargechange >= rnd(10)) consume_obj_charge(bag, TRUE);

	if (Aggravate_monster) {
		u.aggravation = 1;
		reset_rndmonst(NON_PM);
	}

	if (!rn2(23)) cnt += rn1(7, 1);
	if (bag && bag->oartifact == ART_VERY_TRICKY_INDEED) cnt *= 2;

	while (cnt-- > 0) {
	    if (makemon((struct permonst *)0, u.ux, u.uy, NO_MM_FLAGS))
		gotone = TRUE;
	}
	if (gotone) makeknown(BAG_OF_TRICKS);

	u.aggravation = 0;

    }
}

#endif /* OVLB */

/*makemon.c*/
